var gb=Object.defineProperty;var yb=(n,a,u)=>a in n?gb(n,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):n[a]=u;var hc=(n,a,u)=>(yb(n,typeof a!="symbol"?a+"":a,u),u);import{r as Z,u as Qp,a as da,R as _b,P as Si,_ as Ve,c as Rc,S as ef,b as Hu,d as xb,e as tf,T as Yu,f as Ec,g as X_,s as Hr,j as nt,h as wt,F as mh,i as Ju,k as Yg,l as vb,m as Bt,n as bb,o as wb,p as Sb}from"./Start.15551df6.js";var Eb=function(n){if(typeof document>"u")return null;var a=Array.isArray(n)?n[0]:n;return a.ownerDocument.body},Js=new WeakMap,Fu=new WeakMap,Bu={},Ep=0,Tb=function(n,a,u){a===void 0&&(a=Eb(n)),u===void 0&&(u="data-aria-hidden");var g=Array.isArray(n)?n:[n];Bu[u]||(Bu[u]=new WeakMap);var _=Bu[u],w=[],T=new Set,l=function(D){!D||T.has(D)||(T.add(D),l(D.parentNode))};g.forEach(l);var O=function(D){!D||g.indexOf(D)>=0||Array.prototype.forEach.call(D.children,function(V){if(T.has(V))O(V);else{var K=V.getAttribute("aria-hidden"),ae=K!==null&&K!=="false",de=(Js.get(V)||0)+1,xe=(_.get(V)||0)+1;Js.set(V,de),_.set(V,xe),w.push(V),de===1&&ae&&Fu.set(V,!0),xe===1&&V.setAttribute(u,"true"),ae||V.setAttribute("aria-hidden","true")}})};return O(a),T.clear(),Ep++,function(){w.forEach(function(D){var V=Js.get(D)-1,K=_.get(D)-1;Js.set(D,V),_.set(D,K),V||(Fu.has(D)||D.removeAttribute("aria-hidden"),Fu.delete(D)),K||D.removeAttribute(u)}),Ep--,Ep||(Js=new WeakMap,Js=new WeakMap,Fu=new WeakMap,Bu={})}},la=function(){return la=Object.assign||function(a){for(var u,g=1,_=arguments.length;g<_;g++){u=arguments[g];for(var w in u)Object.prototype.hasOwnProperty.call(u,w)&&(a[w]=u[w])}return a},la.apply(this,arguments)};function Cb(n,a){var u={};for(var g in n)Object.prototype.hasOwnProperty.call(n,g)&&a.indexOf(g)<0&&(u[g]=n[g]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,g=Object.getOwnPropertySymbols(n);_<g.length;_++)a.indexOf(g[_])<0&&Object.prototype.propertyIsEnumerable.call(n,g[_])&&(u[g[_]]=n[g[_]]);return u}function kb(n,a,u){if(u||arguments.length===2)for(var g=0,_=a.length,w;g<_;g++)(w||!(g in a))&&(w||(w=Array.prototype.slice.call(a,0,g)),w[g]=a[g]);return n.concat(w||Array.prototype.slice.call(a))}var Qu="right-scroll-bar-position",eh="width-before-scroll-bar",Ib="with-scroll-bars-hidden",Ab="--removed-body-scroll-bar-size";function Pb(n,a){return typeof n=="function"?n(a):n&&(n.current=a),n}function Mb(n,a){var u=Z.exports.useState(function(){return{value:n,callback:a,facade:{get current(){return u.value},set current(g){var _=u.value;_!==g&&(u.value=g,u.callback(g,_))}}}})[0];return u.callback=a,u.facade}function zb(n,a){return Mb(a||null,function(u){return n.forEach(function(g){return Pb(g,u)})})}var gh=function(){return gh=Object.assign||function(a){for(var u,g=1,_=arguments.length;g<_;g++){u=arguments[g];for(var w in u)Object.prototype.hasOwnProperty.call(u,w)&&(a[w]=u[w])}return a},gh.apply(this,arguments)};function Db(n,a){var u={};for(var g in n)Object.prototype.hasOwnProperty.call(n,g)&&a.indexOf(g)<0&&(u[g]=n[g]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,g=Object.getOwnPropertySymbols(n);_<g.length;_++)a.indexOf(g[_])<0&&Object.prototype.propertyIsEnumerable.call(n,g[_])&&(u[g[_]]=n[g[_]]);return u}function Rb(n){return n}function Lb(n,a){a===void 0&&(a=Rb);var u=[],g=!1,_={read:function(){if(g)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return u.length?u[u.length-1]:n},useMedium:function(w){var T=a(w,g);return u.push(T),function(){u=u.filter(function(l){return l!==T})}},assignSyncMedium:function(w){for(g=!0;u.length;){var T=u;u=[],T.forEach(w)}u={push:function(l){return w(l)},filter:function(){return u}}},assignMedium:function(w){g=!0;var T=[];if(u.length){var l=u;u=[],l.forEach(w),T=u}var O=function(){var V=T;T=[],V.forEach(w)},D=function(){return Promise.resolve().then(O)};D(),u={push:function(V){T.push(V),D()},filter:function(V){return T=T.filter(V),u}}}};return _}function Fb(n){n===void 0&&(n={});var a=Lb(null);return a.options=gh({async:!0,ssr:!1},n),a}var K_=function(n){var a=n.sideCar,u=Db(n,["sideCar"]);if(!a)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var g=a.read();if(!g)throw new Error("Sidecar medium not found");return Z.exports.createElement(g,gh({},u))};K_.isSideCarExport=!0;function Bb(n,a){return n.useMedium(a),K_}var H_=Fb(),Tp=function(){},Ah=Z.exports.forwardRef(function(n,a){var u=Z.exports.useRef(null),g=Z.exports.useState({onScrollCapture:Tp,onWheelCapture:Tp,onTouchMoveCapture:Tp}),_=g[0],w=g[1],T=n.forwardProps,l=n.children,O=n.className,D=n.removeScrollBar,V=n.enabled,K=n.shards,ae=n.sideCar,de=n.noIsolation,xe=n.inert,oe=n.allowPinchZoom,_e=n.as,ge=_e===void 0?"div":_e,Ie=Cb(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),De=ae,We=zb([u,a]),Me=la(la({},Ie),_);return Z.exports.createElement(Z.exports.Fragment,null,V&&Z.exports.createElement(De,{sideCar:H_,removeScrollBar:D,shards:K,noIsolation:de,inert:xe,setCallbacks:w,allowPinchZoom:!!oe,lockRef:u}),T?Z.exports.cloneElement(Z.exports.Children.only(l),la(la({},Me),{ref:We})):Z.exports.createElement(ge,la({},Me,{className:O,ref:We}),l))});Ah.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ah.classNames={fullWidth:eh,zeroRight:Qu};var Ob=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function $b(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var a=Ob();return a&&n.setAttribute("nonce",a),n}function Ub(n,a){n.styleSheet?n.styleSheet.cssText=a:n.appendChild(document.createTextNode(a))}function Nb(n){var a=document.head||document.getElementsByTagName("head")[0];a.appendChild(n)}var Vb=function(){var n=0,a=null;return{add:function(u){n==0&&(a=$b())&&(Ub(a,u),Nb(a)),n++},remove:function(){n--,!n&&a&&(a.parentNode&&a.parentNode.removeChild(a),a=null)}}},jb=function(){var n=Vb();return function(a){Z.exports.useEffect(function(){return n.add(a),function(){n.remove()}},[a])}},Y_=function(){var n=jb(),a=function(u){var g=u.styles;return n(g),null};return a},qb={left:0,top:0,right:0,gap:0},Cp=function(n){return parseInt(n||"",10)||0},Gb=function(n){var a=window.getComputedStyle(document.body),u=a[n==="padding"?"paddingLeft":"marginLeft"],g=a[n==="padding"?"paddingTop":"marginTop"],_=a[n==="padding"?"paddingRight":"marginRight"];return[Cp(u),Cp(g),Cp(_)]},Jg=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return qb;var a=Gb(n),u=document.documentElement.clientWidth,g=window.innerWidth;return{left:a[0],top:a[1],right:a[2],gap:Math.max(0,g-u+a[2]-a[0])}},Zb=Y_(),Wb=function(n,a,u,g){var _=n.left,w=n.top,T=n.right,l=n.gap;return u===void 0&&(u="margin"),`
  .`.concat(Ib,` {
   overflow: hidden `).concat(g,`;
   padding-right: `).concat(l,"px ").concat(g,`;
  }
  body {
    overflow: hidden `).concat(g,`;
    overscroll-behavior: contain;
    `).concat([a&&"position: relative ".concat(g,";"),u==="margin"&&`
    padding-left: `.concat(_,`px;
    padding-top: `).concat(w,`px;
    padding-right: `).concat(T,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(g,`;
    `),u==="padding"&&"padding-right: ".concat(l,"px ").concat(g,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qu,` {
    right: `).concat(l,"px ").concat(g,`;
  }
  
  .`).concat(eh,` {
    margin-right: `).concat(l,"px ").concat(g,`;
  }
  
  .`).concat(Qu," .").concat(Qu,` {
    right: 0 `).concat(g,`;
  }
  
  .`).concat(eh," .").concat(eh,` {
    margin-right: 0 `).concat(g,`;
  }
  
  body {
    `).concat(Ab,": ").concat(l,`px;
  }
`)},Xb=function(n){var a=Z.exports.useState(Jg(n.gapMode)),u=a[0],g=a[1];Z.exports.useEffect(function(){g(Jg(n.gapMode))},[n.gapMode]);var _=n.noRelative,w=n.noImportant,T=n.gapMode,l=T===void 0?"margin":T;return Z.exports.createElement(Zb,{styles:Wb(u,!_,l,w?"":"!important")})},rf=!1;if(typeof window<"u")try{var Ou=Object.defineProperty({},"passive",{get:function(){return rf=!0,!0}});window.addEventListener("test",Ou,Ou),window.removeEventListener("test",Ou,Ou)}catch{rf=!1}var Qs=rf?{passive:!1}:!1,Kb=function(n){var a=window.getComputedStyle(n);return a.overflowY!=="hidden"&&!(a.overflowY===a.overflowX&&a.overflowY==="visible")},Hb=function(n){var a=window.getComputedStyle(n);return a.overflowX!=="hidden"&&!(a.overflowY===a.overflowX&&a.overflowX==="visible")},Qg=function(n,a){var u=a;do{typeof ShadowRoot<"u"&&u instanceof ShadowRoot&&(u=u.host);var g=J_(n,u);if(g){var _=Q_(n,u),w=_[1],T=_[2];if(w>T)return!0}u=u.parentNode}while(u&&u!==document.body);return!1},Yb=function(n){var a=n.scrollTop,u=n.scrollHeight,g=n.clientHeight;return[a,u,g]},Jb=function(n){var a=n.scrollLeft,u=n.scrollWidth,g=n.clientWidth;return[a,u,g]},J_=function(n,a){return n==="v"?Kb(a):Hb(a)},Q_=function(n,a){return n==="v"?Yb(a):Jb(a)},Qb=function(n,a){return n==="h"&&a==="rtl"?-1:1},ew=function(n,a,u,g,_){var w=Qb(n,window.getComputedStyle(a).direction),T=w*g,l=u.target,O=a.contains(l),D=!1,V=T>0,K=0,ae=0;do{var de=Q_(n,l),xe=de[0],oe=de[1],_e=de[2],ge=oe-_e-w*xe;(xe||ge)&&J_(n,l)&&(K+=ge,ae+=xe),l=l.parentNode}while(!O&&l!==document.body||O&&(a.contains(l)||a===l));return(V&&(_&&K===0||!_&&T>K)||!V&&(_&&ae===0||!_&&-T>ae))&&(D=!0),D},$u=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},ey=function(n){return[n.deltaX,n.deltaY]},ty=function(n){return n&&"current"in n?n.current:n},tw=function(n,a){return n[0]===a[0]&&n[1]===a[1]},rw=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},nw=0,el=[];function iw(n){var a=Z.exports.useRef([]),u=Z.exports.useRef([0,0]),g=Z.exports.useRef(),_=Z.exports.useState(nw++)[0],w=Z.exports.useState(function(){return Y_()})[0],T=Z.exports.useRef(n);Z.exports.useEffect(function(){T.current=n},[n]),Z.exports.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(_));var oe=kb([n.lockRef.current],(n.shards||[]).map(ty),!0).filter(Boolean);return oe.forEach(function(_e){return _e.classList.add("allow-interactivity-".concat(_))}),function(){document.body.classList.remove("block-interactivity-".concat(_)),oe.forEach(function(_e){return _e.classList.remove("allow-interactivity-".concat(_))})}}},[n.inert,n.lockRef.current,n.shards]);var l=Z.exports.useCallback(function(oe,_e){if("touches"in oe&&oe.touches.length===2)return!T.current.allowPinchZoom;var ge=$u(oe),Ie=u.current,De="deltaX"in oe?oe.deltaX:Ie[0]-ge[0],We="deltaY"in oe?oe.deltaY:Ie[1]-ge[1],Me,Re=oe.target,Ce=Math.abs(De)>Math.abs(We)?"h":"v";if("touches"in oe&&Ce==="h"&&Re.type==="range")return!1;var Ze=Qg(Ce,Re);if(!Ze)return!0;if(Ze?Me=Ce:(Me=Ce==="v"?"h":"v",Ze=Qg(Ce,Re)),!Ze)return!1;if(!g.current&&"changedTouches"in oe&&(De||We)&&(g.current=Me),!Me)return!0;var yt=g.current||Me;return ew(yt,_e,oe,yt==="h"?De:We,!0)},[]),O=Z.exports.useCallback(function(oe){var _e=oe;if(!(!el.length||el[el.length-1]!==w)){var ge="deltaY"in _e?ey(_e):$u(_e),Ie=a.current.filter(function(Me){return Me.name===_e.type&&Me.target===_e.target&&tw(Me.delta,ge)})[0];if(Ie&&Ie.should){_e.preventDefault();return}if(!Ie){var De=(T.current.shards||[]).map(ty).filter(Boolean).filter(function(Me){return Me.contains(_e.target)}),We=De.length>0?l(_e,De[0]):!T.current.noIsolation;We&&_e.preventDefault()}}},[]),D=Z.exports.useCallback(function(oe,_e,ge,Ie){var De={name:oe,delta:_e,target:ge,should:Ie};a.current.push(De),setTimeout(function(){a.current=a.current.filter(function(We){return We!==De})},1)},[]),V=Z.exports.useCallback(function(oe){u.current=$u(oe),g.current=void 0},[]),K=Z.exports.useCallback(function(oe){D(oe.type,ey(oe),oe.target,l(oe,n.lockRef.current))},[]),ae=Z.exports.useCallback(function(oe){D(oe.type,$u(oe),oe.target,l(oe,n.lockRef.current))},[]);Z.exports.useEffect(function(){return el.push(w),n.setCallbacks({onScrollCapture:K,onWheelCapture:K,onTouchMoveCapture:ae}),document.addEventListener("wheel",O,Qs),document.addEventListener("touchmove",O,Qs),document.addEventListener("touchstart",V,Qs),function(){el=el.filter(function(oe){return oe!==w}),document.removeEventListener("wheel",O,Qs),document.removeEventListener("touchmove",O,Qs),document.removeEventListener("touchstart",V,Qs)}},[]);var de=n.removeScrollBar,xe=n.inert;return Z.exports.createElement(Z.exports.Fragment,null,xe?Z.exports.createElement(w,{styles:rw(_)}):null,de?Z.exports.createElement(Xb,{gapMode:"margin"}):null)}const ow=Bb(H_,iw);var e0=Z.exports.forwardRef(function(n,a){return Z.exports.createElement(Ah,la({},n,{ref:a,sideCar:ow}))});e0.classNames=Ah.classNames;const aw=e0;let kp=0;function sw(){Z.exports.useEffect(()=>{var n,a;const u=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(n=u[0])!==null&&n!==void 0?n:ry()),document.body.insertAdjacentElement("beforeend",(a=u[1])!==null&&a!==void 0?a:ry()),kp++,()=>{kp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(g=>g.remove()),kp--}},[])}function ry(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",n}const Ph=n=>{const{present:a,children:u}=n,g=function(T){const[l,O]=Z.exports.useState(),D=Z.exports.useRef({}),V=Z.exports.useRef(T),K=Z.exports.useRef("none"),ae=T?"mounted":"unmounted",[de,xe]=function(oe,_e){return Z.exports.useReducer((ge,Ie)=>{const De=_e[ge][Ie];return De!=null?De:ge},oe)}(ae,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Z.exports.useEffect(()=>{const oe=Uu(D.current);K.current=de==="mounted"?oe:"none"},[de]),Qp(()=>{const oe=D.current,_e=V.current;if(_e!==T){const ge=K.current,Ie=Uu(oe);T?xe("MOUNT"):Ie==="none"||(oe==null?void 0:oe.display)==="none"?xe("UNMOUNT"):xe(_e&&ge!==Ie?"ANIMATION_OUT":"UNMOUNT"),V.current=T}},[T,xe]),Qp(()=>{if(l){const oe=ge=>{const Ie=Uu(D.current).includes(ge.animationName);ge.target===l&&Ie&&xe("ANIMATION_END")},_e=ge=>{ge.target===l&&(K.current=Uu(D.current))};return l.addEventListener("animationstart",_e),l.addEventListener("animationcancel",oe),l.addEventListener("animationend",oe),()=>{l.removeEventListener("animationstart",_e),l.removeEventListener("animationcancel",oe),l.removeEventListener("animationend",oe)}}xe("ANIMATION_END")},[l,xe]),{isPresent:["mounted","unmountSuspended"].includes(de),ref:Z.exports.useCallback(oe=>{oe&&(D.current=getComputedStyle(oe)),O(oe)},[])}}(a),_=typeof u=="function"?u({present:g.isPresent}):Z.exports.Children.only(u),w=da(g.ref,_.ref);return typeof u=="function"||g.isPresent?Z.exports.cloneElement(_,{ref:w}):null};function Uu(n){return(n==null?void 0:n.animationName)||"none"}Ph.displayName="Presence";const lw=Z.exports.forwardRef((n,a)=>{var u;const{container:g=globalThis==null||(u=globalThis.document)===null||u===void 0?void 0:u.body,..._}=n;return g?_b.createPortal(Z.exports.createElement(Si.div,Ve({},_,{ref:a})),g):null});function pa(n){const a=Z.exports.useRef(n);return Z.exports.useEffect(()=>{a.current=n}),Z.exports.useMemo(()=>(...u)=>{var g;return(g=a.current)===null||g===void 0?void 0:g.call(a,...u)},[])}const ny={bubbles:!1,cancelable:!0},cw=Z.exports.forwardRef((n,a)=>{const{loop:u=!1,trapped:g=!1,onMountAutoFocus:_,onUnmountAutoFocus:w,...T}=n,[l,O]=Z.exports.useState(null),D=pa(_),V=pa(w),K=Z.exports.useRef(null),ae=da(a,oe=>O(oe)),de=Z.exports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Z.exports.useEffect(()=>{if(g){let oe=function(ge){if(de.paused||!l)return;const Ie=ge.target;l.contains(Ie)?K.current=Ie:Ya(K.current,{select:!0})},_e=function(ge){!de.paused&&l&&(l.contains(ge.relatedTarget)||Ya(K.current,{select:!0}))};return document.addEventListener("focusin",oe),document.addEventListener("focusout",_e),()=>{document.removeEventListener("focusin",oe),document.removeEventListener("focusout",_e)}}},[g,l,de.paused]),Z.exports.useEffect(()=>{if(l){ay.add(de);const _e=document.activeElement;if(!l.contains(_e)){const ge=new Event("focusScope.autoFocusOnMount",ny);l.addEventListener("focusScope.autoFocusOnMount",D),l.dispatchEvent(ge),ge.defaultPrevented||(function(Ie,{select:De=!1}={}){const We=document.activeElement;for(const Me of Ie)if(Ya(Me,{select:De}),document.activeElement!==We)return}((oe=iy(l),oe.filter(Ie=>Ie.tagName!=="A")),{select:!0}),document.activeElement===_e&&Ya(l))}return()=>{l.removeEventListener("focusScope.autoFocusOnMount",D),setTimeout(()=>{const ge=new Event("focusScope.autoFocusOnUnmount",ny);l.addEventListener("focusScope.autoFocusOnUnmount",V),l.dispatchEvent(ge),ge.defaultPrevented||Ya(_e!=null?_e:document.body,{select:!0}),l.removeEventListener("focusScope.autoFocusOnUnmount",V),ay.remove(de)},0)}}var oe},[l,D,V,de]);const xe=Z.exports.useCallback(oe=>{if(!u&&!g||de.paused)return;const _e=oe.key==="Tab"&&!oe.altKey&&!oe.ctrlKey&&!oe.metaKey,ge=document.activeElement;if(_e&&ge){const Ie=oe.currentTarget,[De,We]=function(Me){const Re=iy(Me),Ce=oy(Re,Me),Ze=oy(Re.reverse(),Me);return[Ce,Ze]}(Ie);De&&We?oe.shiftKey||ge!==We?oe.shiftKey&&ge===De&&(oe.preventDefault(),u&&Ya(We,{select:!0})):(oe.preventDefault(),u&&Ya(De,{select:!0})):ge===Ie&&oe.preventDefault()}},[u,g,de.paused]);return Z.exports.createElement(Si.div,Ve({tabIndex:-1},T,{ref:ae,onKeyDown:xe}))});function iy(n){const a=[],u=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:g=>{const _=g.tagName==="INPUT"&&g.type==="hidden";return g.disabled||g.hidden||_?NodeFilter.FILTER_SKIP:g.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;u.nextNode();)a.push(u.currentNode);return a}function oy(n,a){for(const u of n)if(!uw(u,{upTo:a}))return u}function uw(n,{upTo:a}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(a!==void 0&&n===a)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function Ya(n,{select:a=!1}={}){if(n&&n.focus){const u=document.activeElement;n.focus({preventScroll:!0}),n!==u&&function(g){return g instanceof HTMLInputElement&&"select"in g}(n)&&a&&n.select()}}const ay=function(){let n=[];return{add(a){const u=n[0];a!==u&&(u==null||u.pause()),n=sy(n,a),n.unshift(a)},remove(a){var u;n=sy(n,a),(u=n[0])===null||u===void 0||u.resume()}}}();function sy(n,a){const u=[...n],g=u.indexOf(a);return g!==-1&&u.splice(g,1),u}function hw(n){const a=pa(n);Z.exports.useEffect(()=>{const u=g=>{g.key==="Escape"&&a(g)};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[a])}let ly,Nu=0;function dw({disabled:n}){const a=Z.exports.useRef(!1);Qp(()=>{if(n){let u=function(){Nu--,Nu===0&&(document.body.style.pointerEvents=ly)},g=function(_){a.current=_.pointerType!=="mouse"};return Nu===0&&(ly=document.body.style.pointerEvents),document.body.style.pointerEvents="none",Nu++,document.addEventListener("pointerup",g),()=>{a.current?document.addEventListener("click",u,{once:!0}):u(),document.removeEventListener("pointerup",g)}}},[n])}function Wn(n,a,{checkForDefaultPrevented:u=!0}={}){return function(g){if(n==null||n(g),u===!1||!g.defaultPrevented)return a==null?void 0:a(g)}}const pw=Z.exports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),fw=Z.exports.forwardRef((n,a)=>{const{disableOutsidePointerEvents:u=!1,onEscapeKeyDown:g,onPointerDownOutside:_,onFocusOutside:w,onInteractOutside:T,onDismiss:l,...O}=n,D=Z.exports.useContext(pw),[V,K]=Z.exports.useState(null),[,ae]=Z.exports.useState({}),de=da(a,Re=>K(Re)),xe=Array.from(D.layers),[oe]=[...D.layersWithOutsidePointerEventsDisabled].slice(-1),_e=xe.indexOf(oe),ge=V?xe.indexOf(V):-1,Ie=D.layersWithOutsidePointerEventsDisabled.size>0,De=ge>=_e,We=function(Re){const Ce=pa(Re),Ze=Z.exports.useRef(!1);return Z.exports.useEffect(()=>{const yt=Ot=>{Ot.target&&!Ze.current&&uy("dismissableLayer.pointerDownOutside",Ce,{originalEvent:Ot}),Ze.current=!1},$e=window.setTimeout(()=>{document.addEventListener("pointerdown",yt)},0);return()=>{window.clearTimeout($e),document.removeEventListener("pointerdown",yt)}},[Ce]),{onPointerDownCapture:()=>Ze.current=!0}}(Re=>{const Ce=Re.target,Ze=[...D.branches].some(yt=>yt.contains(Ce));De&&!Ze&&(_==null||_(Re),T==null||T(Re),Re.defaultPrevented||l==null||l())}),Me=function(Re){const Ce=pa(Re),Ze=Z.exports.useRef(!1);return Z.exports.useEffect(()=>{const yt=$e=>{$e.target&&!Ze.current&&uy("dismissableLayer.focusOutside",Ce,{originalEvent:$e})};return document.addEventListener("focusin",yt),()=>document.removeEventListener("focusin",yt)},[Ce]),{onFocusCapture:()=>Ze.current=!0,onBlurCapture:()=>Ze.current=!1}}(Re=>{const Ce=Re.target;[...D.branches].some(Ze=>Ze.contains(Ce))||(w==null||w(Re),T==null||T(Re),Re.defaultPrevented||l==null||l())});return hw(Re=>{ge===D.layers.size-1&&(g==null||g(Re),Re.defaultPrevented||l==null||l())}),dw({disabled:u}),Z.exports.useEffect(()=>{V&&(u&&D.layersWithOutsidePointerEventsDisabled.add(V),D.layers.add(V),cy())},[V,u,D]),Z.exports.useEffect(()=>()=>{V&&(D.layers.delete(V),D.layersWithOutsidePointerEventsDisabled.delete(V),cy())},[V,D]),Z.exports.useEffect(()=>{const Re=()=>ae({});return document.addEventListener("dismissableLayer.update",Re),()=>document.removeEventListener("dismissableLayer.update",Re)},[]),Z.exports.createElement(Si.div,Ve({},O,{ref:de,style:{pointerEvents:Ie?De?"auto":"none":void 0,...n.style},onFocusCapture:Wn(n.onFocusCapture,Me.onFocusCapture),onBlurCapture:Wn(n.onBlurCapture,Me.onBlurCapture),onPointerDownCapture:Wn(n.onPointerDownCapture,We.onPointerDownCapture)}))});function cy(){const n=new Event("dismissableLayer.update");document.dispatchEvent(n)}function uy(n,a,u){const g=u.originalEvent.target,_=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:u});return a&&g.addEventListener(n,a,{once:!0}),!g.dispatchEvent(_)}function Lc({prop:n,defaultProp:a,onChange:u=()=>{}}){const[g,_]=function({defaultProp:O,onChange:D}){const V=Z.exports.useState(O),[K]=V,ae=Z.exports.useRef(K),de=pa(D);return Z.exports.useEffect(()=>{ae.current!==K&&(de(K),ae.current=K)},[K,ae,de]),V}({defaultProp:a,onChange:u}),w=n!==void 0,T=w?n:g,l=pa(u);return[T,Z.exports.useCallback(O=>{if(w){const D=O,V=typeof O=="function"?D(n):O;V!==n&&l(V)}else _(O)},[w,n,_,l])]}const[mw,wM]=Rc("Dialog"),[gw,fa]=mw("Dialog"),yw=n=>{const{__scopeDialog:a,children:u,open:g,defaultOpen:_,onOpenChange:w,modal:T=!0,allowPinchZoom:l}=n,O=Z.exports.useRef(null),D=Z.exports.useRef(null),[V=!1,K]=Lc({prop:g,defaultProp:_,onChange:w});return Z.exports.createElement(gw,{scope:a,triggerRef:O,contentRef:D,contentId:Hu(),titleId:Hu(),descriptionId:Hu(),open:V,onOpenChange:K,onOpenToggle:Z.exports.useCallback(()=>K(ae=>!ae),[K]),modal:T,allowPinchZoom:l},u)},_w=n=>{const{__scopeDialog:a,forceMount:u,children:g,container:_}=n,w=fa("DialogPortal",a);return Z.exports.createElement(Z.exports.Fragment,null,Z.exports.Children.map(g,T=>Z.exports.createElement(Ph,{present:u||w.open},Z.exports.createElement(lw,{asChild:!0,container:_},T))))},xw=Z.exports.forwardRef((n,a)=>{const{forceMount:u,...g}=n,_=fa("DialogOverlay",n.__scopeDialog);return _.modal?Z.exports.createElement(Ph,{present:u||_.open},Z.exports.createElement(vw,Ve({},g,{ref:a}))):null}),vw=Z.exports.forwardRef((n,a)=>{const{__scopeDialog:u,...g}=n,_=fa("DialogOverlay",u);return Z.exports.createElement(aw,{as:ef,allowPinchZoom:_.allowPinchZoom,shards:[_.contentRef]},Z.exports.createElement(Si.div,Ve({"data-state":r0(_.open)},g,{ref:a,style:{pointerEvents:"auto",...g.style}})))}),bw=Z.exports.forwardRef((n,a)=>{const{forceMount:u,...g}=n,_=fa("DialogContent",n.__scopeDialog);return Z.exports.createElement(Ph,{present:u||_.open},_.modal?Z.exports.createElement(ww,Ve({},g,{ref:a})):Z.exports.createElement(Sw,Ve({},g,{ref:a})))}),ww=Z.exports.forwardRef((n,a)=>{const u=fa("DialogContent",n.__scopeDialog),g=Z.exports.useRef(null),_=da(a,u.contentRef,g);return Z.exports.useEffect(()=>{const w=g.current;if(w)return Tb(w)},[]),Z.exports.createElement(t0,Ve({},n,{ref:_,trapFocus:u.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wn(n.onCloseAutoFocus,w=>{var T;w.preventDefault(),(T=u.triggerRef.current)===null||T===void 0||T.focus()}),onPointerDownOutside:Wn(n.onPointerDownOutside,w=>{const T=w.detail.originalEvent,l=T.button===0&&T.ctrlKey===!0;(T.button===2||l)&&w.preventDefault()}),onFocusOutside:Wn(n.onFocusOutside,w=>w.preventDefault())}))}),Sw=Z.exports.forwardRef((n,a)=>{const u=fa("DialogContent",n.__scopeDialog),g=Z.exports.useRef(!1);return Z.exports.createElement(t0,Ve({},n,{ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:_=>{var w,T;(w=n.onCloseAutoFocus)===null||w===void 0||w.call(n,_),_.defaultPrevented||(g.current||(T=u.triggerRef.current)===null||T===void 0||T.focus(),_.preventDefault()),g.current=!1},onInteractOutside:_=>{var w,T;(w=n.onInteractOutside)===null||w===void 0||w.call(n,_),_.defaultPrevented||(g.current=!0);const l=_.target;!((T=u.triggerRef.current)===null||T===void 0)&&T.contains(l)&&_.preventDefault()}}))}),t0=Z.exports.forwardRef((n,a)=>{const{__scopeDialog:u,trapFocus:g,onOpenAutoFocus:_,onCloseAutoFocus:w,...T}=n,l=fa("DialogContent",u),O=Z.exports.useRef(null),D=da(a,O);return sw(),Z.exports.createElement(Z.exports.Fragment,null,Z.exports.createElement(cw,{asChild:!0,loop:!0,trapped:g,onMountAutoFocus:_,onUnmountAutoFocus:w},Z.exports.createElement(fw,Ve({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":r0(l.open)},T,{ref:D,onDismiss:()=>l.onOpenChange(!1)}))),!1)}),Ew=Z.exports.forwardRef((n,a)=>{const{__scopeDialog:u,...g}=n,_=fa("DialogClose",u);return Z.exports.createElement(Si.button,Ve({type:"button"},g,{ref:a,onClick:Wn(n.onClick,()=>_.onOpenChange(!1))}))});function r0(n){return n?"open":"closed"}xb("DialogTitleWarning",{contentName:"DialogContent",titleName:"DialogTitle",docsSlug:"dialog"});const Tw=yw,Cw=_w,kw=xw,Iw=bw,Aw=Ew;function Pw(n,a){if(n==null)return{};var u={},g=Object.keys(n),_,w;for(w=0;w<g.length;w++)_=g[w],!(a.indexOf(_)>=0)&&(u[_]=n[_]);return u}var Mw=["color"],zw=Z.exports.forwardRef(function(n,a){var u=n.color,g=u===void 0?"currentColor":u,_=Pw(n,Mw);return Z.exports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_,{ref:a}),Z.exports.createElement("path",{d:"M7.49933 0.25C3.49635 0.25 0.25 3.49593 0.25 7.50024C0.25 10.703 2.32715 13.4206 5.2081 14.3797C5.57084 14.446 5.70302 14.2222 5.70302 14.0299C5.70302 13.8576 5.69679 13.4019 5.69323 12.797C3.67661 13.235 3.25112 11.825 3.25112 11.825C2.92132 10.9874 2.44599 10.7644 2.44599 10.7644C1.78773 10.3149 2.49584 10.3238 2.49584 10.3238C3.22353 10.375 3.60629 11.0711 3.60629 11.0711C4.25298 12.1788 5.30335 11.8588 5.71638 11.6732C5.78225 11.205 5.96962 10.8854 6.17658 10.7043C4.56675 10.5209 2.87415 9.89918 2.87415 7.12104C2.87415 6.32925 3.15677 5.68257 3.62053 5.17563C3.54576 4.99226 3.29697 4.25521 3.69174 3.25691C3.69174 3.25691 4.30015 3.06196 5.68522 3.99973C6.26337 3.83906 6.8838 3.75895 7.50022 3.75583C8.1162 3.75895 8.73619 3.83906 9.31523 3.99973C10.6994 3.06196 11.3069 3.25691 11.3069 3.25691C11.7026 4.25521 11.4538 4.99226 11.3795 5.17563C11.8441 5.68257 12.1245 6.32925 12.1245 7.12104C12.1245 9.9063 10.4292 10.5192 8.81452 10.6985C9.07444 10.9224 9.30633 11.3648 9.30633 12.0413C9.30633 13.0102 9.29742 13.7922 9.29742 14.0299C9.29742 14.2239 9.42828 14.4496 9.79591 14.3788C12.6746 13.4179 14.75 10.7025 14.75 7.50024C14.75 3.49593 11.5036 0.25 7.49933 0.25Z",fill:g,fillRule:"evenodd",clipRule:"evenodd"}))});const Dw=n=>(a,u)=>{if(u instanceof AbortController)return n(a,u);const g=new AbortController;return n(a,g).then(_=>u(void 0,_.data,_.cacheControl||"",_.expires||""),_=>u(_)).catch(_=>u(_)),{cancel:()=>g.abort()}};class Rw{constructor(a){hc(this,"tiles");hc(this,"metadata");hc(this,"tilev4",async(a,u)=>{if(a.type==="json"){const ae=a.url.substr(10);let de=this.tiles.get(ae);if(de||(de=new tf(ae),this.tiles.set(ae,de)),this.metadata)return{data:await de.getTileJson(a.url)};const xe=await de.getHeader();return{data:{tiles:[`${a.url}/{z}/{x}/{y}`],minzoom:xe.minZoom,maxzoom:xe.maxZoom,bounds:[xe.minLon,xe.minLat,xe.maxLon,xe.maxLat]}}}const g=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),_=a.url.match(g);if(!_)throw new Error("Invalid PMTiles protocol URL");const w=_[1];let T=this.tiles.get(w);T||(T=new tf(w),this.tiles.set(w,T));const l=_[2],O=_[3],D=_[4],V=await T.getHeader(),K=await(T==null?void 0:T.getZxy(+l,+O,+D,u.signal));return K?{data:new Uint8Array(K.data),cacheControl:K.cacheControl,expires:K.expires}:V.tileType===Yu.Mvt?{data:new Uint8Array}:{data:null}});hc(this,"tile",Dw(this.tilev4));this.tiles=new Map,this.metadata=(a==null?void 0:a.metadata)||!1}add(a){this.tiles.set(a.source.getKey(),a)}get(a){return this.tiles.get(a)}}var n0={exports:{}};(function(n,a){(function(u,g){n.exports=g()})(Ec,function(){var u,g,_;function w(l,O){if(!u)u=O;else if(!g)g=O;else{var D="var sharedChunk = {}; ("+u+")(sharedChunk); ("+g+")(sharedChunk);",V={};u(V),_=O(V),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}w(["exports"],function(l){function O(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var D=V;function V(r,e){this.x=r,this.y=e}V.prototype={clone:function(){return new V(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(r,e){var i=Math.cos(r),s=Math.sin(r),h=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},V.convert=function(r){return r instanceof V?r:Array.isArray(r)?new V(r[0],r[1]):r};var K=O(D),ae=de;function de(r,e,i,s){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=i,this.p2y=s}de.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,s=0;s<8;s++){var h=this.sampleCurveX(i)-r;if(Math.abs(h)<e)return i;var f=this.sampleCurveDerivativeX(i);if(Math.abs(f)<1e-6)break;i-=h/f}var y=0,x=1;for(i=r,s=0;s<20&&(h=this.sampleCurveX(i),!(Math.abs(h-r)<e));s++)r>h?y=i:x=i,i=.5*(x-y)+y;return i},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var xe=O(ae);function oe(r,e,i,s){const h=new xe(r,e,i,s);return function(f){return h.solve(f)}}const _e=oe(.25,.1,.25,1);function ge(r,e,i){return Math.min(i,Math.max(e,r))}function Ie(r,e,i){const s=i-e,h=((r-e)%s+s)%s+e;return h===e?i:h}function De(r,...e){for(const i of e)for(const s in i)r[s]=i[s];return r}let We=1;function Me(r,e,i){const s={};for(const h in r)s[h]=e.call(i||this,r[h],h,r);return s}function Re(r,e,i){const s={};for(const h in r)e.call(i||this,r[h],h,r)&&(s[h]=r[h]);return s}function Ce(r){return Array.isArray(r)?r.map(Ce):typeof r=="object"&&r?Me(r,Ce):r}const Ze={};function yt(r){Ze[r]||(typeof console<"u"&&console.warn(r),Ze[r]=!0)}function $e(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function Ot(r){let e=0;for(let i,s,h=0,f=r.length,y=f-1;h<f;y=h++)i=r[h],s=r[y],e+=(s.x-i.x)*(i.y+s.y);return e}function Mt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let or=null;function Xt(r){if(or==null){const e=r.navigator?r.navigator.userAgent:null;or=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return or}function Lr(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Vr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let gn,yn;const _n={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const e=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(r,e=0){return this.getImageCanvasContext(r).getImageData(-e,-e,r.width+2*e,r.height+2*e)},getImageCanvasContext(r){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=r.width,e.height=r.height,i.drawImage(r,0,0,r.width,r.height),i},resolveURL:r=>(gn||(gn=document.createElement("a")),gn.href=r,gn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(yn==null&&(yn=matchMedia("(prefers-reduced-motion: reduce)")),yn.matches)}},Mn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Yr extends Error{constructor(e,i,s,h){super(`AJAXError: ${i} (${e}): ${s}`),this.status=e,this.statusText=i,this.url=s,this.body=h}}const Ct=Mt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Ar=r=>Mn.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))];function Jt(r,e){const i=new AbortController,s=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,cache:r.cache,referrer:Ct(),signal:i.signal});let h=!1,f=!1;return r.type==="json"&&s.headers.set("Accept","application/json"),f||fetch(s).then(y=>y.ok?(x=>{(r.type==="arrayBuffer"||r.type==="image"?x.arrayBuffer():r.type==="json"?x.json():x.text()).then(S=>{f||(h=!0,e(null,S,x.headers.get("Cache-Control"),x.headers.get("Expires")))}).catch(S=>{f||e(new Error(S.message))})})(y):y.blob().then(x=>e(new Yr(y.status,y.statusText,r.url,x)))).catch(y=>{y.code!==20&&e(new Error(y.message))}),{cancel:()=>{f=!0,h||i.abort()}}}const ai=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(Mt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e);if(!Mt())return(Ar(r.url)||Jt)(r,e)}if(!(/^file:/.test(i=r.url)||/^file:/.test(Ct())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Jt(r,e);if(Mt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(s,h){const f=new XMLHttpRequest;f.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(f.responseType="arraybuffer");for(const y in s.headers)f.setRequestHeader(y,s.headers[y]);return s.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=s.credentials==="include",f.onerror=()=>{h(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let y=f.response;if(s.type==="json")try{y=JSON.parse(f.response)}catch(x){return h(x)}h(null,y,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else{const y=new Blob([f.response],{type:f.getResponseHeader("Content-Type")});h(new Yr(f.status,f.statusText,s.url,y))}},f.send(s.body),{cancel:()=>f.abort()}}(r,e)},Hn=function(r,e){return ai(De(r,{type:"arrayBuffer"}),e)};function $i(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const e=new URL(r),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function Qi(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function zn(r,e,i){if(i&&i[r]){const s=i[r].indexOf(e);s!==-1&&i[r].splice(s,1)}}class Jr{constructor(e,i={}){De(this,i),this.type=e}}class Gt extends Jr{constructor(e,i={}){super("error",De({error:e},i))}}class br{on(e,i){return this._listeners=this._listeners||{},Qi(e,i,this._listeners),this}off(e,i){return zn(e,i,this._listeners),zn(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Qi(e,i,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,i){typeof e=="string"&&(e=new Jr(e,i||{}));const s=e.type;if(this.listens(s)){e.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const x of h)x.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const x of f)zn(s,x,this._oneTimeListeners),x.call(this,e);const y=this._eventedParent;y&&(De(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Gt&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Dn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Yn(r,e){const i={};for(const s in r)s!=="ref"&&(i[s]=r[s]);return Dn.forEach(s=>{s in e&&(i[s]=e[s])}),i}function jt(r,e){if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(!jt(r[i],e[i]))return!1;return!0}if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object"||Object.keys(r).length!==Object.keys(e).length)return!1;for(const i in r)if(!jt(r[i],e[i]))return!1;return!0}return r===e}const Lt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ui(r,e,i){i.push({command:Lt.addSource,args:[r,e[r]]})}function Ni(r,e,i){e.push({command:Lt.removeSource,args:[r]}),i[r]=!0}function eo(r,e,i,s){Ni(r,i,s),Ui(r,e,i)}function xn(r,e,i){let s;for(s in r[i])if(Object.prototype.hasOwnProperty.call(r[i],s)&&s!=="data"&&!jt(r[i][s],e[i][s]))return!1;for(s in e[i])if(Object.prototype.hasOwnProperty.call(e[i],s)&&s!=="data"&&!jt(r[i][s],e[i][s]))return!1;return!0}function ar(r,e,i,s,h,f){let y;for(y in e=e||{},r=r||{})Object.prototype.hasOwnProperty.call(r,y)&&(jt(r[y],e[y])||i.push({command:f,args:[s,y,e[y],h]}));for(y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(r,y)&&(jt(r[y],e[y])||i.push({command:f,args:[s,y,e[y],h]}))}function Ti(r){return r.id}function Vi(r,e){return r[e.id]=e,r}class Fe{constructor(e,i,s,h){this.message=(e?`${e}: `:"")+s,h&&(this.identifier=h),i!=null&&i.__line__&&(this.line=i.__line__)}}function Fr(r,...e){for(const i of e)for(const s in i)r[s]=i[s];return r}class Gr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class qt{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[s,h]of i)this.bindings[s]=h}concat(e){return new qt(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const si={kind:"null"},Be={kind:"number"},xt={kind:"string"},vt={kind:"boolean"},Qr={kind:"color"},ji={kind:"object"},pt={kind:"value"},Ci={kind:"collator"},ki={kind:"formatted"},to={kind:"padding"},Jn={kind:"resolvedImage"},ro={kind:"variableAnchorOffsetCollection"};function Zr(r,e){return{kind:"array",itemType:r,N:e}}function er(r){if(r.kind==="array"){const e=er(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const _a=[si,Be,xt,vt,Qr,ki,ji,Zr(pt),to,Jn,ro];function Ii(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Ii(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of _a)if(!Ii(i,e))return null}}return`Expected ${er(r)} but found ${er(e)} instead.`}function X(r,e){return e.some(i=>i.kind===r.kind)}function z(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}function L(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const U=.96422,Y=.82521,ee=4/29,le=6/29,re=3*le*le,te=le*le*le,ue=Math.PI/180,Se=180/Math.PI;function Ee(r){return(r%=360)<0&&(r+=360),r}function Te([r,e,i,s]){let h,f;const y=gt((.2225045*(r=ht(r))+.7168786*(e=ht(e))+.0606169*(i=ht(i)))/1);r===e&&e===i?h=f=y:(h=gt((.4360747*r+.3850649*e+.1430804*i)/U),f=gt((.0139322*r+.0971045*e+.7141733*i)/Y));const x=116*y-16;return[x<0?0:x,500*(h-y),200*(y-f),s]}function ht(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function gt(r){return r>te?Math.pow(r,1/3):r/re+ee}function Je([r,e,i,s]){let h=(r+16)/116,f=isNaN(e)?h:h+e/500,y=isNaN(i)?h:h-i/200;return h=1*mt(h),f=U*mt(f),y=Y*mt(y),[at(3.1338561*f-1.6168667*h-.4906146*y),at(-.9787684*f+1.9161415*h+.033454*y),at(.0719453*f-.2289914*h+1.4052427*y),s]}function at(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function mt(r){return r>le?r*r*r:re*(r-ee)}function Dt(r){return parseInt(r.padEnd(2,r),16)/255}function Kt(r,e){return kt(e?r/100:r,0,1)}function kt(r,e,i){return Math.min(Math.max(e,r),i)}function zt(r){return!r.some(Number.isNaN)}const vn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ft{constructor(e,i,s,h=1,f=!0){this.r=e,this.g=i,this.b=s,this.a=h,f||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,i,s,h]))}static parse(e){if(e instanceof ft)return e;if(typeof e!="string")return;const i=function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=vn[s];if(h){const[y,x,S]=h;return[y/255,x/255,S/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const y=s.length<6?1:2;let x=1;return[Dt(s.slice(x,x+=y)),Dt(s.slice(x,x+=y)),Dt(s.slice(x,x+=y)),Dt(s.slice(x,x+y)||"ff")]}if(s.startsWith("rgb")){const y=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,S,C,A,M,R,B,$,G,H,Q,ce]=y,ne=[A||" ",B||" ",H].join("");if(ne==="  "||ne==="  /"||ne===",,"||ne===",,,"){const he=[C,R,G].join(""),fe=he==="%%%"?100:he===""?255:0;if(fe){const we=[kt(+S/fe,0,1),kt(+M/fe,0,1),kt(+$/fe,0,1),Q?Kt(+Q,ce):1];if(zt(we))return we}}return}}const f=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(f){const[y,x,S,C,A,M,R,B,$]=f,G=[S||" ",A||" ",R].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const H=[+x,kt(+C,0,100),kt(+M,0,100),B?Kt(+B,$):1];if(zt(H))return function([Q,ce,ne,he]){function fe(we){const Ge=(we+Q/30)%12,et=ce*Math.min(ne,1-ne);return ne-et*Math.max(-1,Math.min(Ge-3,9-Ge,1))}return Q=Ee(Q),ce/=100,ne/=100,[fe(0),fe(8),fe(4),he]}(H)}}}(e);return i?new ft(...i,!1):void 0}get rgb(){const{r:e,g:i,b:s,a:h}=this,f=h||1/0;return this.overwriteGetter("rgb",[e/f,i/f,s/f,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[i,s,h,f]=Te(e),y=Math.sqrt(s*s+h*h);return[Math.round(1e4*y)?Ee(Math.atan2(h,s)*Se):NaN,y,i,f]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Te(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,s,h]=this.rgb;return`rgba(${[e,i,s].map(f=>Math.round(255*f)).join(",")},${h})`}}ft.black=new ft(0,0,0,1),ft.white=new ft(1,1,1,1),ft.transparent=new ft(0,0,0,0),ft.red=new ft(1,0,0,1);class Pr{constructor(e,i,s){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Wr{constructor(e,i,s,h,f){this.text=e,this.image=i,this.scale=s,this.fontStack=h,this.textColor=f}}class wr{constructor(e){this.sections=e}static fromString(e){return new wr([new Wr(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof wr?e:wr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Rn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Rn)return e;if(typeof e=="number")return new Rn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Rn(e)}}toString(){return JSON.stringify(this.values)}}const dd=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class en{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof en)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const s=e[i],h=e[i+1];if(typeof s!="string"||!dd.has(s)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new en(e)}}toString(){return JSON.stringify(this.values)}}class Qn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Qn({name:e,available:!1}):null}}function Uc(r,e,i,s){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,e,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,e,i,s]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ss(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof ft||r instanceof Pr||r instanceof wr||r instanceof Rn||r instanceof en||r instanceof Qn)return!0;if(Array.isArray(r)){for(const e of r)if(!ss(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!ss(r[e]))return!1;return!0}return!1}function Sr(r){if(r===null)return si;if(typeof r=="string")return xt;if(typeof r=="boolean")return vt;if(typeof r=="number")return Be;if(r instanceof ft)return Qr;if(r instanceof Pr)return Ci;if(r instanceof wr)return ki;if(r instanceof Rn)return to;if(r instanceof en)return ro;if(r instanceof Qn)return Jn;if(Array.isArray(r)){const e=r.length;let i;for(const s of r){const h=Sr(s);if(i){if(i===h)continue;i=pt;break}i=h}return Zr(i||pt,e)}return ji}function no(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof ft||r instanceof wr||r instanceof Rn||r instanceof en||r instanceof Qn?r.toString():JSON.stringify(r)}class _o{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ss(e[1]))return i.error("invalid value");const s=e[1];let h=Sr(s);const f=i.expectedType;return h.kind!=="array"||h.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(h=f),new _o(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Er{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const ls={string:xt,number:Be,boolean:vt,object:ji};class tn{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let s,h=1;const f=e[0];if(f==="array"){let x,S;if(e.length>2){const C=e[1];if(typeof C!="string"||!(C in ls)||C==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=ls[C],h++}else x=pt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);S=e[2],h++}s=Zr(x,S)}else{if(!ls[f])throw new Error(`Types doesn't contain name = ${f}`);s=ls[f]}const y=[];for(;h<e.length;h++){const x=i.parse(e[h],h,pt);if(!x)return null;y.push(x)}return new tn(s,y)}evaluate(e){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(e);if(!Ii(this.type,Sr(s)))return s;if(i===this.args.length-1)throw new Er(`Expected value to be of type ${er(this.type)}, but found ${er(Sr(s))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const cs={"to-boolean":vt,"to-color":Qr,"to-number":Be,"to-string":xt};class Ai{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[0];if(!cs[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&e.length!==2)return i.error("Expected one argument.");const h=cs[s],f=[];for(let y=1;y<e.length;y++){const x=i.parse(e[y],y,pt);if(!x)return null;f.push(x)}return new Ai(h,f)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let i,s;for(const h of this.args){if(i=h.evaluate(e),s=null,i instanceof ft)return i;if(typeof i=="string"){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Uc(i[0],i[1],i[2],i[3]),!s))return new ft(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Er(s||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const s of this.args){i=s.evaluate(e);const h=Rn.parse(i);if(h)return h}throw new Er(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const s of this.args){i=s.evaluate(e);const h=en.parse(i);if(h)return h}throw new Er(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const s of this.args){if(i=s.evaluate(e),i===null)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Er(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return wr.fromString(no(this.args[0].evaluate(e)));case"resolvedImage":return Qn.fromString(no(this.args[0].evaluate(e)));default:return no(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const xa=["Unknown","Point","LineString","Polygon"];class Zt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=ft.parse(e)),i}}class us{constructor(e,i,s=[],h,f=new qt,y=[]){this.registry=e,this.path=s,this.key=s.map(x=>`[${x}]`).join(""),this.scope=f,this.errors=y,this.expectedType=h,this._isConstant=i}parse(e,i,s,h,f={}){return i?this.concat(i,s,h)._parse(e,f):this._parse(e,f)}_parse(e,i){function s(h,f,y){return y==="assert"?new tn(f,[h]):y==="coerce"?new Ai(f,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[h];if(f){let y=f.parse(e,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,S=y.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(x.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(x,S))return null}else y=s(y,x,i.typeAnnotation||"coerce");else y=s(y,x,i.typeAnnotation||"coerce");else y=s(y,x,i.typeAnnotation||"coerce");else y=s(y,x,i.typeAnnotation||"assert")}if(!(y instanceof _o)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const x=new Zt;try{y=new _o(y.type,y.evaluate(x))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,s){const h=typeof e=="number"?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new us(this.registry,this._isConstant,h,i||null,f,this.errors)}error(e,...i){const s=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new Gr(s,e))}checkSubtype(e,i){const s=Ii(e,i);return s&&this.error(s),s}}class Vo{constructor(e,i,s){this.type=Ci,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const s=e[1];if(typeof s!="object"||Array.isArray(s))return i.error("Collator options argument must be an object.");const h=i.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,vt);if(!h)return null;const f=i.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,vt);if(!f)return null;let y=null;return s.locale&&(y=i.parse(s.locale,1,xt),!y)?null:new Vo(h,f,y)}evaluate(e){return new Pr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const io=8192;function hs(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function va(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function pd(r,e){const i=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*io),Math.round(s*h*io)]}function Nc(r,e,i){const s=r[0]-e[0],h=r[1]-e[1],f=r[0]-i[0],y=r[1]-i[1];return s*y-f*h==0&&s*f<=0&&h*y<=0}function ds(r,e){let i=!1;for(let y=0,x=e.length;y<x;y++){const S=e[y];for(let C=0,A=S.length;C<A-1;C++){if(Nc(r,S[C],S[C+1]))return!1;(h=S[C])[1]>(s=r)[1]!=(f=S[C+1])[1]>s[1]&&s[0]<(f[0]-h[0])*(s[1]-h[1])/(f[1]-h[1])+h[0]&&(i=!i)}}var s,h,f;return i}function fd(r,e){for(let i=0;i<e.length;i++)if(ds(r,e[i]))return!0;return!1}function Vc(r,e,i,s){const h=s[0]-i[0],f=s[1]-i[1],y=(r[0]-i[0])*f-h*(r[1]-i[1]),x=(e[0]-i[0])*f-h*(e[1]-i[1]);return y>0&&x<0||y<0&&x>0}function md(r,e,i){for(const C of i)for(let A=0;A<C.length-1;++A)if((x=[(y=C[A+1])[0]-(f=C[A])[0],y[1]-f[1]])[0]*(S=[(h=e)[0]-(s=r)[0],h[1]-s[1]])[1]-x[1]*S[0]!=0&&Vc(s,h,f,y)&&Vc(f,y,s,h))return!0;var s,h,f,y,x,S;return!1}function jc(r,e){for(let i=0;i<r.length;++i)if(!ds(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(md(r[i],r[i+1],e))return!1;return!0}function qc(r,e){for(let i=0;i<e.length;i++)if(jc(r,e[i]))return!0;return!1}function ps(r,e,i){const s=[];for(let h=0;h<r.length;h++){const f=[];for(let y=0;y<r[h].length;y++){const x=pd(r[h][y],i);hs(e,x),f.push(x)}s.push(f)}return s}function Gc(r,e,i){const s=[];for(let h=0;h<r.length;h++){const f=ps(r[h],e,i);s.push(f)}return s}function Zc(r,e,i,s){if(r[0]<i[0]||r[0]>i[2]){const h=.5*s;let f=r[0]-i[0]>h?-s:i[0]-r[0]>h?s:0;f===0&&(f=r[0]-i[2]>h?-s:i[2]-r[0]>h?s:0),r[0]+=f}hs(e,r)}function fs(r,e,i,s){const h=Math.pow(2,s.z)*io,f=[s.x*io,s.y*io],y=[];for(const x of r)for(const S of x){const C=[S.x+f[0],S.y+f[1]];Zc(C,e,i,h),y.push(C)}return y}function Wc(r,e,i,s){const h=Math.pow(2,s.z)*io,f=[s.x*io,s.y*io],y=[];for(const S of r){const C=[];for(const A of S){const M=[A.x+f[0],A.y+f[1]];hs(e,M),C.push(M)}y.push(C)}if(e[2]-e[0]<=h/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of y)for(const C of S)Zc(C,e,i,h)}var x;return y}class xo{constructor(e,i){this.type=vt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ss(e[1])){const s=e[1];if(s.type==="FeatureCollection")for(let h=0;h<s.features.length;++h){const f=s.features[h].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new xo(s,s.features[h].geometry)}else if(s.type==="Feature"){const h=s.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new xo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new xo(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,s){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(s.type==="Polygon"){const x=ps(s.coordinates,f,y),S=fs(i.geometry(),h,f,y);if(!va(h,f))return!1;for(const C of S)if(!ds(C,x))return!1}if(s.type==="MultiPolygon"){const x=Gc(s.coordinates,f,y),S=fs(i.geometry(),h,f,y);if(!va(h,f))return!1;for(const C of S)if(!fd(C,x))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,s){const h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(s.type==="Polygon"){const x=ps(s.coordinates,f,y),S=Wc(i.geometry(),h,f,y);if(!va(h,f))return!1;for(const C of S)if(!jc(C,x))return!1}if(s.type==="MultiPolygon"){const x=Gc(s.coordinates,f,y),S=Wc(i.geometry(),h,f,y);if(!va(h,f))return!1;for(const C of S)if(!qc(C,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class ms{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const s=e[1];return i.scope.has(s)?new ms(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Ln{constructor(e,i,s,h){this.name=e,this.type=i,this._evaluate=s,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const s=e[0],h=Ln.definitions[s];if(!h)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,x=y.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let S=null;for(const[C,A]of x){S=new us(i.registry,ba,i.path,null,i.scope);const M=[];let R=!1;for(let B=1;B<e.length;B++){const $=e[B],G=Array.isArray(C)?C[B-1]:C.type,H=S.parse($,1+M.length,G);if(!H){R=!0;break}M.push(H)}if(!R)if(Array.isArray(C)&&C.length!==M.length)S.error(`Expected ${C.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const $=Array.isArray(C)?C[B]:C.type,G=M[B];S.concat(B+1).checkSubtype($,G.type)}if(S.errors.length===0)return new Ln(s,f,A,M)}}if(x.length===1)i.errors.push(...S.errors);else{const C=(x.length?x:y).map(([M])=>{return R=M,Array.isArray(R)?`(${R.map(er).join(", ")})`:`(${er(R.type)}...)`;var R}).join(" | "),A=[];for(let M=1;M<e.length;M++){const R=i.parse(e[M],1+A.length);if(!R)return null;A.push(er(R.type))}i.error(`Expected arguments of type ${C}, but found (${A.join(", ")}) instead.`)}return null}static register(e,i){Ln.definitions=i;for(const s in i)e[s]=Ln}}function ba(r){if(r instanceof ms)return ba(r.boundExpression);if(r instanceof Ln&&r.name==="error"||r instanceof Vo||r instanceof xo)return!1;const e=r instanceof Ai||r instanceof tn;let i=!0;return r.eachChild(s=>{i=e?i&&ba(s):i&&s instanceof _o}),!!i&&gs(r)&&Sa(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function gs(r){if(r instanceof Ln&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof xo)return!1;let e=!0;return r.eachChild(i=>{e&&!gs(i)&&(e=!1)}),e}function wa(r){if(r instanceof Ln&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!wa(i)&&(e=!1)}),e}function Sa(r,e){if(r instanceof Ln&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(s=>{i&&!Sa(s,e)&&(i=!1)}),i}function Ea(r,e){const i=r.length-1;let s,h,f=0,y=i,x=0;for(;f<=y;)if(x=Math.floor((f+y)/2),s=r[x],h=r[x+1],s<=e){if(x===i||e<h)return x;f=x+1}else{if(!(s>e))throw new Er("Input is not a number.");y=x-1}return 0}class Ta{constructor(e,i,s){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[h,f]of s)this.labels.push(h),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(e[1],1,Be);if(!s)return null;const h=[];let f=null;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);for(let y=1;y<e.length;y+=2){const x=y===1?-1/0:e[y],S=e[y+1],C=y,A=y+1;if(typeof x!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=x)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const M=i.parse(S,A,f);if(!M)return null;f=f||M.type,h.push([x,M])}return new Ta(f,s,h)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return s[0].evaluate(e);const f=i.length;return h>=i[f-1]?s[f-1].evaluate(e):s[Ea(i,h)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function vo(r,e,i){return r+i*(e-r)}function ys(r,e,i){return r.map((s,h)=>vo(s,e[h],i))}const Fn={number:vo,color:function(r,e,i,s="rgb"){switch(s){case"rgb":{const[h,f,y,x]=ys(r.rgb,e.rgb,i);return new ft(h,f,y,x,!1)}case"hcl":{const[h,f,y,x]=r.hcl,[S,C,A,M]=e.hcl;let R,B;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?R=NaN:(R=S,y!==1&&y!==0||(B=C)):(R=h,A!==1&&A!==0||(B=f));else{let ce=S-h;S>h&&ce>180?ce-=360:S<h&&h-S>180&&(ce+=360),R=h+i*ce}const[$,G,H,Q]=function([ce,ne,he,fe]){return ce=isNaN(ce)?0:ce*ue,Je([he,Math.cos(ce)*ne,Math.sin(ce)*ne,fe])}([R,B!=null?B:vo(f,C,i),vo(y,A,i),vo(x,M,i)]);return new ft($,G,H,Q,!1)}case"lab":{const[h,f,y,x]=Je(ys(r.lab,e.lab,i));return new ft(h,f,y,x,!1)}}},array:ys,padding:function(r,e,i){return new Rn(ys(r.values,e.values,i))},variableAnchorOffsetCollection:function(r,e,i){const s=r.values,h=e.values;if(s.length!==h.length)throw new Er(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${e.toString()}`);const f=[];for(let y=0;y<s.length;y+=2){if(s[y]!==h[y])throw new Er(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${s[y]}, to[${y}]: ${h[y]}`);f.push(s[y]);const[x,S]=s[y+1],[C,A]=h[y+1];f.push([vo(x,C,i),vo(S,A,i)])}return new en(f)}};class Bn{constructor(e,i,s,h,f){this.type=e,this.operator=i,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,x]of f)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(e,i,s,h){let f=0;if(e.name==="exponential")f=yl(i,e.base,s,h);else if(e.name==="linear")f=yl(i,1,s,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;f=new xe(y[0],y[1],y[2],y[3]).solve(yl(i,1,s,h))}return f}static parse(e,i){let[s,h,f,...y]=e;if(!Array.isArray(h)||h.length===0)return i.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const C=h[1];if(typeof C!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:C}}else{if(h[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const C=h.slice(1);if(C.length!==4||C.some(A=>typeof A!="number"||A<0||A>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,Be),!f)return null;const x=[];let S=null;s==="interpolate-hcl"||s==="interpolate-lab"?S=Qr:i.expectedType&&i.expectedType.kind!=="value"&&(S=i.expectedType);for(let C=0;C<y.length;C+=2){const A=y[C],M=y[C+1],R=C+3,B=C+4;if(typeof A!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=A)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const $=i.parse(M,B,S);if(!$)return null;S=S||$.type,x.push([A,$])}return L(S,Be)||L(S,Qr)||L(S,to)||L(S,ro)||L(S,Zr(Be))?new Bn(S,s,h,f,x):i.error(`Type ${er(S)} is not interpolatable.`)}evaluate(e){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return s[0].evaluate(e);const f=i.length;if(h>=i[f-1])return s[f-1].evaluate(e);const y=Ea(i,h),x=Bn.interpolationFactor(this.interpolation,h,i[y],i[y+1]),S=s[y].evaluate(e),C=s[y+1].evaluate(e);switch(this.operator){case"interpolate":return Fn[this.type.kind](S,C,x);case"interpolate-hcl":return Fn.color(S,C,x,"hcl");case"interpolate-lab":return Fn.color(S,C,x,"lab")}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function yl(r,e,i,s){const h=s-i,f=r-i;return h===0?0:e===1?f/h:(Math.pow(e,f)-1)/(Math.pow(e,h)-1)}class _s{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let s=null;const h=i.expectedType;h&&h.kind!=="value"&&(s=h);const f=[];for(const x of e.slice(1)){const S=i.parse(x,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!S)return null;s=s||S.type,f.push(S)}if(!s)throw new Error("No output type");const y=h&&f.some(x=>Ii(h,x.type));return new _s(y?pt:s,f)}evaluate(e){let i,s=null,h=0;for(const f of this.args)if(h++,s=f.evaluate(e),s&&s instanceof Qn&&!s.available&&(i||(i=s.name),s=null,h===this.args.length&&(s=i)),s!==null)break;return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class jo{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const y=e[f];if(typeof y!="string")return i.error(`Expected string, but found ${typeof y} instead.`,f);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const x=i.parse(e[f+1],f+1);if(!x)return null;s.push([y,x])}const h=i.parse(e[e.length-1],e.length-1,i.expectedType,s);return h?new jo(s,h):null}outputDefined(){return this.result.outputDefined()}}class qo{constructor(e,i,s){this.type=e,this.index=i,this.input=s}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Be),h=i.parse(e[2],2,Zr(i.expectedType||pt));return s&&h?new qo(h.type.itemType,s,h):null}evaluate(e){const i=this.index.evaluate(e),s=this.input.evaluate(e);if(i<0)throw new Er(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new Er(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new Er(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Ft{constructor(e,i){this.type=vt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,pt),h=i.parse(e[2],2,pt);return s&&h?X(s.type,[vt,xt,Be,si,pt])?new Ft(s,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${er(s.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!z(i,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${er(Sr(i))} instead.`);if(!z(s,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${er(Sr(s))} instead.`);return s.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class xs{constructor(e,i,s){this.type=Be,this.needle=e,this.haystack=i,this.fromIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,pt),h=i.parse(e[2],2,pt);if(!s||!h)return null;if(!X(s.type,[vt,xt,Be,si,pt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${er(s.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,Be);return f?new xs(s,h,f):null}return new xs(s,h)}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!z(i,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${er(Sr(i))} instead.`);if(!z(s,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${er(Sr(s))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return s.indexOf(i,h)}return s.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class _l{constructor(e,i,s,h,f,y){this.inputType=e,this.type=i,this.input=s,this.cases=h,this.outputs=f,this.otherwise=y}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let s,h;i.expectedType&&i.expectedType.kind!=="value"&&(h=i.expectedType);const f={},y=[];for(let C=2;C<e.length-1;C+=2){let A=e[C];const M=e[C+1];Array.isArray(A)||(A=[A]);const R=i.concat(C);if(A.length===0)return R.error("Expected at least one branch label.");for(const $ of A){if(typeof $!="number"&&typeof $!="string")return R.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return R.error("Numeric branch labels must be integer values.");if(s){if(R.checkSubtype(s,Sr($)))return null}else s=Sr($);if(f[String($)]!==void 0)return R.error("Branch labels must be unique.");f[String($)]=y.length}const B=i.parse(M,C,h);if(!B)return null;h=h||B.type,y.push(B)}const x=i.parse(e[1],1,pt);if(!x)return null;const S=i.parse(e[e.length-1],e.length-1,h);return S?x.type.kind!=="value"&&i.concat(1).checkSubtype(s,x.type)?null:new _l(s,h,x,f,y,S):null}evaluate(e){const i=this.input.evaluate(e);return(Sr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class xl{constructor(e,i,s){this.type=e,this.branches=i,this.otherwise=s}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const x=i.parse(e[y],y,vt);if(!x)return null;const S=i.parse(e[y+1],y+1,s);if(!S)return null;h.push([x,S]),s=s||S.type}const f=i.parse(e[e.length-1],e.length-1,s);if(!f)return null;if(!s)throw new Error("Can't infer output type");return new xl(s,h,f)}evaluate(e){for(const[i,s]of this.branches)if(i.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,s]of this.branches)e(i),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class vs{constructor(e,i,s,h){this.type=e,this.input=i,this.beginIndex=s,this.endIndex=h}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,pt),h=i.parse(e[2],2,Be);if(!s||!h)return null;if(!X(s.type,[Zr(pt),xt,pt]))return i.error(`Expected first argument to be of type array or string, but found ${er(s.type)} instead`);if(e.length===4){const f=i.parse(e[3],3,Be);return f?new vs(s.type,s,h,f):null}return new vs(s.type,s,h)}evaluate(e){const i=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!z(i,["string","array"]))throw new Er(`Expected first argument to be of type array or string, but found ${er(Sr(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return i.slice(s,h)}return i.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Xc(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Kc(r,e,i,s){return s.compare(e,i)===0}function Go(r,e,i){const s=r!=="=="&&r!=="!=";return class i0{constructor(f,y,x){this.type=vt,this.lhs=f,this.rhs=y,this.collator=x,this.hasUntypedArgument=f.type.kind==="value"||y.type.kind==="value"}static parse(f,y){if(f.length!==3&&f.length!==4)return y.error("Expected two or three arguments.");const x=f[0];let S=y.parse(f[1],1,pt);if(!S)return null;if(!Xc(x,S.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${er(S.type)}'.`);let C=y.parse(f[2],2,pt);if(!C)return null;if(!Xc(x,C.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${er(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${er(S.type)}' and '${er(C.type)}'.`);s&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new tn(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new tn(S.type,[C])));let A=null;if(f.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(A=y.parse(f[3],3,Ci),!A)return null}return new i0(S,C,A)}evaluate(f){const y=this.lhs.evaluate(f),x=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const S=Sr(y),C=Sr(x);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new Er(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const S=Sr(y),C=Sr(x);if(S.kind!=="string"||C.kind!=="string")return e(f,y,x)}return this.collator?i(f,y,x,this.collator.evaluate(f)):e(f,y,x)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}}}const gd=Go("==",function(r,e,i){return e===i},Kc),yd=Go("!=",function(r,e,i){return e!==i},function(r,e,i,s){return!Kc(0,e,i,s)}),_d=Go("<",function(r,e,i){return e<i},function(r,e,i,s){return s.compare(e,i)<0}),xd=Go(">",function(r,e,i){return e>i},function(r,e,i,s){return s.compare(e,i)>0}),vd=Go("<=",function(r,e,i){return e<=i},function(r,e,i,s){return s.compare(e,i)<=0}),bd=Go(">=",function(r,e,i){return e>=i},function(r,e,i,s){return s.compare(e,i)>=0});class vl{constructor(e,i,s,h,f){this.type=xt,this.number=e,this.locale=i,this.currency=s,this.minFractionDigits=h,this.maxFractionDigits=f}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Be);if(!s)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let f=null;if(h.locale&&(f=i.parse(h.locale,1,xt),!f))return null;let y=null;if(h.currency&&(y=i.parse(h.currency,1,xt),!y))return null;let x=null;if(h["min-fraction-digits"]&&(x=i.parse(h["min-fraction-digits"],1,Be),!x))return null;let S=null;return h["max-fraction-digits"]&&(S=i.parse(h["max-fraction-digits"],1,Be),!S)?null:new vl(s,f,y,x,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class bs{constructor(e){this.type=ki,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&typeof s=="object")return i.error("First argument must be an image or text section.");const h=[];let f=!1;for(let y=1;y<=e.length-1;++y){const x=e[y];if(f&&typeof x=="object"&&!Array.isArray(x)){f=!1;let S=null;if(x["font-scale"]&&(S=i.parse(x["font-scale"],1,Be),!S))return null;let C=null;if(x["text-font"]&&(C=i.parse(x["text-font"],1,Zr(xt)),!C))return null;let A=null;if(x["text-color"]&&(A=i.parse(x["text-color"],1,Qr),!A))return null;const M=h[h.length-1];M.scale=S,M.font=C,M.textColor=A}else{const S=i.parse(e[y],1,pt);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new bs(h)}evaluate(e){return new wr(this.sections.map(i=>{const s=i.content.evaluate(e);return Sr(s)===Jn?new Wr("",s,null,null,null):new Wr(no(s),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}}class bl{constructor(e){this.type=Jn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const s=i.parse(e[1],1,xt);return s?new bl(s):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),s=Qn.fromString(i);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(i)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}}class wl{constructor(e){this.type=Be,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=i.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${er(s.type)} instead.`):new wl(s):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Er(`Expected value to be of type string or array, but found ${er(Sr(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Zo={"==":gd,"!=":yd,">":xd,"<":_d,">=":bd,"<=":vd,array:tn,at:qo,boolean:tn,case:xl,coalesce:_s,collator:Vo,format:bs,image:bl,in:Ft,"index-of":xs,interpolate:Bn,"interpolate-hcl":Bn,"interpolate-lab":Bn,length:wl,let:jo,literal:_o,match:_l,number:tn,"number-format":vl,object:tn,slice:vs,step:Ta,string:tn,"to-boolean":Ai,"to-color":Ai,"to-number":Ai,"to-string":Ai,var:ms,within:xo};function Hc(r,[e,i,s,h]){e=e.evaluate(r),i=i.evaluate(r),s=s.evaluate(r);const f=h?h.evaluate(r):1,y=Uc(e,i,s,f);if(y)throw new Er(y);return new ft(e/255,i/255,s/255,f,!1)}function Yc(r,e){return r in e}function Sl(r,e){const i=e[r];return i===void 0?null:i}function bo(r){return{type:r}}function Jc(r){return{result:"success",value:r}}function Wo(r){return{result:"error",value:r}}function Xo(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Qc(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function El(r){return!!r.expression&&r.expression.interpolated}function Vt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function ws(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function wd(r){return r}function eu(r,e){const i=e.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",h=s||!(s||r.property!==void 0),f=r.type||(El(e)?"exponential":"interval");if(i||e.type==="padding"){const A=i?ft.parse:Rn.parse;(r=Fr({},r)).stops&&(r.stops=r.stops.map(M=>[M[0],A(M[1])])),r.default=A(r.default?r.default:e.default)}if(r.colorSpace&&(y=r.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var y;let x,S,C;if(f==="exponential")x=tu;else if(f==="interval")x=Ed;else if(f==="categorical"){x=Sd,S=Object.create(null);for(const A of r.stops)S[A[0]]=A[1];C=typeof r.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);x=Td}if(s){const A={},M=[];for(let $=0;$<r.stops.length;$++){const G=r.stops[$],H=G[0].zoom;A[H]===void 0&&(A[H]={zoom:H,type:r.type,property:r.property,default:r.default,stops:[]},M.push(H)),A[H].stops.push([G[0].value,G[1]])}const R=[];for(const $ of M)R.push([A[$].zoom,eu(A[$],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Bn.interpolationFactor.bind(void 0,B),zoomStops:R.map($=>$[0]),evaluate:({zoom:$},G)=>tu({stops:R,base:r.base},e,$).evaluate($,G)}}if(h){const A=f==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Bn.interpolationFactor.bind(void 0,A),zoomStops:r.stops.map(M=>M[0]),evaluate:({zoom:M})=>x(r,e,M,S,C)}}return{kind:"source",evaluate(A,M){const R=M&&M.properties?M.properties[r.property]:void 0;return R===void 0?wo(r.default,e.default):x(r,e,R,S,C)}}}function wo(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function Sd(r,e,i,s,h){return wo(typeof i===h?s[i]:void 0,r.default,e.default)}function Ed(r,e,i){if(Vt(i)!=="number")return wo(r.default,e.default);const s=r.stops.length;if(s===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[s-1][0])return r.stops[s-1][1];const h=Ea(r.stops.map(f=>f[0]),i);return r.stops[h][1]}function tu(r,e,i){const s=r.base!==void 0?r.base:1;if(Vt(i)!=="number")return wo(r.default,e.default);const h=r.stops.length;if(h===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[h-1][0])return r.stops[h-1][1];const f=Ea(r.stops.map(A=>A[0]),i),y=function(A,M,R,B){const $=B-R,G=A-R;return $===0?0:M===1?G/$:(Math.pow(M,G)-1)/(Math.pow(M,$)-1)}(i,s,r.stops[f][0],r.stops[f+1][0]),x=r.stops[f][1],S=r.stops[f+1][1],C=Fn[e.type]||wd;return typeof x.evaluate=="function"?{evaluate(...A){const M=x.evaluate.apply(void 0,A),R=S.evaluate.apply(void 0,A);if(M!==void 0&&R!==void 0)return C(M,R,y,r.colorSpace)}}:C(x,S,y,r.colorSpace)}function Td(r,e,i){switch(e.type){case"color":i=ft.parse(i);break;case"formatted":i=wr.fromString(i.toString());break;case"resolvedImage":i=Qn.fromString(i.toString());break;case"padding":i=Rn.parse(i);break;default:Vt(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return wo(i,r.default,e.default)}Ln.register(Zo,{error:[{kind:"error"},[xt],(r,[e])=>{throw new Er(e.evaluate(r))}],typeof:[xt,[pt],(r,[e])=>er(Sr(e.evaluate(r)))],"to-rgba":[Zr(Be,4),[Qr],(r,[e])=>{const[i,s,h,f]=e.evaluate(r).rgb;return[255*i,255*s,255*h,f]}],rgb:[Qr,[Be,Be,Be],Hc],rgba:[Qr,[Be,Be,Be,Be],Hc],has:{type:vt,overloads:[[[xt],(r,[e])=>Yc(e.evaluate(r),r.properties())],[[xt,ji],(r,[e,i])=>Yc(e.evaluate(r),i.evaluate(r))]]},get:{type:pt,overloads:[[[xt],(r,[e])=>Sl(e.evaluate(r),r.properties())],[[xt,ji],(r,[e,i])=>Sl(e.evaluate(r),i.evaluate(r))]]},"feature-state":[pt,[xt],(r,[e])=>Sl(e.evaluate(r),r.featureState||{})],properties:[ji,[],r=>r.properties()],"geometry-type":[xt,[],r=>r.geometryType()],id:[pt,[],r=>r.id()],zoom:[Be,[],r=>r.globals.zoom],"heatmap-density":[Be,[],r=>r.globals.heatmapDensity||0],"line-progress":[Be,[],r=>r.globals.lineProgress||0],accumulated:[pt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Be,bo(Be),(r,e)=>{let i=0;for(const s of e)i+=s.evaluate(r);return i}],"*":[Be,bo(Be),(r,e)=>{let i=1;for(const s of e)i*=s.evaluate(r);return i}],"-":{type:Be,overloads:[[[Be,Be],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[Be],(r,[e])=>-e.evaluate(r)]]},"/":[Be,[Be,Be],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[Be,[Be,Be],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[Be,[Be],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Be,[Be],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Be,[Be],(r,[e])=>Math.log(e.evaluate(r))],log2:[Be,[Be],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Be,[Be],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Be,[Be],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Be,[Be],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Be,[Be],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Be,[Be],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Be,[Be],(r,[e])=>Math.atan(e.evaluate(r))],min:[Be,bo(Be),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[Be,bo(Be),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[Be,[Be],(r,[e])=>Math.abs(e.evaluate(r))],round:[Be,[Be],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Be,[Be],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Be,[Be],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[vt,[xt,pt],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[vt,[pt],(r,[e])=>r.id()===e.value],"filter-type-==":[vt,[xt],(r,[e])=>r.geometryType()===e.value],"filter-<":[vt,[xt,pt],(r,[e,i])=>{const s=r.properties()[e.value],h=i.value;return typeof s==typeof h&&s<h}],"filter-id-<":[vt,[pt],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i<s}],"filter->":[vt,[xt,pt],(r,[e,i])=>{const s=r.properties()[e.value],h=i.value;return typeof s==typeof h&&s>h}],"filter-id->":[vt,[pt],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i>s}],"filter-<=":[vt,[xt,pt],(r,[e,i])=>{const s=r.properties()[e.value],h=i.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[vt,[pt],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i<=s}],"filter->=":[vt,[xt,pt],(r,[e,i])=>{const s=r.properties()[e.value],h=i.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[vt,[pt],(r,[e])=>{const i=r.id(),s=e.value;return typeof i==typeof s&&i>=s}],"filter-has":[vt,[pt],(r,[e])=>e.value in r.properties()],"filter-has-id":[vt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[vt,[Zr(xt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[vt,[Zr(pt)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[vt,[xt,Zr(pt)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[vt,[xt,Zr(pt)],(r,[e,i])=>function(s,h,f,y){for(;f<=y;){const x=f+y>>1;if(h[x]===s)return!0;h[x]>s?y=x-1:f=x+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:vt,overloads:[[[vt,vt],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[bo(vt),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:vt,overloads:[[[vt,vt],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[bo(vt),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[vt,[vt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[vt,[xt],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[xt,[xt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[xt,[xt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[xt,bo(pt),(r,e)=>e.map(i=>no(i.evaluate(r))).join("")],"resolved-locale":[xt,[Ci],(r,[e])=>e.evaluate(r).resolvedLocale()]});class mr{constructor(e,i){var s;this.expression=e,this._warningHistory={},this._evaluator=new Zt,this._defaultValue=i?(s=i).type==="color"&&ws(s.default)?new ft(0,0,0,0):s.type==="color"?ft.parse(s.default)||null:s.type==="padding"?Rn.parse(s.default)||null:s.type==="variableAnchorOffsetCollection"?en.parse(s.default)||null:s.default===void 0?null:s.default:null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,s,h,f,y){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,i,s,h,f,y){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Ss(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Zo}function It(r,e){const i=new us(Zo,ba,[],e?function(h){const f={color:Qr,string:xt,number:Be,enum:xt,boolean:vt,formatted:ki,padding:to,resolvedImage:Jn,variableAnchorOffsetCollection:ro};return h.type==="array"?Zr(f[h.value]||pt,h.length):f[h.type]}(e):void 0),s=i.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Jc(new mr(s,e)):Wo(i.errors)}class Ca{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!wa(i.expression)}evaluateWithoutErrorHandling(e,i,s,h,f,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,h,f,y)}evaluate(e,i,s,h,f,y){return this._styleExpression.evaluate(e,i,s,h,f,y)}}class rr{constructor(e,i,s,h){this.kind=e,this.zoomStops=s,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!wa(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,i,s,h,f,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,h,f,y)}evaluate(e,i,s,h,f,y){return this._styleExpression.evaluate(e,i,s,h,f,y)}interpolationFactor(e,i,s){return this.interpolationType?Bn.interpolationFactor(this.interpolationType,e,i,s):0}}function nr(r,e){const i=It(r,e);if(i.result==="error")return i;const s=i.value.expression,h=gs(s);if(!h&&!Xo(e))return Wo([new Gr("","data expressions not supported")]);const f=Sa(s,["zoom"]);if(!f&&!Qc(e))return Wo([new Gr("","zoom expressions not supported")]);const y=ka(s);return y||f?y instanceof Gr?Wo([y]):y instanceof Bn&&!El(e)?Wo([new Gr("",'"interpolate" expressions cannot be used with this property')]):Jc(y?new rr(h?"camera":"composite",i.value,y.labels,y instanceof Bn?y.interpolation:void 0):new Ca(h?"constant":"source",i.value)):Wo([new Gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class So{constructor(e,i){this._parameters=e,this._specification=i,Fr(this,eu(this._parameters,this._specification))}static deserialize(e){return new So(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ka(r){let e=null;if(r instanceof jo)e=ka(r.result);else if(r instanceof _s){for(const i of r.args)if(e=ka(i),e)break}else(r instanceof Ta||r instanceof Bn)&&r.input instanceof Ln&&r.input.name==="zoom"&&(e=r);return e instanceof Gr||r.eachChild(i=>{const s=ka(i);s instanceof Gr?e=s:!e&&s?e=new Gr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Gr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Tl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Tl(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Cd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Cl(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Tl(r)||(r=Ia(r));const e=It(r,Cd);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,s,h)=>e.value.evaluate(i,s,{},h),needGeometry:kl(r)}}function kd(r,e){return r<e?-1:r>e?1:0}function kl(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(kl(r[e]))return!0;return!1}function Ia(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?Es(r[1],r[2],"=="):e==="!="?Cs(Es(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Es(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map(Ia))):e==="all"?["all"].concat(r.slice(1).map(Ia)):e==="none"?["all"].concat(r.slice(1).map(Ia).map(Cs)):e==="in"?Il(r[1],r.slice(2)):e==="!in"?Cs(Il(r[1],r.slice(2))):e==="has"?Ts(r[1]):e==="!has"?Cs(Ts(r[1])):e!=="within"||r;var i}function Es(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function Il(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort(kd)]]:["filter-in-small",r,["literal",e]]}}function Ts(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Cs(r){return["!",r]}function Al(r){const e=typeof r;if(e==="number"||e==="boolean"||e==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let h="[";for(const f of r)h+=`${Al(f)},`;return`${h}]`}const i=Object.keys(r).sort();let s="{";for(let h=0;h<i.length;h++)s+=`${JSON.stringify(i[h])}:${Al(r[i[h]])},`;return`${s}}`}function Id(r){let e="";for(const i of Dn)e+=`/${Al(r[i])}`;return e}function ru(r){const e=r.value;return e?[new Fe(r.key,e,"constants have been deprecated as of v8")]:[]}function Tr(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Eo(r){if(Array.isArray(r))return r.map(Eo);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=Eo(r[i]);return e}return Tr(r)}function ei(r){const e=r.key,i=r.value,s=r.valueSpec||{},h=r.objectElementValidators||{},f=r.style,y=r.styleSpec,x=r.validateSpec;let S=[];const C=Vt(i);if(C!=="object")return[new Fe(e,i,`object expected, ${C} found`)];for(const A in i){const M=A.split(".")[0],R=s[M]||s["*"];let B;if(h[M])B=h[M];else if(s[M])B=x;else if(h["*"])B=h["*"];else{if(!s["*"]){S.push(new Fe(e,i[A],`unknown property "${A}"`));continue}B=x}S=S.concat(B({key:(e&&`${e}.`)+A,value:i[A],valueSpec:R,style:f,styleSpec:y,object:i,objectKey:A,validateSpec:x},i))}for(const A in s)h[A]||s[A].required&&s[A].default===void 0&&i[A]===void 0&&S.push(new Fe(e,i,`missing required property "${A}"`));return S}function Pl(r){const e=r.value,i=r.valueSpec,s=r.style,h=r.styleSpec,f=r.key,y=r.arrayElementValidator||r.validateSpec;if(Vt(e)!=="array")return[new Fe(f,e,`array expected, ${Vt(e)} found`)];if(i.length&&e.length!==i.length)return[new Fe(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Fe(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let x={type:i.value,values:i.values};h.$version<7&&(x.function=i.function),Vt(i.value)==="object"&&(x=i.value);let S=[];for(let C=0;C<e.length;C++)S=S.concat(y({array:e,arrayIndex:C,value:e[C],valueSpec:x,validateSpec:r.validateSpec,style:s,styleSpec:h,key:`${f}[${C}]`}));return S}function ks(r){const e=r.key,i=r.value,s=r.valueSpec;let h=Vt(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new Fe(e,i,`number expected, ${h} found`)]:"minimum"in s&&i<s.minimum?[new Fe(e,i,`${i} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&i>s.maximum?[new Fe(e,i,`${i} is greater than the maximum value ${s.maximum}`)]:[]}function Ml(r){const e=r.valueSpec,i=Tr(r.value.type);let s,h,f,y={};const x=i!=="categorical"&&r.value.property===void 0,S=!x,C=Vt(r.value.stops)==="array"&&Vt(r.value.stops[0])==="array"&&Vt(r.value.stops[0][0])==="object",A=ei({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(B){if(i==="identity")return[new Fe(B.key,B.value,'identity function may not have a "stops" property')];let $=[];const G=B.value;return $=$.concat(Pl({key:B.key,value:G,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:M})),Vt(G)==="array"&&G.length===0&&$.push(new Fe(B.key,G,"array must have at least one stop")),$},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return i==="identity"&&x&&A.push(new Fe(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||A.push(new Fe(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!El(r.valueSpec)&&A.push(new Fe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(S&&!Xo(r.valueSpec)?A.push(new Fe(r.key,r.value,"property functions not supported")):x&&!Qc(r.valueSpec)&&A.push(new Fe(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!C||r.value.property!==void 0||A.push(new Fe(r.key,r.value,'"property" property is required')),A;function M(B){let $=[];const G=B.value,H=B.key;if(Vt(G)!=="array")return[new Fe(H,G,`array expected, ${Vt(G)} found`)];if(G.length!==2)return[new Fe(H,G,`array length 2 expected, length ${G.length} found`)];if(C){if(Vt(G[0])!=="object")return[new Fe(H,G,`object expected, ${Vt(G[0])} found`)];if(G[0].zoom===void 0)return[new Fe(H,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Fe(H,G,"object stop key must have value")];if(f&&f>Tr(G[0].zoom))return[new Fe(H,G[0].zoom,"stop zoom values must appear in ascending order")];Tr(G[0].zoom)!==f&&(f=Tr(G[0].zoom),h=void 0,y={}),$=$.concat(ei({key:`${H}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:ks,value:R}}))}else $=$.concat(R({key:`${H}[0]`,value:G[0],valueSpec:{},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},G));return Ss(Eo(G[1]))?$.concat([new Fe(`${H}[1]`,G[1],"expressions are not allowed in function stops.")]):$.concat(B.validateSpec({key:`${H}[1]`,value:G[1],valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function R(B,$){const G=Vt(B.value),H=Tr(B.value),Q=B.value!==null?B.value:$;if(s){if(G!==s)return[new Fe(B.key,Q,`${G} stop domain type must match previous stop domain type ${s}`)]}else s=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new Fe(B.key,Q,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&i!=="categorical"){let ce=`number expected, ${G} found`;return Xo(e)&&i===void 0&&(ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(B.key,Q,ce)]}return i!=="categorical"||G!=="number"||isFinite(H)&&Math.floor(H)===H?i!=="categorical"&&G==="number"&&h!==void 0&&H<h?[new Fe(B.key,Q,"stop domain values must appear in ascending order")]:(h=H,i==="categorical"&&H in y?[new Fe(B.key,Q,"stop domain values must be unique")]:(y[H]=!0,[])):[new Fe(B.key,Q,`integer expected, found ${H}`)]}}function qi(r){const e=(r.expressionContext==="property"?nr:It)(Eo(r.value),r.valueSpec);if(e.result==="error")return e.value.map(s=>new Fe(`${r.key}${s.key}`,r.value,s.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new Fe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!wa(i))return[new Fe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!wa(i))return[new Fe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Sa(i,["zoom","feature-state"]))return[new Fe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!gs(i))return[new Fe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Aa(r){const e=r.key,i=r.value,s=r.valueSpec,h=[];return Array.isArray(s.values)?s.values.indexOf(Tr(i))===-1&&h.push(new Fe(e,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(s.values).indexOf(Tr(i))===-1&&h.push(new Fe(e,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function Is(r){return Tl(Eo(r.value))?qi(Fr({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):nu(r)}function nu(r){const e=r.value,i=r.key;if(Vt(e)!=="array")return[new Fe(i,e,`array expected, ${Vt(e)} found`)];const s=r.styleSpec;let h,f=[];if(e.length<1)return[new Fe(i,e,"filter array must have at least 1 element")];switch(f=f.concat(Aa({key:`${i}[0]`,value:e[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),Tr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Tr(e[1])==="$type"&&f.push(new Fe(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&f.push(new Fe(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=Vt(e[1]),h!=="string"&&f.push(new Fe(`${i}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=Vt(e[y]),Tr(e[1])==="$type"?f=f.concat(Aa({key:`${i}[${y}]`,value:e[y],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&f.push(new Fe(`${i}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)f=f.concat(nu({key:`${i}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=Vt(e[1]),e.length!==2?f.push(new Fe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&f.push(new Fe(`${i}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=Vt(e[1]),e.length!==2?f.push(new Fe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&f.push(new Fe(`${i}[1]`,e[1],`object expected, ${h} found`))}return f}function As(r,e){const i=r.key,s=r.validateSpec,h=r.style,f=r.styleSpec,y=r.value,x=r.objectKey,S=f[`${e}_${r.layerType}`];if(!S)return[];const C=x.match(/^(.*)-transition$/);if(e==="paint"&&C&&S[C[1]]&&S[C[1]].transition)return s({key:i,value:y,valueSpec:f.transition,style:h,styleSpec:f});const A=r.valueSpec||S[x];if(!A)return[new Fe(i,y,`unknown property "${x}"`)];let M;if(Vt(y)==="string"&&Xo(A)&&!A.tokens&&(M=/^{([^}]+)}$/.exec(y)))return[new Fe(i,y,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const R=[];return r.layerType==="symbol"&&(x==="text-field"&&h&&!h.glyphs&&R.push(new Fe(i,y,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&ws(Eo(y))&&Tr(y.type)==="identity"&&R.push(new Fe(i,y,'"text-font" does not support identity functions'))),R.concat(s({key:r.key,value:y,valueSpec:A,style:h,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:x}))}function Pa(r){return As(r,"paint")}function Ps(r){return As(r,"layout")}function Ms(r){let e=[];const i=r.value,s=r.key,h=r.style,f=r.styleSpec;i.type||i.ref||e.push(new Fe(s,i,'either "type" or "ref" is required'));let y=Tr(i.type);const x=Tr(i.ref);if(i.id){const S=Tr(i.id);for(let C=0;C<r.arrayIndex;C++){const A=h.layers[C];Tr(A.id)===S&&e.push(new Fe(s,i.id,`duplicate layer id "${i.id}", previously used at line ${A.id.__line__}`))}}if("ref"in i){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in i&&e.push(new Fe(s,i[C],`"${C}" is prohibited for ref layers`))}),h.layers.forEach(C=>{Tr(C.id)===x&&(S=C)}),S?S.ref?e.push(new Fe(s,i.ref,"ref cannot reference another ref layer")):y=Tr(S.type):e.push(new Fe(s,i.ref,`ref layer "${x}" not found`))}else if(y!=="background")if(i.source){const S=h.sources&&h.sources[i.source],C=S&&Tr(S.type);S?C==="vector"&&y==="raster"?e.push(new Fe(s,i.source,`layer "${i.id}" requires a raster source`)):C==="raster"&&y!=="raster"?e.push(new Fe(s,i.source,`layer "${i.id}" requires a vector source`)):C!=="vector"||i["source-layer"]?C==="raster-dem"&&y!=="hillshade"?e.push(new Fe(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!i.paint||!i.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||e.push(new Fe(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Fe(s,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Fe(s,i.source,`source "${i.source}" not found`))}else e.push(new Fe(s,i,'missing required property "source"'));return e=e.concat(ei({key:s,value:i,valueSpec:f.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${s}.type`,value:i.type,valueSpec:f.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:i,objectKey:"type"}),filter:Is,layout:S=>ei({layer:i,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Ps(Fr({layerType:y},C))}}),paint:S=>ei({layer:i,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":C=>Pa(Fr({layerType:y},C))}})}})),e}function oo(r){const e=r.value,i=r.key,s=Vt(e);return s!=="string"?[new Fe(i,e,`string expected, ${s} found`)]:[]}const iu={promoteId:function({key:r,value:e}){if(Vt(e)==="string")return oo({key:r,value:e});{const i=[];for(const s in e)i.push(...oo({key:`${r}.${s}`,value:e[s]}));return i}}};function Ma(r){const e=r.value,i=r.key,s=r.styleSpec,h=r.style,f=r.validateSpec;if(!e.type)return[new Fe(i,e,'"type" is required')];const y=Tr(e.type);let x;switch(y){case"vector":case"raster":case"raster-dem":return x=ei({key:i,value:e,valueSpec:s[`source_${y.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:iu,validateSpec:f}),x;case"geojson":if(x=ei({key:i,value:e,valueSpec:s.source_geojson,style:h,styleSpec:s,validateSpec:f,objectElementValidators:iu}),e.cluster)for(const S in e.clusterProperties){const[C,A]=e.clusterProperties[S],M=typeof C=="string"?[C,["accumulated"],["get",S]]:C;x.push(...qi({key:`${i}.${S}.map`,value:A,validateSpec:f,expressionContext:"cluster-map"})),x.push(...qi({key:`${i}.${S}.reduce`,value:M,validateSpec:f,expressionContext:"cluster-reduce"}))}return x;case"video":return ei({key:i,value:e,valueSpec:s.source_video,style:h,validateSpec:f,styleSpec:s});case"image":return ei({key:i,value:e,valueSpec:s.source_image,style:h,validateSpec:f,styleSpec:s});case"canvas":return[new Fe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Aa({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:f,styleSpec:s})}}function ou(r){const e=r.value,i=r.styleSpec,s=i.light,h=r.style;let f=[];const y=Vt(e);if(e===void 0)return f;if(y!=="object")return f=f.concat([new Fe("light",e,`object expected, ${y} found`)]),f;for(const x in e){const S=x.match(/^(.*)-transition$/);f=f.concat(S&&s[S[1]]&&s[S[1]].transition?r.validateSpec({key:x,value:e[x],valueSpec:i.transition,validateSpec:r.validateSpec,style:h,styleSpec:i}):s[x]?r.validateSpec({key:x,value:e[x],valueSpec:s[x],validateSpec:r.validateSpec,style:h,styleSpec:i}):[new Fe(x,e[x],`unknown property "${x}"`)])}return f}function au(r){const e=r.value,i=r.styleSpec,s=i.terrain,h=r.style;let f=[];const y=Vt(e);if(e===void 0)return f;if(y!=="object")return f=f.concat([new Fe("terrain",e,`object expected, ${y} found`)]),f;for(const x in e)f=f.concat(s[x]?r.validateSpec({key:x,value:e[x],valueSpec:s[x],validateSpec:r.validateSpec,style:h,styleSpec:i}):[new Fe(x,e[x],`unknown property "${x}"`)]);return f}function su(r){let e=[];const i=r.value,s=r.key;if(Array.isArray(i)){const h=[],f=[];for(const y in i)i[y].id&&h.includes(i[y].id)&&e.push(new Fe(s,i,`all the sprites' ids must be unique, but ${i[y].id} is duplicated`)),h.push(i[y].id),i[y].url&&f.includes(i[y].url)&&e.push(new Fe(s,i,`all the sprites' URLs must be unique, but ${i[y].url} is duplicated`)),f.push(i[y].url),e=e.concat(ei({key:`${s}[${y}]`,value:i[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return e}return oo({key:s,value:i})}const lu={"*":()=>[],array:Pl,boolean:function(r){const e=r.value,i=r.key,s=Vt(e);return s!=="boolean"?[new Fe(i,e,`boolean expected, ${s} found`)]:[]},number:ks,color:function(r){const e=r.key,i=r.value,s=Vt(i);return s!=="string"?[new Fe(e,i,`color expected, ${s} found`)]:ft.parse(String(i))?[]:[new Fe(e,i,`color expected, "${i}" found`)]},constants:ru,enum:Aa,filter:Is,function:Ml,layer:Ms,object:ei,source:Ma,light:ou,terrain:au,string:oo,formatted:function(r){return oo(r).length===0?[]:qi(r)},resolvedImage:function(r){return oo(r).length===0?[]:qi(r)},padding:function(r){const e=r.key,i=r.value;if(Vt(i)==="array"){if(i.length<1||i.length>4)return[new Fe(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const s={type:"number"};let h=[];for(let f=0;f<i.length;f++)h=h.concat(r.validateSpec({key:`${e}[${f}]`,value:i[f],validateSpec:r.validateSpec,valueSpec:s}));return h}return ks({key:e,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const e=r.key,i=r.value,s=Vt(i),h=r.styleSpec;if(s!=="array"||i.length<1||i.length%2!=0)return[new Fe(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let f=[];for(let y=0;y<i.length;y+=2)f=f.concat(Aa({key:`${e}[${y}]`,value:i[y],valueSpec:h.layout_symbol["text-anchor"]})),f=f.concat(Pl({key:`${e}[${y+1}]`,value:i[y+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:h}));return f},sprite:su};function za(r){const e=r.value,i=r.valueSpec,s=r.styleSpec;return r.validateSpec=za,i.expression&&ws(Tr(e))?Ml(r):i.expression&&Ss(Eo(e))?qi(r):i.type&&lu[i.type]?lu[i.type](r):ei(Fr({},r,{valueSpec:i.type?s[i.type]:i}))}function Da(r){const e=r.value,i=r.key,s=oo(r);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new Fe(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new Fe(i,e,'"glyphs" url must include a "{range}" token'))),s}function On(r,e=ve){let i=[];return i=i.concat(za({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:za,objectElementValidators:{glyphs:Da,"*":()=>[]}})),r.constants&&(i=i.concat(ru({key:"constants",value:r.constants,style:r,styleSpec:e,validateSpec:za}))),Ra(i)}function Mr(r){return function(e){return r({...e,validateSpec:za})}}function Ra(r){return[].concat(r).sort((e,i)=>e.line-i.line)}function Gi(r){return function(...e){return Ra(r.apply(this,e))}}On.source=Gi(Mr(Ma)),On.sprite=Gi(Mr(su)),On.glyphs=Gi(Mr(Da)),On.light=Gi(Mr(ou)),On.terrain=Gi(Mr(au)),On.layer=Gi(Mr(Ms)),On.filter=Gi(Mr(Is)),On.paintProperty=Gi(Mr(Pa)),On.layoutProperty=Gi(Mr(Ps));const La=On,Ad=La.light,Fa=La.paintProperty,Pd=La.layoutProperty;function zs(r,e){let i=!1;if(e&&e.length)for(const s of e)r.fire(new Gt(new Error(s.message))),i=!0;return i}class Ba{constructor(e,i,s){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(i=y[1])+2*(s=y[2]);for(let S=0;S<this.d*this.d;S++){const C=y[3+S],A=y[3+S+1];h.push(C===A?null:y.subarray(C,A))}const x=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],x),this.bboxes=y.subarray(x),this.insert=this._insertReadonly}else{this.d=i+2*s;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=s,this.scale=i/e,this.uid=0;const f=s/i*e;this.min=-f,this.max=e+f}insert(e,i,s,h,f){this._forEachCell(i,s,h,f,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(f)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,s,h,f,y){this.cells[f].push(y)}query(e,i,s,h,f){const y=this.min,x=this.max;if(e<=y&&i<=y&&x<=s&&x<=h&&!f)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,i,s,h,this._queryCell,S,{},f),S}}_queryCell(e,i,s,h,f,y,x,S){const C=this.cells[f];if(C!==null){const A=this.keys,M=this.bboxes;for(let R=0;R<C.length;R++){const B=C[R];if(x[B]===void 0){const $=4*B;(S?S(M[$+0],M[$+1],M[$+2],M[$+3]):e<=M[$+2]&&i<=M[$+3]&&s>=M[$+0]&&h>=M[$+1])?(x[B]=!0,y.push(A[B])):x[B]=!1}}}}_forEachCell(e,i,s,h,f,y,x,S){const C=this._convertToCellCoord(e),A=this._convertToCellCoord(i),M=this._convertToCellCoord(s),R=this._convertToCellCoord(h);for(let B=C;B<=M;B++)for(let $=A;$<=R;$++){const G=this.d*$+B;if((!S||S(this._convertFromCellCoord(B),this._convertFromCellCoord($),this._convertFromCellCoord(B+1),this._convertFromCellCoord($+1)))&&f.call(this,e,i,s,h,G,y,x,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let s=0;for(let y=0;y<this.cells.length;y++)s+=this.cells[y].length;const h=new Int32Array(i+s+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let f=i;for(let y=0;y<e.length;y++){const x=e[y];h[3+y]=f,h.set(x,f),f+=x.length}return h[3+e.length]=f,h.set(this.keys,f),f+=this.keys.length,h[3+e.length+1]=f,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer}static serialize(e,i){const s=e.toArrayBuffer();return i&&i.push(s),{buffer:s}}static deserialize(e){return new Ba(e.buffer)}}const Pi={};function Xe(r,e,i={}){if(Pi[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),Pi[r]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Xe("Object",Object),Xe("TransferableGridIndex",Ba),Xe("Color",ft),Xe("Error",Error),Xe("AJAXError",Yr),Xe("ResolvedImage",Qn),Xe("StylePropertyFunction",So),Xe("StyleExpression",mr,{omit:["_evaluator"]}),Xe("ZoomDependentExpression",rr),Xe("ZoomConstantExpression",Ca),Xe("CompoundExpression",Ln,{omit:["_evaluate"]});for(const r in Zo)Zo[r]._classRegistryKey||Xe(`Expression_${r}`,Zo[r]);function Ko(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Oa(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Ko(r)||Lr(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.push(i.buffer),i}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const s of r)i.push(Oa(s,e));return i}if(typeof r=="object"){const i=r.constructor,s=i._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");if(!Pi[s])throw new Error(`${s} is not registered.`);const h=i.serialize?i.serialize(r,e):{};if(i.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const f in r){if(!r.hasOwnProperty(f)||Pi[s].omit.indexOf(f)>=0)continue;const y=r[f];h[f]=Pi[s].shallow.indexOf(f)>=0?y:Oa(y,e)}r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(h.$name=s),h}throw new Error("can't serialize object of type "+typeof r)}function To(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Ko(r)||Lr(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(To);if(typeof r=="object"){const e=r.$name||"Object";if(!Pi[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Pi[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const s=Object.create(i.prototype);for(const h of Object.keys(r)){if(h==="$name")continue;const f=r[h];s[h]=Pi[e].shallow.indexOf(h)>=0?f:To(f)}return s}throw new Error("can't deserialize object of type "+typeof r)}class zl{constructor(){this.first=!0}update(e,i){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}const je={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Ds(r){for(const e of r)if($a(e.charCodeAt(0)))return!0;return!1}function cu(r){for(const e of r)if(!Md(e.charCodeAt(0)))return!1;return!0}function Md(r){return!(je.Arabic(r)||je["Arabic Supplement"](r)||je["Arabic Extended-A"](r)||je["Arabic Presentation Forms-A"](r)||je["Arabic Presentation Forms-B"](r))}function $a(r){return!(r!==746&&r!==747&&(r<4352||!(je["Bopomofo Extended"](r)||je.Bopomofo(r)||je["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||je["CJK Compatibility Ideographs"](r)||je["CJK Compatibility"](r)||je["CJK Radicals Supplement"](r)||je["CJK Strokes"](r)||!(!je["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||je["CJK Unified Ideographs Extension A"](r)||je["CJK Unified Ideographs"](r)||je["Enclosed CJK Letters and Months"](r)||je["Hangul Compatibility Jamo"](r)||je["Hangul Jamo Extended-A"](r)||je["Hangul Jamo Extended-B"](r)||je["Hangul Jamo"](r)||je["Hangul Syllables"](r)||je.Hiragana(r)||je["Ideographic Description Characters"](r)||je.Kanbun(r)||je["Kangxi Radicals"](r)||je["Katakana Phonetic Extensions"](r)||je.Katakana(r)&&r!==12540||!(!je["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!je["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||je["Unified Canadian Aboriginal Syllabics"](r)||je["Unified Canadian Aboriginal Syllabics Extended"](r)||je["Vertical Forms"](r)||je["Yijing Hexagram Symbols"](r)||je["Yi Syllables"](r)||je["Yi Radicals"](r))))}function Ua(r){return!($a(r)||function(e){return!!(je["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||je["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||je["Letterlike Symbols"](e)||je["Number Forms"](e)||je["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||je["Control Pictures"](e)&&e!==9251||je["Optical Character Recognition"](e)||je["Enclosed Alphanumerics"](e)||je["Geometric Shapes"](e)||je["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||je["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||je["CJK Symbols and Punctuation"](e)||je.Katakana(e)||je["Private Use Area"](e)||je["CJK Compatibility Forms"](e)||je["Small Form Variants"](e)||je["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Dl(r){return r>=1424&&r<=2303||je["Arabic Presentation Forms-A"](r)||je["Arabic Presentation Forms-B"](r)}function zd(r,e){return!(!e&&Dl(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||je.Khmer(r))}function uu(r){for(const e of r)if(Dl(e.charCodeAt(0)))return!0;return!1}const Rl="deferred",Na="loading",Ll="loaded";let Fl=null,bn="unavailable",ao=null;const Bl=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(bn="error"),Fl&&Fl(r)};function Ol(){$l.fire(new Jr("pluginStateChange",{pluginStatus:bn,pluginURL:ao}))}const $l=new br,Ul=function(){return bn},hu=function(){if(bn!==Rl||!ao)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");bn=Na,Ol(),ao&&Hn({url:ao},r=>{r?Bl(r):(bn=Ll,Ol())})},ti={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>bn===Ll||ti.applyArabicShaping!=null,isLoading:()=>bn===Na,setState(r){if(!Mt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");bn=r.pluginStatus,ao=r.pluginURL},isParsed(){if(!Mt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ti.applyArabicShaping!=null&&ti.processBidirectionalText!=null&&ti.processStyledBidirectionalText!=null},getPluginURL(){if(!Mt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ao}};class sr{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new zl,this.transition={})}isSupportedScript(e){return function(i,s){for(const h of i)if(!zd(h.charCodeAt(0),s))return!1;return!0}(e,ti.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*i}}}class Rs{constructor(e,i){this.property=e,this.value=i,this.expression=function(s,h){if(ws(s))return new So(s,h);if(Ss(s)){const f=nr(s,h);if(f.result==="error")throw new Error(f.value.map(y=>`${y.key}: ${y.message}`).join(", "));return f.value}{let f=s;return h.type==="color"&&typeof s=="string"?f=ft.parse(s):h.type!=="padding"||typeof s!="number"&&!Array.isArray(s)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(s)&&(f=en.parse(s)):f=Rn.parse(s),{kind:"constant",evaluate:()=>f}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,s){return this.property.possiblyEvaluate(this,e,i,s)}}class Ho{constructor(e){this.property=e,this.value=new Rs(e,void 0)}transitioned(e,i){return new Ls(this.property,this.value,i,De({},e.transition,this.transition),e.now)}untransitioned(){return new Ls(this.property,this.value,null,{},0)}}class du{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ce(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ho(this._values[e].property)),this._values[e].value=new Rs(this._values[e].property,i===null?void 0:Ce(i))}getTransition(e){return Ce(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ho(this._values[e].property)),this._values[e].transition=Ce(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s);const h=this.getTransition(i);h!==void 0&&(e[`${i}-transition`]=h)}return e}transitioned(e,i){const s=new pu(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(e,i._values[h]);return s}untransitioned(){const e=new pu(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Ls{constructor(e,i,s,h,f){this.property=e,this.value=i,this.begin=f+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(e,i,s){const h=e.now||0,f=this.value.possiblyEvaluate(e,i,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(h<this.begin)return y.possiblyEvaluate(e,i,s);{const x=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,i,s),f,function(S){if(S<=0)return 0;if(S>=1)return 1;const C=S*S,A=C*S;return 4*(S<.5?A:3*(S-C)+A-.75)}(x))}}return f}}class pu{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,s){const h=new Va(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,i,s);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Dd{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Ce(this._values[e].value)}setValue(e,i){this._values[e]=new Rs(this._values[e].property,i===null?void 0:Ce(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(e[i]=s)}return e}possiblyEvaluate(e,i,s){const h=new Va(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,i,s);return h}}class li{constructor(e,i,s){this.property=e,this.value=i,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,s,h){return this.property.evaluate(this.value,this.parameters,e,i,s,h)}}class Va{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class rt{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,s){const h=Fn[this.specification.type];return h?h(e,i,s):e}}class dt{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,s,h){return new li(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},s,h)}:e.expression,i)}interpolate(e,i,s){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new li(this,{kind:"constant",value:void 0},e.parameters);const h=Fn[this.specification.type];if(h){const f=h(e.value.value,i.value.value,s);return new li(this,{kind:"constant",value:f},e.parameters)}return e}evaluate(e,i,s,h,f,y){return e.kind==="constant"?e.value:e.evaluate(i,s,h,f,y)}}class Fs extends dt{possiblyEvaluate(e,i,s,h){if(e.value===void 0)return new li(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const f=e.expression.evaluate(i,null,{},s,h),y=e.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,x=this._calculate(y,y,y,i);return new li(this,{kind:"constant",value:x},i)}if(e.expression.kind==="camera"){const f=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new li(this,{kind:"constant",value:f},i)}return new li(this,e.expression,i)}evaluate(e,i,s,h,f,y){if(e.kind==="source"){const x=e.evaluate(i,s,h,f,y);return this._calculate(x,x,x,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},s,h),e.evaluate({zoom:Math.floor(i.zoom)},s,h),e.evaluate({zoom:Math.floor(i.zoom)+1},s,h),i):e.value}_calculate(e,i,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:s,to:i}}interpolate(e){return e}}class Nl{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const f=e.expression.evaluate(i,null,{},s,h);return this._calculate(f,f,f,i)}return this._calculate(e.expression.evaluate(new sr(Math.floor(i.zoom-1),i)),e.expression.evaluate(new sr(Math.floor(i.zoom),i)),e.expression.evaluate(new sr(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:s,to:i}}interpolate(e){return e}}class Vl{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,h){return!!e.expression.evaluate(i,null,{},s,h)}interpolate(){return!1}}class wn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const s=e[i];s.specification.overridable&&this.overridableProperties.push(i);const h=this.defaultPropertyValues[i]=new Rs(s,void 0),f=this.defaultTransitionablePropertyValues[i]=new Ho(s);this.defaultTransitioningPropertyValues[i]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=h.possiblyEvaluate({})}}}Xe("DataDrivenProperty",dt),Xe("DataConstantProperty",rt),Xe("CrossFadedDataDrivenProperty",Fs),Xe("CrossFadedProperty",Nl),Xe("ColorRampProperty",Vl);const Co="-transition";class Mi extends br{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Dd(i.layout)),i.paint)){this._transitionablePaint=new du(i.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Va(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,s={}){i!=null&&this._validate(Pd,`layers.${this.id}.layout.${e}`,e,i,s)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return e.endsWith(Co)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,s={}){if(i!=null&&this._validate(Fa,`layers.${this.id}.paint.${e}`,e,i,s))return!1;if(e.endsWith(Co))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const h=this._transitionablePaint._values[e],f=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),x=h.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||y||f||this._handleOverridablePaintPropertyUpdate(e,x,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Re(e,(i,s)=>!(i===void 0||s==="layout"&&!Object.keys(i).length||s==="paint"&&!Object.keys(i).length))}_validate(e,i,s,h,f={}){return(!f||f.validate!==!1)&&zs(this,e.call(La,{key:i,layerType:this.type,objectKey:s,value:h,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof li&&Xo(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const Rd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ja{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ur{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Cr(r,e=1){let i=0,s=0;return{members:r.map(h=>{const f=Rd[h.type].BYTES_PER_ELEMENT,y=i=fu(i,Math.max(e,f)),x=h.components||1;return s=Math.max(s,f),i+=f*x,{name:h.name,type:h.type,components:x,offset:y}}),size:fu(i,Math.max(s,e)),alignment:e}}function fu(r,e){return Math.ceil(r/e)*e}class ri extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.int16[h+0]=i,this.int16[h+1]=s,e}}ri.prototype.bytesPerElement=4,Xe("StructArrayLayout2i4",ri);class qa extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=s,this.int16[f+2]=h,e}}qa.prototype.bytesPerElement=6,Xe("StructArrayLayout3i6",qa);class Ga extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,h)}emplace(e,i,s,h,f){const y=4*e;return this.int16[y+0]=i,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=f,e}}Ga.prototype.bytesPerElement=8,Xe("StructArrayLayout4i8",Ga);class Bs extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,s,h,f,y)}emplace(e,i,s,h,f,y,x){const S=6*e;return this.int16[S+0]=i,this.int16[S+1]=s,this.int16[S+2]=h,this.int16[S+3]=f,this.int16[S+4]=y,this.int16[S+5]=x,e}}Bs.prototype.bytesPerElement=12,Xe("StructArrayLayout2i4i12",Bs);class Za extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,s,h,f,y)}emplace(e,i,s,h,f,y,x){const S=4*e,C=8*e;return this.int16[S+0]=i,this.int16[S+1]=s,this.uint8[C+4]=h,this.uint8[C+5]=f,this.uint8[C+6]=y,this.uint8[C+7]=x,e}}Za.prototype.bytesPerElement=8,Xe("StructArrayLayout2i4ub8",Za);class Wa extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.float32[h+0]=i,this.float32[h+1]=s,e}}Wa.prototype.bytesPerElement=8,Xe("StructArrayLayout2f8",Wa);class Yo extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y,x,S,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,e,i,s,h,f,y,x,S,C,A)}emplace(e,i,s,h,f,y,x,S,C,A,M){const R=10*e;return this.uint16[R+0]=i,this.uint16[R+1]=s,this.uint16[R+2]=h,this.uint16[R+3]=f,this.uint16[R+4]=y,this.uint16[R+5]=x,this.uint16[R+6]=S,this.uint16[R+7]=C,this.uint16[R+8]=A,this.uint16[R+9]=M,e}}Yo.prototype.bytesPerElement=20,Xe("StructArrayLayout10ui20",Yo);class ko extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y,x,S,C,A,M,R){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,s,h,f,y,x,S,C,A,M,R)}emplace(e,i,s,h,f,y,x,S,C,A,M,R,B){const $=12*e;return this.int16[$+0]=i,this.int16[$+1]=s,this.int16[$+2]=h,this.int16[$+3]=f,this.uint16[$+4]=y,this.uint16[$+5]=x,this.uint16[$+6]=S,this.uint16[$+7]=C,this.int16[$+8]=A,this.int16[$+9]=M,this.int16[$+10]=R,this.int16[$+11]=B,e}}ko.prototype.bytesPerElement=24,Xe("StructArrayLayout4i4ui4i24",ko);class jl extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=s,this.float32[f+2]=h,e}}jl.prototype.bytesPerElement=12,Xe("StructArrayLayout3f12",jl);class Os extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Os.prototype.bytesPerElement=4,Xe("StructArrayLayout1ul4",Os);class Io extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y,x,S,C){const A=this.length;return this.resize(A+1),this.emplace(A,e,i,s,h,f,y,x,S,C)}emplace(e,i,s,h,f,y,x,S,C,A){const M=10*e,R=5*e;return this.int16[M+0]=i,this.int16[M+1]=s,this.int16[M+2]=h,this.int16[M+3]=f,this.int16[M+4]=y,this.int16[M+5]=x,this.uint32[R+3]=S,this.uint16[M+8]=C,this.uint16[M+9]=A,e}}Io.prototype.bytesPerElement=20,Xe("StructArrayLayout6i1ul2ui20",Io);class ql extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,s,h,f,y)}emplace(e,i,s,h,f,y,x){const S=6*e;return this.int16[S+0]=i,this.int16[S+1]=s,this.int16[S+2]=h,this.int16[S+3]=f,this.int16[S+4]=y,this.int16[S+5]=x,e}}ql.prototype.bytesPerElement=12,Xe("StructArrayLayout2i2i2i12",ql);class Gl extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,s,h,f)}emplace(e,i,s,h,f,y){const x=4*e,S=8*e;return this.float32[x+0]=i,this.float32[x+1]=s,this.float32[x+2]=h,this.int16[S+6]=f,this.int16[S+7]=y,e}}Gl.prototype.bytesPerElement=16,Xe("StructArrayLayout2f1f2i16",Gl);class $s extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,h)}emplace(e,i,s,h,f){const y=12*e,x=3*e;return this.uint8[y+0]=i,this.uint8[y+1]=s,this.float32[x+1]=h,this.float32[x+2]=f,e}}$s.prototype.bytesPerElement=12,Xe("StructArrayLayout2ub2f12",$s);class Us extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=s,this.uint16[f+2]=h,e}}Us.prototype.bytesPerElement=6,Xe("StructArrayLayout3ui6",Us);class Zl extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q){const ce=this.length;return this.resize(ce+1),this.emplace(ce,e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q)}emplace(e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q,ce){const ne=24*e,he=12*e,fe=48*e;return this.int16[ne+0]=i,this.int16[ne+1]=s,this.uint16[ne+2]=h,this.uint16[ne+3]=f,this.uint32[he+2]=y,this.uint32[he+3]=x,this.uint32[he+4]=S,this.uint16[ne+10]=C,this.uint16[ne+11]=A,this.uint16[ne+12]=M,this.float32[he+7]=R,this.float32[he+8]=B,this.uint8[fe+36]=$,this.uint8[fe+37]=G,this.uint8[fe+38]=H,this.uint32[he+10]=Q,this.int16[ne+22]=ce,e}}Zl.prototype.bytesPerElement=48,Xe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);class $t extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q,ce,ne,he,fe,we,Ge,et,qe,Ne,Le,Ke){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q,ce,ne,he,fe,we,Ge,et,qe,Ne,Le,Ke)}emplace(e,i,s,h,f,y,x,S,C,A,M,R,B,$,G,H,Q,ce,ne,he,fe,we,Ge,et,qe,Ne,Le,Ke,Oe){const Pe=32*e,ct=16*e;return this.int16[Pe+0]=i,this.int16[Pe+1]=s,this.int16[Pe+2]=h,this.int16[Pe+3]=f,this.int16[Pe+4]=y,this.int16[Pe+5]=x,this.int16[Pe+6]=S,this.int16[Pe+7]=C,this.uint16[Pe+8]=A,this.uint16[Pe+9]=M,this.uint16[Pe+10]=R,this.uint16[Pe+11]=B,this.uint16[Pe+12]=$,this.uint16[Pe+13]=G,this.uint16[Pe+14]=H,this.uint16[Pe+15]=Q,this.uint16[Pe+16]=ce,this.uint16[Pe+17]=ne,this.uint16[Pe+18]=he,this.uint16[Pe+19]=fe,this.uint16[Pe+20]=we,this.uint16[Pe+21]=Ge,this.uint16[Pe+22]=et,this.uint32[ct+12]=qe,this.float32[ct+13]=Ne,this.float32[ct+14]=Le,this.uint16[Pe+30]=Ke,this.uint16[Pe+31]=Oe,e}}$t.prototype.bytesPerElement=64,Xe("StructArrayLayout8i15ui1ul2f2ui64",$t);class p extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}p.prototype.bytesPerElement=4,Xe("StructArrayLayout1f4",p);class t extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const f=3*e;return this.uint16[6*e+0]=i,this.float32[f+1]=s,this.float32[f+2]=h,e}}t.prototype.bytesPerElement=12,Xe("StructArrayLayout1ui2f12",t);class o extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const f=4*e;return this.uint32[2*e+0]=i,this.uint16[f+2]=s,this.uint16[f+3]=h,e}}o.prototype.bytesPerElement=8,Xe("StructArrayLayout1ul2ui8",o);class c extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.uint16[h+0]=i,this.uint16[h+1]=s,e}}c.prototype.bytesPerElement=4,Xe("StructArrayLayout2ui4",c);class d extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}d.prototype.bytesPerElement=2,Xe("StructArrayLayout1ui2",d);class m extends ur{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,h)}emplace(e,i,s,h,f){const y=4*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=f,e}}m.prototype.bytesPerElement=16,Xe("StructArrayLayout4f16",m);class v extends ja{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new K(this.anchorPointX,this.anchorPointY)}}v.prototype.size=20;class b extends Io{get(e){return new v(this,e)}}Xe("CollisionBoxArray",b);class E extends ja{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}E.prototype.size=48;class k extends Zl{get(e){return new E(this,e)}}Xe("PlacedSymbolArray",k);class I extends ja{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}I.prototype.size=64;class P extends $t{get(e){return new I(this,e)}}Xe("SymbolInstanceArray",P);class F extends p{getoffsetX(e){return this.float32[1*e+0]}}Xe("GlyphOffsetArray",F);class q extends qa{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Xe("SymbolLineVertexArray",q);class j extends ja{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}j.prototype.size=12;class W extends t{get(e){return new j(this,e)}}Xe("TextAnchorOffsetArray",W);class N extends ja{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}N.prototype.size=8;class ie extends o{get(e){return new N(this,e)}}Xe("FeatureIndexArray",ie);class pe extends ri{}class J extends ri{}class se extends ri{}class me extends Bs{}class ye extends Za{}class be extends Wa{}class Ae extends Yo{}class ke extends ko{}class ze extends jl{}class Qe extends Os{}class St extends ql{}class Ue extends $s{}class st extends Us{}class Ye extends c{}const lr=Cr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Et}=lr;class lt{constructor(e=[]){this.segments=e}prepareSegment(e,i,s,h){let f=this.segments[this.segments.length-1];return e>lt.MAX_VERTEX_ARRAY_LENGTH&&yt(`Max vertices per segment is ${lt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>lt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==h)&&(f={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},h!==void 0&&(f.sortKey=h),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,s,h){return new lt([{vertexOffset:e,primitiveOffset:i,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}function Tt(r,e){return 256*(r=ge(Math.floor(r),0,255))+ge(Math.floor(e),0,255)}lt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xe("SegmentVector",lt);const hr=Cr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Wt={exports:{}},$n={exports:{}};$n.exports=function(r,e){var i,s,h,f,y,x,S,C;for(s=r.length-(i=3&r.length),h=e,y=3432918353,x=461845907,C=0;C<s;)S=255&r.charCodeAt(C)|(255&r.charCodeAt(++C))<<8|(255&r.charCodeAt(++C))<<16|(255&r.charCodeAt(++C))<<24,++C,h=27492+(65535&(f=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(S=0,i){case 3:S^=(255&r.charCodeAt(C+2))<<16;case 2:S^=(255&r.charCodeAt(C+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&r.charCodeAt(C)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295}return h^=r.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var Xr=$n.exports,yr={exports:{}};yr.exports=function(r,e){for(var i,s=r.length,h=e^s,f=0;s>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(f)|(255&r.charCodeAt(++f))<<8|(255&r.charCodeAt(++f))<<16|(255&r.charCodeAt(++f))<<24))+((1540483477*(i>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:h^=(255&r.charCodeAt(f+2))<<16;case 2:h^=(255&r.charCodeAt(f+1))<<8;case 1:h=1540483477*(65535&(h^=255&r.charCodeAt(f)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Sn=Xr,zi=yr.exports;Wt.exports=Sn,Wt.exports.murmur3=Sn,Wt.exports.murmur2=zi;var ci=O(Wt.exports);class Di{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,s,h){this.ids.push(Jo(e)),this.positions.push(i,s,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=Jo(e);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=i?h=y:s=y+1}const f=[];for(;this.ids[s]===i;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,i){const s=new Float64Array(e.ids),h=new Uint32Array(e.positions);return so(s,h,0,s.length-1),i&&i.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(e){const i=new Di;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Jo(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:ci(String(r))}function so(r,e,i,s){for(;i<s;){const h=r[i+s>>1];let f=i-1,y=s+1;for(;;){do f++;while(r[f]<h);do y--;while(r[y]>h);if(f>=y)break;Zi(r,f,y),Zi(e,3*f,3*y),Zi(e,3*f+1,3*y+1),Zi(e,3*f+2,3*y+2)}y-i<s-y?(so(r,e,i,y),i=y+1):(so(r,e,y+1,s),s=y)}}function Zi(r,e,i){const s=r[e];r[e]=r[i],r[i]=s}Xe("FeaturePositionMap",Di);class kr{constructor(e,i){this.gl=e.gl,this.location=i}}class Br extends kr{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class rn extends kr{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Qo extends kr{constructor(e,i){super(e,i),this.current=ft.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Or=new Float32Array(16);function zr(r){return[Tt(255*r.r,255*r.g),Tt(255*r.b,255*r.a)]}class nn{constructor(e,i,s){this.value=e,this.uniformNames=i.map(h=>`u_${h}`),this.type=s}setUniform(e,i,s){e.set(s.constantOr(this.value))}getBinding(e,i,s){return this.type==="color"?new Qo(e,i):new Br(e,i)}}class dr{constructor(e,i){this.uniformNames=i.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setUniform(e,i,s,h){const f=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)}getBinding(e,i,s){return s.substr(0,9)==="u_pattern"?new rn(e,i):new Br(e,i)}}class Wi{constructor(e,i,s,h){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,i,s,h,f){const y=this.paintVertexArray.length,x=this.expression.evaluate(new sr(0),i,{},h,[],f);this.paintVertexArray.resize(e),this._setPaintValue(y,e,x)}updatePaintArray(e,i,s,h){const f=this.expression.evaluate({zoom:0},s,h);this._setPaintValue(e,i,f)}_setPaintValue(e,i,s){if(this.type==="color"){const h=zr(s);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,h[0],h[1])}else{for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ui{constructor(e,i,s,h,f,y){this.expression=e,this.uniformNames=i.map(x=>`u_${x}_t`),this.type=s,this.useIntegerZoom=h,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(x=>({name:`a_${x}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,i,s,h,f){const y=this.expression.evaluate(new sr(this.zoom),i,{},h,[],f),x=this.expression.evaluate(new sr(this.zoom+1),i,{},h,[],f),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,x)}updatePaintArray(e,i,s,h){const f=this.expression.evaluate({zoom:this.zoom},s,h),y=this.expression.evaluate({zoom:this.zoom+1},s,h);this._setPaintValue(e,i,f,y)}_setPaintValue(e,i,s,h){if(this.type==="color"){const f=zr(s),y=zr(h);for(let x=e;x<i;x++)this.paintVertexArray.emplace(x,f[0],f[1],y[0],y[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=ge(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,i,s){return new Br(e,i)}}class lo{constructor(e,i,s,h,f,y){this.expression=e,this.type=i,this.useIntegerZoom=s,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(e,i,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(e,i,s,h,f){this._setPaintValues(e,i,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(e,i,s,h){if(!h||!s)return;const{min:f,mid:y,max:x}=s,S=h[f],C=h[y],A=h[x];if(S&&C&&A)for(let M=e;M<i;M++)this.zoomInPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],C.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,C.tl[0],C.tl[1],C.br[0],C.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],C.pixelRatio,A.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,hr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,hr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class mu{constructor(e,i,s){this.binders={},this._buffers=[];const h=[];for(const f in e.paint._values){if(!s(f))continue;const y=e.paint.get(f);if(!(y instanceof li&&Xo(y.property.specification)))continue;const x=Ld(f,e.type),S=y.value,C=y.property.specification.type,A=y.property.useIntegerZoom,M=y.property.specification["property-type"],R=M==="cross-faded"||M==="cross-faded-data-driven";if(S.kind==="constant")this.binders[f]=R?new dr(S.value,x):new nn(S.value,x,C),h.push(`/u_${f}`);else if(S.kind==="source"||R){const B=Po(f,C,"source");this.binders[f]=R?new lo(S,C,A,i,B,e.id):new Wi(S,x,C,B),h.push(`/a_${f}`)}else{const B=Po(f,C,"composite");this.binders[f]=new ui(S,x,C,A,i,B),h.push(`/z_${f}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Wi||i instanceof ui?i.maxValue:0}populatePaintArrays(e,i,s,h,f){for(const y in this.binders){const x=this.binders[y];(x instanceof Wi||x instanceof ui||x instanceof lo)&&x.populatePaintArray(e,i,s,h,f)}}setConstantPatternPositions(e,i){for(const s in this.binders){const h=this.binders[s];h instanceof dr&&h.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,s,h,f){let y=!1;for(const x in e){const S=i.getPositions(x);for(const C of S){const A=s.feature(C.index);for(const M in this.binders){const R=this.binders[M];if((R instanceof Wi||R instanceof ui||R instanceof lo)&&R.expression.isStateDependent===!0){const B=h.paint.get(M);R.expression=B.value,R.updatePaintArray(C.start,C.end,A,e[x],f),y=!0}}}}return y}defines(){const e=[];for(const i in this.binders){const s=this.binders[i];(s instanceof nn||s instanceof dr)&&e.push(...s.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Wi||s instanceof ui)for(let h=0;h<s.paintVertexAttributes.length;h++)e.push(s.paintVertexAttributes[h].name);else if(s instanceof lo)for(let h=0;h<hr.members.length;h++)e.push(hr.members[h].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof nn||s instanceof dr||s instanceof ui)for(const h of s.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const s=[];for(const h in this.binders){const f=this.binders[h];if(f instanceof nn||f instanceof dr||f instanceof ui){for(const y of f.uniformNames)if(i[y]){const x=f.getBinding(e,i[y],y);s.push({name:y,property:h,binding:x})}}}return s}setUniforms(e,i,s,h){for(const{name:f,property:y,binding:x}of i)this.binders[y].setUniform(x,h,s.get(y),f)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const s=this.binders[i];if(e&&s instanceof lo){const h=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof Wi||s instanceof ui)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const i in this.binders){const s=this.binders[i];(s instanceof Wi||s instanceof ui||s instanceof lo)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Wi||i instanceof ui||i instanceof lo)&&i.destroy()}}}class Ao{constructor(e,i,s=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new mu(h,i,s);this.needsUpload=!1,this._featureMap=new Di,this._bufferOffset=0}populatePaintArrays(e,i,s,h,f,y){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,i,h,f,y);i.id!==void 0&&this._featureMap.add(i.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,s,h){for(const f of s)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(e,this._featureMap,i,f,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Ld(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function Po(r,e,i){const s={color:{source:Wa,composite:m},number:{source:p,composite:Wa}},h=function(f){return{"line-pattern":{source:Ae,composite:Ae},"fill-pattern":{source:Ae,composite:Ae},"fill-extrusion-pattern":{source:Ae,composite:Ae}}[f]}(r);return h&&h[i]||s[e][i]}Xe("ConstantBinder",nn),Xe("CrossFadedConstantBinder",dr),Xe("SourceExpressionBinder",Wi),Xe("CrossFadedCompositeBinder",lo),Xe("CompositeExpressionBinder",ui),Xe("ProgramConfiguration",mu,{omit:["_buffers"]}),Xe("ProgramConfigurationSet",Ao);const gr=8192,Ns=Math.pow(2,14)-1,Wl=-Ns-1;function Xi(r){const e=gr/r.extent,i=r.loadGeometry();for(let s=0;s<i.length;s++){const h=i[s];for(let f=0;f<h.length;f++){const y=h[f],x=Math.round(y.x*e),S=Math.round(y.y*e);y.x=ge(x,Wl,Ns),y.y=ge(S,Wl,Ns),(x<y.x||x>y.x+1||S<y.y||S>y.y+1)&&yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function co(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Xi(r):[]}}function ea(r,e,i,s,h){r.emplaceBack(2*e+(s+1)/2,2*i+(h+1)/2)}class Fd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new J,this.indexArray=new st,this.segments=new lt,this.programConfigurations=new Ao(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){const h=this.layers[0],f=[];let y=null,x=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),x=!y.isConstant());for(const{feature:S,id:C,index:A,sourceLayerIndex:M}of e){const R=this.layers[0]._featureFilter.needGeometry,B=co(S,R);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),B,s))continue;const $=x?y.evaluate(B,{},s):void 0,G={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:A,geometry:R?B.geometry:Xi(S),patterns:{},sortKey:$};f.push(G)}x&&f.sort((S,C)=>S.sortKey-C.sortKey);for(const S of f){const{geometry:C,index:A,sourceLayerIndex:M}=S,R=e[A].feature;this.addFeature(S,C,A,s),i.featureIndex.insert(R,C,A,M,this.index)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Et),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,h){for(const f of i)for(const y of f){const x=y.x,S=y.y;if(x<0||x>=gr||S<0||S>=gr)continue;const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),A=C.vertexLength;ea(this.layoutVertexArray,x,S,-1,-1),ea(this.layoutVertexArray,x,S,1,-1),ea(this.layoutVertexArray,x,S,1,1),ea(this.layoutVertexArray,x,S,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+3,A+2),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},h)}}function vm(r,e){for(let i=0;i<r.length;i++)if(Vs(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Vs(r,e[i]))return!0;return!!Bd(r,e)}function Sv(r,e,i){return!!Vs(r,e)||!!Od(e,r,i)}function bm(r,e){if(r.length===1)return Sm(e,r[0]);for(let i=0;i<e.length;i++){const s=e[i];for(let h=0;h<s.length;h++)if(Vs(r,s[h]))return!0}for(let i=0;i<r.length;i++)if(Sm(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(Bd(r,e[i]))return!0;return!1}function Ev(r,e,i){if(r.length>1){if(Bd(r,e))return!0;for(let s=0;s<e.length;s++)if(Od(e[s],r,i))return!0}for(let s=0;s<r.length;s++)if(Od(r[s],e,i))return!0;return!1}function Bd(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const s=r[i],h=r[i+1];for(let f=0;f<e.length-1;f++)if(Tv(s,h,e[f],e[f+1]))return!0}return!1}function Tv(r,e,i,s){return $e(r,i,s)!==$e(e,i,s)&&$e(r,e,i)!==$e(r,e,s)}function Od(r,e,i){const s=i*i;if(e.length===1)return r.distSqr(e[0])<s;for(let h=1;h<e.length;h++)if(wm(r,e[h-1],e[h])<s)return!0;return!1}function wm(r,e,i){const s=e.distSqr(i);if(s===0)return r.distSqr(e);const h=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/s;return r.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function Sm(r,e){let i,s,h,f=!1;for(let y=0;y<r.length;y++){i=r[y];for(let x=0,S=i.length-1;x<i.length;S=x++)s=i[x],h=i[S],s.y>e.y!=h.y>e.y&&e.x<(h.x-s.x)*(e.y-s.y)/(h.y-s.y)+s.x&&(f=!f)}return f}function Vs(r,e){let i=!1;for(let s=0,h=r.length-1;s<r.length;h=s++){const f=r[s],y=r[h];f.y>e.y!=y.y>e.y&&e.x<(y.x-f.x)*(e.y-f.y)/(y.y-f.y)+f.x&&(i=!i)}return i}function Cv(r,e,i){const s=i[0],h=i[2];if(r.x<s.x&&e.x<s.x||r.x>h.x&&e.x>h.x||r.y<s.y&&e.y<s.y||r.y>h.y&&e.y>h.y)return!1;const f=$e(r,e,i[0]);return f!==$e(r,e,i[1])||f!==$e(r,e,i[2])||f!==$e(r,e,i[3])}function Xl(r,e,i){const s=e.paint.get(r).value;return s.kind==="constant"?s.value:i.programConfigurations.get(e.id).getMaxValue(r)}function gu(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function yu(r,e,i,s,h){if(!e[0]&&!e[1])return r;const f=K.convert(e)._mult(h);i==="viewport"&&f._rotate(-s);const y=[];for(let x=0;x<r.length;x++)y.push(r[x].sub(f));return y}let Em,Tm;Xe("CircleBucket",Fd,{omit:["layers"]});var kv={get paint(){return Tm=Tm||new wn({"circle-radius":new dt(ve.paint_circle["circle-radius"]),"circle-color":new dt(ve.paint_circle["circle-color"]),"circle-blur":new dt(ve.paint_circle["circle-blur"]),"circle-opacity":new dt(ve.paint_circle["circle-opacity"]),"circle-translate":new rt(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new rt(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new rt(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new rt(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dt(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dt(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dt(ve.paint_circle["circle-stroke-opacity"])})},get layout(){return Em=Em||new wn({"circle-sort-key":new dt(ve.layout_circle["circle-sort-key"])})}},En=1e-6,js=typeof Float32Array<"u"?Float32Array:Array;function $d(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Cm(r,e,i){var s=e[0],h=e[1],f=e[2],y=e[3],x=e[4],S=e[5],C=e[6],A=e[7],M=e[8],R=e[9],B=e[10],$=e[11],G=e[12],H=e[13],Q=e[14],ce=e[15],ne=i[0],he=i[1],fe=i[2],we=i[3];return r[0]=ne*s+he*x+fe*M+we*G,r[1]=ne*h+he*S+fe*R+we*H,r[2]=ne*f+he*C+fe*B+we*Q,r[3]=ne*y+he*A+fe*$+we*ce,r[4]=(ne=i[4])*s+(he=i[5])*x+(fe=i[6])*M+(we=i[7])*G,r[5]=ne*h+he*S+fe*R+we*H,r[6]=ne*f+he*C+fe*B+we*Q,r[7]=ne*y+he*A+fe*$+we*ce,r[8]=(ne=i[8])*s+(he=i[9])*x+(fe=i[10])*M+(we=i[11])*G,r[9]=ne*h+he*S+fe*R+we*H,r[10]=ne*f+he*C+fe*B+we*Q,r[11]=ne*y+he*A+fe*$+we*ce,r[12]=(ne=i[12])*s+(he=i[13])*x+(fe=i[14])*M+(we=i[15])*G,r[13]=ne*h+he*S+fe*R+we*H,r[14]=ne*f+he*C+fe*B+we*Q,r[15]=ne*y+he*A+fe*$+we*ce,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Kl,Iv=Cm;function _u(r,e,i){var s=e[0],h=e[1],f=e[2],y=e[3];return r[0]=i[0]*s+i[4]*h+i[8]*f+i[12]*y,r[1]=i[1]*s+i[5]*h+i[9]*f+i[13]*y,r[2]=i[2]*s+i[6]*h+i[10]*f+i[14]*y,r[3]=i[3]*s+i[7]*h+i[11]*f+i[15]*y,r}Kl=new js(4),js!=Float32Array&&(Kl[0]=0,Kl[1]=0,Kl[2]=0,Kl[3]=0);class Av extends Mi{constructor(e){super(e,kv)}createBucket(e){return new Fd(e)}queryRadius(e){const i=e;return Xl("circle-radius",this,i)+Xl("circle-stroke-width",this,i)+gu(this.paint.get("circle-translate"))}queryIntersectsFeature(e,i,s,h,f,y,x,S){const C=yu(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,x),A=this.paint.get("circle-radius").evaluate(i,s)+this.paint.get("circle-stroke-width").evaluate(i,s),M=this.paint.get("circle-pitch-alignment")==="map",R=M?C:function($,G){return $.map(H=>km(H,G))}(C,S),B=M?A*x:A;for(const $ of h)for(const G of $){const H=M?G:km(G,S);let Q=B;const ce=_u([],[G.x,G.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=ce[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=y.cameraToCenterDistance/ce[3]),Sv(R,H,Q))return!0}return!1}}function km(r,e){const i=_u([],[r.x,r.y,0,1],e);return new K(i[0]/i[3],i[1]/i[3])}class Im extends Fd{}let Am;Xe("HeatmapBucket",Im,{omit:["layers"]});var Pv={get paint(){return Am=Am||new wn({"heatmap-radius":new dt(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dt(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new rt(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vl(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new rt(ve.paint_heatmap["heatmap-opacity"])})}};function Ud(r,{width:e,height:i},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*i*s)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*i*s}`)}else h=new Uint8Array(e*i*s);return r.width=e,r.height=i,r.data=h,r}function Pm(r,{width:e,height:i},s){if(e===r.width&&i===r.height)return;const h=Ud({},{width:e,height:i},s);Nd(r,h,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,i)},s),r.width=e,r.height=i,r.data=h.data}function Nd(r,e,i,s,h,f){if(h.width===0||h.height===0)return e;if(h.width>r.width||h.height>r.height||i.x>r.width-h.width||i.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||s.x>e.width-h.width||s.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,x=e.data;if(y===x)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const C=((i.y+S)*r.width+i.x)*f,A=((s.y+S)*e.width+s.x)*f;for(let M=0;M<h.width*f;M++)x[A+M]=y[C+M]}return e}class Hl{constructor(e,i){Ud(this,e,1,i)}resize(e){Pm(this,e,1)}clone(){return new Hl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,h,f){Nd(e,i,s,h,f,1)}}class hi{constructor(e,i){Ud(this,e,4,i)}resize(e){Pm(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new hi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,h,f){Nd(e,i,s,h,f,4)}}function Mm(r){const e={},i=r.resolution||256,s=r.clips?r.clips.length:1,h=r.image||new hi({width:i,height:s});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const f=(y,x,S)=>{e[r.evaluationKey]=S;const C=r.expression.evaluate(e);h.data[y+x+0]=Math.floor(255*C.r/C.a),h.data[y+x+1]=Math.floor(255*C.g/C.a),h.data[y+x+2]=Math.floor(255*C.b/C.a),h.data[y+x+3]=Math.floor(255*C.a)};if(r.clips)for(let y=0,x=0;y<s;++y,x+=4*i)for(let S=0,C=0;S<i;S++,C+=4){const A=S/(i-1),{start:M,end:R}=r.clips[y];f(x,C,M*(1-A)+R*A)}else for(let y=0,x=0;y<i;y++,x+=4)f(0,x,y/(i-1));return h}Xe("AlphaImage",Hl),Xe("RGBAImage",hi);class Mv extends Mi{createBucket(e){return new Im(e)}constructor(e){super(e,Pv),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Mm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let zm;var zv={get paint(){return zm=zm||new wn({"hillshade-illumination-direction":new rt(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new rt(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new rt(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new rt(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new rt(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new rt(ve.paint_hillshade["hillshade-accent-color"])})}};class Dv extends Mi{constructor(e){super(e,zv)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Rv=Cr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Lv}=Rv;var Vd={exports:{}};function xu(r,e,i){i=i||2;var s,h,f,y,x,S,C,A=e&&e.length,M=A?e[0]*i:r.length,R=Dm(r,0,M,i,!0),B=[];if(!R||R.next===R.prev)return B;if(A&&(R=function(G,H,Q,ce){var ne,he,fe,we=[];for(ne=0,he=H.length;ne<he;ne++)(fe=Dm(G,H[ne]*ce,ne<he-1?H[ne+1]*ce:G.length,ce,!1))===fe.next&&(fe.steiner=!0),we.push(jv(fe));for(we.sort(Uv),ne=0;ne<we.length;ne++)Q=Nv(we[ne],Q);return Q}(r,e,R,i)),r.length>80*i){s=f=r[0],h=y=r[1];for(var $=i;$<M;$+=i)(x=r[$])<s&&(s=x),(S=r[$+1])<h&&(h=S),x>f&&(f=x),S>y&&(y=S);C=(C=Math.max(f-s,y-h))!==0?32767/C:0}return Yl(R,B,i,s,h,C,0),B}function Dm(r,e,i,s,h){var f,y;if(h===Gd(r,e,i,s)>0)for(f=e;f<i;f+=s)y=Fm(f,r[f],r[f+1],y);else for(f=i-s;f>=e;f-=s)y=Fm(f,r[f],r[f+1],y);return y&&vu(y,y.next)&&(Ql(y),y=y.next),y}function Xa(r,e){if(!r)return r;e||(e=r);var i,s=r;do if(i=!1,s.steiner||!vu(s,s.next)&&Ir(s.prev,s,s.next)!==0)s=s.next;else{if(Ql(s),(s=e=s.prev)===s.next)break;i=!0}while(i||s!==e);return e}function Yl(r,e,i,s,h,f,y){if(r){!y&&f&&function(A,M,R,B){var $=A;do $.z===0&&($.z=jd($.x,$.y,M,R,B)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==A);$.prevZ.nextZ=null,$.prevZ=null,function(G){var H,Q,ce,ne,he,fe,we,Ge,et=1;do{for(Q=G,G=null,he=null,fe=0;Q;){for(fe++,ce=Q,we=0,H=0;H<et&&(we++,ce=ce.nextZ);H++);for(Ge=et;we>0||Ge>0&&ce;)we!==0&&(Ge===0||!ce||Q.z<=ce.z)?(ne=Q,Q=Q.nextZ,we--):(ne=ce,ce=ce.nextZ,Ge--),he?he.nextZ=ne:G=ne,ne.prevZ=he,he=ne;Q=ce}he.nextZ=null,et*=2}while(fe>1)}($)}(r,s,h,f);for(var x,S,C=r;r.prev!==r.next;)if(x=r.prev,S=r.next,f?Bv(r,s,h,f):Fv(r))e.push(x.i/i|0),e.push(r.i/i|0),e.push(S.i/i|0),Ql(r),r=S.next,C=S.next;else if((r=S)===C){y?y===1?Yl(r=Ov(Xa(r),e,i),e,i,s,h,f,2):y===2&&$v(r,e,i,s,h,f):Yl(Xa(r),e,i,s,h,f,1);break}}}function Fv(r){var e=r.prev,i=r,s=r.next;if(Ir(e,i,s)>=0)return!1;for(var h=e.x,f=i.x,y=s.x,x=e.y,S=i.y,C=s.y,A=h<f?h<y?h:y:f<y?f:y,M=x<S?x<C?x:C:S<C?S:C,R=h>f?h>y?h:y:f>y?f:y,B=x>S?x>C?x:C:S>C?S:C,$=s.next;$!==e;){if($.x>=A&&$.x<=R&&$.y>=M&&$.y<=B&&qs(h,x,f,S,y,C,$.x,$.y)&&Ir($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function Bv(r,e,i,s){var h=r.prev,f=r,y=r.next;if(Ir(h,f,y)>=0)return!1;for(var x=h.x,S=f.x,C=y.x,A=h.y,M=f.y,R=y.y,B=x<S?x<C?x:C:S<C?S:C,$=A<M?A<R?A:R:M<R?M:R,G=x>S?x>C?x:C:S>C?S:C,H=A>M?A>R?A:R:M>R?M:R,Q=jd(B,$,e,i,s),ce=jd(G,H,e,i,s),ne=r.prevZ,he=r.nextZ;ne&&ne.z>=Q&&he&&he.z<=ce;){if(ne.x>=B&&ne.x<=G&&ne.y>=$&&ne.y<=H&&ne!==h&&ne!==y&&qs(x,A,S,M,C,R,ne.x,ne.y)&&Ir(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,he.x>=B&&he.x<=G&&he.y>=$&&he.y<=H&&he!==h&&he!==y&&qs(x,A,S,M,C,R,he.x,he.y)&&Ir(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;ne&&ne.z>=Q;){if(ne.x>=B&&ne.x<=G&&ne.y>=$&&ne.y<=H&&ne!==h&&ne!==y&&qs(x,A,S,M,C,R,ne.x,ne.y)&&Ir(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;he&&he.z<=ce;){if(he.x>=B&&he.x<=G&&he.y>=$&&he.y<=H&&he!==h&&he!==y&&qs(x,A,S,M,C,R,he.x,he.y)&&Ir(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function Ov(r,e,i){var s=r;do{var h=s.prev,f=s.next.next;!vu(h,f)&&Rm(h,s,s.next,f)&&Jl(h,f)&&Jl(f,h)&&(e.push(h.i/i|0),e.push(s.i/i|0),e.push(f.i/i|0),Ql(s),Ql(s.next),s=r=f),s=s.next}while(s!==r);return Xa(s)}function $v(r,e,i,s,h,f){var y=r;do{for(var x=y.next.next;x!==y.prev;){if(y.i!==x.i&&qv(y,x)){var S=Lm(y,x);return y=Xa(y,y.next),S=Xa(S,S.next),Yl(y,e,i,s,h,f,0),void Yl(S,e,i,s,h,f,0)}x=x.next}y=y.next}while(y!==r)}function Uv(r,e){return r.x-e.x}function Nv(r,e){var i=function(h,f){var y,x=f,S=h.x,C=h.y,A=-1/0;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){var M=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(M<=S&&M>A&&(A=M,y=x.x<x.next.x?x:x.next,M===S))return y}x=x.next}while(x!==f);if(!y)return null;var R,B=y,$=y.x,G=y.y,H=1/0;x=y;do S>=x.x&&x.x>=$&&S!==x.x&&qs(C<G?S:A,C,$,G,C<G?A:S,C,x.x,x.y)&&(R=Math.abs(C-x.y)/(S-x.x),Jl(x,h)&&(R<H||R===H&&(x.x>y.x||x.x===y.x&&Vv(y,x)))&&(y=x,H=R)),x=x.next;while(x!==B);return y}(r,e);if(!i)return e;var s=Lm(i,r);return Xa(s,s.next),Xa(i,i.next)}function Vv(r,e){return Ir(r.prev,r,e.prev)<0&&Ir(e.next,r,r.next)<0}function jd(r,e,i,s,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jv(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function qs(r,e,i,s,h,f,y,x){return(h-y)*(e-x)>=(r-y)*(f-x)&&(r-y)*(s-x)>=(i-y)*(e-x)&&(i-y)*(f-x)>=(h-y)*(s-x)}function qv(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,s){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==s.i&&h.next.i!==s.i&&Rm(h,h.next,i,s))return!0;h=h.next}while(h!==i);return!1}(r,e)&&(Jl(r,e)&&Jl(e,r)&&function(i,s){var h=i,f=!1,y=(i.x+s.x)/2,x=(i.y+s.y)/2;do h.y>x!=h.next.y>x&&h.next.y!==h.y&&y<(h.next.x-h.x)*(x-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==i);return f}(r,e)&&(Ir(r.prev,r,e.prev)||Ir(r,e.prev,e))||vu(r,e)&&Ir(r.prev,r,r.next)>0&&Ir(e.prev,e,e.next)>0)}function Ir(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function vu(r,e){return r.x===e.x&&r.y===e.y}function Rm(r,e,i,s){var h=wu(Ir(r,e,i)),f=wu(Ir(r,e,s)),y=wu(Ir(i,s,r)),x=wu(Ir(i,s,e));return h!==f&&y!==x||!(h!==0||!bu(r,i,e))||!(f!==0||!bu(r,s,e))||!(y!==0||!bu(i,r,s))||!(x!==0||!bu(i,e,s))}function bu(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function wu(r){return r>0?1:r<0?-1:0}function Jl(r,e){return Ir(r.prev,r,r.next)<0?Ir(r,e,r.next)>=0&&Ir(r,r.prev,e)>=0:Ir(r,e,r.prev)<0||Ir(r,r.next,e)<0}function Lm(r,e){var i=new qd(r.i,r.x,r.y),s=new qd(e.i,e.x,e.y),h=r.next,f=e.prev;return r.next=e,e.prev=r,i.next=h,h.prev=i,s.next=i,i.prev=s,f.next=s,s.prev=f,s}function Fm(r,e,i,s){var h=new qd(r,e,i);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function Ql(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function qd(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gd(r,e,i,s){for(var h=0,f=e,y=i-s;f<i;f+=s)h+=(r[y]-r[f])*(r[f+1]+r[y+1]),y=f;return h}Vd.exports=xu,Vd.exports.default=xu,xu.deviation=function(r,e,i,s){var h=e&&e.length,f=Math.abs(Gd(r,0,h?e[0]*i:r.length,i));if(h)for(var y=0,x=e.length;y<x;y++)f-=Math.abs(Gd(r,e[y]*i,y<x-1?e[y+1]*i:r.length,i));var S=0;for(y=0;y<s.length;y+=3){var C=s[y]*i,A=s[y+1]*i,M=s[y+2]*i;S+=Math.abs((r[C]-r[M])*(r[A+1]-r[C+1])-(r[C]-r[A])*(r[M+1]-r[C+1]))}return f===0&&S===0?0:Math.abs((S-f)/f)},xu.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,h=0;h<r.length;h++){for(var f=0;f<r[h].length;f++)for(var y=0;y<e;y++)i.vertices.push(r[h][f][y]);h>0&&i.holes.push(s+=r[h-1].length)}return i};var Bm=O(Vd.exports);function Gv(r,e,i,s,h){Om(r,e,i||0,s||r.length-1,h||Zv)}function Om(r,e,i,s,h){for(;s>i;){if(s-i>600){var f=s-i+1,y=e-i+1,x=Math.log(f),S=.5*Math.exp(2*x/3),C=.5*Math.sqrt(x*S*(f-S)/f)*(y-f/2<0?-1:1);Om(r,e,Math.max(i,Math.floor(e-y*S/f+C)),Math.min(s,Math.floor(e+(f-y)*S/f+C)),h)}var A=r[e],M=i,R=s;for(ec(r,i,e),h(r[s],A)>0&&ec(r,i,s);M<R;){for(ec(r,M,R),M++,R--;h(r[M],A)<0;)M++;for(;h(r[R],A)>0;)R--}h(r[i],A)===0?ec(r,i,R):ec(r,++R,s),R<=e&&(i=R+1),e<=R&&(s=R-1)}}function ec(r,e,i){var s=r[e];r[e]=r[i],r[i]=s}function Zv(r,e){return r<e?-1:r>e?1:0}function Zd(r,e){const i=r.length;if(i<=1)return[r];const s=[];let h,f;for(let y=0;y<i;y++){const x=Ot(r[y]);x!==0&&(r[y].area=Math.abs(x),f===void 0&&(f=x<0),f===x<0?(h&&s.push(h),h=[r[y]]):h.push(r[y]))}if(h&&s.push(h),e>1)for(let y=0;y<s.length;y++)s[y].length<=e||(Gv(s[y],e,1,s[y].length-1,Wv),s[y]=s[y].slice(0,e));return s}function Wv(r,e){return e.area-r.area}function Wd(r,e,i){const s=i.patternDependencies;let h=!1;for(const f of e){const y=f.paint.get(`${r}-pattern`);y.isConstant()||(h=!0);const x=y.constantOr(null);x&&(h=!0,s[x.to]=!0,s[x.from]=!0)}return h}function Xd(r,e,i,s,h){const f=h.patternDependencies;for(const y of e){const x=y.paint.get(`${r}-pattern`).value;if(x.kind!=="constant"){let S=x.evaluate({zoom:s-1},i,{},h.availableImages),C=x.evaluate({zoom:s},i,{},h.availableImages),A=x.evaluate({zoom:s+1},i,{},h.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,A=A&&A.name?A.name:A,f[S]=!0,f[C]=!0,f[A]=!0,i.patterns[y.id]={min:S,mid:C,max:A}}}return i}class Kd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new se,this.indexArray=new st,this.indexArray2=new Ye,this.programConfigurations=new Ao(e.layers,e.zoom),this.segments=new lt,this.segments2=new lt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){this.hasPattern=Wd("fill",this.layers,i);const h=this.layers[0].layout.get("fill-sort-key"),f=!h.isConstant(),y=[];for(const{feature:x,id:S,index:C,sourceLayerIndex:A}of e){const M=this.layers[0]._featureFilter.needGeometry,R=co(x,M);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),R,s))continue;const B=f?h.evaluate(R,{},s,i.availableImages):void 0,$={id:S,properties:x.properties,type:x.type,sourceLayerIndex:A,index:C,geometry:M?R.geometry:Xi(x),patterns:{},sortKey:B};y.push($)}f&&y.sort((x,S)=>x.sortKey-S.sortKey);for(const x of y){const{geometry:S,index:C,sourceLayerIndex:A}=x;if(this.hasPattern){const M=Xd("fill",this.layers,x,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(x,S,C,s,{});i.featureIndex.insert(e[C].feature,S,C,A,this.index)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}addFeatures(e,i,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Lv),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,s,h,f){for(const y of Zd(i,500)){let x=0;for(const B of y)x+=B.length;const S=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),C=S.vertexLength,A=[],M=[];for(const B of y){if(B.length===0)continue;B!==y[0]&&M.push(A.length/2);const $=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),G=$.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(G+B.length-1,G),A.push(B[0].x),A.push(B[0].y);for(let H=1;H<B.length;H++)this.layoutVertexArray.emplaceBack(B[H].x,B[H].y),this.indexArray2.emplaceBack(G+H-1,G+H),A.push(B[H].x),A.push(B[H].y);$.vertexLength+=B.length,$.primitiveLength+=B.length}const R=Bm(A,M);for(let B=0;B<R.length;B+=3)this.indexArray.emplaceBack(C+R[B],C+R[B+1],C+R[B+2]);S.vertexLength+=x,S.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,h)}}let $m,Um;Xe("FillBucket",Kd,{omit:["layers","patternFeatures"]});var Xv={get paint(){return Um=Um||new wn({"fill-antialias":new rt(ve.paint_fill["fill-antialias"]),"fill-opacity":new dt(ve.paint_fill["fill-opacity"]),"fill-color":new dt(ve.paint_fill["fill-color"]),"fill-outline-color":new dt(ve.paint_fill["fill-outline-color"]),"fill-translate":new rt(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new rt(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fs(ve.paint_fill["fill-pattern"])})},get layout(){return $m=$m||new wn({"fill-sort-key":new dt(ve.layout_fill["fill-sort-key"])})}};class Kv extends Mi{constructor(e){super(e,Xv)}recalculate(e,i){super.recalculate(e,i);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Kd(e)}queryRadius(){return gu(this.paint.get("fill-translate"))}queryIntersectsFeature(e,i,s,h,f,y,x){return bm(yu(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,x),h)}isTileClipped(){return!0}}const Hv=Cr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Yv=Cr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jv}=Hv;var ta={},Qv=D,Nm=Gs;function Gs(r,e,i,s,h){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=s,this._values=h,r.readFields(e1,this,e)}function e1(r,e,i){r==1?e.id=i.readVarint():r==2?function(s,h){for(var f=s.readVarint()+s.pos;s.pos<f;){var y=h._keys[s.readVarint()],x=h._values[s.readVarint()];h.properties[y]=x}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function t1(r){for(var e,i,s=0,h=0,f=r.length,y=f-1;h<f;y=h++)s+=((i=r[y]).x-(e=r[h]).x)*(e.y+i.y);return s}Gs.types=["Unknown","Point","LineString","Polygon"],Gs.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,s=1,h=0,f=0,y=0,x=[];r.pos<i;){if(h<=0){var S=r.readVarint();s=7&S,h=S>>3}if(h--,s===1||s===2)f+=r.readSVarint(),y+=r.readSVarint(),s===1&&(e&&x.push(e),e=[]),e.push(new Qv(f,y));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&x.push(e),x},Gs.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,s=0,h=0,f=0,y=1/0,x=-1/0,S=1/0,C=-1/0;r.pos<e;){if(s<=0){var A=r.readVarint();i=7&A,s=A>>3}if(s--,i===1||i===2)(h+=r.readSVarint())<y&&(y=h),h>x&&(x=h),(f+=r.readSVarint())<S&&(S=f),f>C&&(C=f);else if(i!==7)throw new Error("unknown command "+i)}return[y,S,x,C]},Gs.prototype.toGeoJSON=function(r,e,i){var s,h,f=this.extent*Math.pow(2,i),y=this.extent*r,x=this.extent*e,S=this.loadGeometry(),C=Gs.types[this.type];function A(B){for(var $=0;$<B.length;$++){var G=B[$];B[$]=[360*(G.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+x)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(s=0;s<S.length;s++)M[s]=S[s][0];A(S=M);break;case 2:for(s=0;s<S.length;s++)A(S[s]);break;case 3:for(S=function(B){var $=B.length;if($<=1)return[B];for(var G,H,Q=[],ce=0;ce<$;ce++){var ne=t1(B[ce]);ne!==0&&(H===void 0&&(H=ne<0),H===ne<0?(G&&Q.push(G),G=[B[ce]]):G.push(B[ce]))}return G&&Q.push(G),Q}(S),s=0;s<S.length;s++)for(h=0;h<S[s].length;h++)A(S[s][h])}S.length===1?S=S[0]:C="Multi"+C;var R={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(R.id=this.id),R};var r1=Nm,Vm=jm;function jm(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(n1,this,e),this.length=this._features.length}function n1(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(s){for(var h=null,f=s.readVarint()+s.pos;s.pos<f;){var y=s.readVarint()>>3;h=y===1?s.readString():y===2?s.readFloat():y===3?s.readDouble():y===4?s.readVarint64():y===5?s.readVarint():y===6?s.readSVarint():y===7?s.readBoolean():null}return h}(i))}jm.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new r1(this._pbf,e,this.extent,this._keys,this._values)};var i1=Vm;function o1(r,e,i){if(r===3){var s=new i1(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}ta.VectorTile=function(r,e){this.layers=r.readFields(o1,{},e)},ta.VectorTileFeature=Nm,ta.VectorTileLayer=Vm;const a1=ta.VectorTileFeature.types,Hd=Math.pow(2,13);function tc(r,e,i,s,h,f,y,x){r.emplaceBack(e,i,2*Math.floor(s*Hd)+y,h*Hd*2,f*Hd*2,Math.round(x))}class Yd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new me,this.centroidVertexArray=new pe,this.indexArray=new st,this.programConfigurations=new Ao(e.layers,e.zoom),this.segments=new lt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){this.features=[],this.hasPattern=Wd("fill-extrusion",this.layers,i);for(const{feature:h,id:f,index:y,sourceLayerIndex:x}of e){const S=this.layers[0]._featureFilter.needGeometry,C=co(h,S);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),C,s))continue;const A={id:f,sourceLayerIndex:x,index:y,geometry:S?C.geometry:Xi(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Xd("fill-extrusion",this.layers,A,this.zoom,i)):this.addFeature(A,A.geometry,y,s,{}),i.featureIndex.insert(h,A.geometry,y,x,this.index,!0)}}addFeatures(e,i,s){for(const h of this.features){const{geometry:f}=h;this.addFeature(h,f,h.index,i,s)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jv),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Yv.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,s,h,f){const y={x:0,y:0,vertexCount:0};for(const x of Zd(i,500)){let S=0;for(const $ of x)S+=$.length;let C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of x){if($.length===0||l1($))continue;let G=0;for(let H=0;H<$.length;H++){const Q=$[H];if(H>=1){const ce=$[H-1];if(!s1(Q,ce)){C.vertexLength+4>lt.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ne=Q.sub(ce)._perp()._unit(),he=ce.dist(Q);G+he>32768&&(G=0),tc(this.layoutVertexArray,Q.x,Q.y,ne.x,ne.y,0,0,G),tc(this.layoutVertexArray,Q.x,Q.y,ne.x,ne.y,0,1,G),y.x+=2*Q.x,y.y+=2*Q.y,y.vertexCount+=2,G+=he,tc(this.layoutVertexArray,ce.x,ce.y,ne.x,ne.y,0,0,G),tc(this.layoutVertexArray,ce.x,ce.y,ne.x,ne.y,0,1,G),y.x+=2*ce.x,y.y+=2*ce.y,y.vertexCount+=2;const fe=C.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),C.vertexLength+=4,C.primitiveLength+=2}}}}if(C.vertexLength+S>lt.MAX_VERTEX_ARRAY_LENGTH&&(C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),a1[e.type]!=="Polygon")continue;const A=[],M=[],R=C.vertexLength;for(const $ of x)if($.length!==0){$!==x[0]&&M.push(A.length/2);for(let G=0;G<$.length;G++){const H=$[G];tc(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),y.x+=H.x,y.y+=H.y,y.vertexCount+=1,A.push(H.x),A.push(H.y)}}const B=Bm(A,M);for(let $=0;$<B.length;$+=3)this.indexArray.emplaceBack(R+B[$],R+B[$+2],R+B[$+1]);C.primitiveLength+=B.length/3,C.vertexLength+=S}for(let x=0;x<y.vertexCount;x++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,h)}}function s1(r,e){return r.x===e.x&&(r.x<0||r.x>gr)||r.y===e.y&&(r.y<0||r.y>gr)}function l1(r){return r.every(e=>e.x<0)||r.every(e=>e.x>gr)||r.every(e=>e.y<0)||r.every(e=>e.y>gr)}let qm;Xe("FillExtrusionBucket",Yd,{omit:["layers","features"]});var c1={get paint(){return qm=qm||new wn({"fill-extrusion-opacity":new rt(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dt(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new rt(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new rt(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fs(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dt(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dt(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new rt(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class u1 extends Mi{constructor(e){super(e,c1)}createBucket(e){return new Yd(e)}queryRadius(){return gu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,i,s,h,f,y,x,S){const C=yu(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,x),A=this.paint.get("fill-extrusion-height").evaluate(i,s),M=this.paint.get("fill-extrusion-base").evaluate(i,s),R=function($,G,H,Q){const ce=[];for(const ne of $){const he=[ne.x,ne.y,0,1];_u(he,he,G),ce.push(new K(he[0]/he[3],he[1]/he[3]))}return ce}(C,S),B=function($,G,H,Q){const ce=[],ne=[],he=Q[8]*G,fe=Q[9]*G,we=Q[10]*G,Ge=Q[11]*G,et=Q[8]*H,qe=Q[9]*H,Ne=Q[10]*H,Le=Q[11]*H;for(const Ke of $){const Oe=[],Pe=[];for(const ct of Ke){const tt=ct.x,bt=ct.y,ir=Q[0]*tt+Q[4]*bt+Q[12],cr=Q[1]*tt+Q[5]*bt+Q[13],Ur=Q[2]*tt+Q[6]*bt+Q[14],ni=Q[3]*tt+Q[7]*bt+Q[15],Tn=Ur+we,Dr=ni+Ge,jr=ir+et,an=cr+qe,Nn=Ur+Ne,Cn=ni+Le,Rr=new K((ir+he)/Dr,(cr+fe)/Dr);Rr.z=Tn/Dr,Oe.push(Rr);const Nr=new K(jr/Cn,an/Cn);Nr.z=Nn/Cn,Pe.push(Nr)}ce.push(Oe),ne.push(Pe)}return[ce,ne]}(h,M,A,S);return function($,G,H){let Q=1/0;bm(H,G)&&(Q=Gm(H,G[0]));for(let ce=0;ce<G.length;ce++){const ne=G[ce],he=$[ce];for(let fe=0;fe<ne.length-1;fe++){const we=ne[fe],Ge=[we,ne[fe+1],he[fe+1],he[fe],we];vm(H,Ge)&&(Q=Math.min(Q,Gm(H,Ge)))}}return Q!==1/0&&Q}(B[0],B[1],R)}}function rc(r,e){return r.x*e.x+r.y*e.y}function Gm(r,e){if(r.length===1){let i=0;const s=e[i++];let h;for(;!h||s.equals(h);)if(h=e[i++],!h)return 1/0;for(;i<e.length;i++){const f=e[i],y=r[0],x=h.sub(s),S=f.sub(s),C=y.sub(s),A=rc(x,x),M=rc(x,S),R=rc(S,S),B=rc(C,x),$=rc(C,S),G=A*R-M*M,H=(R*B-M*$)/G,Q=(A*$-M*B)/G,ce=s.z*(1-H-Q)+h.z*H+f.z*Q;if(isFinite(ce))return ce}return 1/0}{let i=1/0;for(const s of e)i=Math.min(i,s.z);return i}}const h1=Cr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:d1}=h1,p1=Cr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:f1}=p1,m1=ta.VectorTileFeature.types,g1=Math.cos(Math.PI/180*37.5),Zm=Math.pow(2,14)/.5;class Jd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new ye,this.layoutVertexArray2=new be,this.indexArray=new st,this.programConfigurations=new Ao(e.layers,e.zoom),this.segments=new lt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s){this.hasPattern=Wd("line",this.layers,i);const h=this.layers[0].layout.get("line-sort-key"),f=!h.isConstant(),y=[];for(const{feature:x,id:S,index:C,sourceLayerIndex:A}of e){const M=this.layers[0]._featureFilter.needGeometry,R=co(x,M);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),R,s))continue;const B=f?h.evaluate(R,{},s):void 0,$={id:S,properties:x.properties,type:x.type,sourceLayerIndex:A,index:C,geometry:M?R.geometry:Xi(x),patterns:{},sortKey:B};y.push($)}f&&y.sort((x,S)=>x.sortKey-S.sortKey);for(const x of y){const{geometry:S,index:C,sourceLayerIndex:A}=x;if(this.hasPattern){const M=Xd("line",this.layers,x,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(x,S,C,s,{});i.featureIndex.insert(e[C].feature,S,C,A,this.index)}}update(e,i,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s)}addFeatures(e,i,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,i,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,f1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,d1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,s,h,f){const y=this.layers[0].layout,x=y.get("line-join").evaluate(e,{}),S=y.get("line-cap"),C=y.get("line-miter-limit"),A=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of i)this.addLine(M,e,x,S,C,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,h)}addLine(e,i,s,h,f,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=m1[i.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let C=0;for(;C<S-1&&e[C].equals(e[C+1]);)C++;if(S<(x?3:2))return;s==="bevel"&&(f=1.05);const A=this.overscaling<=16?15*gr/(512*this.overscaling):0,M=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let R,B,$,G,H;this.e1=this.e2=-1,x&&(R=e[S-2],H=e[C].sub(R)._unit()._perp());for(let Q=C;Q<S;Q++){if($=Q===S-1?x?e[C+1]:void 0:e[Q+1],$&&e[Q].equals($))continue;H&&(G=H),R&&(B=R),R=e[Q],H=$?$.sub(R)._unit()._perp():G,G=G||H;let ce=G.add(H);ce.x===0&&ce.y===0||ce._unit();const ne=G.x*H.x+G.y*H.y,he=ce.x*H.x+ce.y*H.y,fe=he!==0?1/he:1/0,we=2*Math.sqrt(2-2*he),Ge=he<g1&&B&&$,et=G.x*H.y-G.y*H.x>0;if(Ge&&Q>C){const Le=R.dist(B);if(Le>2*A){const Ke=R.sub(R.sub(B)._mult(A/Le)._round());this.updateDistance(B,Ke),this.addCurrentVertex(Ke,G,0,0,M),B=Ke}}const qe=B&&$;let Ne=qe?s:x?"butt":h;if(qe&&Ne==="round"&&(fe<y?Ne="miter":fe<=2&&(Ne="fakeround")),Ne==="miter"&&fe>f&&(Ne="bevel"),Ne==="bevel"&&(fe>2&&(Ne="flipbevel"),fe<f&&(Ne="miter")),B&&this.updateDistance(B,R),Ne==="miter")ce._mult(fe),this.addCurrentVertex(R,ce,0,0,M);else if(Ne==="flipbevel"){if(fe>100)ce=H.mult(-1);else{const Le=fe*G.add(H).mag()/G.sub(H).mag();ce._perp()._mult(Le*(et?-1:1))}this.addCurrentVertex(R,ce,0,0,M),this.addCurrentVertex(R,ce.mult(-1),0,0,M)}else if(Ne==="bevel"||Ne==="fakeround"){const Le=-Math.sqrt(fe*fe-1),Ke=et?Le:0,Oe=et?0:Le;if(B&&this.addCurrentVertex(R,G,Ke,Oe,M),Ne==="fakeround"){const Pe=Math.round(180*we/Math.PI/20);for(let ct=1;ct<Pe;ct++){let tt=ct/Pe;if(tt!==.5){const ir=tt-.5;tt+=tt*ir*(tt-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*ir*ir+(.848013+ne*(.215638*ne-1.06021)))}const bt=H.sub(G)._mult(tt)._add(G)._unit()._mult(et?-1:1);this.addHalfVertex(R,bt.x,bt.y,!1,et,0,M)}}$&&this.addCurrentVertex(R,H,-Ke,-Oe,M)}else if(Ne==="butt")this.addCurrentVertex(R,ce,0,0,M);else if(Ne==="square"){const Le=B?1:-1;this.addCurrentVertex(R,ce,Le,Le,M)}else Ne==="round"&&(B&&(this.addCurrentVertex(R,G,0,0,M),this.addCurrentVertex(R,G,1,1,M,!0)),$&&(this.addCurrentVertex(R,H,-1,-1,M,!0),this.addCurrentVertex(R,H,0,0,M)));if(Ge&&Q<S-1){const Le=R.dist($);if(Le>2*A){const Ke=R.add($.sub(R)._mult(A/Le)._round());this.updateDistance(R,Ke),this.addCurrentVertex(Ke,H,0,0,M),R=Ke}}}}addCurrentVertex(e,i,s,h,f,y=!1){const x=i.y*h-i.x,S=-i.y-i.x*h;this.addHalfVertex(e,i.x+i.y*s,i.y-i.x*s,y,!1,s,f),this.addHalfVertex(e,x,S,y,!0,-h,f),this.distance>Zm/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,s,h,f,y))}addHalfVertex({x:e,y:i},s,h,f,y,x,S){const C=.5*(this.lineClips?this.scaledDistance*(Zm-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(x===0?0:x<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),S.primitiveLength++),y?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}let Wm,Xm;Xe("LineBucket",Jd,{omit:["layers","patternFeatures"]});var Km={get paint(){return Xm=Xm||new wn({"line-opacity":new dt(ve.paint_line["line-opacity"]),"line-color":new dt(ve.paint_line["line-color"]),"line-translate":new rt(ve.paint_line["line-translate"]),"line-translate-anchor":new rt(ve.paint_line["line-translate-anchor"]),"line-width":new dt(ve.paint_line["line-width"]),"line-gap-width":new dt(ve.paint_line["line-gap-width"]),"line-offset":new dt(ve.paint_line["line-offset"]),"line-blur":new dt(ve.paint_line["line-blur"]),"line-dasharray":new Nl(ve.paint_line["line-dasharray"]),"line-pattern":new Fs(ve.paint_line["line-pattern"]),"line-gradient":new Vl(ve.paint_line["line-gradient"])})},get layout(){return Wm=Wm||new wn({"line-cap":new rt(ve.layout_line["line-cap"]),"line-join":new dt(ve.layout_line["line-join"]),"line-miter-limit":new rt(ve.layout_line["line-miter-limit"]),"line-round-limit":new rt(ve.layout_line["line-round-limit"]),"line-sort-key":new dt(ve.layout_line["line-sort-key"])})}};class y1 extends dt{possiblyEvaluate(e,i){return i=new sr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,s,h){return i=De({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,s,h)}}let Su;class _1 extends Mi{constructor(e){super(e,Km),this.gradientVersion=0,Su||(Su=new y1(Km.paint.properties["line-width"].specification),Su.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){e==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ta,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=Su.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Jd(e)}queryRadius(e){const i=e,s=Hm(Xl("line-width",this,i),Xl("line-gap-width",this,i)),h=Xl("line-offset",this,i);return s/2+Math.abs(h)+gu(this.paint.get("line-translate"))}queryIntersectsFeature(e,i,s,h,f,y,x){const S=yu(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,x),C=x/2*Hm(this.paint.get("line-width").evaluate(i,s),this.paint.get("line-gap-width").evaluate(i,s)),A=this.paint.get("line-offset").evaluate(i,s);return A&&(h=function(M,R){const B=[];for(let $=0;$<M.length;$++){const G=M[$],H=[];for(let Q=0;Q<G.length;Q++){const ce=G[Q-1],ne=G[Q],he=G[Q+1],fe=Q===0?new K(0,0):ne.sub(ce)._unit()._perp(),we=Q===G.length-1?new K(0,0):he.sub(ne)._unit()._perp(),Ge=fe._add(we)._unit(),et=Ge.x*we.x+Ge.y*we.y;et!==0&&Ge._mult(1/et),H.push(Ge._mult(R)._add(ne))}B.push(H)}return B}(h,A*x)),function(M,R,B){for(let $=0;$<R.length;$++){const G=R[$];if(M.length>=3){for(let H=0;H<G.length;H++)if(Vs(M,G[H]))return!0}if(Ev(M,G,B))return!0}return!1}(S,h,C)}isTileClipped(){return!0}}function Hm(r,e){return e>0?e+2*r:r}const x1=Cr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),v1=Cr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Cr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const b1=Cr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Cr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ym=Cr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),w1=Cr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function S1(r,e,i){return r.sections.forEach(s=>{s.text=function(h,f,y){const x=f.layout.get("text-transform").evaluate(y,{});return x==="uppercase"?h=h.toLocaleUpperCase():x==="lowercase"&&(h=h.toLocaleLowerCase()),ti.applyArabicShaping&&(h=ti.applyArabicShaping(h)),h}(s.text,e,i)}),r}Cr([{name:"triangle",components:3,type:"Uint16"}]),Cr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Cr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Cr([{type:"Float32",name:"offsetX"}]),Cr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Cr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const nc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var $r=24,Jm=Ht,Qm=function(r,e,i,s,h){var f,y,x=8*h-s-1,S=(1<<x)-1,C=S>>1,A=-7,M=i?h-1:0,R=i?-1:1,B=r[e+M];for(M+=R,f=B&(1<<-A)-1,B>>=-A,A+=x;A>0;f=256*f+r[e+M],M+=R,A-=8);for(y=f&(1<<-A)-1,f>>=-A,A+=s;A>0;y=256*y+r[e+M],M+=R,A-=8);if(f===0)f=1-C;else{if(f===S)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,s),f-=C}return(B?-1:1)*y*Math.pow(2,f-s)},eg=function(r,e,i,s,h,f){var y,x,S,C=8*f-h-1,A=(1<<C)-1,M=A>>1,R=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=s?0:f-1,$=s?1:-1,G=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,y=A):(y=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-y))<1&&(y--,S*=2),(e+=y+M>=1?R/S:R*Math.pow(2,1-M))*S>=2&&(y++,S/=2),y+M>=A?(x=0,y=A):y+M>=1?(x=(e*S-1)*Math.pow(2,h),y+=M):(x=e*Math.pow(2,M-1)*Math.pow(2,h),y=0));h>=8;r[i+B]=255&x,B+=$,x/=256,h-=8);for(y=y<<h|x,C+=h;C>0;r[i+B]=255&y,B+=$,y/=256,C-=8);r[i+B-$]|=128*G};function Ht(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Ht.Varint=0,Ht.Fixed64=1,Ht.Bytes=2,Ht.Fixed32=5;var Qd=4294967296,tg=1/Qd,rg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Mo(r){return r.type===Ht.Bytes?r.readVarint()+r.pos:r.pos+1}function Zs(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function ng(r,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var h=i.pos-1;h>=r;h--)i.buf[h+s]=i.buf[h]}function E1(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function T1(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function C1(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function k1(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function I1(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function A1(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function P1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function M1(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function z1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function Eu(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Ws(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function ig(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}Ht.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),h=s>>3,f=this.pos;this.type=7&s,r(h,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=Eu(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=ig(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Eu(this.buf,this.pos)+Eu(this.buf,this.pos+4)*Qd;return this.pos+=8,r},readSFixed64:function(){var r=Eu(this.buf,this.pos)+ig(this.buf,this.pos+4)*Qd;return this.pos+=8,r},readFloat:function(){var r=Qm(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Qm(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(h,f,y){var x,S,C=y.buf;if(x=(112&(S=C[y.pos++]))>>4,S<128||(x|=(127&(S=C[y.pos++]))<<3,S<128)||(x|=(127&(S=C[y.pos++]))<<10,S<128)||(x|=(127&(S=C[y.pos++]))<<17,S<128)||(x|=(127&(S=C[y.pos++]))<<24,S<128)||(x|=(1&(S=C[y.pos++]))<<31,S<128))return Zs(h,x,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&rg?function(i,s,h){return rg.decode(i.subarray(s,h))}(this.buf,e,r):function(i,s,h){for(var f="",y=s;y<h;){var x,S,C,A=i[y],M=null,R=A>239?4:A>223?3:A>191?2:1;if(y+R>h)break;R===1?A<128&&(M=A):R===2?(192&(x=i[y+1]))==128&&(M=(31&A)<<6|63&x)<=127&&(M=null):R===3?(S=i[y+2],(192&(x=i[y+1]))==128&&(192&S)==128&&((M=(15&A)<<12|(63&x)<<6|63&S)<=2047||M>=55296&&M<=57343)&&(M=null)):R===4&&(S=i[y+2],C=i[y+3],(192&(x=i[y+1]))==128&&(192&S)==128&&(192&C)==128&&((M=(15&A)<<18|(63&x)<<12|(63&S)<<6|63&C)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,R=1):M>65535&&(M-=65536,f+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),f+=String.fromCharCode(M),y+=R}return f}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Ht.Bytes)return r.push(this.readVarint(e));var i=Mo(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Ht.Bytes)return r.push(this.readSVarint());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Ht.Bytes)return r.push(this.readBoolean());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Ht.Bytes)return r.push(this.readFloat());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Ht.Bytes)return r.push(this.readDouble());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Ht.Bytes)return r.push(this.readFixed32());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Ht.Bytes)return r.push(this.readSFixed32());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Ht.Bytes)return r.push(this.readFixed64());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Ht.Bytes)return r.push(this.readSFixed64());var e=Mo(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Ht.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ht.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ht.Fixed32)this.pos+=4;else{if(e!==Ht.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Ws(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Ws(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Ws(this.buf,-1&r,this.pos),Ws(this.buf,Math.floor(r*tg),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Ws(this.buf,-1&r,this.pos),Ws(this.buf,Math.floor(r*tg),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var s,h;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(f,y,x){x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,f>>>=7,x.buf[x.pos++]=127&f|128,x.buf[x.pos]=127&(f>>>=7)}(s,0,i),function(f,y){var x=(7&f)<<4;y.buf[y.pos++]|=x|((f>>>=3)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f)))))}(h,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(s,h,f){for(var y,x,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!x){y>56319||S+1===h.length?(s[f++]=239,s[f++]=191,s[f++]=189):x=y;continue}if(y<56320){s[f++]=239,s[f++]=191,s[f++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(s[f++]=239,s[f++]=191,s[f++]=189,x=null);y<128?s[f++]=y:(y<2048?s[f++]=y>>6|192:(y<65536?s[f++]=y>>12|224:(s[f++]=y>>18|240,s[f++]=y>>12&63|128),s[f++]=y>>6&63|128),s[f++]=63&y|128)}return f}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&ng(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),eg(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),eg(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var s=this.pos-i;s>=128&&ng(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(r,e,i){this.writeTag(r,Ht.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,E1,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,T1,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,I1,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,C1,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,k1,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,A1,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,P1,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,M1,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,z1,e)},writeBytesField:function(r,e){this.writeTag(r,Ht.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Ht.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Ht.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Ht.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Ht.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Ht.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Ht.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Ht.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Ht.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Ht.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};var ep=O(Jm);const tp=3;function D1(r,e,i){r===1&&i.readMessage(R1,e)}function R1(r,e,i){if(r===3){const{id:s,bitmap:h,width:f,height:y,left:x,top:S,advance:C}=i.readMessage(L1,{});e.push({id:s,bitmap:new Hl({width:f+2*tp,height:y+2*tp},h),metrics:{width:f,height:y,left:x,top:S,advance:C}})}}function L1(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}const og=tp;function ag(r){let e=0,i=0;for(const y of r)e+=y.w*y.h,i=Math.max(i,y.w);r.sort((y,x)=>x.h-y.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let h=0,f=0;for(const y of r)for(let x=s.length-1;x>=0;x--){const S=s[x];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,f=Math.max(f,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const C=s.pop();x<s.length&&(s[x]=C)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(s.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:f,fill:e/(h*f)||0}}const Un=1;class rp{constructor(e,{pixelRatio:i,version:s,stretchX:h,stretchY:f,content:y}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=f,this.content=y,this.version=s}get tl(){return[this.paddedRect.x+Un,this.paddedRect.y+Un]}get br(){return[this.paddedRect.x+this.paddedRect.w-Un,this.paddedRect.y+this.paddedRect.h-Un]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Un)/this.pixelRatio,(this.paddedRect.h-2*Un)/this.pixelRatio]}}class sg{constructor(e,i){const s={},h={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(i,h,f);const{w:y,h:x}=ag(f),S=new hi({width:y||1,height:x||1});for(const C in e){const A=e[C],M=s[C].paddedRect;hi.copy(A.data,S,{x:0,y:0},{x:M.x+Un,y:M.y+Un},A.data)}for(const C in i){const A=i[C],M=h[C].paddedRect,R=M.x+Un,B=M.y+Un,$=A.data.width,G=A.data.height;hi.copy(A.data,S,{x:0,y:0},{x:R,y:B},A.data),hi.copy(A.data,S,{x:0,y:G-1},{x:R,y:B-1},{width:$,height:1}),hi.copy(A.data,S,{x:0,y:0},{x:R,y:B+G},{width:$,height:1}),hi.copy(A.data,S,{x:$-1,y:0},{x:R-1,y:B},{width:1,height:G}),hi.copy(A.data,S,{x:0,y:0},{x:R+$,y:B},{width:1,height:G})}this.image=S,this.iconPositions=s,this.patternPositions=h}addImages(e,i,s){for(const h in e){const f=e[h],y={x:0,y:0,w:f.data.width+2*Un,h:f.data.height+2*Un};s.push(y),i[h]=new rp(y,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),i)}patchUpdatedImage(e,i,s){if(!e||!i||e.version===i.version)return;e.version=i.version;const[h,f]=e.tl;s.update(i.data,void 0,{x:h,y:f})}}var ra;Xe("ImagePosition",rp),Xe("ImageAtlas",sg),l.WritingMode=void 0,(ra=l.WritingMode||(l.WritingMode={}))[ra.none=0]="none",ra[ra.horizontal=1]="horizontal",ra[ra.vertical=2]="vertical",ra[ra.horizontalOnly=3]="horizontalOnly";const ic=-17;class oc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const s=new oc;return s.scale=e||1,s.fontStack=i,s}static forImage(e){const i=new oc;return i.imageName=e,i}}class Xs{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const s=new Xs;for(let h=0;h<e.sections.length;h++){const f=e.sections[h];f.image?s.addImageSection(f):s.addTextSection(f,i)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let i="";for(let s=0;s<e.length;s++){const h=e.charCodeAt(s+1)||null,f=e.charCodeAt(s-1)||null;i+=h&&Ua(h)&&!nc[e[s+1]]||f&&Ua(f)&&!nc[e[s-1]]||!nc[e[s]]?e[s]:nc[e[s]]}return i}(this.text)}trim(){let e=0;for(let s=0;s<this.text.length&&Cu[this.text.charCodeAt(s)];s++)e++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&Cu[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const s=new Xs;return s.text=this.text.substring(e,i),s.sectionIndex=this.sectionIndex.slice(e,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(oc.forText(e.scale,e.fontStack||i));const s=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(s)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void yt("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(oc.forImage(i)),this.sectionIndex.push(this.sections.length-1)):yt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Tu(r,e,i,s,h,f,y,x,S,C,A,M,R,B,$,G){const H=Xs.fromFeature(r,h);let Q;M===l.WritingMode.vertical&&H.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:ne}=ti;if(ce&&H.sections.length===1){Q=[];const we=ce(H.toString(),np(H,C,f,e,s,B,$));for(const Ge of we){const et=new Xs;et.text=Ge,et.sections=H.sections;for(let qe=0;qe<Ge.length;qe++)et.sectionIndex.push(0);Q.push(et)}}else if(ne){Q=[];const we=ne(H.text,H.sectionIndex,np(H,C,f,e,s,B,$));for(const Ge of we){const et=new Xs;et.text=Ge[0],et.sectionIndex=Ge[1],et.sections=H.sections,Q.push(et)}}else Q=function(we,Ge){const et=[],qe=we.text;let Ne=0;for(const Le of Ge)et.push(we.substring(Ne,Le)),Ne=Le;return Ne<qe.length&&et.push(we.substring(Ne,qe.length)),et}(H,np(H,C,f,e,s,B,$));const he=[],fe={positionedLines:he,text:H.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(we,Ge,et,qe,Ne,Le,Ke,Oe,Pe,ct,tt,bt){let ir=0,cr=ic,Ur=0,ni=0;const Tn=Oe==="right"?1:Oe==="left"?0:.5;let Dr=0;for(const Rr of Ne){Rr.trim();const Nr=Rr.getMaxScale(),un=(Nr-1)*$r,kn={positionedGlyphs:[],lineOffset:0};we.positionedLines[Dr]=kn;const Vn=kn.positionedGlyphs;let jn=0;if(!Rr.length()){cr+=Le,++Dr;continue}for(let sn=0;sn<Rr.length();sn++){const At=Rr.getSection(sn),ii=Rr.getSectionIndex(sn),ln=Rr.getCharCode(sn);let In=0,Ri=null,Ki=null,Hi=null,zo=$r;const Li=!(Pe===l.WritingMode.horizontal||!tt&&!$a(ln)||tt&&(Cu[ln]||(jr=ln,je.Arabic(jr)||je["Arabic Supplement"](jr)||je["Arabic Extended-A"](jr)||je["Arabic Presentation Forms-A"](jr)||je["Arabic Presentation Forms-B"](jr))));if(At.imageName){const pi=qe[At.imageName];if(!pi)continue;Hi=At.imageName,we.iconsInText=we.iconsInText||!0,Ki=pi.paddedRect;const qn=pi.displaySize;At.scale=At.scale*$r/bt,Ri={width:qn[0],height:qn[1],left:Un,top:-og,advance:Li?qn[1]:qn[0]},In=un+($r-qn[1]*At.scale),zo=Ri.advance;const Do=Li?qn[0]*At.scale-$r*Nr:qn[1]*At.scale-$r*Nr;Do>0&&Do>jn&&(jn=Do)}else{const pi=et[At.fontStack],qn=pi&&pi[ln];if(qn&&qn.rect)Ki=qn.rect,Ri=qn.metrics;else{const Do=Ge[At.fontStack],uc=Do&&Do[ln];if(!uc)continue;Ri=uc.metrics}In=(Nr-At.scale)*$r}Li?(we.verticalizable=!0,Vn.push({glyph:ln,imageName:Hi,x:ir,y:cr+In,vertical:Li,scale:At.scale,fontStack:At.fontStack,sectionIndex:ii,metrics:Ri,rect:Ki}),ir+=zo*At.scale+ct):(Vn.push({glyph:ln,imageName:Hi,x:ir,y:cr+In,vertical:Li,scale:At.scale,fontStack:At.fontStack,sectionIndex:ii,metrics:Ri,rect:Ki}),ir+=Ri.advance*At.scale+ct)}Vn.length!==0&&(Ur=Math.max(ir-ct,Ur),O1(Vn,0,Vn.length-1,Tn,jn)),ir=0;const _r=Le*Nr+jn;kn.lineOffset=Math.max(jn,un),cr+=_r,ni=Math.max(_r,ni),++Dr}var jr;const an=cr-ic,{horizontalAlign:Nn,verticalAlign:Cn}=ip(Ke);(function(Rr,Nr,un,kn,Vn,jn,_r,sn,At){const ii=(Nr-un)*Vn;let ln=0;ln=jn!==_r?-sn*kn-ic:(-kn*At+.5)*_r;for(const In of Rr)for(const Ri of In.positionedGlyphs)Ri.x+=ii,Ri.y+=ln})(we.positionedLines,Tn,Nn,Cn,Ur,ni,Le,an,Ne.length),we.top+=-Cn*an,we.bottom=we.top+an,we.left+=-Nn*Ur,we.right=we.left+Ur}(fe,e,i,s,Q,y,x,S,M,C,R,G),!function(we){for(const Ge of we)if(Ge.positionedGlyphs.length!==0)return!1;return!0}(he)&&fe}const Cu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},F1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function lg(r,e,i,s,h,f){if(e.imageName){const y=s[e.imageName];return y?y.displaySize[0]*e.scale*$r/f+h:0}{const y=i[e.fontStack],x=y&&y[r];return x?x.metrics.advance*e.scale+h:0}}function cg(r,e,i,s){const h=Math.pow(r-e,2);return s?r<e?h/2:2*h:h+Math.abs(i)*i}function B1(r,e,i){let s=0;return r===10&&(s-=1e4),i&&(s+=150),r!==40&&r!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function ug(r,e,i,s,h,f){let y=null,x=cg(e,i,h,f);for(const S of s){const C=cg(e-S.x,i,h,f)+S.badness;C<=x&&(y=S,x=C)}return{index:r,x:e,priorBreak:y,badness:x}}function hg(r){return r?hg(r.priorBreak).concat(r.index):[]}function np(r,e,i,s,h,f,y){if(f!=="point")return[];if(!r)return[];const x=[],S=function(R,B,$,G,H,Q){let ce=0;for(let ne=0;ne<R.length();ne++){const he=R.getSection(ne);ce+=lg(R.getCharCode(ne),he,G,H,B,Q)}return ce/Math.max(1,Math.ceil(ce/$))}(r,e,i,s,h,y),C=r.text.indexOf("\u200B")>=0;let A=0;for(let R=0;R<r.length();R++){const B=r.getSection(R),$=r.getCharCode(R);if(Cu[$]||(A+=lg($,B,s,h,e,y)),R<r.length()-1){const G=!((M=$)<11904||!(je["Bopomofo Extended"](M)||je.Bopomofo(M)||je["CJK Compatibility Forms"](M)||je["CJK Compatibility Ideographs"](M)||je["CJK Compatibility"](M)||je["CJK Radicals Supplement"](M)||je["CJK Strokes"](M)||je["CJK Symbols and Punctuation"](M)||je["CJK Unified Ideographs Extension A"](M)||je["CJK Unified Ideographs"](M)||je["Enclosed CJK Letters and Months"](M)||je["Halfwidth and Fullwidth Forms"](M)||je.Hiragana(M)||je["Ideographic Description Characters"](M)||je["Kangxi Radicals"](M)||je["Katakana Phonetic Extensions"](M)||je.Katakana(M)||je["Vertical Forms"](M)||je["Yi Radicals"](M)||je["Yi Syllables"](M)));(F1[$]||G||B.imageName)&&x.push(ug(R+1,A,S,x,B1($,r.getCharCode(R+1),G&&C),!1))}}var M;return hg(ug(r.length(),A,S,x,0,!0))}function ip(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function O1(r,e,i,s,h){if(!s&&!h)return;const f=r[i],y=(r[i].x+f.metrics.advance*f.scale)*s;for(let x=e;x<=i;x++)r[x].x-=y,r[x].y+=h}function $1(r,e,i){const{horizontalAlign:s,verticalAlign:h}=ip(i),f=e[0]-r.displaySize[0]*s,y=e[1]-r.displaySize[1]*h;return{image:r,top:y,bottom:y+r.displaySize[1],left:f,right:f+r.displaySize[0]}}function dg(r,e,i,s,h,f){const y=r.image;let x;if(y.content){const H=y.content,Q=y.pixelRatio||1;x=[H[0]/Q,H[1]/Q,y.displaySize[0]-H[2]/Q,y.displaySize[1]-H[3]/Q]}const S=e.left*f,C=e.right*f;let A,M,R,B;i==="width"||i==="both"?(B=h[0]+S-s[3],M=h[0]+C+s[1]):(B=h[0]+(S+C-y.displaySize[0])/2,M=B+y.displaySize[0]);const $=e.top*f,G=e.bottom*f;return i==="height"||i==="both"?(A=h[1]+$-s[0],R=h[1]+G+s[2]):(A=h[1]+($+G-y.displaySize[1])/2,R=A+y.displaySize[1]),{image:y,top:A,right:M,bottom:R,left:B,collisionPadding:x}}const ac=255,uo=128,na=ac*uo;function pg(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new sr(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:h}=i;let f=0;for(;f<s.length&&s[f]<=r;)f++;f=Math.max(0,f-1);let y=f;for(;y<s.length&&s[y]<r+1;)y++;y=Math.min(s.length-1,y);const x=s[f],S=s[y];return i.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:x,maxZoom:S,minSize:i.evaluate(new sr(x)),maxSize:i.evaluate(new sr(S)),interpolationType:h}}}function op(r,e,i){let s="never";const h=r.get(e);return h?s=h:r.get(i)&&(s="always"),s}const U1=ta.VectorTileFeature.types,N1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ku(r,e,i,s,h,f,y,x,S,C,A,M,R){const B=x?Math.min(na,Math.round(x[0])):0,$=x?Math.min(na,Math.round(x[1])):0;r.emplaceBack(e,i,Math.round(32*s),Math.round(32*h),f,y,(B<<1)+(S?1:0),$,16*C,16*A,256*M,256*R)}function ap(r,e,i){r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i)}function V1(r){for(const e of r.sections)if(uu(e.text))return!0;return!1}class sp{constructor(e){this.layoutVertexArray=new ke,this.indexArray=new st,this.programConfigurations=e,this.segments=new lt,this.dynamicLayoutVertexArray=new ze,this.opacityVertexArray=new Qe,this.hasVisibleVertices=!1,this.placedSymbolArray=new k}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,x1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,v1.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,N1,!0),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Xe("SymbolBuffers",sp);class lp{constructor(e,i,s){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new s,this.segments=new lt,this.collisionVertexArray=new Ue}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,b1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Xe("CollisionBuffers",lp);class Ks{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$d([]),this.placementViewportMatrix=$d([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pg(this.zoom,i["text-size"]),this.iconSizeData=pg(this.zoom,i["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=op(s,"text-overlap","text-allow-overlap")!=="never"||op(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(y=>l.WritingMode[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new sp(new Ao(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new sp(new Ao(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new F,this.lineVertexArray=new q,this.symbolInstances=new P,this.textAnchorOffsets=new W}calculateGlyphDependencies(e,i,s,h,f){for(let y=0;y<e.length;y++)if(i[e.charCodeAt(y)]=!0,(s||h)&&f){const x=nc[e.charAt(y)];x&&(i[x.charCodeAt(0)]=!0)}}populate(e,i,s){const h=this.layers[0],f=h.layout,y=f.get("text-font"),x=f.get("text-field"),S=f.get("icon-image"),C=(x.value.kind!=="constant"||x.value.value instanceof wr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),A=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,M=f.get("symbol-sort-key");if(this.features=[],!C&&!A)return;const R=i.iconDependencies,B=i.glyphDependencies,$=i.availableImages,G=new sr(this.zoom);for(const{feature:H,id:Q,index:ce,sourceLayerIndex:ne}of e){const he=h._featureFilter.needGeometry,fe=co(H,he);if(!h._featureFilter.filter(G,fe,s))continue;let we,Ge;if(he||(fe.geometry=Xi(H)),C){const qe=h.getValueAndResolveTokens("text-field",fe,s,$),Ne=wr.factory(qe);V1(Ne)&&(this.hasRTLText=!0),(!this.hasRTLText||Ul()==="unavailable"||this.hasRTLText&&ti.isParsed())&&(we=S1(Ne,h,fe))}if(A){const qe=h.getValueAndResolveTokens("icon-image",fe,s,$);Ge=qe instanceof Qn?qe:Qn.fromString(qe)}if(!we&&!Ge)continue;const et=this.sortFeaturesByKey?M.evaluate(fe,{},s):void 0;if(this.features.push({id:Q,text:we,icon:Ge,index:ce,sourceLayerIndex:ne,geometry:fe.geometry,properties:H.properties,type:U1[H.type],sortKey:et}),Ge&&(R[Ge.name]=!0),we){const qe=y.evaluate(fe,{},s).join(","),Ne=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const Le of we.sections)if(Le.image)R[Le.image.name]=!0;else{const Ke=Ds(we.toString()),Oe=Le.fontStack||qe,Pe=B[Oe]=B[Oe]||{};this.calculateGlyphDependencies(Le.text,Pe,Ne,this.allowVerticalPlacement,Ke)}}}f.get("symbol-placement")==="line"&&(this.features=function(H){const Q={},ce={},ne=[];let he=0;function fe(qe){ne.push(H[qe]),he++}function we(qe,Ne,Le){const Ke=ce[qe];return delete ce[qe],ce[Ne]=Ke,ne[Ke].geometry[0].pop(),ne[Ke].geometry[0]=ne[Ke].geometry[0].concat(Le[0]),Ke}function Ge(qe,Ne,Le){const Ke=Q[Ne];return delete Q[Ne],Q[qe]=Ke,ne[Ke].geometry[0].shift(),ne[Ke].geometry[0]=Le[0].concat(ne[Ke].geometry[0]),Ke}function et(qe,Ne,Le){const Ke=Le?Ne[0][Ne[0].length-1]:Ne[0][0];return`${qe}:${Ke.x}:${Ke.y}`}for(let qe=0;qe<H.length;qe++){const Ne=H[qe],Le=Ne.geometry,Ke=Ne.text?Ne.text.toString():null;if(!Ke){fe(qe);continue}const Oe=et(Ke,Le),Pe=et(Ke,Le,!0);if(Oe in ce&&Pe in Q&&ce[Oe]!==Q[Pe]){const ct=Ge(Oe,Pe,Le),tt=we(Oe,Pe,ne[ct].geometry);delete Q[Oe],delete ce[Pe],ce[et(Ke,ne[tt].geometry,!0)]=tt,ne[ct].geometry=null}else Oe in ce?we(Oe,Pe,Le):Pe in Q?Ge(Oe,Pe,Le):(fe(qe),Q[Oe]=he-1,ce[Pe]=he-1)}return ne.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Q)=>H.sortKey-Q.sortKey)}update(e,i,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,s),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,s))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const s=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(i[e.segment+1]),f=e.dist(i[e.segment]);const y={};for(let x=e.segment+1;x<i.length;x++)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:h},x<i.length-1&&(h+=i[x+1].dist(i[x]));for(let x=e.segment||0;x>=0;x--)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:f},x>0&&(f+=i[x-1].dist(i[x]));for(let x=0;x<i.length;x++){const S=y[x];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,i,s,h,f,y,x,S,C,A,M,R){const B=e.indexArray,$=e.layoutVertexArray,G=e.segments.prepareSegment(4*i.length,$,B,this.canOverlap?y.sortKey:void 0),H=this.glyphOffsetArray.length,Q=G.vertexLength,ce=this.allowVerticalPlacement&&x===l.WritingMode.vertical?Math.PI/2:0,ne=y.text&&y.text.sections;for(let he=0;he<i.length;he++){const{tl:fe,tr:we,bl:Ge,br:et,tex:qe,pixelOffsetTL:Ne,pixelOffsetBR:Le,minFontScaleX:Ke,minFontScaleY:Oe,glyphOffset:Pe,isSDF:ct,sectionIndex:tt}=i[he],bt=G.vertexLength,ir=Pe[1];ku($,S.x,S.y,fe.x,ir+fe.y,qe.x,qe.y,s,ct,Ne.x,Ne.y,Ke,Oe),ku($,S.x,S.y,we.x,ir+we.y,qe.x+qe.w,qe.y,s,ct,Le.x,Ne.y,Ke,Oe),ku($,S.x,S.y,Ge.x,ir+Ge.y,qe.x,qe.y+qe.h,s,ct,Ne.x,Le.y,Ke,Oe),ku($,S.x,S.y,et.x,ir+et.y,qe.x+qe.w,qe.y+qe.h,s,ct,Le.x,Le.y,Ke,Oe),ap(e.dynamicLayoutVertexArray,S,ce),B.emplaceBack(bt,bt+1,bt+2),B.emplaceBack(bt+1,bt+2,bt+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pe[0]),he!==i.length-1&&tt===i[he+1].sectionIndex||e.programConfigurations.populatePaintArrays($.length,y,y.index,{},R,ne&&ne[tt])}e.placedSymbolArray.emplaceBack(S.x,S.y,H,this.glyphOffsetArray.length-H,Q,C,A,S.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],x,0,!1,0,M)}_addCollisionDebugVertex(e,i,s,h,f,y){return i.emplaceBack(0,0),e.emplaceBack(s.x,s.y,h,f,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,i,s,h,f,y,x){const S=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),C=S.vertexLength,A=f.layoutVertexArray,M=f.collisionVertexArray,R=x.anchorX,B=x.anchorY;this._addCollisionDebugVertex(A,M,y,R,B,new K(e,i)),this._addCollisionDebugVertex(A,M,y,R,B,new K(s,i)),this._addCollisionDebugVertex(A,M,y,R,B,new K(s,h)),this._addCollisionDebugVertex(A,M,y,R,B,new K(e,h)),S.vertexLength+=4;const $=f.indexArray;$.emplaceBack(C,C+1),$.emplaceBack(C+1,C+2),$.emplaceBack(C+2,C+3),$.emplaceBack(C+3,C),S.primitiveLength+=4}addDebugCollisionBoxes(e,i,s,h){for(let f=e;f<i;f++){const y=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new lp(St,Ym.members,Ye),this.iconCollisionBox=new lp(St,Ym.members,Ye);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,s,h,f,y,x,S,C){const A={};for(let M=i;M<s;M++){const R=e.get(M);A.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.textFeatureIndex=R.featureIndex;break}for(let M=h;M<f;M++){const R=e.get(M);A.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.verticalTextFeatureIndex=R.featureIndex;break}for(let M=y;M<x;M++){const R=e.get(M);A.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.iconFeatureIndex=R.featureIndex;break}for(let M=S;M<C;M++){const R=e.get(M);A.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},A.verticalIconFeatureIndex=R.featureIndex;break}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const s=e.placedSymbolArray.get(i),h=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<h;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),s=Math.cos(e),h=[],f=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const S=this.symbolInstances.get(x);h.push(0|Math.round(i*S.anchorX+s*S.anchorY)),f.push(S.featureIndex)}return y.sort((x,S)=>h[x]-h[S]||f[S]-f[x]),y}addToSortKeyRanges(e,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((h,f,y)=>{h>=0&&y.indexOf(h)===f&&this.addIndicesForPlacedSymbol(this.text,h)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let fg,mg;Xe("SymbolBucket",Ks,{omit:["layers","collisionBoxArray","features","compareText"]}),Ks.MAX_GLYPHS=65535,Ks.addDynamicAttributes=ap;var cp={get paint(){return mg=mg||new wn({"icon-opacity":new dt(ve.paint_symbol["icon-opacity"]),"icon-color":new dt(ve.paint_symbol["icon-color"]),"icon-halo-color":new dt(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new dt(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dt(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new rt(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new rt(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new dt(ve.paint_symbol["text-opacity"]),"text-color":new dt(ve.paint_symbol["text-color"],{runtimeType:Qr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new dt(ve.paint_symbol["text-halo-color"]),"text-halo-width":new dt(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new dt(ve.paint_symbol["text-halo-blur"]),"text-translate":new rt(ve.paint_symbol["text-translate"]),"text-translate-anchor":new rt(ve.paint_symbol["text-translate-anchor"])})},get layout(){return fg=fg||new wn({"symbol-placement":new rt(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new rt(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new rt(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dt(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new rt(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new rt(ve.layout_symbol["icon-allow-overlap"]),"icon-overlap":new rt(ve.layout_symbol["icon-overlap"]),"icon-ignore-placement":new rt(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new rt(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new rt(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new dt(ve.layout_symbol["icon-size"]),"icon-text-fit":new rt(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new rt(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new dt(ve.layout_symbol["icon-image"]),"icon-rotate":new dt(ve.layout_symbol["icon-rotate"]),"icon-padding":new dt(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new rt(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new dt(ve.layout_symbol["icon-offset"]),"icon-anchor":new dt(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new rt(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new rt(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new rt(ve.layout_symbol["text-rotation-alignment"]),"text-field":new dt(ve.layout_symbol["text-field"]),"text-font":new dt(ve.layout_symbol["text-font"]),"text-size":new dt(ve.layout_symbol["text-size"]),"text-max-width":new dt(ve.layout_symbol["text-max-width"]),"text-line-height":new rt(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new dt(ve.layout_symbol["text-letter-spacing"]),"text-justify":new dt(ve.layout_symbol["text-justify"]),"text-radial-offset":new dt(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new rt(ve.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new dt(ve.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new dt(ve.layout_symbol["text-anchor"]),"text-max-angle":new rt(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new rt(ve.layout_symbol["text-writing-mode"]),"text-rotate":new dt(ve.layout_symbol["text-rotate"]),"text-padding":new rt(ve.layout_symbol["text-padding"]),"text-keep-upright":new rt(ve.layout_symbol["text-keep-upright"]),"text-transform":new dt(ve.layout_symbol["text-transform"]),"text-offset":new dt(ve.layout_symbol["text-offset"]),"text-allow-overlap":new rt(ve.layout_symbol["text-allow-overlap"]),"text-overlap":new rt(ve.layout_symbol["text-overlap"]),"text-ignore-placement":new rt(ve.layout_symbol["text-ignore-placement"]),"text-optional":new rt(ve.layout_symbol["text-optional"])})}};class gg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:si,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xe("FormatSectionOverride",gg,{omit:["defaultValue"]});class Iu extends Mi{constructor(e){super(e,cp)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const f of s)h.indexOf(f)<0&&h.push(f);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,s,h){const f=this.layout.get(e).evaluate(i,{},s,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ss(y.value)||!f?f:function(x,S){return S.replace(/{([^{}]+)}/g,(C,A)=>A in x?String(x[A]):"")}(i.properties,f)}createBucket(e){return new Ks(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of cp.paint.overridableProperties){if(!Iu.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),s=new gg(i),h=new mr(s,i.property.specification);let f=null;f=i.value.kind==="constant"||i.value.kind==="source"?new Ca("source",h):new rr("composite",h,i.value.zoomStops),this.paint._values[e]=new li(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&Iu.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const s=e.get("text-field"),h=cp.paint.properties[i];let f=!1;const y=x=>{for(const S of x)if(h.overrides&&h.overrides.hasOverride(S))return void(f=!0)};if(s.value.kind==="constant"&&s.value.value instanceof wr)y(s.value.value.sections);else if(s.value.kind==="source"){const x=C=>{f||(C instanceof _o&&Sr(C.value)===ki?y(C.value.sections):C instanceof bs?y(C.sections):C.eachChild(x))},S=s.value;S._styleExpression&&x(S._styleExpression.expression)}return f}}let yg;var j1={get paint(){return yg=yg||new wn({"background-color":new rt(ve.paint_background["background-color"]),"background-pattern":new Nl(ve.paint_background["background-pattern"]),"background-opacity":new rt(ve.paint_background["background-opacity"])})}};class q1 extends Mi{constructor(e){super(e,j1)}}let _g;var G1={get paint(){return _g=_g||new wn({"raster-opacity":new rt(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new rt(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new rt(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new rt(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new rt(ve.paint_raster["raster-saturation"]),"raster-contrast":new rt(ve.paint_raster["raster-contrast"]),"raster-resampling":new rt(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new rt(ve.paint_raster["raster-fade-duration"])})}};class Z1 extends Mi{constructor(e){super(e,G1)}}class W1 extends Mi{constructor(e){super(e,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class X1{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const up=63710088e-1;class ia{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ia(Ie(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,s=this.lat*i,h=e.lat*i,f=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((e.lng-this.lng)*i);return up*Math.acos(Math.min(f,1))}static convert(e){if(e instanceof ia)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ia(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ia(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const xg=2*Math.PI*up;function vg(r){return xg*Math.cos(r*Math.PI/180)}function bg(r){return(180+r)/360}function wg(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Sg(r,e){return r/vg(e)}function hp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Au{constructor(e,i,s=0){this.x=+e,this.y=+i,this.z=+s}static fromLngLat(e,i=0){const s=ia.convert(e);return new Au(bg(s.lng),wg(s.lat),Sg(i,s.lat))}toLngLat(){return new ia(360*this.x-180,hp(this.y))}toAltitude(){return this.z*vg(hp(this.y))}meterInMercatorCoordinateUnits(){return 1/xg*(e=hp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Eg(r,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[r*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class dp{constructor(e,i,s){if(e<0||e>25||s<0||s>=Math.pow(2,e)||i<0||i>=Math.pow(2,e))throw new Error(`x=${i}, y=${s}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=s,this.key=sc(0,e,e,i,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,s){const h=(y=this.y,x=this.z,S=Eg(256*(f=this.x),256*(y=Math.pow(2,x)-y-1),x),C=Eg(256*(f+1),256*(y+1),x),S[0]+","+S[1]+","+C[0]+","+C[1]);var f,y,x,S,C;const A=function(M,R,B){let $,G="";for(let H=M;H>0;H--)$=1<<H-1,G+=(R&$?1:0)+(B&$?2:0);return G}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new K((e.x*i-this.x)*gr,(e.y*i-this.y)*gr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tg{constructor(e,i){this.wrap=e,this.canonical=i,this.key=sc(e,i.z,i.z,i.x,i.y)}}class di{constructor(e,i,s,h,f){if(e<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${s}`);this.overscaledZ=e,this.wrap=i,this.canonical=new dp(s,+h,+f),this.key=sc(i,e,s,h,f)}clone(){return new di(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new di(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new di(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-e;return e>this.canonical.z?sc(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):sc(this.wrap*+i,e,e,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new di(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new di(i,this.wrap,i,s,h),new di(i,this.wrap,i,s+1,h),new di(i,this.wrap,i,s,h+1),new di(i,this.wrap,i,s+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new di(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new di(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Au(e.x-this.wrap,e.y))}}function sc(r,e,i,s,h){(r*=2)<0&&(r=-1*r-1);const f=1<<i;return(f*f*r+f*h+s).toString(36)+i.toString(36)+e.toString(36)}Xe("CanonicalTileID",dp),Xe("OverscaledTileID",di,{omit:["posMatrix"]});class Cg{constructor(e,i,s){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return void yt(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const h=this.dim=i.height-2;this.data=new Uint32Array(i.data.buffer),this.encoding=s||"mapbox";for(let f=0;f<h;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(h,f)]=this.data[this._idx(h-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,h)]=this.data[this._idx(f,h-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(h,-1)]=this.data[this._idx(h-1,0)],this.data[this._idx(-1,h)]=this.data[this._idx(0,h-1)],this.data[this._idx(h,h)]=this.data[this._idx(h-1,h-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let f=0;f<h;f++)for(let y=0;y<h;y++){const x=this.get(f,y);x>this.max&&(this.max=x),x<this.min&&(this.min=x)}}get(e,i){const s=new Uint8Array(this.data.buffer),h=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(s[h],s[h+1],s[h+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,s){return(256*e*256+256*i+s)/10-1e4}_unpackTerrarium(e,i,s){return 256*e+i+s/256-32768}getPixels(){return new hi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,f=i*this.dim+this.dim,y=s*this.dim,x=s*this.dim+this.dim;switch(i){case-1:h=f-1;break;case 1:f=h+1}switch(s){case-1:y=x-1;break;case 1:x=y+1}const S=-i*this.dim,C=-s*this.dim;for(let A=y;A<x;A++)for(let M=h;M<f;M++)this.data[this._idx(M,A)]=e.data[this._idx(M+S,A+C)]}}Xe("DEMData",Cg);class kg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const s=e[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Ig{constructor(e,i,s,h,f){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=s,e._y=h,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(e[i]=this[i]);return e}}class Ag{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ba(gr,16,0),this.grid3D=new Ba(gr,16,0),this.featureIndexArray=new ie,this.promoteId=i}insert(e,i,s,h,f,y){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,f);const S=y?this.grid3D:this.grid;for(let C=0;C<i.length;C++){const A=i[C],M=[1/0,1/0,-1/0,-1/0];for(let R=0;R<A.length;R++){const B=A[R];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}M[0]<gr&&M[1]<gr&&M[2]>=0&&M[3]>=0&&S.insert(x,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ta.VectorTile(new ep(this.rawTileData)).layers,this.sourceLayerCoder=new kg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,i,s,h){this.loadVTLayers();const f=e.params||{},y=gr/e.tileSize/e.scale,x=Cl(f.filter),S=e.queryGeometry,C=e.queryPadding*y,A=Mg(S),M=this.grid.query(A.minX-C,A.minY-C,A.maxX+C,A.maxY+C),R=Mg(e.cameraQueryGeometry),B=this.grid3D.query(R.minX-C,R.minY-C,R.maxX+C,R.maxY+C,(H,Q,ce,ne)=>function(he,fe,we,Ge,et){for(const Ne of he)if(fe<=Ne.x&&we<=Ne.y&&Ge>=Ne.x&&et>=Ne.y)return!0;const qe=[new K(fe,we),new K(fe,et),new K(Ge,et),new K(Ge,we)];if(he.length>2){for(const Ne of qe)if(Vs(he,Ne))return!0}for(let Ne=0;Ne<he.length-1;Ne++)if(Cv(he[Ne],he[Ne+1],qe))return!0;return!1}(e.cameraQueryGeometry,H-C,Q-C,ce+C,ne+C));for(const H of B)M.push(H);M.sort(K1);const $={};let G;for(let H=0;H<M.length;H++){const Q=M[H];if(Q===G)continue;G=Q;const ce=this.featureIndexArray.get(Q);let ne=null;this.loadMatchingFeature($,ce.bucketIndex,ce.sourceLayerIndex,ce.featureIndex,x,f.layers,f.availableImages,i,s,h,(he,fe,we)=>(ne||(ne=Xi(he)),fe.queryIntersectsFeature(S,he,we,ne,this.z,e.transform,y,e.pixelPosMatrix)))}return $}loadMatchingFeature(e,i,s,h,f,y,x,S,C,A,M){const R=this.bucketLayerIDs[i];if(y&&!function(H,Q){for(let ce=0;ce<H.length;ce++)if(Q.indexOf(H[ce])>=0)return!0;return!1}(y,R))return;const B=this.sourceLayerCoder.decode(s),$=this.vtLayers[B].feature(h);if(f.needGeometry){const H=co($,!0);if(!f.filter(new sr(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!f.filter(new sr(this.tileID.overscaledZ),$))return;const G=this.getId($,B);for(let H=0;H<R.length;H++){const Q=R[H];if(y&&y.indexOf(Q)<0)continue;const ce=S[Q];if(!ce)continue;let ne={};G&&A&&(ne=A.getState(ce.sourceLayer||"_geojsonTileLayer",G));const he=De({},C[Q]);he.paint=Pg(he.paint,ce.paint,$,ne,x),he.layout=Pg(he.layout,ce.layout,$,ne,x);const fe=!M||M($,ce,ne);if(!fe)continue;const we=new Ig($,this.z,this.x,this.y,G);we.layer=he;let Ge=e[Q];Ge===void 0&&(Ge=e[Q]=[]),Ge.push({featureIndex:h,feature:we,intersectionZ:fe})}}lookupSymbolFeatures(e,i,s,h,f,y,x,S){const C={};this.loadVTLayers();const A=Cl(f);for(const M of e)this.loadMatchingFeature(C,s,h,M,A,y,x,S,i);return C}hasLayer(e){for(const i of this.bucketLayerIDs)for(const s of i)if(e===s)return!0;return!1}getId(e,i){let s=e.id;return this.promoteId&&(s=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof s=="boolean"&&(s=Number(s))),s}}function Pg(r,e,i,s,h){return Me(r,(f,y)=>{const x=e instanceof Va?e.get(y):null;return x&&x.evaluate?x.evaluate(i,s,h):x})}function Mg(r){let e=1/0,i=1/0,s=-1/0,h=-1/0;for(const f of r)e=Math.min(e,f.x),i=Math.min(i,f.y),s=Math.max(s,f.x),h=Math.max(h,f.y);return{minX:e,minY:i,maxX:s,maxY:h}}function K1(r,e){return e-r}function zg(r,e,i,s,h){const f=[];for(let y=0;y<r.length;y++){const x=r[y];let S;for(let C=0;C<x.length-1;C++){let A=x[C],M=x[C+1];A.x<e&&M.x<e||(A.x<e?A=new K(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x<e&&(M=new K(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y<i&&M.y<i||(A.y<i?A=new K(A.x+(i-A.y)/(M.y-A.y)*(M.x-A.x),i)._round():M.y<i&&(M=new K(A.x+(i-A.y)/(M.y-A.y)*(M.x-A.x),i)._round()),A.x>=s&&M.x>=s||(A.x>=s?A=new K(s,A.y+(s-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x>=s&&(M=new K(s,A.y+(s-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y>=h&&M.y>=h||(A.y>=h?A=new K(A.x+(h-A.y)/(M.y-A.y)*(M.x-A.x),h)._round():M.y>=h&&(M=new K(A.x+(h-A.y)/(M.y-A.y)*(M.x-A.x),h)._round()),S&&A.equals(S[S.length-1])||(S=[A],f.push(S)),S.push(M)))))}}return f}Xe("FeatureIndex",Ag,{omit:["rawTileData","sourceLayerCoder"]});class oa extends K{constructor(e,i,s,h){super(e,i),this.angle=s,h!==void 0&&(this.segment=h)}clone(){return new oa(this.x,this.y,this.angle,this.segment)}}function Dg(r,e,i,s,h){if(e.segment===void 0||i===0)return!0;let f=e,y=e.segment+1,x=0;for(;x>-i/2;){if(y--,y<0)return!1;x-=r[y].dist(f),f=r[y]}x+=r[y].dist(r[y+1]),y++;const S=[];let C=0;for(;x<i/2;){const A=r[y],M=r[y+1];if(!M)return!1;let R=r[y-1].angleTo(A)-A.angleTo(M);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:R}),C+=R;x-S[0].distance>s;)C-=S.shift().angleDelta;if(C>h)return!1;y++,x+=A.dist(M)}return!0}function Rg(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function Lg(r,e,i){return r?.6*e*i:0}function Fg(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function H1(r,e,i,s,h,f){const y=Lg(i,h,f),x=Fg(i,s)*f;let S=0;const C=Rg(r)/2;for(let A=0;A<r.length-1;A++){const M=r[A],R=r[A+1],B=M.dist(R);if(S+B>C){const $=(C-S)/B,G=Fn.number(M.x,R.x,$),H=Fn.number(M.y,R.y,$),Q=new oa(G,H,R.angleTo(M),A);return Q._round(),!y||Dg(r,Q,x,y,e)?Q:void 0}S+=B}}function Y1(r,e,i,s,h,f,y,x,S){const C=Lg(s,f,y),A=Fg(s,h),M=A*y,R=r[0].x===0||r[0].x===S||r[0].y===0||r[0].y===S;return e-M<e/4&&(e=M+e/4),Bg(r,R?e/2*x%e:(A/2+2*f)*y*x%e,e,C,i,M,R,!1,S)}function Bg(r,e,i,s,h,f,y,x,S){const C=f/2,A=Rg(r);let M=0,R=e-i,B=[];for(let $=0;$<r.length-1;$++){const G=r[$],H=r[$+1],Q=G.dist(H),ce=H.angleTo(G);for(;R+i<M+Q;){R+=i;const ne=(R-M)/Q,he=Fn.number(G.x,H.x,ne),fe=Fn.number(G.y,H.y,ne);if(he>=0&&he<S&&fe>=0&&fe<S&&R-C>=0&&R+C<=A){const we=new oa(he,fe,ce,$);we._round(),s&&!Dg(r,we,f,s,h)||B.push(we)}}M+=Q}return x||B.length||y||(B=Bg(r,M/2,i,s,h,f,y,!0,S)),B}Xe("Anchor",oa);const Hs=Un;function Og(r,e,i,s){const h=[],f=r.image,y=f.pixelRatio,x=f.paddedRect.w-2*Hs,S=f.paddedRect.h-2*Hs,C=r.right-r.left,A=r.bottom-r.top,M=f.stretchX||[[0,x]],R=f.stretchY||[[0,S]],B=(Le,Ke)=>Le+Ke[1]-Ke[0],$=M.reduce(B,0),G=R.reduce(B,0),H=x-$,Q=S-G;let ce=0,ne=$,he=0,fe=G,we=0,Ge=H,et=0,qe=Q;if(f.content&&s){const Le=f.content;ce=Pu(M,0,Le[0]),he=Pu(R,0,Le[1]),ne=Pu(M,Le[0],Le[2]),fe=Pu(R,Le[1],Le[3]),we=Le[0]-ce,et=Le[1]-he,Ge=Le[2]-Le[0]-ne,qe=Le[3]-Le[1]-fe}const Ne=(Le,Ke,Oe,Pe)=>{const ct=Mu(Le.stretch-ce,ne,C,r.left),tt=zu(Le.fixed-we,Ge,Le.stretch,$),bt=Mu(Ke.stretch-he,fe,A,r.top),ir=zu(Ke.fixed-et,qe,Ke.stretch,G),cr=Mu(Oe.stretch-ce,ne,C,r.left),Ur=zu(Oe.fixed-we,Ge,Oe.stretch,$),ni=Mu(Pe.stretch-he,fe,A,r.top),Tn=zu(Pe.fixed-et,qe,Pe.stretch,G),Dr=new K(ct,bt),jr=new K(cr,bt),an=new K(cr,ni),Nn=new K(ct,ni),Cn=new K(tt/y,ir/y),Rr=new K(Ur/y,Tn/y),Nr=e*Math.PI/180;if(Nr){const Vn=Math.sin(Nr),jn=Math.cos(Nr),_r=[jn,-Vn,Vn,jn];Dr._matMult(_r),jr._matMult(_r),Nn._matMult(_r),an._matMult(_r)}const un=Le.stretch+Le.fixed,kn=Ke.stretch+Ke.fixed;return{tl:Dr,tr:jr,bl:Nn,br:an,tex:{x:f.paddedRect.x+Hs+un,y:f.paddedRect.y+Hs+kn,w:Oe.stretch+Oe.fixed-un,h:Pe.stretch+Pe.fixed-kn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Cn,pixelOffsetBR:Rr,minFontScaleX:Ge/y/C,minFontScaleY:qe/y/A,isSDF:i}};if(s&&(f.stretchX||f.stretchY)){const Le=$g(M,H,$),Ke=$g(R,Q,G);for(let Oe=0;Oe<Le.length-1;Oe++){const Pe=Le[Oe],ct=Le[Oe+1];for(let tt=0;tt<Ke.length-1;tt++)h.push(Ne(Pe,Ke[tt],ct,Ke[tt+1]))}}else h.push(Ne({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return h}function Pu(r,e,i){let s=0;for(const h of r)s+=Math.max(e,Math.min(i,h[1]))-Math.max(e,Math.min(i,h[0]));return s}function $g(r,e,i){const s=[{fixed:-Hs,stretch:0}];for(const[h,f]of r){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(f-h)})}return s.push({fixed:e+Hs,stretch:i}),s}function Mu(r,e,i,s){return r/e*i+s}function zu(r,e,i,s){return r-e*i/s}class Du{constructor(e,i,s,h,f,y,x,S,C,A){if(this.boxStartIndex=e.length,C){let M=y.top,R=y.bottom;const B=y.collisionPadding;B&&(M-=B[1],R+=B[3]);let $=R-M;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{let M=y.top*x-S[0],R=y.bottom*x+S[2],B=y.left*x-S[3],$=y.right*x+S[1];const G=y.collisionPadding;if(G&&(B-=G[0]*x,M-=G[1]*x,$+=G[2]*x,R+=G[3]*x),A){const H=new K(B,M),Q=new K($,M),ce=new K(B,R),ne=new K($,R),he=A*Math.PI/180;H._rotate(he),Q._rotate(he),ce._rotate(he),ne._rotate(he),B=Math.min(H.x,Q.x,ce.x,ne.x),$=Math.max(H.x,Q.x,ce.x,ne.x),M=Math.min(H.y,Q.y,ce.y,ne.y),R=Math.max(H.y,Q.y,ce.y,ne.y)}e.emplaceBack(i.x,i.y,B,M,$,R,s,h,f)}this.boxEndIndex=e.length}}class J1{constructor(e=[],i=Q1){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:s}=this,h=i[e];for(;e>0;){const f=e-1>>1,y=i[f];if(s(h,y)>=0)break;i[e]=y,e=f}i[e]=h}_down(e){const{data:i,compare:s}=this,h=this.length>>1,f=i[e];for(;e<h;){let y=1+(e<<1),x=i[y];const S=y+1;if(S<this.length&&s(i[S],x)<0&&(y=S,x=i[S]),s(x,f)>=0)break;i[e]=x,e=y}i[e]=f}}function Q1(r,e){return r<e?-1:r>e?1:0}function eb(r,e=1,i=!1){let s=1/0,h=1/0,f=-1/0,y=-1/0;const x=r[0];for(let B=0;B<x.length;B++){const $=x[B];(!B||$.x<s)&&(s=$.x),(!B||$.y<h)&&(h=$.y),(!B||$.x>f)&&(f=$.x),(!B||$.y>y)&&(y=$.y)}const S=Math.min(f-s,y-h);let C=S/2;const A=new J1([],tb);if(S===0)return new K(s,h);for(let B=s;B<f;B+=S)for(let $=h;$<y;$+=S)A.push(new Ys(B+C,$+C,C,r));let M=function(B){let $=0,G=0,H=0;const Q=B[0];for(let ce=0,ne=Q.length,he=ne-1;ce<ne;he=ce++){const fe=Q[ce],we=Q[he],Ge=fe.x*we.y-we.x*fe.y;G+=(fe.x+we.x)*Ge,H+=(fe.y+we.y)*Ge,$+=3*Ge}return new Ys(G/$,H/$,0,B)}(r),R=A.length;for(;A.length;){const B=A.pop();(B.d>M.d||!M.d)&&(M=B,i&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,R)),B.max-M.d<=e||(C=B.h/2,A.push(new Ys(B.p.x-C,B.p.y-C,C,r)),A.push(new Ys(B.p.x+C,B.p.y-C,C,r)),A.push(new Ys(B.p.x-C,B.p.y+C,C,r)),A.push(new Ys(B.p.x+C,B.p.y+C,C,r)),R+=4)}return i&&(console.log(`num probes: ${R}`),console.log(`best distance: ${M.d}`)),M.p}function tb(r,e){return e.max-r.max}function Ys(r,e,i,s){this.p=new K(r,e),this.h=i,this.d=function(h,f){let y=!1,x=1/0;for(let S=0;S<f.length;S++){const C=f[S];for(let A=0,M=C.length,R=M-1;A<M;R=A++){const B=C[A],$=C[R];B.y>h.y!=$.y>h.y&&h.x<($.x-B.x)*(h.y-B.y)/($.y-B.y)+B.x&&(y=!y),x=Math.min(x,wm(h,B,$))}}return(y?1:-1)*Math.sqrt(x)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}var on;l.TextAnchorEnum=void 0,(on=l.TextAnchorEnum||(l.TextAnchorEnum={}))[on.center=1]="center",on[on.left=2]="left",on[on.right=3]="right",on[on.top=4]="top",on[on.bottom=5]="bottom",on[on["top-left"]=6]="top-left",on[on["top-right"]=7]="top-right",on[on["bottom-left"]=8]="bottom-left",on[on["bottom-right"]=9]="bottom-right";const aa=7,pp=Number.POSITIVE_INFINITY;function Ug(r,e){return e[1]!==pp?function(i,s,h){let f=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),i){case"top-right":case"top-left":case"top":y=h-aa;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+aa}switch(i){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}return[f,y]}(r,e[0],e[1]):function(i,s){let h=0,f=0;s<0&&(s=0);const y=s/Math.SQRT2;switch(i){case"top-right":case"top-left":f=y-aa;break;case"bottom-right":case"bottom-left":f=-y+aa;break;case"bottom":f=-s+aa;break;case"top":f=s-aa}switch(i){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,f]}(r,e[0])}function Ng(r,e,i){var s;const h=r.layout,f=(s=h.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(e,{},i);if(f){const x=f.values,S=[];for(let C=0;C<x.length;C+=2){const A=S[C]=x[C],M=x[C+1].map(R=>R*$r);A.startsWith("top")?M[1]-=aa:A.startsWith("bottom")&&(M[1]+=aa),S[C+1]=M}return new en(S)}const y=h.get("text-variable-anchor");if(y){let x;x=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},i)*$r,pp]:h.get("text-offset").evaluate(e,{},i).map(C=>C*$r);const S=[];for(const C of y)S.push(C,Ug(C,x));return new en(S)}return null}function fp(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rb(r,e,i,s,h,f,y,x,S,C,A){let M=f.textMaxSize.evaluate(e,{});M===void 0&&(M=y);const R=r.layers[0].layout,B=R.get("icon-offset").evaluate(e,{},A),$=jg(i.horizontal),G=y/24,H=r.tilePixelRatio*G,Q=r.tilePixelRatio*M/24,ce=r.tilePixelRatio*x,ne=r.tilePixelRatio*R.get("symbol-spacing"),he=R.get("text-padding")*r.tilePixelRatio,fe=function(Pe,ct,tt,bt=1){const ir=Pe.get("icon-padding").evaluate(ct,{},tt),cr=ir&&ir.values;return[cr[0]*bt,cr[1]*bt,cr[2]*bt,cr[3]*bt]}(R,e,A,r.tilePixelRatio),we=R.get("text-max-angle")/180*Math.PI,Ge=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",et=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",qe=R.get("symbol-placement"),Ne=ne/2,Le=R.get("icon-text-fit");let Ke;s&&Le!=="none"&&(r.allowVerticalPlacement&&i.vertical&&(Ke=dg(s,i.vertical,Le,R.get("icon-text-fit-padding"),B,G)),$&&(s=dg(s,$,Le,R.get("icon-text-fit-padding"),B,G)));const Oe=(Pe,ct)=>{ct.x<0||ct.x>=gr||ct.y<0||ct.y>=gr||function(tt,bt,ir,cr,Ur,ni,Tn,Dr,jr,an,Nn,Cn,Rr,Nr,un,kn,Vn,jn,_r,sn,At,ii,ln,In,Ri){const Ki=tt.addToLineVertexArray(bt,ir);let Hi,zo,Li,pi,qn=0,Do=0,uc=0,Wg=0,wp=-1,Sp=-1;const Ro={};let Xg=ci("");if(tt.allowVerticalPlacement&&cr.vertical){const hn=Dr.layout.get("text-rotate").evaluate(At,{},In)+90;Li=new Du(jr,bt,an,Nn,Cn,cr.vertical,Rr,Nr,un,hn),Tn&&(pi=new Du(jr,bt,an,Nn,Cn,Tn,Vn,jn,un,hn))}if(Ur){const hn=Dr.layout.get("icon-rotate").evaluate(At,{}),fi=Dr.layout.get("icon-text-fit")!=="none",Ka=Og(Ur,hn,ln,fi),Ji=Tn?Og(Tn,hn,ln,fi):void 0;zo=new Du(jr,bt,an,Nn,Cn,Ur,Vn,jn,!1,hn),qn=4*Ka.length;const Ha=tt.iconSizeData;let ho=null;Ha.kind==="source"?(ho=[uo*Dr.layout.get("icon-size").evaluate(At,{})],ho[0]>na&&yt(`${tt.layerIds[0]}: Value for "icon-size" is >= ${ac}. Reduce your "icon-size".`)):Ha.kind==="composite"&&(ho=[uo*ii.compositeIconSizes[0].evaluate(At,{},In),uo*ii.compositeIconSizes[1].evaluate(At,{},In)],(ho[0]>na||ho[1]>na)&&yt(`${tt.layerIds[0]}: Value for "icon-size" is >= ${ac}. Reduce your "icon-size".`)),tt.addSymbols(tt.icon,Ka,ho,sn,_r,At,l.WritingMode.none,bt,Ki.lineStartIndex,Ki.lineLength,-1,In),wp=tt.icon.placedSymbolArray.length-1,Ji&&(Do=4*Ji.length,tt.addSymbols(tt.icon,Ji,ho,sn,_r,At,l.WritingMode.vertical,bt,Ki.lineStartIndex,Ki.lineLength,-1,In),Sp=tt.icon.placedSymbolArray.length-1)}const Kg=Object.keys(cr.horizontal);for(const hn of Kg){const fi=cr.horizontal[hn];if(!Hi){Xg=ci(fi.text);const Ji=Dr.layout.get("text-rotate").evaluate(At,{},In);Hi=new Du(jr,bt,an,Nn,Cn,fi,Rr,Nr,un,Ji)}const Ka=fi.positionedLines.length===1;if(uc+=Vg(tt,bt,fi,ni,Dr,un,At,kn,Ki,cr.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,Ka?Kg:[hn],Ro,wp,ii,In),Ka)break}cr.vertical&&(Wg+=Vg(tt,bt,cr.vertical,ni,Dr,un,At,kn,Ki,l.WritingMode.vertical,["vertical"],Ro,Sp,ii,In));const ob=Hi?Hi.boxStartIndex:tt.collisionBoxArray.length,ab=Hi?Hi.boxEndIndex:tt.collisionBoxArray.length,sb=Li?Li.boxStartIndex:tt.collisionBoxArray.length,lb=Li?Li.boxEndIndex:tt.collisionBoxArray.length,cb=zo?zo.boxStartIndex:tt.collisionBoxArray.length,ub=zo?zo.boxEndIndex:tt.collisionBoxArray.length,hb=pi?pi.boxStartIndex:tt.collisionBoxArray.length,db=pi?pi.boxEndIndex:tt.collisionBoxArray.length;let Yi=-1;const Lu=(hn,fi)=>hn&&hn.circleDiameter?Math.max(hn.circleDiameter,fi):fi;Yi=Lu(Hi,Yi),Yi=Lu(Li,Yi),Yi=Lu(zo,Yi),Yi=Lu(pi,Yi);const Hg=Yi>-1?1:0;Hg&&(Yi*=Ri/$r),tt.glyphOffsetArray.length>=Ks.MAX_GLYPHS&&yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),At.sortKey!==void 0&&tt.addToSortKeyRanges(tt.symbolInstances.length,At.sortKey);const pb=Ng(Dr,At,In),[fb,mb]=function(hn,fi){const Ka=hn.length,Ji=fi==null?void 0:fi.values;if((Ji==null?void 0:Ji.length)>0)for(let Ha=0;Ha<Ji.length;Ha+=2){const ho=Ji[Ha+1];hn.emplaceBack(l.TextAnchorEnum[Ji[Ha]],ho[0],ho[1])}return[Ka,hn.length]}(tt.textAnchorOffsets,pb);tt.symbolInstances.emplaceBack(bt.x,bt.y,Ro.right>=0?Ro.right:-1,Ro.center>=0?Ro.center:-1,Ro.left>=0?Ro.left:-1,Ro.vertical||-1,wp,Sp,Xg,ob,ab,sb,lb,cb,ub,hb,db,an,uc,Wg,qn,Do,Hg,0,Rr,Yi,fb,mb)}(r,ct,Pe,i,s,h,Ke,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,H,[he,he,he,he],Ge,S,ce,fe,et,B,e,f,C,A,y)};if(qe==="line")for(const Pe of zg(e.geometry,0,0,gr,gr)){const ct=Y1(Pe,ne,we,i.vertical||$,s,24,Q,r.overscaling,gr);for(const tt of ct)$&&nb(r,$.text,Ne,tt)||Oe(Pe,tt)}else if(qe==="line-center"){for(const Pe of e.geometry)if(Pe.length>1){const ct=H1(Pe,we,i.vertical||$,s,24,Q);ct&&Oe(Pe,ct)}}else if(e.type==="Polygon")for(const Pe of Zd(e.geometry,0)){const ct=eb(Pe,16);Oe(Pe[0],new oa(ct.x,ct.y,0))}else if(e.type==="LineString")for(const Pe of e.geometry)Oe(Pe,new oa(Pe[0].x,Pe[0].y,0));else if(e.type==="Point")for(const Pe of e.geometry)for(const ct of Pe)Oe([ct],new oa(ct.x,ct.y,0))}function Vg(r,e,i,s,h,f,y,x,S,C,A,M,R,B,$){const G=function(ce,ne,he,fe,we,Ge,et,qe){const Ne=fe.layout.get("text-rotate").evaluate(Ge,{})*Math.PI/180,Le=[];for(const Ke of ne.positionedLines)for(const Oe of Ke.positionedGlyphs){if(!Oe.rect)continue;const Pe=Oe.rect||{};let ct=og+1,tt=!0,bt=1,ir=0;const cr=(we||qe)&&Oe.vertical,Ur=Oe.metrics.advance*Oe.scale/2;if(qe&&ne.verticalizable&&(ir=Ke.lineOffset/2-(Oe.imageName?-($r-Oe.metrics.width*Oe.scale)/2:(Oe.scale-1)*$r)),Oe.imageName){const _r=et[Oe.imageName];tt=_r.sdf,bt=_r.pixelRatio,ct=Un/bt}const ni=we?[Oe.x+Ur,Oe.y]:[0,0];let Tn=we?[0,0]:[Oe.x+Ur+he[0],Oe.y+he[1]-ir],Dr=[0,0];cr&&(Dr=Tn,Tn=[0,0]);const jr=(Oe.metrics.left-ct)*Oe.scale-Ur+Tn[0],an=(-Oe.metrics.top-ct)*Oe.scale+Tn[1],Nn=jr+Pe.w*Oe.scale/bt,Cn=an+Pe.h*Oe.scale/bt,Rr=new K(jr,an),Nr=new K(Nn,an),un=new K(jr,Cn),kn=new K(Nn,Cn);if(cr){const _r=new K(-Ur,Ur-ic),sn=-Math.PI/2,At=$r/2-Ur,ii=new K(5-ic-At,-(Oe.imageName?At:0)),ln=new K(...Dr);Rr._rotateAround(sn,_r)._add(ii)._add(ln),Nr._rotateAround(sn,_r)._add(ii)._add(ln),un._rotateAround(sn,_r)._add(ii)._add(ln),kn._rotateAround(sn,_r)._add(ii)._add(ln)}if(Ne){const _r=Math.sin(Ne),sn=Math.cos(Ne),At=[sn,-_r,_r,sn];Rr._matMult(At),Nr._matMult(At),un._matMult(At),kn._matMult(At)}const Vn=new K(0,0),jn=new K(0,0);Le.push({tl:Rr,tr:Nr,bl:un,br:kn,tex:Pe,writingMode:ne.writingMode,glyphOffset:ni,sectionIndex:Oe.sectionIndex,isSDF:tt,pixelOffsetTL:Vn,pixelOffsetBR:jn,minFontScaleX:0,minFontScaleY:0})}return Le}(0,i,x,h,f,y,s,r.allowVerticalPlacement),H=r.textSizeData;let Q=null;H.kind==="source"?(Q=[uo*h.layout.get("text-size").evaluate(y,{})],Q[0]>na&&yt(`${r.layerIds[0]}: Value for "text-size" is >= ${ac}. Reduce your "text-size".`)):H.kind==="composite"&&(Q=[uo*B.compositeTextSizes[0].evaluate(y,{},$),uo*B.compositeTextSizes[1].evaluate(y,{},$)],(Q[0]>na||Q[1]>na)&&yt(`${r.layerIds[0]}: Value for "text-size" is >= ${ac}. Reduce your "text-size".`)),r.addSymbols(r.text,G,Q,x,f,y,C,e,S.lineStartIndex,S.lineLength,R,$);for(const ce of A)M[ce]=r.text.placedSymbolArray.length-1;return 4*G.length}function jg(r){for(const e in r)return r[e];return null}function nb(r,e,i,s){const h=r.compareText;if(e in h){const f=h[e];for(let y=f.length-1;y>=0;y--)if(s.dist(f[y])<i)return!0}else h[e]=[];return h[e].push(s),!1}const qg=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class mp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,s]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=s>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const f=qg[15&s];if(!f)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[x]=new Uint32Array(e,4,1);return new mp(x,y,f,e)}constructor(e,i=64,s=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=qg.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,x=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-x%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${s}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+x+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=i,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return gp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:x}=this,S=[0,f.length-1,0],C=[];for(;S.length;){const A=S.pop()||0,M=S.pop()||0,R=S.pop()||0;if(M-R<=x){for(let H=R;H<=M;H++){const Q=y[2*H],ce=y[2*H+1];Q>=e&&Q<=s&&ce>=i&&ce<=h&&C.push(f[H])}continue}const B=R+M>>1,$=y[2*B],G=y[2*B+1];$>=e&&$<=s&&G>=i&&G<=h&&C.push(f[B]),(A===0?e<=$:i<=G)&&(S.push(R),S.push(B-1),S.push(1-A)),(A===0?s>=$:h>=G)&&(S.push(B+1),S.push(M),S.push(1-A))}return C}within(e,i,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:f,nodeSize:y}=this,x=[0,h.length-1,0],S=[],C=s*s;for(;x.length;){const A=x.pop()||0,M=x.pop()||0,R=x.pop()||0;if(M-R<=y){for(let H=R;H<=M;H++)Zg(f[2*H],f[2*H+1],e,i)<=C&&S.push(h[H]);continue}const B=R+M>>1,$=f[2*B],G=f[2*B+1];Zg($,G,e,i)<=C&&S.push(h[B]),(A===0?e-s<=$:i-s<=G)&&(x.push(R),x.push(B-1),x.push(1-A)),(A===0?e+s>=$:i+s>=G)&&(x.push(B+1),x.push(M),x.push(1-A))}return S}}function gp(r,e,i,s,h,f){if(h-s<=i)return;const y=s+h>>1;Gg(r,e,y,s,h,f),gp(r,e,i,s,y-1,1-f),gp(r,e,i,y+1,h,1-f)}function Gg(r,e,i,s,h,f){for(;h>s;){if(h-s>600){const C=h-s+1,A=i-s+1,M=Math.log(C),R=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*R*(C-R)/C)*(A-C/2<0?-1:1);Gg(r,e,i,Math.max(s,Math.floor(i-A*R/C+B)),Math.min(h,Math.floor(i+(C-A)*R/C+B)),f)}const y=e[2*i+f];let x=s,S=h;for(lc(r,e,s,i),e[2*h+f]>y&&lc(r,e,s,h);x<S;){for(lc(r,e,x,S),x++,S--;e[2*x+f]<y;)x++;for(;e[2*S+f]>y;)S--}e[2*s+f]===y?lc(r,e,s,S):(S++,lc(r,e,S,h)),S<=i&&(s=S+1),i<=S&&(h=S-1)}}function lc(r,e,i,s){yp(r,i,s),yp(e,2*i,2*s),yp(e,2*i+1,2*s+1)}function yp(r,e,i){const s=r[e];r[e]=r[i],r[i]=s}function Zg(r,e,i,s){const h=r-i,f=e-s;return h*h+f*f}var _p;l.PerformanceMarkers=void 0,(_p=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",_p.load="load",_p.fullLoad="fullLoad";let Ru=null,cc=[];const xp=1e3/60,vp="loadTime",bp="fullLoadTime",ib={mark(r){performance.mark(r)},frame(r){const e=r;Ru!=null&&cc.push(e-Ru),Ru=e},clearMetrics(){Ru=null,cc=[],performance.clearMeasures(vp),performance.clearMeasures(bp);for(const r in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure(vp,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(bp,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName(vp)[0].duration,e=performance.getEntriesByName(bp)[0].duration,i=cc.length,s=1/(cc.reduce((f,y)=>f+y,0)/i/1e3),h=cc.filter(f=>f>xp).reduce((f,y)=>f+(y-xp)/xp,0);return{loadTime:r,fullLoadTime:e,fps:s,percentDroppedFrames:h/(i+h)*100,totalFrames:i}}};l.AJAXError=Yr,l.ARRAY_TYPE=js,l.Actor=class{constructor(r,e,i){this.receive=s=>{const h=s.data,f=h.id;if(f&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){delete this.tasks[f];const y=this.cancelCallbacks[f];delete this.cancelCallbacks[f],y&&y()}else Mt()||h.mustQueue?(this.tasks[f]=h,this.taskQueue.push(f),this.invoker.trigger()):this.processTask(f,h)},this.process=()=>{if(!this.taskQueue.length)return;const s=this.taskQueue.shift(),h=this.tasks[s];delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),h&&this.processTask(s,h)},this.target=r,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new X1(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Mt()?r:window}send(r,e,i,s,h=!1){const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[f]=i);const y=Xt(this.globalScope)?void 0:[];return this.target.postMessage({id:f,type:r,hasCallback:!!i,targetMapId:s,mustQueue:h,sourceMapId:this.mapId,data:Oa(e,y)},y),{cancel:()=>{i&&delete this.callbacks[f],this.target.postMessage({id:f,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}processTask(r,e){if(e.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(e.error?i(To(e.error)):i(null,To(e.data)))}else{let i=!1;const s=Xt(this.globalScope)?void 0:[],h=e.hasCallback?(x,S)=>{i=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:x?Oa(x):null,data:Oa(S,s)},s)}:x=>{i=!0};let f=null;const y=To(e.data);if(this.parent[e.type])f=this.parent[e.type](e.sourceMapId,y,h);else if(this.parent.getWorkerSource){const x=e.type.split(".");f=this.parent.getWorkerSource(e.sourceMapId,x[0],y.source)[x[1]](y,h)}else h(new Error(`Could not find function ${e.type}`));!i&&f&&f.cancel&&(this.cancelCallbacks[r]=f.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=Hl,l.CanonicalTileID=dp,l.CollisionBoxArray=b,l.CollisionCircleLayoutArray=class extends Gl{},l.Color=ft,l.DEMData=Cg,l.DataConstantProperty=rt,l.DictionaryCoder=kg,l.EXTENT=gr,l.ErrorEvent=Gt,l.EvaluationParameters=sr,l.Event=Jr,l.Evented=br,l.FeatureIndex=Ag,l.FillBucket=Kd,l.FillExtrusionBucket=Yd,l.GeoJSONFeature=Ig,l.ImageAtlas=sg,l.ImagePosition=rp,l.KDBush=mp,l.LineBucket=Jd,l.LineStripIndexArray=class extends d{},l.LngLat=ia,l.MercatorCoordinate=Au,l.ONE_EM=$r,l.OverscaledTileID=di,l.PerformanceUtils=ib,l.Point=K,l.Pos3dArray=class extends qa{},l.PosArray=pe,l.Properties=wn,l.Protobuf=ep,l.QuadTriangleArray=class extends Us{},l.RGBAImage=hi,l.RasterBoundsArray=class extends Ga{},l.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},l.SegmentVector=lt,l.SymbolBucket=Ks,l.Transitionable=du,l.TriangleIndexArray=st,l.Uniform1f=Br,l.Uniform1i=class extends kr{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},l.Uniform2f=class extends kr{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},l.Uniform3f=class extends kr{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},l.Uniform4f=rn,l.UniformColor=Qo,l.UniformMatrix4f=class extends kr{constructor(r,e){super(r,e),this.current=Or}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},l.UnwrappedTileID=Tg,l.ValidationError=Fe,l.ZoomHistory=zl,l.addDynamicAttributes=ap,l.arrayBufferToImage=function(r,e){const i=new Image;i.onload=()=>{e(null,i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame(()=>{i.src=Vr})},i.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const s=new Blob([new Uint8Array(r)],{type:"image/png"});i.src=r.byteLength?URL.createObjectURL(s):Vr},l.arrayBufferToImageBitmap=function(r,e){const i=new Blob([new Uint8Array(r)],{type:"image/png"});createImageBitmap(i).then(s=>{e(null,s)}).catch(s=>{e(new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(r,e,i){if(!r.length)return i(null,[]);let s=r.length;const h=new Array(r.length);let f=null;r.forEach((y,x)=>{e(y,(S,C)=>{S&&(f=S),h[x]=C,--s==0&&i(f,h)})})},l.bezier=oe,l.browser=_n,l.clamp=ge,l.clipLine=zg,l.clone=function(r){var e=new js(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},l.clone$1=Ce,l.collisionCircleLayout=w1,l.config=Mn,l.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},l.create=function(){var r=new js(16);return js!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},l.createExpression=It,l.createFilter=Cl,l.createLayout=Cr,l.createStyleLayer=function(r){if(r.type==="custom")return new W1(r);switch(r.type){case"background":return new q1(r);case"circle":return new Av(r);case"fill":return new Kv(r);case"fill-extrusion":return new u1(r);case"heatmap":return new Mv(r);case"hillshade":return new Dv(r);case"line":return new _1(r);case"raster":return new Z1(r);case"symbol":return new Iu(r)}},l.deepEqual=function r(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(!r(e[s],i[s]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const s in e)if(!r(e[s],i[s]))return!1;return!0}return e===i},l.defaultEasing=_e,l.derefLayers=function(r){r=r.slice();const e=Object.create(null);for(let i=0;i<r.length;i++)e[r[i].id]=r[i];for(let i=0;i<r.length;i++)"ref"in r[i]&&(r[i]=Yn(r[i],e[r[i].ref]));return r},l.diffStyles=function(r,e){if(!r)return[{command:Lt.setStyle,args:[e]}];let i=[];try{if(!jt(r.version,e.version))return[{command:Lt.setStyle,args:[e]}];jt(r.center,e.center)||i.push({command:Lt.setCenter,args:[e.center]}),jt(r.zoom,e.zoom)||i.push({command:Lt.setZoom,args:[e.zoom]}),jt(r.bearing,e.bearing)||i.push({command:Lt.setBearing,args:[e.bearing]}),jt(r.pitch,e.pitch)||i.push({command:Lt.setPitch,args:[e.pitch]}),jt(r.sprite,e.sprite)||i.push({command:Lt.setSprite,args:[e.sprite]}),jt(r.glyphs,e.glyphs)||i.push({command:Lt.setGlyphs,args:[e.glyphs]}),jt(r.transition,e.transition)||i.push({command:Lt.setTransition,args:[e.transition]}),jt(r.light,e.light)||i.push({command:Lt.setLight,args:[e.light]});const s={},h=[];(function(y,x,S,C){let A;for(A in x=x||{},y=y||{})Object.prototype.hasOwnProperty.call(y,A)&&(Object.prototype.hasOwnProperty.call(x,A)||Ni(A,S,C));for(A in x)Object.prototype.hasOwnProperty.call(x,A)&&(Object.prototype.hasOwnProperty.call(y,A)?jt(y[A],x[A])||(y[A].type==="geojson"&&x[A].type==="geojson"&&xn(y,x,A)?S.push({command:Lt.setGeoJSONSourceData,args:[A,x[A].data]}):eo(A,x,S,C)):Ui(A,x,S))})(r.sources,e.sources,h,s);const f=[];r.layers&&r.layers.forEach(y=>{s[y.source]?i.push({command:Lt.removeLayer,args:[y.id]}):f.push(y)}),i=i.concat(h),function(y,x,S){x=x||[];const C=(y=y||[]).map(Ti),A=x.map(Ti),M=y.reduce(Vi,{}),R=x.reduce(Vi,{}),B=C.slice(),$=Object.create(null);let G,H,Q,ce,ne,he,fe;for(G=0,H=0;G<C.length;G++)Q=C[G],Object.prototype.hasOwnProperty.call(R,Q)?H++:(S.push({command:Lt.removeLayer,args:[Q]}),B.splice(B.indexOf(Q,H),1));for(G=0,H=0;G<A.length;G++)Q=A[A.length-1-G],B[B.length-1-G]!==Q&&(Object.prototype.hasOwnProperty.call(M,Q)?(S.push({command:Lt.removeLayer,args:[Q]}),B.splice(B.lastIndexOf(Q,B.length-H),1)):H++,he=B[B.length-G],S.push({command:Lt.addLayer,args:[R[Q],he]}),B.splice(B.length-G,0,Q),$[Q]=!0);for(G=0;G<A.length;G++)if(Q=A[G],ce=M[Q],ne=R[Q],!$[Q]&&!jt(ce,ne))if(jt(ce.source,ne.source)&&jt(ce["source-layer"],ne["source-layer"])&&jt(ce.type,ne.type)){for(fe in ar(ce.layout,ne.layout,S,Q,null,Lt.setLayoutProperty),ar(ce.paint,ne.paint,S,Q,null,Lt.setPaintProperty),jt(ce.filter,ne.filter)||S.push({command:Lt.setFilter,args:[Q,ne.filter]}),jt(ce.minzoom,ne.minzoom)&&jt(ce.maxzoom,ne.maxzoom)||S.push({command:Lt.setLayerZoomRange,args:[Q,ne.minzoom,ne.maxzoom]}),ce)Object.prototype.hasOwnProperty.call(ce,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?ar(ce[fe],ne[fe],S,Q,fe.slice(6),Lt.setPaintProperty):jt(ce[fe],ne[fe])||S.push({command:Lt.setLayerProperty,args:[Q,fe,ne[fe]]}));for(fe in ne)Object.prototype.hasOwnProperty.call(ne,fe)&&!Object.prototype.hasOwnProperty.call(ce,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?ar(ce[fe],ne[fe],S,Q,fe.slice(6),Lt.setPaintProperty):jt(ce[fe],ne[fe])||S.push({command:Lt.setLayerProperty,args:[Q,fe,ne[fe]]}))}else S.push({command:Lt.removeLayer,args:[Q]}),he=B[B.lastIndexOf(Q)+1],S.push({command:Lt.addLayer,args:[ne,he]})}(f,e.layers,i)}catch(s){console.warn("Unable to compute style diff:",s),i=[{command:Lt.setStyle,args:[e]}]}return i},l.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},l.earthRadius=up,l.emitValidationErrors=zs,l.emptyStyle=function(){const r={},e=ve.$version;for(const i in ve.$root){const s=ve.$root[i];if(s.required){let h=null;h=i==="version"?e:s.type==="array"?[]:{},h!=null&&(r[i]=h)}}return r},l.equals=function(r,e){var i=r[0],s=r[1],h=r[2],f=r[3],y=r[4],x=r[5],S=r[6],C=r[7],A=r[8],M=r[9],R=r[10],B=r[11],$=r[12],G=r[13],H=r[14],Q=r[15],ce=e[0],ne=e[1],he=e[2],fe=e[3],we=e[4],Ge=e[5],et=e[6],qe=e[7],Ne=e[8],Le=e[9],Ke=e[10],Oe=e[11],Pe=e[12],ct=e[13],tt=e[14],bt=e[15];return Math.abs(i-ce)<=En*Math.max(1,Math.abs(i),Math.abs(ce))&&Math.abs(s-ne)<=En*Math.max(1,Math.abs(s),Math.abs(ne))&&Math.abs(h-he)<=En*Math.max(1,Math.abs(h),Math.abs(he))&&Math.abs(f-fe)<=En*Math.max(1,Math.abs(f),Math.abs(fe))&&Math.abs(y-we)<=En*Math.max(1,Math.abs(y),Math.abs(we))&&Math.abs(x-Ge)<=En*Math.max(1,Math.abs(x),Math.abs(Ge))&&Math.abs(S-et)<=En*Math.max(1,Math.abs(S),Math.abs(et))&&Math.abs(C-qe)<=En*Math.max(1,Math.abs(C),Math.abs(qe))&&Math.abs(A-Ne)<=En*Math.max(1,Math.abs(A),Math.abs(Ne))&&Math.abs(M-Le)<=En*Math.max(1,Math.abs(M),Math.abs(Le))&&Math.abs(R-Ke)<=En*Math.max(1,Math.abs(R),Math.abs(Ke))&&Math.abs(B-Oe)<=En*Math.max(1,Math.abs(B),Math.abs(Oe))&&Math.abs($-Pe)<=En*Math.max(1,Math.abs($),Math.abs(Pe))&&Math.abs(G-ct)<=En*Math.max(1,Math.abs(G),Math.abs(ct))&&Math.abs(H-tt)<=En*Math.max(1,Math.abs(H),Math.abs(tt))&&Math.abs(Q-bt)<=En*Math.max(1,Math.abs(Q),Math.abs(bt))},l.evaluateSizeForFeature=function(r,{uSize:e,uSizeT:i},{lowerSize:s,upperSize:h}){return r.kind==="source"?s/uo:r.kind==="composite"?Fn.number(s/uo,h/uo,i):e},l.evaluateSizeForZoom=function(r,e){let i=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:f,maxZoom:y}=r,x=h?ge(Bn.interpolationFactor(h,e,f,y),0,1):0;r.kind==="camera"?s=Fn.number(r.minSize,r.maxSize,x):i=x}return{uSizeT:i,uSize:s}},l.evented=$l,l.extend=De,l.filterObject=Re,l.findLineIntersection=function(r,e,i,s){const h=e.y-r.y,f=e.x-r.x,y=s.y-i.y,x=s.x-i.x,S=y*f-x*h;if(S===0)return null;const C=(x*(r.y-i.y)-y*(r.x-i.x))/S;return new K(r.x+C*f,r.y+C*h)},l.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},l.getAnchorAlignment=ip,l.getAnchorJustification=fp,l.getArrayBuffer=Hn,l.getDefaultExportFromCjs=O,l.getJSON=function(r,e){return ai(De(r,{type:"json"}),e)},l.getOverlapMode=op,l.getProtocolAction=Ar,l.getRTLTextPluginStatus=Ul,l.getReferrer=Ct,l.getVideo=function(r,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let s=0;s<r.length;s++){const h=window.document.createElement("source");$i(r[s])||(i.crossOrigin="Anonymous"),h.src=r[s],i.appendChild(h)}return{cancel:()=>{}}},l.groupByLayout=function(r,e){const i={};for(let h=0;h<r.length;h++){const f=e&&e[r[h].id]||Id(r[h]);e&&(e[r[h].id]=f);let y=i[f];y||(y=i[f]=[]),y.push(r[h])}const s=[];for(const h in i)s.push(i[h]);return s},l.identity=$d,l.interpolate=Fn,l.invert=function(r,e){var i=e[0],s=e[1],h=e[2],f=e[3],y=e[4],x=e[5],S=e[6],C=e[7],A=e[8],M=e[9],R=e[10],B=e[11],$=e[12],G=e[13],H=e[14],Q=e[15],ce=i*x-s*y,ne=i*S-h*y,he=i*C-f*y,fe=s*S-h*x,we=s*C-f*x,Ge=h*C-f*S,et=A*G-M*$,qe=A*H-R*$,Ne=A*Q-B*$,Le=M*H-R*G,Ke=M*Q-B*G,Oe=R*Q-B*H,Pe=ce*Oe-ne*Ke+he*Le+fe*Ne-we*qe+Ge*et;return Pe?(r[0]=(x*Oe-S*Ke+C*Le)*(Pe=1/Pe),r[1]=(h*Ke-s*Oe-f*Le)*Pe,r[2]=(G*Ge-H*we+Q*fe)*Pe,r[3]=(R*we-M*Ge-B*fe)*Pe,r[4]=(S*Ne-y*Oe-C*qe)*Pe,r[5]=(i*Oe-h*Ne+f*qe)*Pe,r[6]=(H*he-$*Ge-Q*ne)*Pe,r[7]=(A*Ge-R*he+B*ne)*Pe,r[8]=(y*Ke-x*Ne+C*et)*Pe,r[9]=(s*Ne-i*Ke-f*et)*Pe,r[10]=($*we-G*he+Q*ce)*Pe,r[11]=(M*he-A*we-B*ce)*Pe,r[12]=(x*qe-y*Le-S*et)*Pe,r[13]=(i*Le-s*qe+h*et)*Pe,r[14]=(G*ne-$*fe-H*ce)*Pe,r[15]=(A*fe-M*ne+R*ce)*Pe,r):null},l.isImageBitmap=Lr,l.isSafari=Xt,l.isWorker=Mt,l.keysDifference=function(r,e){const i=[];for(const s in r)s in e||i.push(s);return i},l.lazyLoadRTLTextPlugin=function(){ti.isLoading()||ti.isLoaded()||Ul()!=="deferred"||hu()},l.makeRequest=ai,l.mapObject=Me,l.mercatorXfromLng=bg,l.mercatorYfromLat=wg,l.mercatorZfromAltitude=Sg,l.mul=Iv,l.mul$1=function(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r[3]=e[3]*i[3],r},l.multiply=Cm,l.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},l.operations=Lt,l.ortho=function(r,e,i,s,h,f,y){var x=1/(e-i),S=1/(s-h),C=1/(f-y);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*S,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*C,r[11]=0,r[12]=(e+i)*x,r[13]=(h+s)*S,r[14]=(y+f)*C,r[15]=1,r},l.parseCacheControl=function(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,h,f)=>{const y=h||f;return e[s]=!y||y.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},l.parseGlyphPbf=function(r){return new ep(r).readFields(D1,[])},l.pbf=Jm,l.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=gr/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0],i=e.layout,s=e._unevaluatedLayout._values,h={layoutIconSize:s["icon-size"].possiblyEvaluate(new sr(r.bucket.zoom+1),r.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new sr(r.bucket.zoom+1),r.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new sr(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:A}=r.bucket.textSizeData;h.compositeTextSizes=[s["text-size"].possiblyEvaluate(new sr(C),r.canonical),s["text-size"].possiblyEvaluate(new sr(A),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:A}=r.bucket.iconSizeData;h.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new sr(C),r.canonical),s["icon-size"].possiblyEvaluate(new sr(A),r.canonical)]}const f=i.get("text-line-height")*$r,y=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",x=i.get("text-keep-upright"),S=i.get("text-size");for(const C of r.bucket.features){const A=i.get("text-font").evaluate(C,{},r.canonical).join(","),M=S.evaluate(C,{},r.canonical),R=h.layoutTextSize.evaluate(C,{},r.canonical),B=h.layoutIconSize.evaluate(C,{},r.canonical),$={horizontal:{},vertical:void 0},G=C.text;let H,Q=[0,0];if(G){const he=G.toString(),fe=i.get("text-letter-spacing").evaluate(C,{},r.canonical)*$r,we=cu(he)?fe:0,Ge=i.get("text-anchor").evaluate(C,{},r.canonical),et=Ng(e,C,r.canonical);if(!et){const Oe=i.get("text-radial-offset").evaluate(C,{},r.canonical);Q=Oe?Ug(Ge,[Oe*$r,pp]):i.get("text-offset").evaluate(C,{},r.canonical).map(Pe=>Pe*$r)}let qe=y?"center":i.get("text-justify").evaluate(C,{},r.canonical);const Ne=i.get("symbol-placement"),Le=Ne==="point"?i.get("text-max-width").evaluate(C,{},r.canonical)*$r:0,Ke=()=>{r.bucket.allowVerticalPlacement&&Ds(he)&&($.vertical=Tu(G,r.glyphMap,r.glyphPositions,r.imagePositions,A,Le,f,Ge,"left",we,Q,l.WritingMode.vertical,!0,Ne,R,M))};if(!y&&et){const Oe=new Set;if(qe==="auto")for(let ct=0;ct<et.values.length;ct+=2)Oe.add(fp(et.values[ct]));else Oe.add(qe);let Pe=!1;for(const ct of Oe)if(!$.horizontal[ct])if(Pe)$.horizontal[ct]=$.horizontal[0];else{const tt=Tu(G,r.glyphMap,r.glyphPositions,r.imagePositions,A,Le,f,"center",ct,we,Q,l.WritingMode.horizontal,!1,Ne,R,M);tt&&($.horizontal[ct]=tt,Pe=tt.positionedLines.length===1)}Ke()}else{qe==="auto"&&(qe=fp(Ge));const Oe=Tu(G,r.glyphMap,r.glyphPositions,r.imagePositions,A,Le,f,Ge,qe,we,Q,l.WritingMode.horizontal,!1,Ne,R,M);Oe&&($.horizontal[qe]=Oe),Ke(),Ds(he)&&y&&x&&($.vertical=Tu(G,r.glyphMap,r.glyphPositions,r.imagePositions,A,Le,f,Ge,qe,we,Q,l.WritingMode.vertical,!1,Ne,R,M))}}let ce=!1;if(C.icon&&C.icon.name){const he=r.imageMap[C.icon.name];he&&(H=$1(r.imagePositions[C.icon.name],i.get("icon-offset").evaluate(C,{},r.canonical),i.get("icon-anchor").evaluate(C,{},r.canonical)),ce=!!he.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=ce:r.bucket.sdfIcons!==ce&&yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(he.pixelRatio!==r.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ne=jg($.horizontal)||$.vertical;r.bucket.iconsInText=!!ne&&ne.iconsInText,(ne||H)&&rb(r.bucket,C,$,H,r.imageMap,h,R,B,Q,ce,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},l.perspective=function(r,e,i,s,h){var f,y=1/Math.tan(e/2);return r[0]=y/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+s)*(f=1/(s-h)),r[14]=2*h*s*f):(r[10]=-1,r[14]=-2*s),r},l.pick=function(r,e){const i={};for(let s=0;s<e.length;s++){const h=e[s];h in r&&(i[h]=r[h])}return i},l.plugin=ti,l.pointGeometry=D,l.polygonIntersectsPolygon=vm,l.potpack=ag,l.register=Xe,l.registerForPluginStateChange=function(r){return r({pluginStatus:bn,pluginURL:ao}),$l.on("pluginStateChange",r),r},l.renderColorRamp=Mm,l.rotateX=function(r,e,i){var s=Math.sin(i),h=Math.cos(i),f=e[4],y=e[5],x=e[6],S=e[7],C=e[8],A=e[9],M=e[10],R=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=f*h+C*s,r[5]=y*h+A*s,r[6]=x*h+M*s,r[7]=S*h+R*s,r[8]=C*h-f*s,r[9]=A*h-y*s,r[10]=M*h-x*s,r[11]=R*h-S*s,r},l.rotateZ=function(r,e,i){var s=Math.sin(i),h=Math.cos(i),f=e[0],y=e[1],x=e[2],S=e[3],C=e[4],A=e[5],M=e[6],R=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=f*h+C*s,r[1]=y*h+A*s,r[2]=x*h+M*s,r[3]=S*h+R*s,r[4]=C*h-f*s,r[5]=A*h-y*s,r[6]=M*h-x*s,r[7]=R*h-S*s,r},l.sameOrigin=$i,l.scale=function(r,e,i){var s=i[0],h=i[1],f=i[2];return r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r[3]=e[3]*s,r[4]=e[4]*h,r[5]=e[5]*h,r[6]=e[6]*h,r[7]=e[7]*h,r[8]=e[8]*f,r[9]=e[9]*f,r[10]=e[10]*f,r[11]=e[11]*f,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},l.setRTLTextPlugin=function(r,e,i=!1){if(bn===Rl||bn===Na||bn===Ll)throw new Error("setRTLTextPlugin cannot be called multiple times.");ao=_n.resolveURL(r),bn=Rl,Fl=e,Ol(),i||hu()},l.sphericalToCartesian=function([r,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(i),y:r*Math.sin(e)*Math.sin(i),z:r*Math.cos(i)}},l.toEvaluationFeature=co,l.transformMat4=_u,l.translate=function(r,e,i){var s,h,f,y,x,S,C,A,M,R,B,$,G=i[0],H=i[1],Q=i[2];return e===r?(r[12]=e[0]*G+e[4]*H+e[8]*Q+e[12],r[13]=e[1]*G+e[5]*H+e[9]*Q+e[13],r[14]=e[2]*G+e[6]*H+e[10]*Q+e[14],r[15]=e[3]*G+e[7]*H+e[11]*Q+e[15]):(h=e[1],f=e[2],y=e[3],x=e[4],S=e[5],C=e[6],A=e[7],M=e[8],R=e[9],B=e[10],$=e[11],r[0]=s=e[0],r[1]=h,r[2]=f,r[3]=y,r[4]=x,r[5]=S,r[6]=C,r[7]=A,r[8]=M,r[9]=R,r[10]=B,r[11]=$,r[12]=s*G+x*H+M*Q+e[12],r[13]=h*G+S*H+R*Q+e[13],r[14]=f*G+C*H+B*Q+e[14],r[15]=y*G+A*H+$*Q+e[15]),r},l.triggerPluginCompletionEvent=Bl,l.unicodeBlockLookup=je,l.uniqueId=function(){return We++},l.v8Spec=ve,l.validateCustomStyleLayer=function(r){const e=[],i=r.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateLight=Ad,l.validateStyle=La,l.vectorTile=ta,l.warnOnce=yt,l.wrap=Ie}),w(["./shared"],function(l){class O{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,L){for(const Y of z){this._layerConfigs[Y.id]=Y;const ee=this._layers[Y.id]=l.createStyleLayer(Y);ee._featureFilter=l.createFilter(ee.filter),this.keyCache[Y.id]&&delete this.keyCache[Y.id]}for(const Y of L)delete this.keyCache[Y],delete this._layerConfigs[Y],delete this._layers[Y];this.familiesBySource={};const U=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const Y of U){const ee=Y.map(Ee=>this._layers[Ee.id]),le=ee[0];if(le.visibility==="none")continue;const re=le.source||"";let te=this.familiesBySource[re];te||(te=this.familiesBySource[re]={});const ue=le.sourceLayer||"_geojsonTileLayer";let Se=te[ue];Se||(Se=te[ue]=[]),Se.push(ee)}}}class D{constructor(z){const L={},U=[];for(const re in z){const te=z[re],ue=L[re]={};for(const Se in te){const Ee=te[+Se];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const Te={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};U.push(Te),ue[Se]={rect:Te,metrics:Ee.metrics}}}const{w:Y,h:ee}=l.potpack(U),le=new l.AlphaImage({width:Y||1,height:ee||1});for(const re in z){const te=z[re];for(const ue in te){const Se=te[+ue];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const Ee=L[re][ue].rect;l.AlphaImage.copy(Se.bitmap,le,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},Se.bitmap)}}this.image=le,this.positions=L}}l.register("GlyphAtlas",D);class V{constructor(z){this.tileID=new l.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(z,L,U,Y,ee){this.status="parsing",this.data=z,this.collisionBoxArray=new l.CollisionBoxArray;const le=new l.DictionaryCoder(Object.keys(z.layers).sort()),re=new l.FeatureIndex(this.tileID,this.promoteId);re.bucketLayerIDs=[];const te={},ue={featureIndex:re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:U},Se=L.familiesBySource[this.source];for(const kt in Se){const zt=z.layers[kt];if(!zt)continue;zt.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const vn=le.encode(kt),ft=[];for(let Pr=0;Pr<zt.length;Pr++){const Wr=zt.feature(Pr),wr=re.getId(Wr,kt);ft.push({feature:Wr,id:wr,index:Pr,sourceLayerIndex:vn})}for(const Pr of Se[kt]){const Wr=Pr[0];Wr.source!==this.source&&l.warnOnce(`layer.source = ${Wr.source} does not equal this.source = ${this.source}`),Wr.minzoom&&this.zoom<Math.floor(Wr.minzoom)||Wr.maxzoom&&this.zoom>=Wr.maxzoom||Wr.visibility!=="none"&&(K(Pr,this.zoom,U),(te[Wr.id]=Wr.createBucket({index:re.bucketLayerIDs.length,layers:Pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vn,sourceID:this.source})).populate(ft,ue,this.tileID.canonical),re.bucketLayerIDs.push(Pr.map(wr=>wr.id)))}}let Ee,Te,ht,gt;const Je=l.mapObject(ue.glyphDependencies,kt=>Object.keys(kt).map(Number));this.inFlightDependencies.forEach(kt=>kt==null?void 0:kt.cancel()),this.inFlightDependencies=[];const at=++this.dependencySentinel;Object.keys(Je).length?this.inFlightDependencies.push(Y.send("getGlyphs",{uid:this.uid,stacks:Je,source:this.source,tileID:this.tileID,type:"glyphs"},(kt,zt)=>{at===this.dependencySentinel&&(Ee||(Ee=kt,Te=zt,Kt.call(this)))})):Te={};const mt=Object.keys(ue.iconDependencies);mt.length?this.inFlightDependencies.push(Y.send("getImages",{icons:mt,source:this.source,tileID:this.tileID,type:"icons"},(kt,zt)=>{at===this.dependencySentinel&&(Ee||(Ee=kt,ht=zt,Kt.call(this)))})):ht={};const Dt=Object.keys(ue.patternDependencies);function Kt(){if(Ee)return ee(Ee);if(Te&&ht&&gt){const kt=new D(Te),zt=new l.ImageAtlas(ht,gt);for(const vn in te){const ft=te[vn];ft instanceof l.SymbolBucket?(K(ft.layers,this.zoom,U),l.performSymbolLayout({bucket:ft,glyphMap:Te,glyphPositions:kt.positions,imageMap:ht,imagePositions:zt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):ft.hasPattern&&(ft instanceof l.LineBucket||ft instanceof l.FillBucket||ft instanceof l.FillExtrusionBucket)&&(K(ft.layers,this.zoom,U),ft.addFeatures(ue,this.tileID.canonical,zt.patternPositions))}this.status="done",ee(null,{buckets:Object.values(te).filter(vn=>!vn.isEmpty()),featureIndex:re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:kt.image,imageAtlas:zt,glyphMap:this.returnDependencies?Te:null,iconMap:this.returnDependencies?ht:null,glyphPositions:this.returnDependencies?kt.positions:null})}}Dt.length?this.inFlightDependencies.push(Y.send("getImages",{icons:Dt,source:this.source,tileID:this.tileID,type:"patterns"},(kt,zt)=>{at===this.dependencySentinel&&(Ee||(Ee=kt,gt=zt,Kt.call(this)))})):gt={},Kt.call(this)}}function K(X,z,L){const U=new l.EvaluationParameters(z);for(const Y of X)Y.recalculate(U,L)}function ae(X,z){const L=l.getArrayBuffer(X.request,(U,Y,ee,le)=>{U?z(U):Y&&z(null,{vectorTile:new l.vectorTile.VectorTile(new l.Protobuf(Y)),rawData:Y,cacheControl:ee,expires:le})});return()=>{L.cancel(),z()}}class de{constructor(z,L,U,Y){this.actor=z,this.layerIndex=L,this.availableImages=U,this.loadVectorData=Y||ae,this.fetching={},this.loading={},this.loaded={}}loadTile(z,L){const U=z.uid;this.loading||(this.loading={});const Y=!!(z&&z.request&&z.request.collectResourceTiming)&&new l.RequestPerformance(z.request),ee=this.loading[U]=new V(z);ee.abort=this.loadVectorData(z,(le,re)=>{if(delete this.loading[U],le||!re)return ee.status="done",this.loaded[U]=ee,L(le);const te=re.rawData,ue={};re.expires&&(ue.expires=re.expires),re.cacheControl&&(ue.cacheControl=re.cacheControl);const Se={};if(Y){const Ee=Y.finish();Ee&&(Se.resourceTiming=JSON.parse(JSON.stringify(Ee)))}ee.vectorTile=re.vectorTile,ee.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ee,Te)=>{if(delete this.fetching[U],Ee||!Te)return L(Ee);L(null,l.extend({rawTileData:te.slice(0)},Te,ue,Se))}),this.loaded=this.loaded||{},this.loaded[U]=ee,this.fetching[U]={rawTileData:te,cacheControl:ue,resourceTiming:Se}})}reloadTile(z,L){const U=this.loaded,Y=z.uid;if(U&&U[Y]){const ee=U[Y];ee.showCollisionBoxes=z.showCollisionBoxes,ee.status==="parsing"?ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,(le,re)=>{if(le||!re)return L(le,re);let te;if(this.fetching[Y]){const{rawTileData:ue,cacheControl:Se,resourceTiming:Ee}=this.fetching[Y];delete this.fetching[Y],te=l.extend({rawTileData:ue.slice(0)},re,Se,Ee)}else te=re;L(null,te)}):ee.status==="done"&&(ee.vectorTile?ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,L):L())}}abortTile(z,L){const U=this.loading,Y=z.uid;U&&U[Y]&&U[Y].abort&&(U[Y].abort(),delete U[Y]),L()}removeTile(z,L){const U=this.loaded,Y=z.uid;U&&U[Y]&&delete U[Y],L()}}class xe{constructor(){this.loaded={}}loadTile(z,L){const{uid:U,encoding:Y,rawImageData:ee}=z,le=l.isImageBitmap(ee)?this.getImageData(ee):ee,re=new l.DEMData(U,le,Y);this.loaded=this.loaded||{},this.loaded[U]=re,L(null,re)}getImageData(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);const L=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:L.width,height:L.height},L.data)}removeTile(z){const L=this.loaded,U=z.uid;L&&L[U]&&delete L[U]}}function oe(X,z){if(X.length!==0){_e(X[0],z);for(var L=1;L<X.length;L++)_e(X[L],!z)}}function _e(X,z){for(var L=0,U=0,Y=0,ee=X.length,le=ee-1;Y<ee;le=Y++){var re=(X[Y][0]-X[le][0])*(X[le][1]+X[Y][1]),te=L+re;U+=Math.abs(L)>=Math.abs(re)?L-te+re:re-te+L,L=te}L+U>=0!=!!z&&X.reverse()}var ge=l.getDefaultExportFromCjs(function X(z,L){var U,Y=z&&z.type;if(Y==="FeatureCollection")for(U=0;U<z.features.length;U++)X(z.features[U],L);else if(Y==="GeometryCollection")for(U=0;U<z.geometries.length;U++)X(z.geometries[U],L);else if(Y==="Feature")X(z.geometry,L);else if(Y==="Polygon")oe(z.coordinates,L);else if(Y==="MultiPolygon")for(U=0;U<z.coordinates.length;U++)oe(z.coordinates[U],L);return z});const Ie=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var De={exports:{}},We=l.pointGeometry,Me=l.vectorTile.VectorTileFeature,Re=Ce;function Ce(X,z){this.options=z||{},this.features=X,this.length=X.length}function Ze(X,z){this.id=typeof X.id=="number"?X.id:void 0,this.type=X.type,this.rawGeometry=X.type===1?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=z||4096}Ce.prototype.feature=function(X){return new Ze(this.features[X],this.options.extent)},Ze.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var z=0;z<X.length;z++){for(var L=X[z],U=[],Y=0;Y<L.length;Y++)U.push(new We(L[Y][0],L[Y][1]));this.geometry.push(U)}return this.geometry},Ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,z=1/0,L=-1/0,U=1/0,Y=-1/0,ee=0;ee<X.length;ee++)for(var le=X[ee],re=0;re<le.length;re++){var te=le[re];z=Math.min(z,te.x),L=Math.max(L,te.x),U=Math.min(U,te.y),Y=Math.max(Y,te.y)}return[z,U,L,Y]},Ze.prototype.toGeoJSON=Me.prototype.toGeoJSON;var yt=l.pbf,$e=Re;function Ot(X){var z=new yt;return function(L,U){for(var Y in L.layers)U.writeMessage(3,Mt,L.layers[Y])}(X,z),z.finish()}function Mt(X,z){var L;z.writeVarintField(15,X.version||1),z.writeStringField(1,X.name||""),z.writeVarintField(5,X.extent||4096);var U={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<X.length;L++)U.feature=X.feature(L),z.writeMessage(2,or,U);var Y=U.keys;for(L=0;L<Y.length;L++)z.writeStringField(3,Y[L]);var ee=U.values;for(L=0;L<ee.length;L++)z.writeMessage(4,yn,ee[L])}function or(X,z){var L=X.feature;L.id!==void 0&&z.writeVarintField(1,L.id),z.writeMessage(2,Xt,X),z.writeVarintField(3,L.type),z.writeMessage(4,gn,L)}function Xt(X,z){var L=X.feature,U=X.keys,Y=X.values,ee=X.keycache,le=X.valuecache;for(var re in L.properties){var te=L.properties[re],ue=ee[re];if(te!==null){ue===void 0&&(U.push(re),ee[re]=ue=U.length-1),z.writeVarint(ue);var Se=typeof te;Se!=="string"&&Se!=="boolean"&&Se!=="number"&&(te=JSON.stringify(te));var Ee=Se+":"+te,Te=le[Ee];Te===void 0&&(Y.push(te),le[Ee]=Te=Y.length-1),z.writeVarint(Te)}}}function Lr(X,z){return(z<<3)+(7&X)}function Vr(X){return X<<1^X>>31}function gn(X,z){for(var L=X.loadGeometry(),U=X.type,Y=0,ee=0,le=L.length,re=0;re<le;re++){var te=L[re],ue=1;U===1&&(ue=te.length),z.writeVarint(Lr(1,ue));for(var Se=U===3?te.length-1:te.length,Ee=0;Ee<Se;Ee++){Ee===1&&U!==1&&z.writeVarint(Lr(2,Se-1));var Te=te[Ee].x-Y,ht=te[Ee].y-ee;z.writeVarint(Vr(Te)),z.writeVarint(Vr(ht)),Y+=Te,ee+=ht}U===3&&z.writeVarint(Lr(7,1))}}function yn(X,z){var L=typeof X;L==="string"?z.writeStringField(1,X):L==="boolean"?z.writeBooleanField(7,X):L==="number"&&(X%1!=0?z.writeDoubleField(3,X):X<0?z.writeSVarintField(6,X):z.writeVarintField(5,X))}De.exports=Ot,De.exports.fromVectorTileJs=Ot,De.exports.fromGeojsonVt=function(X,z){z=z||{};var L={};for(var U in X)L[U]=new $e(X[U].features,z),L[U].name=U,L[U].version=z.version,L[U].extent=z.extent;return Ot({layers:L})},De.exports.GeoJSONWrapper=$e;var _n=l.getDefaultExportFromCjs(De.exports);const Mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},Yr=Math.fround||(Ct=new Float32Array(1),X=>(Ct[0]=+X,Ct[0]));var Ct;const Ar=3,Jt=5,ai=6;class Hn{constructor(z){this.options=Object.assign(Object.create(Mn),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){const{log:L,minZoom:U,maxZoom:Y}=this.options;L&&console.time("total time");const ee=`prepare ${z.length} points`;L&&console.time(ee),this.points=z;const le=[];for(let te=0;te<z.length;te++){const ue=z[te];if(!ue.geometry)continue;const[Se,Ee]=ue.geometry.coordinates,Te=Yr(zn(Se)),ht=Yr(Jr(Ee));le.push(Te,ht,1/0,te,-1,1),this.options.reduce&&le.push(0)}let re=this.trees[Y+1]=this._createTree(le);L&&console.timeEnd(ee);for(let te=Y;te>=U;te--){const ue=+Date.now();re=this.trees[te]=this._createTree(this._cluster(re,te)),L&&console.log("z%d: %d clusters in %dms",te,re.numItems,+Date.now()-ue)}return L&&console.timeEnd("total time"),this}getClusters(z,L){let U=((z[0]+180)%360+360)%360-180;const Y=Math.max(-90,Math.min(90,z[1]));let ee=z[2]===180?180:((z[2]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)U=-180,ee=180;else if(U>ee){const Ee=this.getClusters([U,Y,180,le],L),Te=this.getClusters([-180,Y,ee,le],L);return Ee.concat(Te)}const re=this.trees[this._limitZoom(L)],te=re.range(zn(U),Jr(le),zn(ee),Jr(Y)),ue=re.data,Se=[];for(const Ee of te){const Te=this.stride*Ee;Se.push(ue[Te+Jt]>1?$i(ue,Te,this.clusterProps):this.points[ue[Te+Ar]])}return Se}getChildren(z){const L=this._getOriginId(z),U=this._getOriginZoom(z),Y="No cluster with the specified id.",ee=this.trees[U];if(!ee)throw new Error(Y);const le=ee.data;if(L*this.stride>=le.length)throw new Error(Y);const re=this.options.radius/(this.options.extent*Math.pow(2,U-1)),te=ee.within(le[L*this.stride],le[L*this.stride+1],re),ue=[];for(const Se of te){const Ee=Se*this.stride;le[Ee+4]===z&&ue.push(le[Ee+Jt]>1?$i(le,Ee,this.clusterProps):this.points[le[Ee+Ar]])}if(ue.length===0)throw new Error(Y);return ue}getLeaves(z,L,U){const Y=[];return this._appendLeaves(Y,z,L=L||10,U=U||0,0),Y}getTile(z,L,U){const Y=this.trees[this._limitZoom(z)],ee=Math.pow(2,z),{extent:le,radius:re}=this.options,te=re/le,ue=(U-te)/ee,Se=(U+1+te)/ee,Ee={features:[]};return this._addTileFeatures(Y.range((L-te)/ee,ue,(L+1+te)/ee,Se),Y.data,L,U,ee,Ee),L===0&&this._addTileFeatures(Y.range(1-te/ee,ue,1,Se),Y.data,ee,U,ee,Ee),L===ee-1&&this._addTileFeatures(Y.range(0,ue,te/ee,Se),Y.data,-1,U,ee,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom(z){let L=this._getOriginZoom(z)-1;for(;L<=this.options.maxZoom;){const U=this.getChildren(z);if(L++,U.length!==1)break;z=U[0].properties.cluster_id}return L}_appendLeaves(z,L,U,Y,ee){const le=this.getChildren(L);for(const re of le){const te=re.properties;if(te&&te.cluster?ee+te.point_count<=Y?ee+=te.point_count:ee=this._appendLeaves(z,te.cluster_id,U,Y,ee):ee<Y?ee++:z.push(re),z.length===U)break}return ee}_createTree(z){const L=new l.KDBush(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let U=0;U<z.length;U+=this.stride)L.add(z[U],z[U+1]);return L.finish(),L.data=z,L}_addTileFeatures(z,L,U,Y,ee,le){for(const re of z){const te=re*this.stride,ue=L[te+Jt]>1;let Se,Ee,Te;if(ue)Se=Qi(L,te,this.clusterProps),Ee=L[te],Te=L[te+1];else{const Je=this.points[L[te+Ar]];Se=Je.properties;const[at,mt]=Je.geometry.coordinates;Ee=zn(at),Te=Jr(mt)}const ht={type:1,geometry:[[Math.round(this.options.extent*(Ee*ee-U)),Math.round(this.options.extent*(Te*ee-Y))]],tags:Se};let gt;gt=ue||this.options.generateId?L[te+Ar]:this.points[L[te+Ar]].id,gt!==void 0&&(ht.id=gt),le.features.push(ht)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,L){const{radius:U,extent:Y,reduce:ee,minPoints:le}=this.options,re=U/(Y*Math.pow(2,L)),te=z.data,ue=[],Se=this.stride;for(let Ee=0;Ee<te.length;Ee+=Se){if(te[Ee+2]<=L)continue;te[Ee+2]=L;const Te=te[Ee],ht=te[Ee+1],gt=z.within(te[Ee],te[Ee+1],re),Je=te[Ee+Jt];let at=Je;for(const mt of gt){const Dt=mt*Se;te[Dt+2]>L&&(at+=te[Dt+Jt])}if(at>Je&&at>=le){let mt,Dt=Te*Je,Kt=ht*Je,kt=-1;const zt=((Ee/Se|0)<<5)+(L+1)+this.points.length;for(const vn of gt){const ft=vn*Se;if(te[ft+2]<=L)continue;te[ft+2]=L;const Pr=te[ft+Jt];Dt+=te[ft]*Pr,Kt+=te[ft+1]*Pr,te[ft+4]=zt,ee&&(mt||(mt=this._map(te,Ee,!0),kt=this.clusterProps.length,this.clusterProps.push(mt)),ee(mt,this._map(te,ft)))}te[Ee+4]=zt,ue.push(Dt/at,Kt/at,1/0,zt,-1,at),ee&&ue.push(kt)}else{for(let mt=0;mt<Se;mt++)ue.push(te[Ee+mt]);if(at>1)for(const mt of gt){const Dt=mt*Se;if(!(te[Dt+2]<=L)){te[Dt+2]=L;for(let Kt=0;Kt<Se;Kt++)ue.push(te[Dt+Kt])}}}}return ue}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,L,U){if(z[L+Jt]>1){const le=this.clusterProps[z[L+ai]];return U?Object.assign({},le):le}const Y=this.points[z[L+Ar]].properties,ee=this.options.map(Y);return U&&ee===Y?Object.assign({},ee):ee}}function $i(X,z,L){return{type:"Feature",id:X[z+Ar],properties:Qi(X,z,L),geometry:{type:"Point",coordinates:[(U=X[z],360*(U-.5)),Gt(X[z+1])]}};var U}function Qi(X,z,L){const U=X[z+Jt],Y=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U,ee=X[z+ai],le=ee===-1?{}:Object.assign({},L[ee]);return Object.assign(le,{cluster:!0,cluster_id:X[z+Ar],point_count:U,point_count_abbreviated:Y})}function zn(X){return X/360+.5}function Jr(X){const z=Math.sin(X*Math.PI/180),L=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return L<0?0:L>1?1:L}function Gt(X){const z=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function br(X,z,L,U){for(var Y,ee=U,le=L-z>>1,re=L-z,te=X[z],ue=X[z+1],Se=X[L],Ee=X[L+1],Te=z+3;Te<L;Te+=3){var ht=ve(X[Te],X[Te+1],te,ue,Se,Ee);if(ht>ee)Y=Te,ee=ht;else if(ht===ee){var gt=Math.abs(Te-le);gt<re&&(Y=Te,re=gt)}}ee>U&&(Y-z>3&&br(X,z,Y,U),X[Y+2]=ee,L-Y>3&&br(X,Y,L,U))}function ve(X,z,L,U,Y,ee){var le=Y-L,re=ee-U;if(le!==0||re!==0){var te=((X-L)*le+(z-U)*re)/(le*le+re*re);te>1?(L=Y,U=ee):te>0&&(L+=le*te,U+=re*te)}return(le=X-L)*le+(re=z-U)*re}function Dn(X,z,L,U){var Y={id:X===void 0?null:X,type:z,geometry:L,tags:U,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ee){var le=ee.geometry,re=ee.type;if(re==="Point"||re==="MultiPoint"||re==="LineString")Yn(ee,le);else if(re==="Polygon"||re==="MultiLineString")for(var te=0;te<le.length;te++)Yn(ee,le[te]);else if(re==="MultiPolygon")for(te=0;te<le.length;te++)for(var ue=0;ue<le[te].length;ue++)Yn(ee,le[te][ue])}(Y),Y}function Yn(X,z){for(var L=0;L<z.length;L+=3)X.minX=Math.min(X.minX,z[L]),X.minY=Math.min(X.minY,z[L+1]),X.maxX=Math.max(X.maxX,z[L]),X.maxY=Math.max(X.maxY,z[L+1])}function jt(X,z,L,U){if(z.geometry){var Y=z.geometry.coordinates,ee=z.geometry.type,le=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),re=[],te=z.id;if(L.promoteId?te=z.properties[L.promoteId]:L.generateId&&(te=U||0),ee==="Point")Lt(Y,re);else if(ee==="MultiPoint")for(var ue=0;ue<Y.length;ue++)Lt(Y[ue],re);else if(ee==="LineString")Ui(Y,re,le,!1);else if(ee==="MultiLineString"){if(L.lineMetrics){for(ue=0;ue<Y.length;ue++)Ui(Y[ue],re=[],le,!1),X.push(Dn(te,"LineString",re,z.properties));return}Ni(Y,re,le,!1)}else if(ee==="Polygon")Ni(Y,re,le,!0);else{if(ee!=="MultiPolygon"){if(ee==="GeometryCollection"){for(ue=0;ue<z.geometry.geometries.length;ue++)jt(X,{id:te,geometry:z.geometry.geometries[ue],properties:z.properties},L,U);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ue=0;ue<Y.length;ue++){var Se=[];Ni(Y[ue],Se,le,!0),re.push(Se)}}X.push(Dn(te,ee,re,z.properties))}}function Lt(X,z){z.push(eo(X[0])),z.push(xn(X[1])),z.push(0)}function Ui(X,z,L,U){for(var Y,ee,le=0,re=0;re<X.length;re++){var te=eo(X[re][0]),ue=xn(X[re][1]);z.push(te),z.push(ue),z.push(0),re>0&&(le+=U?(Y*ue-te*ee)/2:Math.sqrt(Math.pow(te-Y,2)+Math.pow(ue-ee,2))),Y=te,ee=ue}var Se=z.length-3;z[2]=1,br(z,0,Se,L),z[Se+2]=1,z.size=Math.abs(le),z.start=0,z.end=z.size}function Ni(X,z,L,U){for(var Y=0;Y<X.length;Y++){var ee=[];Ui(X[Y],ee,L,U),z.push(ee)}}function eo(X){return X/360+.5}function xn(X){var z=Math.sin(X*Math.PI/180),L=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return L<0?0:L>1?1:L}function ar(X,z,L,U,Y,ee,le,re){if(U/=z,ee>=(L/=z)&&le<U)return X;if(le<L||ee>=U)return null;for(var te=[],ue=0;ue<X.length;ue++){var Se=X[ue],Ee=Se.geometry,Te=Se.type,ht=Y===0?Se.minX:Se.minY,gt=Y===0?Se.maxX:Se.maxY;if(ht>=L&&gt<U)te.push(Se);else if(!(gt<L||ht>=U)){var Je=[];if(Te==="Point"||Te==="MultiPoint")Ti(Ee,Je,L,U,Y);else if(Te==="LineString")Vi(Ee,Je,L,U,Y,!1,re.lineMetrics);else if(Te==="MultiLineString")Fr(Ee,Je,L,U,Y,!1);else if(Te==="Polygon")Fr(Ee,Je,L,U,Y,!0);else if(Te==="MultiPolygon")for(var at=0;at<Ee.length;at++){var mt=[];Fr(Ee[at],mt,L,U,Y,!0),mt.length&&Je.push(mt)}if(Je.length){if(re.lineMetrics&&Te==="LineString"){for(at=0;at<Je.length;at++)te.push(Dn(Se.id,Te,Je[at],Se.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(Je.length===1?(Te="LineString",Je=Je[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=Je.length===3?"Point":"MultiPoint"),te.push(Dn(Se.id,Te,Je,Se.tags))}}}return te.length?te:null}function Ti(X,z,L,U,Y){for(var ee=0;ee<X.length;ee+=3){var le=X[ee+Y];le>=L&&le<=U&&(z.push(X[ee]),z.push(X[ee+1]),z.push(X[ee+2]))}}function Vi(X,z,L,U,Y,ee,le){for(var re,te,ue=Fe(X),Se=Y===0?qt:si,Ee=X.start,Te=0;Te<X.length-3;Te+=3){var ht=X[Te],gt=X[Te+1],Je=X[Te+2],at=X[Te+3],mt=X[Te+4],Dt=Y===0?ht:gt,Kt=Y===0?at:mt,kt=!1;le&&(re=Math.sqrt(Math.pow(ht-at,2)+Math.pow(gt-mt,2))),Dt<L?Kt>L&&(te=Se(ue,ht,gt,at,mt,L),le&&(ue.start=Ee+re*te)):Dt>U?Kt<U&&(te=Se(ue,ht,gt,at,mt,U),le&&(ue.start=Ee+re*te)):Gr(ue,ht,gt,Je),Kt<L&&Dt>=L&&(te=Se(ue,ht,gt,at,mt,L),kt=!0),Kt>U&&Dt<=U&&(te=Se(ue,ht,gt,at,mt,U),kt=!0),!ee&&kt&&(le&&(ue.end=Ee+re*te),z.push(ue),ue=Fe(X)),le&&(Ee+=re)}var zt=X.length-3;ht=X[zt],gt=X[zt+1],Je=X[zt+2],(Dt=Y===0?ht:gt)>=L&&Dt<=U&&Gr(ue,ht,gt,Je),zt=ue.length-3,ee&&zt>=3&&(ue[zt]!==ue[0]||ue[zt+1]!==ue[1])&&Gr(ue,ue[0],ue[1],ue[2]),ue.length&&z.push(ue)}function Fe(X){var z=[];return z.size=X.size,z.start=X.start,z.end=X.end,z}function Fr(X,z,L,U,Y,ee){for(var le=0;le<X.length;le++)Vi(X[le],z,L,U,Y,ee,!1)}function Gr(X,z,L,U){X.push(z),X.push(L),X.push(U)}function qt(X,z,L,U,Y,ee){var le=(ee-z)/(U-z);return X.push(ee),X.push(L+(Y-L)*le),X.push(1),le}function si(X,z,L,U,Y,ee){var le=(ee-L)/(Y-L);return X.push(z+(U-z)*le),X.push(ee),X.push(1),le}function Be(X,z){for(var L=[],U=0;U<X.length;U++){var Y,ee=X[U],le=ee.type;if(le==="Point"||le==="MultiPoint"||le==="LineString")Y=xt(ee.geometry,z);else if(le==="MultiLineString"||le==="Polygon"){Y=[];for(var re=0;re<ee.geometry.length;re++)Y.push(xt(ee.geometry[re],z))}else if(le==="MultiPolygon")for(Y=[],re=0;re<ee.geometry.length;re++){for(var te=[],ue=0;ue<ee.geometry[re].length;ue++)te.push(xt(ee.geometry[re][ue],z));Y.push(te)}L.push(Dn(ee.id,le,Y,ee.tags))}return L}function xt(X,z){var L=[];L.size=X.size,X.start!==void 0&&(L.start=X.start,L.end=X.end);for(var U=0;U<X.length;U+=3)L.push(X[U]+z,X[U+1],X[U+2]);return L}function vt(X,z){if(X.transformed)return X;var L,U,Y,ee=1<<X.z,le=X.x,re=X.y;for(L=0;L<X.features.length;L++){var te=X.features[L],ue=te.geometry,Se=te.type;if(te.geometry=[],Se===1)for(U=0;U<ue.length;U+=2)te.geometry.push(Qr(ue[U],ue[U+1],z,ee,le,re));else for(U=0;U<ue.length;U++){var Ee=[];for(Y=0;Y<ue[U].length;Y+=2)Ee.push(Qr(ue[U][Y],ue[U][Y+1],z,ee,le,re));te.geometry.push(Ee)}}return X.transformed=!0,X}function Qr(X,z,L,U,Y,ee){return[Math.round(L*(X*U-Y)),Math.round(L*(z*U-ee))]}function ji(X,z,L,U,Y){for(var ee=z===Y.maxZoom?0:Y.tolerance/((1<<z)*Y.extent),le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:U,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},re=0;re<X.length;re++){le.numFeatures++,pt(le,X[re],ee,Y);var te=X[re].minX,ue=X[re].minY,Se=X[re].maxX,Ee=X[re].maxY;te<le.minX&&(le.minX=te),ue<le.minY&&(le.minY=ue),Se>le.maxX&&(le.maxX=Se),Ee>le.maxY&&(le.maxY=Ee)}return le}function pt(X,z,L,U){var Y=z.geometry,ee=z.type,le=[];if(ee==="Point"||ee==="MultiPoint")for(var re=0;re<Y.length;re+=3)le.push(Y[re]),le.push(Y[re+1]),X.numPoints++,X.numSimplified++;else if(ee==="LineString")Ci(le,Y,X,L,!1,!1);else if(ee==="MultiLineString"||ee==="Polygon")for(re=0;re<Y.length;re++)Ci(le,Y[re],X,L,ee==="Polygon",re===0);else if(ee==="MultiPolygon")for(var te=0;te<Y.length;te++){var ue=Y[te];for(re=0;re<ue.length;re++)Ci(le,ue[re],X,L,!0,re===0)}if(le.length){var Se=z.tags||null;if(ee==="LineString"&&U.lineMetrics){for(var Ee in Se={},z.tags)Se[Ee]=z.tags[Ee];Se.mapbox_clip_start=Y.start/Y.size,Se.mapbox_clip_end=Y.end/Y.size}var Te={geometry:le,type:ee==="Polygon"||ee==="MultiPolygon"?3:ee==="LineString"||ee==="MultiLineString"?2:1,tags:Se};z.id!==null&&(Te.id=z.id),X.features.push(Te)}}function Ci(X,z,L,U,Y,ee){var le=U*U;if(U>0&&z.size<(Y?le:U))L.numPoints+=z.length/3;else{for(var re=[],te=0;te<z.length;te+=3)(U===0||z[te+2]>le)&&(L.numSimplified++,re.push(z[te]),re.push(z[te+1])),L.numPoints++;Y&&function(ue,Se){for(var Ee=0,Te=0,ht=ue.length,gt=ht-2;Te<ht;gt=Te,Te+=2)Ee+=(ue[Te]-ue[gt])*(ue[Te+1]+ue[gt+1]);if(Ee>0===Se)for(Te=0,ht=ue.length;Te<ht/2;Te+=2){var Je=ue[Te],at=ue[Te+1];ue[Te]=ue[ht-2-Te],ue[Te+1]=ue[ht-1-Te],ue[ht-2-Te]=Je,ue[ht-1-Te]=at}}(re,ee),X.push(re)}}function ki(X,z){var L=(z=this.options=function(Y,ee){for(var le in ee)Y[le]=ee[le];return Y}(Object.create(this.options),z)).debug;if(L&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var U=function(Y,ee){var le=[];if(Y.type==="FeatureCollection")for(var re=0;re<Y.features.length;re++)jt(le,Y.features[re],ee,re);else jt(le,Y.type==="Feature"?Y:{geometry:Y},ee);return le}(X,z);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),U=function(Y,ee){var le=ee.buffer/ee.extent,re=Y,te=ar(Y,1,-1-le,le,0,-1,2,ee),ue=ar(Y,1,1-le,2+le,0,-1,2,ee);return(te||ue)&&(re=ar(Y,1,-le,1+le,0,-1,2,ee)||[],te&&(re=Be(te,1).concat(re)),ue&&(re=re.concat(Be(ue,-1)))),re}(U,z),U.length&&this.splitTile(U,0,0,0),L&&(U.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function to(X,z,L){return 32*((1<<X)*L+z)+X}function Jn(X,z){return z?X.properties[z]:X.id}function ro(X,z){if(X==null)return!0;if(X.type==="Feature")return Jn(X,z)!=null;if(X.type==="FeatureCollection"){const L=new Set;for(const U of X.features){const Y=Jn(U,z);if(Y==null||L.has(Y))return!1;L.add(Y)}return!0}return!1}function Zr(X,z){const L=new Map;if(X!=null)if(X.type==="Feature")L.set(Jn(X,z),X);else for(const U of X.features)L.set(Jn(U,z),U);return L}function er(X,z){const L=X.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);const U=this._geoJSONIndex.getTile(L.z,L.x,L.y);if(!U)return z(null,null);const Y=new class{constructor(le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=le.length,this._features=le}feature(le){return new class{constructor(re){this._feature=re,this.extent=l.EXTENT,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))}loadGeometry(){if(this._feature.type===1){const re=[];for(const te of this._feature.geometry)re.push([new l.Point(te[0],te[1])]);return re}{const re=[];for(const te of this._feature.geometry){const ue=[];for(const Se of te)ue.push(new l.Point(Se[0],Se[1]));re.push(ue)}return re}}toGeoJSON(re,te,ue){return Ie.call(this,re,te,ue)}}(this._features[le])}}(U.features);let ee=_n(Y);ee.byteOffset===0&&ee.byteLength===ee.buffer.byteLength||(ee=new Uint8Array(ee)),z(null,{vectorTile:Y,rawData:ee.buffer})}ki.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ki.prototype.splitTile=function(X,z,L,U,Y,ee,le){for(var re=[X,z,L,U],te=this.options,ue=te.debug;re.length;){U=re.pop(),L=re.pop(),z=re.pop(),X=re.pop();var Se=1<<z,Ee=to(z,L,U),Te=this.tiles[Ee];if(!Te&&(ue>1&&console.time("creation"),Te=this.tiles[Ee]=ji(X,z,L,U,te),this.tileCoords.push({z,x:L,y:U}),ue)){ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,L,U,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));var ht="z"+z;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(Te.source=X,Y){if(z===te.maxZoom||z===Y)continue;var gt=1<<Y-z;if(L!==Math.floor(ee/gt)||U!==Math.floor(le/gt))continue}else if(z===te.indexMaxZoom||Te.numPoints<=te.indexMaxPoints)continue;if(Te.source=null,X.length!==0){ue>1&&console.time("clipping");var Je,at,mt,Dt,Kt,kt,zt=.5*te.buffer/te.extent,vn=.5-zt,ft=.5+zt,Pr=1+zt;Je=at=mt=Dt=null,Kt=ar(X,Se,L-zt,L+ft,0,Te.minX,Te.maxX,te),kt=ar(X,Se,L+vn,L+Pr,0,Te.minX,Te.maxX,te),X=null,Kt&&(Je=ar(Kt,Se,U-zt,U+ft,1,Te.minY,Te.maxY,te),at=ar(Kt,Se,U+vn,U+Pr,1,Te.minY,Te.maxY,te),Kt=null),kt&&(mt=ar(kt,Se,U-zt,U+ft,1,Te.minY,Te.maxY,te),Dt=ar(kt,Se,U+vn,U+Pr,1,Te.minY,Te.maxY,te),kt=null),ue>1&&console.timeEnd("clipping"),re.push(Je||[],z+1,2*L,2*U),re.push(at||[],z+1,2*L,2*U+1),re.push(mt||[],z+1,2*L+1,2*U),re.push(Dt||[],z+1,2*L+1,2*U+1)}}},ki.prototype.getTile=function(X,z,L){var U=this.options,Y=U.extent,ee=U.debug;if(X<0||X>24)return null;var le=1<<X,re=to(X,z=(z%le+le)%le,L);if(this.tiles[re])return vt(this.tiles[re],Y);ee>1&&console.log("drilling down to z%d-%d-%d",X,z,L);for(var te,ue=X,Se=z,Ee=L;!te&&ue>0;)ue--,Se=Math.floor(Se/2),Ee=Math.floor(Ee/2),te=this.tiles[to(ue,Se,Ee)];return te&&te.source?(ee>1&&console.log("found parent tile z%d-%d-%d",ue,Se,Ee),ee>1&&console.time("drilling down"),this.splitTile(te.source,ue,Se,Ee,X,z,L),ee>1&&console.timeEnd("drilling down"),this.tiles[re]?vt(this.tiles[re],Y):null):null};class _a extends de{constructor(z,L,U,Y){super(z,L,U,er),this._dataUpdateable=new Map,this.loadGeoJSON=(ee,le)=>{const{promoteId:re}=ee;if(ee.request)return l.getJSON(ee.request,(te,ue,Se,Ee)=>{this._dataUpdateable=ro(ue,re)?Zr(ue,re):void 0,le(te,ue,Se,Ee)});if(typeof ee.data=="string")try{const te=JSON.parse(ee.data);this._dataUpdateable=ro(te,re)?Zr(te,re):void 0,le(null,te)}catch{le(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`))}else ee.dataDiff?this._dataUpdateable?(function(te,ue,Se){var Ee,Te,ht,gt;if(ue.removeAll&&te.clear(),ue.remove)for(const Je of ue.remove)te.delete(Je);if(ue.add)for(const Je of ue.add){const at=Jn(Je,Se);at!=null&&te.set(at,Je)}if(ue.update)for(const Je of ue.update){let at=te.get(Je.id);if(at==null)continue;const mt=!Je.removeAllProperties&&(((Ee=Je.removeProperties)===null||Ee===void 0?void 0:Ee.length)>0||((Te=Je.addOrUpdateProperties)===null||Te===void 0?void 0:Te.length)>0);if((Je.newGeometry||Je.removeAllProperties||mt)&&(at={...at},te.set(Je.id,at),mt&&(at.properties={...at.properties})),Je.newGeometry&&(at.geometry=Je.newGeometry),Je.removeAllProperties)at.properties={};else if(((ht=Je.removeProperties)===null||ht===void 0?void 0:ht.length)>0)for(const Dt of Je.removeProperties)Object.prototype.hasOwnProperty.call(at.properties,Dt)&&delete at.properties[Dt];if(((gt=Je.addOrUpdateProperties)===null||gt===void 0?void 0:gt.length)>0)for(const{key:Dt,value:Kt}of Je.addOrUpdateProperties)at.properties[Dt]=Kt}}(this._dataUpdateable,ee.dataDiff,re),le(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):le(new Error(`Cannot update existing geojson data in ${ee.source}`)):le(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},Y&&(this.loadGeoJSON=Y)}loadData(z,L){var U;(U=this._pendingRequest)===null||U===void 0||U.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const Y=!!(z&&z.request&&z.request.collectResourceTiming)&&new l.RequestPerformance(z.request);this._pendingCallback=L,this._pendingRequest=this.loadGeoJSON(z,(ee,le)=>{if(delete this._pendingCallback,delete this._pendingRequest,ee||!le)return L(ee);if(typeof le!="object")return L(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));{ge(le,!0);try{if(z.filter){const te=l.createExpression(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));le={type:"FeatureCollection",features:le.features.filter(Se=>te.value.evaluate({zoom:0},Se))}}this._geoJSONIndex=z.cluster?new Hn(function({superclusterOptions:te,clusterProperties:ue}){if(!ue||!te)return te;const Se={},Ee={},Te={accumulated:null,zoom:0},ht={properties:null},gt=Object.keys(ue);for(const Je of gt){const[at,mt]=ue[Je],Dt=l.createExpression(mt),Kt=l.createExpression(typeof at=="string"?[at,["accumulated"],["get",Je]]:at);Se[Je]=Dt.value,Ee[Je]=Kt.value}return te.map=Je=>{ht.properties=Je;const at={};for(const mt of gt)at[mt]=Se[mt].evaluate(Te,ht);return at},te.reduce=(Je,at)=>{ht.properties=at;for(const mt of gt)Te.accumulated=Je[mt],Je[mt]=Ee[mt].evaluate(Te,ht)},te}(z)).load(le.features):function(te,ue){return new ki(te,ue)}(le,z.geojsonVtOptions)}catch(te){return L(te)}this.loaded={};const re={};if(Y){const te=Y.finish();te&&(re.resourceTiming={},re.resourceTiming[z.source]=JSON.parse(JSON.stringify(te)))}L(null,re)}})}reloadTile(z,L){const U=this.loaded;return U&&U[z.uid]?super.reloadTile(z,L):this.loadTile(z,L)}removeSource(z,L){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),L()}getClusterExpansionZoom(z,L){try{L(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(U){L(U)}}getClusterChildren(z,L){try{L(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(U){L(U)}}getClusterLeaves(z,L){try{L(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(U){L(U)}}}class Ii{constructor(z){this.self=z,this.actor=new l.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:de,geojson:_a},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(L,U)=>{if(this.workerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.workerSourceTypes[L]=U},this.self.registerRTLTextPlugin=L=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=L.applyArabicShaping,l.plugin.processBidirectionalText=L.processBidirectionalText,l.plugin.processStyledBidirectionalText=L.processStyledBidirectionalText}}setReferrer(z,L){this.referrer=L}setImages(z,L,U){this.availableImages[z]=L;for(const Y in this.workerSources[z]){const ee=this.workerSources[z][Y];for(const le in ee)ee[le].availableImages=L}U()}setLayers(z,L,U){this.getLayerIndex(z).replace(L),U()}updateLayers(z,L,U){this.getLayerIndex(z).update(L.layers,L.removedIds),U()}loadTile(z,L,U){this.getWorkerSource(z,L.type,L.source).loadTile(L,U)}loadDEMTile(z,L,U){this.getDEMWorkerSource(z,L.source).loadTile(L,U)}reloadTile(z,L,U){this.getWorkerSource(z,L.type,L.source).reloadTile(L,U)}abortTile(z,L,U){this.getWorkerSource(z,L.type,L.source).abortTile(L,U)}removeTile(z,L,U){this.getWorkerSource(z,L.type,L.source).removeTile(L,U)}removeDEMTile(z,L){this.getDEMWorkerSource(z,L.source).removeTile(L)}removeSource(z,L,U){if(!this.workerSources[z]||!this.workerSources[z][L.type]||!this.workerSources[z][L.type][L.source])return;const Y=this.workerSources[z][L.type][L.source];delete this.workerSources[z][L.type][L.source],Y.removeSource!==void 0?Y.removeSource(L,U):U()}loadWorkerSource(z,L,U){try{this.self.importScripts(L.url),U()}catch(Y){U(Y.toString())}}syncRTLPluginState(z,L,U){try{l.plugin.setState(L);const Y=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&Y!=null){this.self.importScripts(Y);const ee=l.plugin.isParsed();U(ee?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Y}`),ee)}}catch(Y){U(Y.toString())}}getAvailableImages(z){let L=this.availableImages[z];return L||(L=[]),L}getLayerIndex(z){let L=this.layerIndexes[z];return L||(L=this.layerIndexes[z]=new O),L}getWorkerSource(z,L,U){if(this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][L]||(this.workerSources[z][L]={}),!this.workerSources[z][L][U]){const Y={send:(ee,le,re)=>{this.actor.send(ee,le,re,z)}};this.workerSources[z][L][U]=new this.workerSourceTypes[L](Y,this.getLayerIndex(z),this.getAvailableImages(z))}return this.workerSources[z][L][U]}getDEMWorkerSource(z,L){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][L]||(this.demWorkerSources[z][L]=new xe),this.demWorkerSources[z][L]}}return l.isWorker()&&(self.worker=new Ii(self)),Ii}),w(["./shared"],function(l){var O="3.3.1";class D{static testProp(t){if(!D.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in D.docStyle)return t[o];return t[0]}static create(t,o,c){const d=window.document.createElement(t);return o!==void 0&&(d.className=o),c&&c.appendChild(d),d}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(t,o){t.style[D.transformProp]=o}static addEventListener(t,o,c,d={}){t.addEventListener(o,c,"passive"in d?d:d.capture)}static removeEventListener(t,o,c,d={}){t.removeEventListener(o,c,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(t,o){const c=t.getBoundingClientRect();return new l.Point(o.clientX-c.left-t.clientLeft,o.clientY-c.top-t.clientTop)}static touchPos(t,o){const c=t.getBoundingClientRect(),d=[];for(let m=0;m<o.length;m++)d.push(new l.Point(o[m].clientX-c.left-t.clientLeft,o[m].clientY-c.top-t.clientTop));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const V={supported:!1,testSupport:function(p){!de&&ae&&(xe?oe(p):K=p)}};let K,ae,de=!1,xe=!1;function oe(p){const t=p.createTexture();p.bindTexture(p.TEXTURE_2D,t);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,ae),p.isContextLost())return;V.supported=!0}catch{}p.deleteTexture(t),de=!0}var _e,ge;typeof document<"u"&&(ae=document.createElement("img"),ae.onload=function(){K&&oe(K),K=null,xe=!0},ae.onerror=function(){de=!0,K=null},ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let t,o,c,d;p.resetRequestQueue=()=>{t=[],o=0,c=0,d={}},p.addThrottleControl=k=>{const I=c++;return d[I]=k,I},p.removeThrottleControl=k=>{delete d[k],b()},p.getImage=(k,I,P=!0)=>{V.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*");const F={requestParameters:k,supportImageRefresh:P,callback:I,cancelled:!1,completed:!1,cancel:()=>{F.completed||F.cancelled||(F.cancelled=!0,F.innerRequest&&(F.innerRequest.cancel(),o--),b())}};return t.push(F),b(),F};const m=k=>{const{requestParameters:I,supportImageRefresh:P,callback:F}=k;return l.extend(I,{type:"image"}),(P!==!1||l.isWorker()||l.getProtocolAction(I.url)||I.headers&&!Object.keys(I.headers).reduce((q,j)=>q&&j==="accept",!0)?l.makeRequest:E)(I,(q,j,W,N)=>{v(k,F,q,j,W,N)})},v=(k,I,P,F,q,j)=>{P?I(P):F instanceof HTMLImageElement||l.isImageBitmap(F)?I(null,F):F&&((W,N)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(W,N):l.arrayBufferToImage(W,N)})(F,(W,N)=>{W!=null?I(W):N!=null&&I(null,N,{cacheControl:q,expires:j})}),k.cancelled||(k.completed=!0,o--,b())},b=()=>{const k=(()=>{const I=Object.keys(d);let P=!1;if(I.length>0){for(const F of I)if(P=d[F](),P)break}return P})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=o;I<k&&t.length>0;I++){const P=t.shift();if(P.cancelled){I--;continue}const F=m(P);o++,P.innerRequest=F}},E=(k,I)=>{const P=new Image,F=k.url;let q=!1;const j=k.credentials;return j&&j==="include"?P.crossOrigin="use-credentials":(j&&j==="same-origin"||!l.sameOrigin(F))&&(P.crossOrigin="anonymous"),P.fetchPriority="high",P.onload=()=>{I(null,P),P.onerror=P.onload=null},P.onerror=()=>{q||I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),P.onerror=P.onload=null},P.src=F,{cancel:()=>{q=!0,P.src=""}}}}(_e||(_e={})),_e.resetRequestQueue(),function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"}(ge||(ge={}));class Ie{constructor(t){this._transformRequestFn=t}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}normalizeSpriteURL(t,o,c){const d=function(m){const v=m.match(De);if(!v)throw new Error(`Unable to parse URL "${m}"`);return{protocol:v[1],authority:v[2],path:v[3]||"/",params:v[4]?v[4].split("&"):[]}}(t);return d.path+=`${o}${c}`,function(m){const v=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${v}`}(d)}setTransformRequest(t){this._transformRequestFn=t}}const De=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function We(p){var t=new l.ARRAY_TYPE(3);return t[0]=p[0],t[1]=p[1],t[2]=p[2],t}var Me,Re=function(p,t,o){return p[0]=t[0]-o[0],p[1]=t[1]-o[1],p[2]=t[2]-o[2],p};Me=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(Me[0]=0,Me[1]=0,Me[2]=0);var Ce=function(p){var t=p[0],o=p[1];return t*t+o*o};function Ze(p){const t=[];if(typeof p=="string")t.push({id:"default",url:p});else if(p&&p.length>0){const o=[];for(const{id:c,url:d}of p){const m=`${c}${d}`;o.indexOf(m)===-1&&(o.push(m),t.push({id:c,url:d}))}}return t}function yt(p,t,o,c,d){if(c)return void p(c);if(d!==Object.values(t).length||d!==Object.values(o).length)return;const m={};for(const v in t){m[v]={};const b=l.browser.getImageCanvasContext(o[v]),E=t[v];for(const k in E){const{width:I,height:P,x:F,y:q,sdf:j,pixelRatio:W,stretchX:N,stretchY:ie,content:pe}=E[k];m[v][k]={data:null,pixelRatio:W,sdf:j,stretchX:N,stretchY:ie,content:pe,spriteData:{width:I,height:P,x:F,y:q,context:b}}}}p(null,m)}(function(){var p=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(p[0]=0,p[1]=0)})();class $e{constructor(t,o,c,d){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(o,d)}update(t,o,c){const{width:d,height:m}=t,v=!(this.size&&this.size[0]===d&&this.size[1]===m||c),{context:b}=this,{gl:E}=b;if(this.useMipmap=Boolean(o&&o.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!o||o.premultiply!==!1)),v)this.size=[d,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.isImageBitmap(t)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,t):E.texImage2D(E.TEXTURE_2D,0,this.format,d,m,0,this.format,E.UNSIGNED_BYTE,t.data);else{const{x:k,y:I}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.isImageBitmap(t)?E.texSubImage2D(E.TEXTURE_2D,0,k,I,E.RGBA,E.UNSIGNED_BYTE,t):E.texSubImage2D(E.TEXTURE_2D,0,k,I,d,m,E.RGBA,E.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(t,o,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||t),this.filter=t),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Ot(p){const{userImage:t}=p;return!!(t&&t.render&&t.render())&&(p.data.replace(new Uint8Array(t.data.buffer)),!0)}class Mt extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,callback:c}of this.requestors)this._notify(o,c);this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const c=o.spriteData;o.data=new l.RGBAImage({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let c=!0;const d=o.data||o.spriteData;return this._validateStretch(o.stretchX,d&&d.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,d&&d.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new l.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,o){if(!t)return!0;let c=0;for(const d of t){if(d[0]<c||d[1]<d[0]||o<d[1])return!1;c=d[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const c=o.spriteData,d=c&&c.width||o.data.width,m=c&&c.height||o.data.height;return!(t[0]<0||d<t[0]||t[1]<0||m<t[1]||t[2]<0||d<t[2]||t[3]<0||m<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,c=!0){const d=this.getImage(t);if(c&&(d.data.width!==o.data.width||d.data.height!==o.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=d.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,o){let c=!0;if(!this.isLoaded())for(const d of t)this.images[d]||(c=!1);this.isLoaded()||c?this._notify(t,o):this.requestors.push({ids:t,callback:o})}_notify(t,o){const c={};for(const d of t){let m=this.getImage(d);m||(this.fire(new l.Event("styleimagemissing",{id:d})),m=this.getImage(d)),m?c[d]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:Boolean(m.userImage&&m.userImage.render)}:l.warnOnce(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,c)}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],c=this.getImage(t);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new l.ImagePosition(d,c);this.patterns[t]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new $e(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:o,h:c}=l.potpack(t),d=this.atlasImage;d.resize({width:o||1,height:c||1});for(const m in this.patterns){const{bin:v}=this.patterns[m],b=v.x+1,E=v.y+1,k=this.getImage(m).data,I=k.width,P=k.height;l.RGBAImage.copy(k,d,{x:0,y:0},{x:b,y:E},{width:I,height:P}),l.RGBAImage.copy(k,d,{x:0,y:P-1},{x:b,y:E-1},{width:I,height:1}),l.RGBAImage.copy(k,d,{x:0,y:0},{x:b,y:E+P},{width:I,height:1}),l.RGBAImage.copy(k,d,{x:I-1,y:0},{x:b-1,y:E},{width:1,height:P}),l.RGBAImage.copy(k,d,{x:0,y:0},{x:b+I,y:E},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.getImage(o);c||l.warnOnce(`Image with ID: "${o}" was not found`),Ot(c)&&this.updateImage(o,c)}}}const or=1e20;function Xt(p,t,o,c,d,m,v,b,E){for(let k=t;k<t+c;k++)Lr(p,o*m+k,m,d,v,b,E);for(let k=o;k<o+d;k++)Lr(p,k*m+t,1,c,v,b,E)}function Lr(p,t,o,c,d,m,v){m[0]=0,v[0]=-or,v[1]=or,d[0]=p[t];for(let b=1,E=0,k=0;b<c;b++){d[b]=p[t+b*o];const I=b*b;do{const P=m[E];k=(d[b]-d[P]+I-P*P)/(b-P)/2}while(k<=v[E]&&--E>-1);E++,m[E]=b,v[E]=k,v[E+1]=or}for(let b=0,E=0;b<c;b++){for(;v[E+1]<b;)E++;const k=m[E],I=b-k;p[t+b*o]=d[k]+I*I}}class Vr{constructor(t,o){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={}}setURL(t){this.url=t}getGlyphs(t,o){const c=[];for(const d in t)for(const m of t[d])c.push({stack:d,id:m});l.asyncAll(c,({stack:d,id:m},v)=>{let b=this.entries[d];b||(b=this.entries[d]={glyphs:{},requests:{},ranges:{}});let E=b.glyphs[m];if(E!==void 0)return void v(null,{stack:d,id:m,glyph:E});if(E=this._tinySDF(b,d,m),E)return b.glyphs[m]=E,void v(null,{stack:d,id:m,glyph:E});const k=Math.floor(m/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[k])return void v(null,{stack:d,id:m,glyph:E});if(!this.url)return void v(new Error("glyphsUrl is not set"));let I=b.requests[k];I||(I=b.requests[k]=[],Vr.loadGlyphRange(d,k,this.url,this.requestManager,(P,F)=>{if(F){for(const q in F)this._doesCharSupportLocalGlyph(+q)||(b.glyphs[+q]=F[+q]);b.ranges[k]=!0}for(const q of I)q(P,F);delete b.requests[k]})),I.push((P,F)=>{P?v(P):F&&v(null,{stack:d,id:m,glyph:F[m]||null})})},(d,m)=>{if(d)o(d);else if(m){const v={};for(const{stack:b,id:E,glyph:k}of m)(v[b]||(v[b]={}))[E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};o(null,v)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](t)||l.unicodeBlockLookup["Hangul Syllables"](t)||l.unicodeBlockLookup.Hiragana(t)||l.unicodeBlockLookup.Katakana(t))}_tinySDF(t,o,c){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let m=t.tinySDF;if(!m){let b="400";/bold/i.test(o)?b="900":/medium/i.test(o)?b="500":/light/i.test(o)&&(b="200"),m=t.tinySDF=new Vr.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:d,fontWeight:b})}const v=m.draw(String.fromCharCode(c));return{id:c,bitmap:new l.AlphaImage({width:v.width||30,height:v.height||30},v.data),metrics:{width:v.glyphWidth||24,height:v.glyphHeight||24,left:v.glyphLeft||0,top:v.glyphTop-27||-8,advance:v.glyphAdvance||24}}}}Vr.loadGlyphRange=function(p,t,o,c,d){const m=256*t,v=m+255,b=c.transformRequest(o.replace("{fontstack}",p).replace("{range}",`${m}-${v}`),ge.Glyphs);l.getArrayBuffer(b,(E,k)=>{if(E)d(E);else if(k){const I={};for(const P of l.parseGlyphPbf(k))I[P.id]=P;d(null,I)}})},Vr.TinySDF=class{constructor({fontSize:p=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=o;const b=this.size=p+4*t,E=this._createCanvas(b),k=this.ctx=E.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${m} ${p}px ${d}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(p){const t=document.createElement("canvas");return t.width=t.height=p,t}draw(p){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(p),v=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),E=Math.min(this.size-this.buffer,v+Math.ceil(c)),k=b+2*this.buffer,I=E+2*this.buffer,P=Math.max(k*I,0),F=new Uint8ClampedArray(P),q={data:F,width:k,height:I,glyphWidth:b,glyphHeight:E,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(b===0||E===0)return q;const{ctx:j,buffer:W,gridInner:N,gridOuter:ie}=this;j.clearRect(W,W,b,E),j.fillText(p,W,W+v);const pe=j.getImageData(W,W,b,E);ie.fill(or,0,P),N.fill(0,0,P);for(let J=0;J<E;J++)for(let se=0;se<b;se++){const me=pe.data[4*(J*b+se)+3]/255;if(me===0)continue;const ye=(J+W)*k+se+W;if(me===1)ie[ye]=0,N[ye]=or;else{const be=.5-me;ie[ye]=be>0?be*be:0,N[ye]=be<0?be*be:0}}Xt(ie,0,0,k,I,k,this.f,this.v,this.z),Xt(N,W,W,b,E,k,this.f,this.v,this.z);for(let J=0;J<P;J++){const se=Math.sqrt(ie[J])-Math.sqrt(N[J]);F[J]=Math.round(255-255*(se/this.radius+this.cutoff))}return q}};class gn{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(t,o){return l.sphericalToCartesian(t.expression.evaluate(o))}interpolate(t,o,c){return{x:l.interpolate.number(t.x,o.x,c),y:l.interpolate.number(t.y,o.y,c),z:l.interpolate.number(t.z,o.z,c)}}}let yn,_n;class Mn extends l.Evented{constructor(t){super(),yn=yn||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new gn,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(yn),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(l.validateLight,t,o))for(const c in t){const d=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c){return(!c||c.validate!==!1)&&l.emitValidationErrors(this,t.call(l.validateStyle,l.extend({value:o,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class Yr{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const c=t.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,o)),this.dashEntry[c]}getDashRanges(t,o,c){const d=[];let m=t.length%2==1?-t[t.length-1]*c:0,v=t[0]*c,b=!0;d.push({left:m,right:v,isDash:b,zeroLength:t[0]===0});let E=t[0];for(let k=1;k<t.length;k++){b=!b;const I=t[k];m=E*c,E+=I,v=E*c,d.push({left:m,right:v,isDash:b,zeroLength:I===0})}return d}addRoundDash(t,o,c){const d=o/2;for(let m=-c;m<=c;m++){const v=this.width*(this.nextRow+c+m);let b=0,E=t[b];for(let k=0;k<this.width;k++){k/E.right>1&&(E=t[++b]);const I=Math.abs(k-E.left),P=Math.abs(k-E.right),F=Math.min(I,P);let q;const j=m/c*(d+1);if(E.isDash){const W=d-Math.abs(j);q=Math.sqrt(F*F+W*W)}else q=d-Math.sqrt(F*F+j*j);this.data[v+k]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(t){for(let b=t.length-1;b>=0;--b){const E=t[b],k=t[b+1];E.zeroLength?t.splice(b,1):k&&k.isDash===E.isDash&&(k.left=E.left,t.splice(b,1))}const o=t[0],c=t[t.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const d=this.width*this.nextRow;let m=0,v=t[m];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++m]);const E=Math.abs(b-v.left),k=Math.abs(b-v.right),I=Math.min(E,k);this.data[d+b]=Math.max(0,Math.min(255,(v.isDash?I:-I)+128))}}addDash(t,o){const c=o?7:0,d=2*c+1;if(this.nextRow+d>this.height)return l.warnOnce("LineAtlas out of space"),null;let m=0;for(let b=0;b<t.length;b++)m+=t[b];if(m!==0){const b=this.width/m,E=this.getDashRanges(t,this.width,b);o?this.addRoundDash(E,b,c):this.addRegularDash(E)}const v={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=d,this.dirty=!0,v}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}class Ct{constructor(t,o,c){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c;const d=this.workerPool.acquire(c);for(let m=0;m<d.length;m++){const v=new Ct.Actor(d[m],o,c);v.name=`Worker ${m}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o,c){l.asyncAll(this.actors,(d,m)=>{d.send(t,o,m)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}}function Ar(p,t,o){const c=function(d,m){if(d)return o(d);if(m){const v=l.pick(l.extend(m,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);m.vector_layers&&(v.vectorLayers=m.vector_layers,v.vectorLayerIds=v.vectorLayers.map(b=>b.id)),o(null,v)}};return p.url?l.getJSON(t.transformRequest(p.url,ge.Source),c):l.browser.frame(()=>c(null,p))}Ct.Actor=l.Actor;class Jt{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.LngLat?new l.LngLat(t.lng,t.lat):l.LngLat.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.LngLat?new l.LngLat(t.lng,t.lat):l.LngLat.convert(t),this}extend(t){const o=this._sw,c=this._ne;let d,m;if(t instanceof l.LngLat)d=t,m=t;else{if(!(t instanceof Jt))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Jt.convert(t)):this.extend(l.LngLat.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.LngLat.convert(t)):this;if(d=t._sw,m=t._ne,!d||!m)return this}return o||c?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new l.LngLat(d.lng,d.lat),this._ne=new l.LngLat(m.lng,m.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=l.LngLat.convert(t);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(t){return t instanceof Jt?t:t&&new Jt(t)}static fromLngLat(t,o=0){const c=360*o/40075017,d=c/Math.cos(Math.PI/180*t.lat);return new Jt(new l.LngLat(t.lng-d,t.lat-c),new l.LngLat(t.lng+d,t.lat+c))}}class ai{constructor(t,o,c){this.bounds=Jt.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),c=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*o),d=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*o),m=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*o),v=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*o);return t.x>=c&&t.x<m&&t.y>=d&&t.y<v}}class Hn extends l.Evented{constructor(t,o,c,d){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ar(this._options,this.map._requestManager,(m,v)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),m?this.fire(new l.ErrorEvent(m)):v&&(l.extend(this,v),v.bounds&&(this.tileBounds=new ai(v.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.extend({},this._options),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(o,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(c,ge.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function m(v,b){return delete t.request,t.aborted?o(null):v&&v.status!==404?o(v):(b&&b.resourceTiming&&(t.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&t.setExpiryData(b),t.loadVectorData(b,this.map.painter),o(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=o:t.request=t.actor.send("reloadTile",d,m.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",d,m.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class $i extends l.Evented{constructor(t,o,c,d){super(),this.id=t,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},o),l.extend(this,l.pick(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ar(this._options,this.map._requestManager,(t,o)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new l.ErrorEvent(t)):o&&(l.extend(this,o),o.bounds&&(this.tileBounds=new ai(o.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=_e.getImage(this.map._requestManager.transformRequest(c,ge.Tile),(d,m,v)=>{if(delete t.request,t.aborted)t.state="unloaded",o(null);else if(d)t.state="errored",o(d);else if(m){this.map._refreshExpiredTiles&&v&&t.setExpiryData(v);const b=this.map.painter.context,E=b.gl;t.texture=this.map.painter.getTileTexture(m.width),t.texture?t.texture.update(m,{useMipmap:!0}):(t.texture=new $e(b,m,E.RGBA,{useMipmap:!0}),t.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),t.state="loaded",o(null)}},this.map._refreshExpiredTiles)}abortTile(t,o){t.request&&(t.request.cancel(),delete t.request),o()}unloadTile(t,o){t.texture&&this.map.painter.saveTileTexture(t.texture),o()}hasTransition(){return!1}}class Qi extends $i{constructor(t,o,c,d){super(t,o,c,d),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(t,o){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function d(m,v){m&&(t.state="errored",o(m)),v&&(t.dem=v,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",o(null))}t.request=_e.getImage(this.map._requestManager.transformRequest(c,ge.Tile),function(m,v){if(delete t.request,t.aborted)t.state="unloaded",o(null);else if(m)t.state="errored",o(m);else if(v){this.map._refreshExpiredTiles&&t.setExpiryData(v),delete v.cacheControl,delete v.expires;const b=l.isImageBitmap(v)&&(_n==null&&(_n=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),_n)?v:l.browser.getImageData(v,1),E={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:b,encoding:this.encoding};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",E,d.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const o=t.canonical,c=Math.pow(2,o.z),d=(o.x-1+c)%c,m=o.x===0?t.wrap-1:t.wrap,v=(o.x+1+c)%c,b=o.x+1===c?t.wrap+1:t.wrap,E={};return E[new l.OverscaledTileID(t.overscaledZ,m,o.z,d,o.y).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,b,o.z,v,o.y).key]={backfilled:!1},o.y>0&&(E[new l.OverscaledTileID(t.overscaledZ,m,o.z,d,o.y-1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,b,o.z,v,o.y-1).key]={backfilled:!1}),o.y+1<c&&(E[new l.OverscaledTileID(t.overscaledZ,m,o.z,d,o.y+1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},E[new l.OverscaledTileID(t.overscaledZ,b,o.z,v,o.y+1).key]={backfilled:!1}),E}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class zn extends l.Evented{constructor(t,o,c,d){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.extend({},this._options,{type:this.type,data:this._data}),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(d),this._data=o.data,this._options=l.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const m=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*m,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*m,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:l.EXTENT,radius:(o.clusterRadius||50)*m,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},o),this}getClusterChildren(t,o){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},o),this}getClusterLeaves(t,o,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:o,offset:c},d),this}_updateWorkerData(t){const o=l.extend({},this.workerOptions);t?o.dataDiff=t:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(l.browser.resolveURL(this._data),ge.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,o,(c,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let m=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(m=d.resourceTiming[this.id].slice(0)),c)return void this.fire(new l.ErrorEvent(c));const v={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&l.extend(v,{resourceTiming:m}),this.fire(new l.Event("data",{...v,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...v,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(t,o){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,d,(m,v)=>(delete t.request,t.unloadVectorData(),t.aborted?o(null):m?o(m):(t.loadVectorData(v,this.map.painter,c==="reloadTile"),o(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Jr=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Gt extends l.Evented{constructor(t,o,c,d){super(),this.load=(m,v)=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=_e.getImage(this.map._requestManager.transformRequest(this.url,ge.Image),(b,E)=>{this._request=null,this._loaded=!0,b?this.fire(new l.ErrorEvent(b)):E&&(this.image=E,m&&(this.coordinates=m),v&&v(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const m=this.map.painter.context,v=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,Jr.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new $e(m,this.image,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE));let b=!1;for(const E in this.tiles){const k=this.tiles[E];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,b=!0)}b&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=o}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(d){let m=1/0,v=1/0,b=-1/0,E=-1/0;for(const F of d)m=Math.min(m,F.x),v=Math.min(v,F.y),b=Math.max(b,F.x),E=Math.max(E,F.y);const k=Math.max(b-m,E-v),I=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),P=Math.pow(2,I);return new l.CanonicalTileID(I,Math.floor((m+b)/2*P),Math.floor((v+E)/2*P))}(o),this.minzoom=this.maxzoom=this.tileID.z;const c=o.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}hasTransition(){return!1}}class br extends Gt{constructor(t,o,c,d){super(t,o,c,d),this.load=()=>{this._loaded=!1;const m=this.options;this.urls=[];for(const v of m.urls)this.urls.push(this.map._requestManager.transformRequest(v,ge.Source).url);l.getVideo(this.urls,(v,b)=>{this._loaded=!0,v?this.fire(new l.ErrorEvent(v)):b&&(this.video=b,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,v=m.gl;this.boundsBuffer||(this.boundsBuffer=m.createVertexBuffer(this._boundsArray,Jr.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.RGBA,v.UNSIGNED_BYTE,this.video)):(this.texture=new $e(m,this.video,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE));let b=!1;for(const E in this.tiles){const k=this.tiles[E];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,b=!0)}b&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=o}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ve extends Gt{constructor(t,o,c,d){super(t,o,c,d),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const v=this.map.painter.context,b=v.gl;this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,Jr.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new $e(v,this.canvas,b.RGBA,{premultiply:!0});let E=!1;for(const k in this.tiles){const I=this.tiles[k];I.state!=="loaded"&&(I.state="loaded",I.texture=this.texture,E=!0)}E&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(v=>typeof v!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Dn={},Yn=p=>{switch(p){case"geojson":return zn;case"image":return Gt;case"raster":return $i;case"raster-dem":return Qi;case"vector":return Hn;case"video":return br;case"canvas":return ve}return Dn[p]};function jt(p,t){const o=l.create();return l.translate(o,o,[1,1,0]),l.scale(o,o,[.5*p.width,.5*p.height,1]),l.multiply(o,o,p.calculatePosMatrix(t.toUnwrapped()))}function Lt(p,t,o,c,d,m){const v=function(P,F,q){if(P)for(const j of P){const W=F[j];if(W&&W.source===q&&W.type==="fill-extrusion")return!0}else for(const j in F){const W=F[j];if(W.source===q&&W.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,p.id),b=m.maxPitchScaleFactor(),E=p.tilesIn(c,b,v);E.sort(Ui);const k=[];for(const P of E)k.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,o,p._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,d,m,b,jt(p.transform,P.tileID))});const I=function(P){const F={},q={};for(const j of P){const W=j.queryResults,N=j.wrappedTileID,ie=q[N]=q[N]||{};for(const pe in W){const J=W[pe],se=ie[pe]=ie[pe]||{},me=F[pe]=F[pe]||[];for(const ye of J)se[ye.featureIndex]||(se[ye.featureIndex]=!0,me.push(ye))}}return F}(k);for(const P in I)I[P].forEach(F=>{const q=F.feature,j=p.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=j});return I}function Ui(p,t){const o=p.tileID,c=t.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}class Ni{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=l.uniqueId(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const o=t+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,m){const v={};if(!m)return v;for(const b of d){const E=b.layerIds.map(k=>m.getLayer(k)).filter(Boolean);if(E.length!==0){b.layers=E,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(k=>E.filter(I=>I.id===k)[0]));for(const k of E)v[k.id]=b}}return v}(t.buckets,o.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof l.SymbolBucket&&m.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(d).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $e(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $e(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,c,d,m,v,b,E,k,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:v,tileSize:this.tileSize,pixelPosMatrix:I,transform:E,params:b,queryPadding:this.queryPadding*k},t,o,c):{}}querySourceFeatures(t,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",v=d._geojsonTileLayer||d[m];if(!v)return;const b=l.createFilter(o&&o.filter),{z:E,x:k,y:I}=this.tileID.canonical,P={z:E,x:k,y:I};for(let F=0;F<v.length;F++){const q=v.feature(F);if(b.needGeometry){const N=l.toEvaluationFeature(q,!0);if(!b.filter(new l.EvaluationParameters(this.tileID.overscaledZ),N,this.tileID.canonical))continue}else if(!b.filter(new l.EvaluationParameters(this.tileID.overscaledZ),q))continue;const j=c.getId(q,m),W=new l.GeoJSONFeature(q,E,k,I,j);W.tile=P,t.push(W)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const c=l.parseCacheControl(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(o)if(this.expirationTime<o)d=!0;else{const m=this.expirationTime-o;m?this.expirationTime=c+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!o.style.hasLayer(d))continue;const m=this.buckets[d],v=m.layers[0].sourceLayer||"_geojsonTileLayer",b=c[v],E=t[v];if(!b||!E||Object.keys(E).length===0)continue;m.update(E,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=o&&o.style&&o.style.getLayer(d);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=l.browser.now()+t}setDependencies(t,o){const c={};for(const d of o)c[d]=!0;this.dependencies[t]=c}hasDependency(t,o){for(const c of t){const d=this.dependencies[c];if(d){for(const m of o)if(d[m])return!0}}return!1}}class eo{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,c){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:o,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(t,m)},c)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const c=t.wrapped().key,d=o===void 0?0:this.data[c].indexOf(o),m=this.data[c][d];return this.data[c].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const c in this.data)for(const d of this.data[c])t(d.value)||o.push(d);for(const c of o)this.remove(c.value.tileID,c)}}class xn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,c){const d=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},l.extend(this.stateChanges[t][d],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==d&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const m in this.state[t][d])c[m]||(this.deletedStates[t][d][m]=null)}else for(const m in c)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][m]===null&&delete this.deletedStates[t][d][m]}removeFeatureState(t,o,c){if(this.deletedStates[t]===null)return;const d=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&o!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][c]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(c in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][c]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,o){const c=String(o),d=l.extend({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][o];if(m===null)return{};for(const v in m)delete d[v]}return d}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const v in this.stateChanges[d])this.state[d][v]||(this.state[d][v]={}),l.extend(this.state[d][v],this.stateChanges[d][v]),m[v]=this.state[d][v];c[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const v in this.state[d])m[v]={},this.state[d][v]={};else for(const v in this.deletedStates[d]){if(this.deletedStates[d][v]===null)this.state[d][v]={};else for(const b of Object.keys(this.deletedStates[d][v]))delete this.state[d][v][b];m[v]=this.state[d][v]}c[d]=c[d]||{},l.extend(c[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in t)t[d].setFeatureState(c,o)}}class ar extends l.Evented{constructor(t,o,c){super(),this.id=t,this.dispatcher=c,this.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,v,b)=>{const E=new(Yn(m.type))(d,m,v,b);if(E.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${E.id}`);return E})(t,o,c,this),this._tiles={},this._cache=new eo(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new xn,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o){return this._source.loadTile(t,o)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new l.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Ti).map(t=>t.key)}getRenderableIds(t){const o=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&o.push(this._tiles[c]);return t?o.sort((c,d)=>{const m=c.tileID,v=d.tileID,b=new l.Point(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),E=new l.Point(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-v.overscaledZ||E.y-b.y||E.x-b.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(Ti).map(c=>c.key)}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,o){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,t,o)))}_tileLoaded(t,o,c,d){if(d)return t.state="errored",void(d.status!==404?this._source.fire(new l.ErrorEvent(d,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=l.browser.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const o=this.getRenderableIds();for(let d=0;d<o.length;d++){const m=o[d];if(t.neighboringTiles&&t.neighboringTiles[m]){const v=this.getTileByID(m);c(t,v),c(v,t)}}function c(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let v=m.tileID.canonical.x-d.tileID.canonical.x;const b=m.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),k=m.tileID.key;v===0&&b===0||Math.abs(b)>1||(Math.abs(v)>1&&(Math.abs(v+E)===1?v+=E:Math.abs(v-E)===1&&(v-=E)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,v,b),d.neighboringTiles&&d.neighboringTiles[k]&&(d.neighboringTiles[k].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,c,d){for(const m in this._tiles){let v=this._tiles[m];if(d[m]||!v.hasData()||v.tileID.overscaledZ<=o||v.tileID.overscaledZ>c)continue;let b=v.tileID;for(;v&&v.tileID.overscaledZ>o+1;){const k=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[k.key],v&&v.hasData()&&(b=k)}let E=b;for(;E.overscaledZ>o;)if(E=E.scaledTo(E.overscaledZ-1),t[E.key]){d[b.key]=b;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=t.overscaledZ-1;c>=o;c--){const d=t.scaledTo(c),m=this._getLoadedTile(d);if(m)return m}}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(o*c*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const c={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),c[m.tileID.key]=m}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(t,o){if(this.transform=t,this.terrain=o,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new l.OverscaledTileID(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(c=c.filter(I=>this._source.hasTile(I)))):c=[];const d=t.coveringZoomLevel(this._source),m=Math.max(d-ar.maxOverzooming,this._source.minzoom),v=Math.max(d+ar.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const I={};for(const P of c)if(P.canonical.z>this._source.minzoom){const F=P.scaledTo(P.canonical.z-1);I[F.key]=F;const q=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));I[q.key]=q}c=c.concat(Object.values(I))}const b=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(c,d);if(Vi(this._source.type)){const I={},P={},F=Object.keys(E),q=l.browser.now();for(const j of F){const W=E[j],N=this._tiles[j];if(!N||N.fadeEndTime!==0&&N.fadeEndTime<=q)continue;const ie=this.findLoadedParent(W,m);ie&&(this._addTile(ie.tileID),I[ie.tileID.key]=ie.tileID),P[j]=W}this._retainLoadedChildren(P,d,v,E);for(const j in I)E[j]||(this._coveredTiles[j]=!0,E[j]=I[j]);if(o){const j={},W={};for(const N of c)this._tiles[N.key].hasData()?j[N.key]=N:W[N.key]=N;for(const N in W){const ie=W[N].children(this._source.maxzoom);this._tiles[ie[0].key]&&this._tiles[ie[1].key]&&this._tiles[ie[2].key]&&this._tiles[ie[3].key]&&(j[ie[0].key]=E[ie[0].key]=ie[0],j[ie[1].key]=E[ie[1].key]=ie[1],j[ie[2].key]=E[ie[2].key]=ie[2],j[ie[3].key]=E[ie[3].key]=ie[3],delete W[N])}for(const N in W){const ie=this.findLoadedParent(W[N],this._source.minzoom);if(ie){j[ie.tileID.key]=E[ie.tileID.key]=ie.tileID;for(const pe in j)j[pe].isChildOf(ie.tileID)&&delete j[pe]}}for(const N in this._tiles)j[N]||(this._coveredTiles[N]=!0)}}for(const I in E)this._tiles[I].clearFadeHold();const k=l.keysDifference(this._tiles,E);for(const I of k){const P=this._tiles[I];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(I)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){const c={},d={},m=Math.max(o-ar.maxOverzooming,this._source.minzoom),v=Math.max(o+ar.maxUnderzooming,this._source.minzoom),b={};for(const E of t){const k=this._addTile(E);c[E.key]=E,k.hasData()||o<this._source.maxzoom&&(b[E.key]=E)}this._retainLoadedChildren(b,o,v,c);for(const E of t){let k=this._tiles[E.key];if(k.hasData())continue;if(o+1>this._source.maxzoom){const P=E.children(this._source.maxzoom)[0],F=this.getTile(P);if(F&&F.hasData()){c[P.key]=P;continue}}else{const P=E.children(this._source.maxzoom);if(c[P[0].key]&&c[P[1].key]&&c[P[2].key]&&c[P[3].key])continue}let I=k.wasRequested();for(let P=E.overscaledZ-1;P>=m;--P){const F=E.scaledTo(P);if(d[F.key])break;if(d[F.key]=!0,k=this.getTile(F),!k&&I&&(k=this._addTile(F)),k){const q=k.hasData();if((I||q)&&(c[F.key]=F),I=k.wasRequested(),q)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let c,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}o.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;d=m}for(const m of o)this._loadedParentTiles[m]=c}}_addTile(t){let o=this._tiles[t.key];if(o)return o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const c=o;return o||(o=new Ni(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,t.key,o.state))),o.uses++,this._tiles[t.key]=o,c||this._source.fire(new l.Event("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=o.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,o,c){const d=[],m=this.transform;if(!m)return d;const v=c?m.getCameraQueryGeometry(t):t,b=t.map(j=>m.pointCoordinate(j,this.terrain)),E=v.map(j=>m.pointCoordinate(j,this.terrain)),k=this.getIds();let I=1/0,P=1/0,F=-1/0,q=-1/0;for(const j of E)I=Math.min(I,j.x),P=Math.min(P,j.y),F=Math.max(F,j.x),q=Math.max(q,j.y);for(let j=0;j<k.length;j++){const W=this._tiles[k[j]];if(W.holdingForFade())continue;const N=W.tileID,ie=Math.pow(2,m.zoom-W.tileID.overscaledZ),pe=o*W.queryPadding*l.EXTENT/W.tileSize/ie,J=[N.getTilePoint(new l.MercatorCoordinate(I,P)),N.getTilePoint(new l.MercatorCoordinate(F,q))];if(J[0].x-pe<l.EXTENT&&J[0].y-pe<l.EXTENT&&J[1].x+pe>=0&&J[1].y+pe>=0){const se=b.map(ye=>N.getTilePoint(ye)),me=E.map(ye=>N.getTilePoint(ye));d.push({tile:W,tileID:N,queryGeometry:se,cameraQueryGeometry:me,scale:ie})}}return d}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of o)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Vi(this._source.type)){const t=l.browser.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=t)return!0}return!1}setFeatureState(t,o,c){this._state.updateState(t=t||"_geojsonTileLayer",o,c)}removeFeatureState(t,o,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,c)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,c){const d=this._tiles[t];d&&d.setDependencies(o,c)}reloadTilesForDependencies(t,o){for(const c in this._tiles)this._tiles[c].hasDependency(t,o)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,o))}}function Ti(p,t){const o=Math.abs(2*p.wrap)-+(p.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return p.overscaledZ-t.overscaledZ||c-o||t.canonical.y-p.canonical.y||t.canonical.x-p.canonical.x}function Vi(p){return p==="raster"||p==="image"||p==="video"}ar.maxOverzooming=10,ar.maxUnderzooming=3;const Fe="mapboxgl_preloaded_worker_pool";class Fr{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Fr.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Fe]}numActive(){return Object.keys(this.active).length}}const Gr=Math.floor(l.browser.hardwareConcurrency/2);let qt;function si(){return qt||(qt=new Fr),qt}Fr.workerCount=l.isSafari(globalThis)?Math.max(Math.min(Gr,3),1):1;class Be{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.clamp(t,0,1);let o=1,c=this._distances[o];const d=t*this.paddedLength+this.padding;for(;c<d&&o<this._distances.length;)c=this._distances[++o];const m=o-1,v=this._distances[m],b=c-v,E=b>0?(d-v)/b:0;return this.points[m].mult(1-E).add(this.points[o].mult(E))}}function xt(p,t){let o=!0;return p==="always"||p!=="never"&&t!=="never"||(o=!1),o}class vt{constructor(t,o,c){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(o/c);for(let v=0;v<this.xCellCount*this.yCellCount;v++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,c,d,m){this._forEachCell(o,c,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(t,o,c,d){this._forEachCell(o-d,c-d,o+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(c),this.circles.push(d)}_insertBoxCell(t,o,c,d,m,v){this.boxCells[m].push(v)}_insertCircleCell(t,o,c,d,m,v){this.circleCells[m].push(v)}_query(t,o,c,d,m,v,b){if(c<0||t>this.width||d<0||o>this.height)return[];const E=[];if(t<=0&&o<=0&&this.width<=c&&this.height<=d){if(m)return[{key:null,x1:t,y1:o,x2:c,y2:d}];for(let k=0;k<this.boxKeys.length;k++)E.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const I=this.circles[3*k],P=this.circles[3*k+1],F=this.circles[3*k+2];E.push({key:this.circleKeys[k],x1:I-F,y1:P-F,x2:I+F,y2:P+F})}}else this._forEachCell(t,o,c,d,this._queryCell,E,{hitTest:m,overlapMode:v,seenUids:{box:{},circle:{}}},b);return E}query(t,o,c,d){return this._query(t,o,c,d,!1,null)}hitTest(t,o,c,d,m,v){return this._query(t,o,c,d,!0,m,v).length>0}hitTestCircle(t,o,c,d,m){const v=t-c,b=t+c,E=o-c,k=o+c;if(b<0||v>this.width||k<0||E>this.height)return!1;const I=[];return this._forEachCell(v,E,b,k,this._queryCellCircle,I,{hitTest:!0,overlapMode:d,circle:{x:t,y:o,radius:c},seenUids:{box:{},circle:{}}},m),I.length>0}_queryCell(t,o,c,d,m,v,b,E){const{seenUids:k,hitTest:I,overlapMode:P}=b,F=this.boxCells[m];if(F!==null){const j=this.bboxes;for(const W of F)if(!k.box[W]){k.box[W]=!0;const N=4*W,ie=this.boxKeys[W];if(t<=j[N+2]&&o<=j[N+3]&&c>=j[N+0]&&d>=j[N+1]&&(!E||E(ie))&&(!I||!xt(P,ie.overlapMode))&&(v.push({key:ie,x1:j[N],y1:j[N+1],x2:j[N+2],y2:j[N+3]}),I))return!0}}const q=this.circleCells[m];if(q!==null){const j=this.circles;for(const W of q)if(!k.circle[W]){k.circle[W]=!0;const N=3*W,ie=this.circleKeys[W];if(this._circleAndRectCollide(j[N],j[N+1],j[N+2],t,o,c,d)&&(!E||E(ie))&&(!I||!xt(P,ie.overlapMode))){const pe=j[N],J=j[N+1],se=j[N+2];if(v.push({key:ie,x1:pe-se,y1:J-se,x2:pe+se,y2:J+se}),I)return!0}}}return!1}_queryCellCircle(t,o,c,d,m,v,b,E){const{circle:k,seenUids:I,overlapMode:P}=b,F=this.boxCells[m];if(F!==null){const j=this.bboxes;for(const W of F)if(!I.box[W]){I.box[W]=!0;const N=4*W,ie=this.boxKeys[W];if(this._circleAndRectCollide(k.x,k.y,k.radius,j[N+0],j[N+1],j[N+2],j[N+3])&&(!E||E(ie))&&!xt(P,ie.overlapMode))return v.push(!0),!0}}const q=this.circleCells[m];if(q!==null){const j=this.circles;for(const W of q)if(!I.circle[W]){I.circle[W]=!0;const N=3*W,ie=this.circleKeys[W];if(this._circlesCollide(j[N],j[N+1],j[N+2],k.x,k.y,k.radius)&&(!E||E(ie))&&!xt(P,ie.overlapMode))return v.push(!0),!0}}}_forEachCell(t,o,c,d,m,v,b,E){const k=this._convertToXCellCoord(t),I=this._convertToYCellCoord(o),P=this._convertToXCellCoord(c),F=this._convertToYCellCoord(d);for(let q=k;q<=P;q++)for(let j=I;j<=F;j++)if(m.call(this,t,o,c,d,this.xCellCount*j+q,v,b,E))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,c,d,m,v){const b=d-t,E=m-o,k=c+v;return k*k>b*b+E*E}_circleAndRectCollide(t,o,c,d,m,v,b){const E=(v-d)/2,k=Math.abs(t-(d+E));if(k>E+c)return!1;const I=(b-m)/2,P=Math.abs(o-(m+I));if(P>I+c)return!1;if(k<=E||P<=I)return!0;const F=k-E,q=P-I;return F*F+q*q<=c*c}}function Qr(p,t,o,c,d){const m=l.create();return t?(l.scale(m,m,[1/d,1/d,1]),o||l.rotateZ(m,m,c.angle)):l.multiply(m,c.labelPlaneMatrix,p),m}function ji(p,t,o,c,d){if(t){const m=l.clone(p);return l.scale(m,m,[d,d,1]),o||l.rotateZ(m,m,-c.angle),m}return c.glCoordMatrix}function pt(p,t,o){let c;o?(c=[p.x,p.y,o(p.x,p.y),1],l.transformMat4(c,c,t)):(c=[p.x,p.y,0,1],Y(c,c,t));const d=c[3];return{point:new l.Point(c[0]/d,c[1]/d),signedDistanceFromCamera:d}}function Ci(p,t){return .5+p/t*.5}function ki(p,t){const o=p[0]/p[3],c=p[1]/p[3];return o>=-t[0]&&o<=t[0]&&c>=-t[1]&&c<=t[1]}function to(p,t,o,c,d,m,v,b,E,k){const I=c?p.textSizeData:p.iconSizeData,P=l.evaluateSizeForZoom(I,o.transform.zoom),F=[256/o.width*2+1,256/o.height*2+1],q=c?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;q.clear();const j=p.lineVertexArray,W=c?p.text.placedSymbolArray:p.icon.placedSymbolArray,N=o.transform.width/o.transform.height;let ie=!1;for(let pe=0;pe<W.length;pe++){const J=W.get(pe);if(J.hidden||J.writingMode===l.WritingMode.vertical&&!ie){U(J.numGlyphs,q);continue}let se;if(ie=!1,k?(se=[J.anchorX,J.anchorY,k(J.anchorX,J.anchorY),1],l.transformMat4(se,se,t)):(se=[J.anchorX,J.anchorY,0,1],Y(se,se,t)),!ki(se,F)){U(J.numGlyphs,q);continue}const me=Ci(o.transform.cameraToCenterDistance,se[3]),ye=l.evaluateSizeForFeature(I,P,J),be=v?ye/me:ye*me,Ae=new l.Point(J.anchorX,J.anchorY),ke=pt(Ae,d,k).point,ze={projections:{},offsets:{}},Qe=Zr(J,be,!1,b,t,d,m,p.glyphOffsetArray,j,q,ke,Ae,ze,N,E,k);ie=Qe.useVertical,(Qe.notEnoughRoom||ie||Qe.needsFlipping&&Zr(J,be,!0,b,t,d,m,p.glyphOffsetArray,j,q,ke,Ae,ze,N,E,k).notEnoughRoom)&&U(J.numGlyphs,q)}c?p.text.dynamicLayoutVertexBuffer.updateData(q):p.icon.dynamicLayoutVertexBuffer.updateData(q)}function Jn(p,t,o,c,d,m,v,b,E,k,I,P,F){const q=b.glyphStartIndex+b.numGlyphs,j=b.lineStartIndex,W=b.lineStartIndex+b.lineLength,N=t.getoffsetX(b.glyphStartIndex),ie=t.getoffsetX(q-1),pe=z(p*N,o,c,d,m,v,b.segment,j,W,E,k,I,P,F);if(!pe)return null;const J=z(p*ie,o,c,d,m,v,b.segment,j,W,E,k,I,P,F);return J?{first:pe,last:J}:null}function ro(p,t,o,c){return p===l.WritingMode.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*c?{useVertical:!0}:(p===l.WritingMode.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function Zr(p,t,o,c,d,m,v,b,E,k,I,P,F,q,j,W){const N=t/24,ie=p.lineOffsetX*N,pe=p.lineOffsetY*N;let J;if(p.numGlyphs>1){const se=p.glyphStartIndex+p.numGlyphs,me=p.lineStartIndex,ye=p.lineStartIndex+p.lineLength,be=Jn(N,b,ie,pe,o,I,P,p,E,m,F,j,W);if(!be)return{notEnoughRoom:!0};const Ae=pt(be.first.point,v,W).point,ke=pt(be.last.point,v,W).point;if(c&&!o){const ze=ro(p.writingMode,Ae,ke,q);if(ze)return ze}J=[be.first];for(let ze=p.glyphStartIndex+1;ze<se-1;ze++)J.push(z(N*b.getoffsetX(ze),ie,pe,o,I,P,p.segment,me,ye,E,m,F,j,W));J.push(be.last)}else{if(c&&!o){const me=pt(P,d,W).point,ye=p.lineStartIndex+p.segment+1,be=new l.Point(E.getx(ye),E.gety(ye)),Ae=pt(be,d,W),ke=Ae.signedDistanceFromCamera>0?Ae.point:er(P,be,me,1,d,W),ze=ro(p.writingMode,me,ke,q);if(ze)return ze}const se=z(N*b.getoffsetX(p.glyphStartIndex),ie,pe,o,I,P,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,E,m,F,j,W);if(!se)return{notEnoughRoom:!0};J=[se]}for(const se of J)l.addDynamicAttributes(k,se.point,se.angle);return{}}function er(p,t,o,c,d,m){const v=pt(p.add(p.sub(t)._unit()),d,m).point,b=o.sub(v);return o.add(b._mult(c/b.mag()))}function _a(p,t){const{projectionCache:o,lineVertexArray:c,labelPlaneMatrix:d,tileAnchorPoint:m,distanceFromAnchor:v,getElevation:b,previousVertex:E,direction:k,absOffsetX:I}=t;if(o.projections[p])return o.projections[p];const P=new l.Point(c.getx(p),c.gety(p)),F=pt(P,d,b);if(F.signedDistanceFromCamera>0)return o.projections[p]=F.point,F.point;const q=p-k;return er(v===0?m:new l.Point(c.getx(q),c.gety(q)),P,E,I-v+1,d,b)}function Ii(p,t,o){return p._unit()._perp()._mult(t*o)}function X(p,t,o,c,d,m,v,b){const{projectionCache:E,direction:k}=b;if(E.offsets[p])return E.offsets[p];const I=o.add(t);if(p+k<c||p+k>=d)return E.offsets[p]=I,I;const P=_a(p+k,b),F=Ii(P.sub(o),v,k),q=o.add(F),j=P.add(F);return E.offsets[p]=l.findLineIntersection(m,I,q,j)||I,E.offsets[p]}function z(p,t,o,c,d,m,v,b,E,k,I,P,F,q){const j=c?p-t:p+t;let W=j>0?1:-1,N=0;c&&(W*=-1,N=Math.PI),W<0&&(N+=Math.PI);let ie,pe,J=W>0?b+v:b+v+1,se=d,me=d,ye=0,be=0;const Ae=Math.abs(j),ke=[];let ze;for(;ye+be<=Ae;){if(J+=W,J<b||J>=E)return null;ye+=be,me=se,pe=ie;const Ue={projectionCache:P,lineVertexArray:k,labelPlaneMatrix:I,tileAnchorPoint:m,distanceFromAnchor:ye,getElevation:q,previousVertex:me,direction:W,absOffsetX:Ae};if(se=_a(J,Ue),o===0)ke.push(me),ze=se.sub(me);else{let st;const Ye=se.sub(me);st=Ye.mag()===0?Ii(_a(J+W,Ue).sub(se),o,W):Ii(Ye,o,W),pe||(pe=me.add(st)),ie=X(J,st,se,b,E,pe,o,Ue),ke.push(pe),ze=ie.sub(pe)}be=ze.mag()}const Qe=ze._mult((Ae-ye)/be)._add(pe||me),St=N+Math.atan2(se.y-me.y,se.x-me.x);return ke.push(Qe),{point:Qe,angle:F?St:0,path:ke}}const L=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function U(p,t){for(let o=0;o<p;o++){const c=t.length;t.resize(c+4),t.float32.set(L,3*c)}}function Y(p,t,o){const c=t[0],d=t[1];return p[0]=o[0]*c+o[4]*d+o[12],p[1]=o[1]*c+o[5]*d+o[13],p[3]=o[3]*c+o[7]*d+o[15],p}const ee=100;class le{constructor(t,o=new vt(t.width+200,t.height+200,25),c=new vt(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ee,this.screenBottomBoundary=t.height+ee,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,c,d,m,v){const b=this.projectAndGetPerspectiveRatio(d,t.anchorPointX,t.anchorPointY,v),E=c*b.perspectiveRatio,k=t.x1*E+b.point.x,I=t.y1*E+b.point.y,P=t.x2*E+b.point.x,F=t.y2*E+b.point.y;return!this.isInsideGrid(k,I,P,F)||o!=="always"&&this.grid.hitTest(k,I,P,F,o,m)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,I,P,F],offscreen:this.isOffscreen(k,I,P,F)}}placeCollisionCircles(t,o,c,d,m,v,b,E,k,I,P,F,q,j){const W=[],N=new l.Point(o.anchorX,o.anchorY),ie=pt(N,v,j),pe=Ci(this.transform.cameraToCenterDistance,ie.signedDistanceFromCamera),J=(I?m/pe:m*pe)/l.ONE_EM,se=pt(N,b,j).point,me=Jn(J,d,o.lineOffsetX*J,o.lineOffsetY*J,!1,se,N,o,c,b,{projections:{},offsets:{}},!1,j);let ye=!1,be=!1,Ae=!0;if(me){const ke=.5*F*pe+q,ze=new l.Point(-100,-100),Qe=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),St=new Be,Ue=me.first,st=me.last;let Ye=[];for(let lt=Ue.path.length-1;lt>=1;lt--)Ye.push(Ue.path[lt]);for(let lt=1;lt<st.path.length;lt++)Ye.push(st.path[lt]);const lr=2.5*ke;if(E){const lt=Ye.map(Tt=>pt(Tt,E,j));Ye=lt.some(Tt=>Tt.signedDistanceFromCamera<=0)?[]:lt.map(Tt=>Tt.point)}let Et=[];if(Ye.length>0){const lt=Ye[0].clone(),Tt=Ye[0].clone();for(let hr=1;hr<Ye.length;hr++)lt.x=Math.min(lt.x,Ye[hr].x),lt.y=Math.min(lt.y,Ye[hr].y),Tt.x=Math.max(Tt.x,Ye[hr].x),Tt.y=Math.max(Tt.y,Ye[hr].y);Et=lt.x>=ze.x&&Tt.x<=Qe.x&&lt.y>=ze.y&&Tt.y<=Qe.y?[Ye]:Tt.x<ze.x||lt.x>Qe.x||Tt.y<ze.y||lt.y>Qe.y?[]:l.clipLine([Ye],ze.x,ze.y,Qe.x,Qe.y)}for(const lt of Et){St.reset(lt,.25*ke);let Tt=0;Tt=St.length<=.5*ke?1:Math.ceil(St.paddedLength/lr)+1;for(let hr=0;hr<Tt;hr++){const Wt=hr/Math.max(Tt-1,1),$n=St.lerp(Wt),Xr=$n.x+ee,yr=$n.y+ee;W.push(Xr,yr,ke,0);const Sn=Xr-ke,zi=yr-ke,ci=Xr+ke,Di=yr+ke;if(Ae=Ae&&this.isOffscreen(Sn,zi,ci,Di),be=be||this.isInsideGrid(Sn,zi,ci,Di),t!=="always"&&this.grid.hitTestCircle(Xr,yr,ke,t,P)&&(ye=!0,!k))return{circles:[],offscreen:!1,collisionDetected:ye}}}}return{circles:!k&&ye||!be||pe<this.perspectiveRatioCutoff?[]:W,offscreen:Ae,collisionDetected:ye}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,d=1/0,m=-1/0,v=-1/0;for(const I of t){const P=new l.Point(I.x+ee,I.y+ee);c=Math.min(c,P.x),d=Math.min(d,P.y),m=Math.max(m,P.x),v=Math.max(v,P.y),o.push(P)}const b=this.grid.query(c,d,m,v).concat(this.ignoredGrid.query(c,d,m,v)),E={},k={};for(const I of b){const P=I.key;if(E[P.bucketInstanceId]===void 0&&(E[P.bucketInstanceId]={}),E[P.bucketInstanceId][P.featureIndex])continue;const F=[new l.Point(I.x1,I.y1),new l.Point(I.x2,I.y1),new l.Point(I.x2,I.y2),new l.Point(I.x1,I.y2)];l.polygonIntersectsPolygon(o,F)&&(E[P.bucketInstanceId][P.featureIndex]=!0,k[P.bucketInstanceId]===void 0&&(k[P.bucketInstanceId]=[]),k[P.bucketInstanceId].push(P.featureIndex))}return k}insertCollisionBox(t,o,c,d,m,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:v,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,c,d,m,v){const b=c?this.ignoredGrid:this.grid,E={bucketInstanceId:d,featureIndex:m,collisionGroupID:v,overlapMode:o};for(let k=0;k<t.length;k+=4)b.insertCircle(E,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,o,c,d){let m;return d?(m=[o,c,d(o,c),1],l.transformMat4(m,m,t)):(m=[o,c,0,1],Y(m,m,t)),{point:new l.Point((m[0]/m[3]+1)/2*this.transform.width+ee,(-m[1]/m[3]+1)/2*this.transform.height+ee),perspectiveRatio:.5+this.transform.cameraToCenterDistance/m[3]*.5}}isOffscreen(t,o,c,d){return c<ee||t>=this.screenRightBoundary||d<ee||o>this.screenBottomBoundary}isInsideGrid(t,o,c,d){return c>=0&&t<this.gridRightBoundary&&d>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=l.identity([]);return l.translate(t,t,[-100,-100,0]),t}}function re(p,t,o){return t*(l.EXTENT/(p.tileSize*Math.pow(2,o-p.tileID.overscaledZ)))}class te{constructor(t,o,c,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class ue{constructor(t,o,c,d,m){this.text=new te(t?t.text:null,o,c,m),this.icon=new te(t?t.icon:null,o,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Se{constructor(t,o,c){this.text=t,this.icon=o,this.skipFade=c}}class Ee{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class Te{constructor(t,o,c,d,m){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=m}}class ht{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[t]}}function gt(p,t,o,c,d){const{horizontalAlign:m,verticalAlign:v}=l.getAnchorAlignment(p);return new l.Point(-(m-.5)*t+c[0]*d,-(v-.5)*o+c[1]*d)}function Je(p,t,o,c,d,m){const{x1:v,x2:b,y1:E,y2:k,anchorPointX:I,anchorPointY:P}=p,F=new l.Point(t,o);return c&&F._rotate(d?m:-m),{x1:v+F.x,y1:E+F.y,x2:b+F.x,y2:k+F.y,anchorPointX:I,anchorPointY:P}}class at{constructor(t,o,c,d,m){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new le(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new ht(d),this.collisionCircleArrays={},this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,o,c,d){const m=c.getBucket(o),v=c.latestFeatureIndex;if(!m||!v||o.id!==m.layerIds[0])return;const b=c.collisionBoxArray,E=m.layers[0].layout,k=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),I=c.tileSize/l.EXTENT,P=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),F=E.get("text-pitch-alignment")==="map",q=E.get("text-rotation-alignment")==="map",j=re(c,1,this.transform.zoom),W=Qr(P,F,q,this.transform,j);let N=null;if(F){const pe=ji(P,F,q,this.transform,j);N=l.multiply([],this.transform.labelPlaneMatrix,pe)}this.retainedQueryData[m.bucketInstanceId]=new Te(m.bucketInstanceId,v,m.sourceLayerIndex,m.index,c.tileID);const ie={bucket:m,layout:E,posMatrix:P,textLabelPlaneMatrix:W,labelToScreenMatrix:N,scale:k,textPixelRatio:I,holdingForFade:c.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const pe of m.sortKeyRanges){const{sortKey:J,symbolInstanceStart:se,symbolInstanceEnd:me}=pe;t.push({sortKey:J,symbolInstanceStart:se,symbolInstanceEnd:me,parameters:ie})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:ie})}attemptAnchorPlacement(t,o,c,d,m,v,b,E,k,I,P,F,q,j,W,N){const ie=l.TextAnchorEnum[t.textAnchor],pe=[t.textOffset0,t.textOffset1],J=gt(ie,c,d,pe,m),se=this.collisionIndex.placeCollisionBox(Je(o,J.x,J.y,v,b,this.transform.angle),P,E,k,I.predicate,N);if((!W||this.collisionIndex.placeCollisionBox(Je(W,J.x,J.y,v,b,this.transform.angle),P,E,k,I.predicate,N).box.length!==0)&&se.box.length>0){let me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(me=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:pe,width:c,height:d,anchor:ie,textBoxScale:m,prevAnchor:me},this.markUsedJustification(q,ie,F,j),q.allowVerticalPlacement&&(this.markUsedOrientation(q,j,F),this.placedOrientations[F.crossTileID]=j),{shift:J,placedGlyphBoxes:se}}}placeLayerBucketPart(t,o,c){const{bucket:d,layout:m,posMatrix:v,textLabelPlaneMatrix:b,labelToScreenMatrix:E,textPixelRatio:k,holdingForFade:I,collisionBoxArray:P,partiallyEvaluatedTextSize:F,collisionGroup:q}=t.parameters,j=m.get("text-optional"),W=m.get("icon-optional"),N=l.getOverlapMode(m,"text-overlap","text-allow-overlap"),ie=N==="always",pe=l.getOverlapMode(m,"icon-overlap","icon-allow-overlap"),J=pe==="always",se=m.get("text-rotation-alignment")==="map",me=m.get("text-pitch-alignment")==="map",ye=m.get("icon-text-fit")!=="none",be=m.get("symbol-z-order")==="viewport-y",Ae=ie&&(J||!d.hasIconData()||W),ke=J&&(ie||!d.hasTextData()||j);!d.collisionArrays&&P&&d.deserializeCollisionBoxes(P);const ze=this.retainedQueryData[d.bucketInstanceId].tileID,Qe=this.terrain?(Ue,st)=>this.terrain.getElevation(ze,Ue,st):null,St=(Ue,st)=>{var Ye,lr;if(o[Ue.crossTileID])return;if(I)return void(this.placements[Ue.crossTileID]=new Se(!1,!1,!1));let Et=!1,lt=!1,Tt=!0,hr=null,Wt={box:null,offscreen:null},$n={box:null,offscreen:null},Xr=null,yr=null,Sn=null,zi=0,ci=0,Di=0;st.textFeatureIndex?zi=st.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(zi=Ue.featureIndex),st.verticalTextFeatureIndex&&(ci=st.verticalTextFeatureIndex);const Jo=st.textBox;if(Jo){const kr=Or=>{let zr=l.WritingMode.horizontal;if(d.allowVerticalPlacement&&!Or&&this.prevPlacement){const nn=this.prevPlacement.placedOrientations[Ue.crossTileID];nn&&(this.placedOrientations[Ue.crossTileID]=nn,zr=nn,this.markUsedOrientation(d,zr,Ue))}return zr},Br=(Or,zr)=>{if(d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&st.verticalTextBox){for(const nn of d.writingModes)if(nn===l.WritingMode.vertical?(Wt=zr(),$n=Wt):Wt=Or(),Wt&&Wt.box&&Wt.box.length)break}else Wt=Or()},rn=Ue.textAnchorOffsetStartIndex,Qo=Ue.textAnchorOffsetEndIndex;if(Qo===rn){const Or=(zr,nn)=>{const dr=this.collisionIndex.placeCollisionBox(zr,N,k,v,q.predicate,Qe);return dr&&dr.box&&dr.box.length&&(this.markUsedOrientation(d,nn,Ue),this.placedOrientations[Ue.crossTileID]=nn),dr};Br(()=>Or(Jo,l.WritingMode.horizontal),()=>{const zr=st.verticalTextBox;return d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&zr?Or(zr,l.WritingMode.vertical):{box:null,offscreen:null}}),kr(Wt&&Wt.box&&Wt.box.length)}else{let Or=l.TextAnchorEnum[(lr=(Ye=this.prevPlacement)===null||Ye===void 0?void 0:Ye.variableOffsets[Ue.crossTileID])===null||lr===void 0?void 0:lr.anchor];const zr=(dr,Wi,ui)=>{const lo=dr.x2-dr.x1,mu=dr.y2-dr.y1,Ao=Ue.textBoxScale,Ld=ye&&pe==="never"?Wi:null;let Po={box:[],offscreen:!1},gr=N==="never"?1:2,Ns="never";Or&&gr++;for(let Wl=0;Wl<gr;Wl++){for(let Xi=rn;Xi<Qo;Xi++){const co=d.textAnchorOffsets.get(Xi);if(Or&&co.textAnchor!==Or)continue;const ea=this.attemptAnchorPlacement(co,dr,lo,mu,Ao,se,me,k,v,q,Ns,Ue,d,ui,Ld,Qe);if(ea&&(Po=ea.placedGlyphBoxes,Po&&Po.box&&Po.box.length))return Et=!0,hr=ea.shift,Po}Or?Or=null:Ns=N}return Po};Br(()=>zr(Jo,st.iconBox,l.WritingMode.horizontal),()=>{const dr=st.verticalTextBox;return d.allowVerticalPlacement&&!(Wt&&Wt.box&&Wt.box.length)&&Ue.numVerticalGlyphVertices>0&&dr?zr(dr,st.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),Wt&&(Et=Wt.box,Tt=Wt.offscreen);const nn=kr(Wt&&Wt.box);if(!Et&&this.prevPlacement){const dr=this.prevPlacement.variableOffsets[Ue.crossTileID];dr&&(this.variableOffsets[Ue.crossTileID]=dr,this.markUsedJustification(d,dr.anchor,Ue,nn))}}}if(Xr=Wt,Et=Xr&&Xr.box&&Xr.box.length>0,Tt=Xr&&Xr.offscreen,Ue.useRuntimeCollisionCircles){const kr=d.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),Br=l.evaluateSizeForFeature(d.textSizeData,F,kr),rn=m.get("text-padding");yr=this.collisionIndex.placeCollisionCircles(N,kr,d.lineVertexArray,d.glyphOffsetArray,Br,v,b,E,c,me,q.predicate,Ue.collisionCircleDiameter,rn,Qe),yr.circles.length&&yr.collisionDetected&&!c&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Et=ie||yr.circles.length>0&&!yr.collisionDetected,Tt=Tt&&yr.offscreen}if(st.iconFeatureIndex&&(Di=st.iconFeatureIndex),st.iconBox){const kr=Br=>{const rn=ye&&hr?Je(Br,hr.x,hr.y,se,me,this.transform.angle):Br;return this.collisionIndex.placeCollisionBox(rn,pe,k,v,q.predicate,Qe)};$n&&$n.box&&$n.box.length&&st.verticalIconBox?(Sn=kr(st.verticalIconBox),lt=Sn.box.length>0):(Sn=kr(st.iconBox),lt=Sn.box.length>0),Tt=Tt&&Sn.offscreen}const so=j||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,Zi=W||Ue.numIconVertices===0;if(so||Zi?Zi?so||(lt=lt&&Et):Et=lt&&Et:lt=Et=lt&&Et,Et&&Xr&&Xr.box&&this.collisionIndex.insertCollisionBox(Xr.box,N,m.get("text-ignore-placement"),d.bucketInstanceId,$n&&$n.box&&ci?ci:zi,q.ID),lt&&Sn&&this.collisionIndex.insertCollisionBox(Sn.box,pe,m.get("icon-ignore-placement"),d.bucketInstanceId,Di,q.ID),yr&&(Et&&this.collisionIndex.insertCollisionCircles(yr.circles,N,m.get("text-ignore-placement"),d.bucketInstanceId,zi,q.ID),c)){const kr=d.bucketInstanceId;let Br=this.collisionCircleArrays[kr];Br===void 0&&(Br=this.collisionCircleArrays[kr]=new Ee);for(let rn=0;rn<yr.circles.length;rn+=4)Br.circles.push(yr.circles[rn+0]),Br.circles.push(yr.circles[rn+1]),Br.circles.push(yr.circles[rn+2]),Br.circles.push(yr.collisionDetected?1:0)}if(Ue.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ue.crossTileID]=new Se(Et||Ae,lt||ke,Tt||d.justReloaded),o[Ue.crossTileID]=!0};if(be){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ue=d.getSortedSymbolIndexes(this.transform.angle);for(let st=Ue.length-1;st>=0;--st){const Ye=Ue[st];St(d.symbolInstances.get(Ye),d.collisionArrays[Ye])}}else for(let Ue=t.symbolInstanceStart;Ue<t.symbolInstanceEnd;Ue++)St(d.symbolInstances.get(Ue),d.collisionArrays[Ue]);if(c&&d.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[d.bucketInstanceId];l.invert(Ue.invProjMatrix,v),Ue.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,o,c,d){let m;m=d===l.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(o)];const v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const b of v)b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=m>=0&&b!==m?0:c.crossTileID)}markUsedOrientation(t,o,c){const d=o===l.WritingMode.horizontal||o===l.WritingMode.horizontalOnly?o:0,m=o===l.WritingMode.vertical?o:0,v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const b of v)t.text.placedSymbolArray.get(b).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const d=o?o.symbolFadeChange(t):1,m=o?o.opacities:{},v=o?o.variableOffsets:{},b=o?o.placedOrientations:{};for(const E in this.placements){const k=this.placements[E],I=m[E];I?(this.opacities[E]=new ue(I,d,k.text,k.icon),c=c||k.text!==I.text.placed||k.icon!==I.icon.placed):(this.opacities[E]=new ue(null,d,k.text,k.icon,k.skipFade),c=c||k.text||k.icon)}for(const E in m){const k=m[E];if(!this.opacities[E]){const I=new ue(k,d,!1,!1);I.isHidden()||(this.opacities[E]=I,c=c||k.text.placed||k.icon.placed)}}for(const E in v)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=v[E]);for(const E in b)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=b[E]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const c={};for(const d of o){const m=d.getBucket(t);m&&d.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,c,d.collisionBoxArray)}}updateBucketOpacities(t,o,c){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const d=t.layers[0],m=d.layout,v=new ue(null,0,!1,!1,!0),b=m.get("text-allow-overlap"),E=m.get("icon-allow-overlap"),k=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=m.get("text-rotation-alignment")==="map",P=m.get("text-pitch-alignment")==="map",F=m.get("icon-text-fit")!=="none",q=new ue(null,0,b&&(E||!t.hasIconData()||m.get("icon-optional")),E&&(b||!t.hasTextData()||m.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const j=(W,N,ie)=>{for(let pe=0;pe<N/4;pe++)W.opacityVertexArray.emplaceBack(ie);W.hasVisibleVertices=W.hasVisibleVertices||ie!==wr};for(let W=0;W<t.symbolInstances.length;W++){const N=t.symbolInstances.get(W),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:pe,crossTileID:J}=N;let se=this.opacities[J];o[J]?se=v:se||(se=q,this.opacities[J]=se),o[J]=!0;const me=N.numIconVertices>0,ye=this.placedOrientations[N.crossTileID],be=ye===l.WritingMode.vertical,Ae=ye===l.WritingMode.horizontal||ye===l.WritingMode.horizontalOnly;if(ie>0||pe>0){const ke=Wr(se.text);j(t.text,ie,be?wr:ke),j(t.text,pe,Ae?wr:ke);const ze=se.text.isHidden();[N.rightJustifiedTextSymbolIndex,N.centerJustifiedTextSymbolIndex,N.leftJustifiedTextSymbolIndex].forEach(Ue=>{Ue>=0&&(t.text.placedSymbolArray.get(Ue).hidden=ze||be?1:0)}),N.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(N.verticalPlacedTextSymbolIndex).hidden=ze||Ae?1:0);const Qe=this.variableOffsets[N.crossTileID];Qe&&this.markUsedJustification(t,Qe.anchor,N,ye);const St=this.placedOrientations[N.crossTileID];St&&(this.markUsedJustification(t,"left",N,St),this.markUsedOrientation(t,St,N))}if(me){const ke=Wr(se.icon),ze=!(F&&N.verticalPlacedIconSymbolIndex&&be);N.placedIconSymbolIndex>=0&&(j(t.icon,N.numIconVertices,ze?ke:wr),t.icon.placedSymbolArray.get(N.placedIconSymbolIndex).hidden=se.icon.isHidden()),N.verticalPlacedIconSymbolIndex>=0&&(j(t.icon,N.numVerticalIconVertices,ze?wr:ke),t.icon.placedSymbolArray.get(N.verticalPlacedIconSymbolIndex).hidden=se.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const ke=t.collisionArrays[W];if(ke){let ze=new l.Point(0,0);if(ke.textBox||ke.verticalTextBox){let St=!0;if(k){const Ue=this.variableOffsets[J];Ue?(ze=gt(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textBoxScale),I&&ze._rotate(P?this.transform.angle:-this.transform.angle)):St=!1}ke.textBox&&mt(t.textCollisionBox.collisionVertexArray,se.text.placed,!St||be,ze.x,ze.y),ke.verticalTextBox&&mt(t.textCollisionBox.collisionVertexArray,se.text.placed,!St||Ae,ze.x,ze.y)}const Qe=Boolean(!Ae&&ke.verticalIconBox);ke.iconBox&&mt(t.iconCollisionBox.collisionVertexArray,se.icon.placed,Qe,F?ze.x:0,F?ze.y:0),ke.verticalIconBox&&mt(t.iconCollisionBox.collisionVertexArray,se.icon.placed,!Qe,F?ze.x:0,F?ze.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const W=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=W.invProjMatrix,t.placementViewportMatrix=W.viewportMatrix,t.collisionCircleArray=W.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function mt(p,t,o,c,d){p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0),p.emplaceBack(t?1:0,o?1:0,c||0,d||0)}const Dt=Math.pow(2,25),Kt=Math.pow(2,24),kt=Math.pow(2,17),zt=Math.pow(2,16),vn=Math.pow(2,9),ft=Math.pow(2,8),Pr=Math.pow(2,1);function Wr(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const t=p.placed?1:0,o=Math.floor(127*p.opacity);return o*Dt+t*Kt+o*kt+t*zt+o*vn+t*ft+o*Pr+t}const wr=0;class Rn{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,c,d,m){const v=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(v,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((b,E)=>b.sortKey-E.sortKey));this._currentPartIndex<v.length;)if(o.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class dd{constructor(t,o,c,d,m,v,b,E){this.placement=new at(t,o,v,b,E),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,o,c){const d=l.browser.now(),m=()=>!this._forceFullPlacement&&l.browser.now()-d>2;for(;this._currentPlacementIndex>=0;){const v=o[t[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=b)&&(!v.maxzoom||v.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new Rn(v)),this._inProgressLayer.continuePlacement(c[v.source],this.placement,this._showCollisionBoxes,v,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const en=512/l.EXTENT/2;class Qn{constructor(t,o,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let m=0;m<o.length;m++){const v=o.get(m),b=v.key,E=d.get(b);E?E.push(v):d.set(b,[v])}for(const[m,v]of d){const b={positions:v.map(E=>({x:Math.floor(E.anchorX*en),y:Math.floor(E.anchorY*en)})),crossTileIDs:v.map(E=>E.crossTileID)};if(b.positions.length>128){const E=new l.KDBush(b.positions.length,16,Uint16Array);for(const{x:k,y:I}of b.positions)E.add(k,I);E.finish(),delete b.positions,b.index=E}this._symbolsByKey[m]=b}}getScaledCoordinates(t,o){const{x:c,y:d,z:m}=this.tileID.canonical,{x:v,y:b,z:E}=o.canonical,k=en/Math.pow(2,E-m),I=(b*l.EXTENT+t.anchorY)*k,P=d*l.EXTENT*en;return{x:Math.floor((v*l.EXTENT+t.anchorX)*k-c*l.EXTENT*en),y:Math.floor(I-P)}}findMatches(t,o,c){const d=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<t.length;m++){const v=t.get(m);if(v.crossTileID)continue;const b=this._symbolsByKey[v.key];if(!b)continue;const E=this.getScaledCoordinates(v,o);if(b.index){const k=b.index.range(E.x-d,E.y-d,E.x+d,E.y+d).sort();for(const I of k){const P=b.crossTileIDs[I];if(!c[P]){c[P]=!0,v.crossTileID=P;break}}}else if(b.positions)for(let k=0;k<b.positions.length;k++){const I=b.positions[k],P=b.crossTileIDs[k];if(Math.abs(I.x-E.x)<=d&&Math.abs(I.y-E.y)<=d&&!c[P]){c[P]=!0,v.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Uc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ss{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const c in this.indexes){const d=this.indexes[c],m={};for(const v in d){const b=d[v];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+o),m[b.tileID.key]=b}this.indexes[c]=m}this.lng=t}addBucket(t,o,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const v=this.indexes[m];if(Number(m)>t.overscaledZ)for(const b in v){const E=v[b];E.tileID.isChildOf(t)&&E.findMatches(o.symbolInstances,t,d)}else{const b=v[t.scaledTo(Number(m)).key];b&&b.findMatches(o.symbolInstances,t,d)}}for(let m=0;m<o.symbolInstances.length;m++){const v=o.symbolInstances.get(m);v.crossTileID||(v.crossTileID=c.generate(),d[v.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Qn(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const c of o.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let o=!1;for(const c in this.indexes){const d=this.indexes[c];for(const m in d)t[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[m]),delete d[m],o=!0)}return o}}class Sr{constructor(){this.layerIndexes={},this.crossTileIDs=new Uc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,c){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new ss);let m=!1;const v={};d.handleWrapJump(c);for(const b of o){const E=b.getBucket(t);E&&t.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(b.tileID,E,this.crossTileIDs)&&(m=!0),v[E.bucketInstanceId]=!0)}return d.removeStaleBuckets(v)&&(m=!0),m}pruneUnusedLayers(t){const o={};t.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}const no=(p,t)=>l.emitValidationErrors(p,t&&t.filter(o=>o.identifier!=="source.canvas")),_o=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Er=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),ls=l.emptyStyle();class tn extends l.Evented{constructor(t,o={}){super(),this.map=t,this.dispatcher=new Ct(si(),this,t._getMapId()),this.imageManager=new Mt,this.imageManager.setEventedParent(this),this.glyphManager=new Vr(t._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Yr(256,512),this.crossTileSymbolIndex=new Sr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const c=this;this._rtlTextPluginCallback=tn.registerForPluginStateChange(d=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},(m,v)=>{if(l.triggerPluginCompletionEvent(m),v&&v.every(b=>b))for(const b in c.sourceCaches){const E=c.sourceCaches[b].getSource().type;E!=="vector"&&E!=="geojson"||c.sourceCaches[b].reload()}})}),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const m=this.sourceCaches[d.sourceId];if(!m)return;const v=m.getSource();if(v&&v.vectorLayerIds)for(const b in this._layers){const E=this._layers[b];E.source===v.id&&this._validateLayer(E)}})}loadURL(t,o={},c){this.fire(new l.Event("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const d=this.map._requestManager.transformRequest(t,ge.Style);this._request=l.getJSON(d,(m,v)=>{this._request=null,m?this.fire(new l.ErrorEvent(m)):v&&this._load(v,o,c)})}loadJSON(t,o={},c){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(()=>{this._request=null,o.validate=o.validate!==!1,this._load(t,o,c)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(ls,{validate:!1})}_load(t,o,c){var d;const m=o.transformStyle?o.transformStyle(c,t):t;if(!o.validate||!no(this,l.validateStyle(m))){this._loaded=!0,this.stylesheet=m;for(const v in m.sources)this.addSource(v,m.sources[v],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new Mn(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const t=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of t){const c=l.createStyleLayer(o);c.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=c}}_loadSprite(t,o=!1,c=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(d,m,v,b){const E=Ze(d),k=E.length,I=v>1?"@2x":"",P={},F={},q={};for(const{id:j,url:W}of E){const N=m.transformRequest(m.normalizeSpriteURL(W,I,".json"),ge.SpriteJSON),ie=`${j}_${N.url}`;P[ie]=l.getJSON(N,(se,me)=>{delete P[ie],F[j]=me,yt(b,F,q,se,k)});const pe=m.transformRequest(m.normalizeSpriteURL(W,I,".png"),ge.SpriteImage),J=`${j}_${pe.url}`;P[J]=_e.getImage(pe,(se,me)=>{delete P[J],q[j]=me,yt(b,F,q,se,k)})}return{cancel(){for(const j of Object.values(P))j.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),(d,m)=>{if(this._spriteRequest=null,d)this.fire(new l.ErrorEvent(d));else if(m)for(const v in m){this._spritesImagesIds[v]=[];const b=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(E=>!(E in m)):[];for(const E of b)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in m[v]){const k=v==="default"?E:`${v}:${E}`;this._spritesImagesIds[v].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,m[v][E],!1):this.imageManager.addImage(k,m[v][E]),o&&(this._changedImages[k]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),c&&c(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(t){const o=this.sourceCaches[t.source];if(!o)return;const c=t.sourceLayer;if(!c)return;const d=o.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const o=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o);const c=[];for(const d of t)o[d]&&c.push(o[d]);return c}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const c of o){const d=this._layers[c];d.type!=="custom"&&(t[c]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const v in this._updatedSources){const b=this._updatedSources[v];if(b==="reload")this._reloadSource(v);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];c[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in c){const m=this.sourceCaches[d];c[d]!==m.used&&m.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.z=t.zoom,o&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){this._checkLoaded();const c=this.serialize();if(t=o.transformStyle?o.transformStyle(c,t):t,no(this,l.validateStyle(t)))return!1;(t=l.clone$1(t)).layers=l.derefLayers(t.layers);const d=l.diffStyles(c,t).filter(v=>!(v.command in Er));if(d.length===0)return!1;const m=d.filter(v=>!(v.command in _o));if(m.length>0)throw new Error(`Unimplemented: ${m.map(v=>v.command).join(", ")}.`);for(const v of d)v.command!=="setTransition"&&this[v.command].apply(this,v.args);return this.stylesheet=t,!0}addImage(t,o){if(this.getImage(t))return this.fire(new l.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(l.validateStyle.source,`sources.${t}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const d=this.sourceCaches[t]=new ar(t,o,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new l.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],o.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,o,c={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new l.ErrorEvent(new Error(`Layer "${d}" already exists on this map.`)));let m;if(t.type==="custom"){if(no(this,l.validateCustomStyleLayer(t)))return;m=l.createStyleLayer(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=l.clone$1(t),t=l.extend(t,{source:d})),this._validate(l.validateStyle.layer,`layers.${d}`,t,{arrayIndex:-1},c))return;m=l.createStyleLayer(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const v=o?this._order.indexOf(o):this._order.length;if(o&&v===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${d}" before non-existing layer "${o}".`)));else{if(this._order.splice(v,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const b=this._removedLayers[d];delete this._removedLayers[d],b.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const c=this._order.indexOf(t);this._order.splice(c,1);const d=o?this._order.indexOf(o):this._order.length;o&&d===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,c){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===o&&d.maxzoom===c||(o!=null&&(d.minzoom=o),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,c={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!l.deepEqual(d.filter,o))return o==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(l.validateStyle.filter,`layers.${d.id}.filter`,o,null,c)||(d.filter=l.clone$1(o),this._updateLayer(d)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,o,c,d={}){this._checkLoaded();const m=this.getLayer(t);m?l.deepEqual(m.getLayoutProperty(o),c)||(m.setLayoutProperty(o,c,d),this._updateLayer(m)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const c=this.getLayer(t);if(c)return c.getLayoutProperty(o);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,c,d={}){this._checkLoaded();const m=this.getLayer(t);m?l.deepEqual(m.getPaintProperty(o),c)||(m.setPaintProperty(o,c,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const c=t.source,d=t.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const v=m.getSource().type;v==="geojson"&&d?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||d?(t.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,t.id,o)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const c=t.source,d=this.sourceCaches[c];if(d===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const m=d.getSource().type,v=m==="vector"?t.sourceLayer:void 0;m!=="vector"||v?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(v,t.id,o):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,c=t.sourceLayer,d=this.sourceCaches[o];if(d!==void 0)return d.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,t.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.mapObject(this.sourceCaches,d=>d.serialize()),o=this._serializeByIds(this._order),c=this.stylesheet;return l.filterObject({version:c.version,name:c.name,metadata:c.metadata,light:c.light,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,sources:t,layers:o},d=>d!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=v=>this._layers[v].type==="fill-extrusion",c={},d=[];for(let v=this._order.length-1;v>=0;v--){const b=this._order[v];if(o(b)){c[b]=v;for(const E of t){const k=E[b];if(k)for(const I of k)d.push(I)}}}d.sort((v,b)=>b.intersectionZ-v.intersectionZ);const m=[];for(let v=this._order.length-1;v>=0;v--){const b=this._order[v];if(o(b))for(let E=d.length-1;E>=0;E--){const k=d[E].feature;if(c[k.layer.id]<v)break;m.push(k),d.pop()}else for(const E of t){const k=E[b];if(k)for(const I of k)m.push(I.feature)}}return m}queryRenderedFeatures(t,o,c){o&&o.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",o.filter,null,o);const d={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const b of o.layers){const E=this._layers[b];if(!E)return this.fire(new l.ErrorEvent(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];d[E.source]=!0}}const m=[];o.availableImages=this._availableImages;const v=this._serializedAllLayers();for(const b in this.sourceCaches)o.layers&&!d[b]||m.push(Lt(this.sourceCaches[b],this._layers,v,t,o,c));return this.placement&&m.push(function(b,E,k,I,P,F,q){const j={},W=F.queryRenderedSymbols(I),N=[];for(const ie of Object.keys(W).map(Number))N.push(q[ie]);N.sort(Ui);for(const ie of N){const pe=ie.featureIndex.lookupSymbolFeatures(W[ie.bucketInstanceId],E,ie.bucketIndex,ie.sourceLayerIndex,P.filter,P.layers,P.availableImages,b);for(const J in pe){const se=j[J]=j[J]||[],me=pe[J];me.sort((ye,be)=>{const Ae=ie.featureSortOrder;if(Ae){const ke=Ae.indexOf(ye.featureIndex);return Ae.indexOf(be.featureIndex)-ke}return be.featureIndex-ye.featureIndex});for(const ye of me)se.push(ye)}}for(const ie in j)j[ie].forEach(pe=>{const J=pe.feature,se=k[b[ie].source].getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=se});return j}(this._layers,v,this.sourceCaches,t,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,o){o&&o.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[t];return c?function(d,m){const v=d.getRenderableIds().map(k=>d.getTileByID(k)),b=[],E={};for(let k=0;k<v.length;k++){const I=v[k],P=I.tileID.canonical.key;E[P]||(E[P]=!0,I.querySourceFeatures(b,m))}return b}(c,o):[]}addSourceType(t,o,c){return Yn(t)?c(new Error(`A source type called "${t}" already exists.`)):(((d,m)=>{Dn[d]=m})(t,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:o.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const v in t)if(!l.deepEqual(t[v],c[v])){d=!0;break}if(!d)return;const m={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(m)}_validate(t,o,c,d,m={}){return(!m||m.validate!==!1)&&no(this,t.call(l.validateStyle,l.extend({key:o,style:this.serialize(),value:c,styleSpec:l.v8Spec},d)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const c=this.sourceCaches[o];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const o in this.sourceCaches)this.sourceCaches[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,o,c,d,m=!1){let v=!1,b=!1;const E={};for(const k of this._order){const I=this._layers[k];if(I.type!=="symbol")continue;if(!E[I.source]){const F=this.sourceCaches[I.source];E[I.source]=F.getRenderableIds(!0).map(q=>F.getTileByID(q)).sort((q,j)=>j.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan(j.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(I,E[I.source],t.center.lng);v=v||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),t.zoom))&&(this.pauseablePlacement=new dd(t,this.map.terrain,this._order,m,o,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),b=!0),v&&this.pauseablePlacement.placement.setStale()),b||v)for(const k of this._order){const I=this._layers[k];I.type==="symbol"&&this.placement.updateLayerOpacities(I,E[I.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o,c){this.imageManager.getImages(o.icons,c),this._updateTilesForChangedImages();const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,o.icons)}getGlyphs(t,o,c){this.glyphManager.getGlyphs(o.stacks,c);const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,[""])}getResource(t,o,c){return l.makeRequest(o,c)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(l.validateStyle.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,o,c={},d){this._checkLoaded();const m=[{id:t,url:o}],v=[...Ze(this.stylesheet.sprite),...m];this._validate(l.validateStyle.sprite,"sprite",v,null,c)||(this.stylesheet.sprite=v,this._loadSprite(m,!0,d))}removeSprite(t){this._checkLoaded();const o=Ze(this.stylesheet.sprite);if(o.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;o.splice(o.findIndex(c=>c.id===t),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(t,o={},c){this._checkLoaded(),t&&this._validate(l.validateStyle.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}tn.registerForPluginStateChange=l.registerForPluginStateChange;var cs=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ai="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const xa={prelude:Zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Zt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Zt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Zt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Zt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Zt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Zt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Zt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Zt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Zt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Zt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ai),terrainDepth:Zt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ai),terrainCoords:Zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ai)};function Zt(p,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),d=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=m?m.concat(d):d,b={};return{fragmentSource:p=p.replace(o,(E,k,I,P,F)=>(b[F]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = u_${F};
#endif
`)),vertexSource:t=t.replace(o,(E,k,I,P,F)=>{const q=P==="float"?"vec2":"vec4",j=F.match(/color/)?"color":q;return b[F]?k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${q} a_${F};
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${j}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${q} a_${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:j==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = unpack_mix_${j}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`}),staticAttributes:c,staticUniforms:v}}class us{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,c,d,m,v,b,E,k){this.context=t;let I=this.boundPaintVertexBuffers.length!==d.length;for(let P=0;!I&&P<d.length;P++)this.boundPaintVertexBuffers[P]!==d[P]&&(I=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||I||this.boundIndexBuffer!==m||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==k?this.freshBind(o,c,d,m,v,b,E,k):(t.bindVertexArray.set(this.vao),b&&b.bind(),m&&m.dynamicDraw&&m.bind(),E&&E.bind(),k&&k.bind())}freshBind(t,o,c,d,m,v,b,E){const k=t.numAttributes,I=this.context,P=I.gl;this.vao&&this.destroy(),this.vao=I.createVertexArray(),I.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=E,o.enableAttributes(P,t);for(const F of c)F.enableAttributes(P,t);v&&v.enableAttributes(P,t),b&&b.enableAttributes(P,t),E&&E.enableAttributes(P,t),o.bind(),o.setVertexAttribPointers(P,t,m);for(const F of c)F.bind(),F.setVertexAttribPointers(P,t,m);v&&(v.bind(),v.setVertexAttribPointers(P,t,m)),d&&d.bind(),b&&(b.bind(),b.setVertexAttribPointers(P,t,m)),E&&(E.bind(),E.setVertexAttribPointers(P,t,m)),I.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Vo(p){const t=[];for(let o=0;o<p.length;o++){if(p[o]===null)continue;const c=p[o].split(" ");t.push(c.pop())}return t}class io{constructor(t,o,c,d,m,v){const b=t.gl;this.program=b.createProgram();const E=Vo(o.staticAttributes),k=c?c.getBinderAttributes():[],I=E.concat(k),P=xa.prelude.staticUniforms?Vo(xa.prelude.staticUniforms):[],F=o.staticUniforms?Vo(o.staticUniforms):[],q=c?c.getBinderUniforms():[],j=P.concat(F).concat(q),W=[];for(const ye of j)W.indexOf(ye)<0&&W.push(ye);const N=c?c.defines():[];m&&N.push("#define OVERDRAW_INSPECTOR;"),v&&N.push("#define TERRAIN3D;");const ie=N.concat(xa.prelude.fragmentSource,o.fragmentSource).join(`
`),pe=N.concat(xa.prelude.vertexSource,o.vertexSource).join(`
`),J=b.createShader(b.FRAGMENT_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(J,ie),b.compileShader(J),!b.getShaderParameter(J,b.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${b.getShaderInfoLog(J)}`);b.attachShader(this.program,J);const se=b.createShader(b.VERTEX_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(se,pe),b.compileShader(se),!b.getShaderParameter(se,b.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${b.getShaderInfoLog(se)}`);b.attachShader(this.program,se),this.attributes={};const me={};this.numAttributes=I.length;for(let ye=0;ye<this.numAttributes;ye++)I[ye]&&(b.bindAttribLocation(this.program,ye,I[ye]),this.attributes[I[ye]]=ye);if(b.linkProgram(this.program),!b.getProgramParameter(this.program,b.LINK_STATUS))throw new Error(`Program failed to link: ${b.getProgramInfoLog(this.program)}`);b.deleteShader(se),b.deleteShader(J);for(let ye=0;ye<W.length;ye++){const be=W[ye];if(be&&!me[be]){const Ae=b.getUniformLocation(this.program,be);Ae&&(me[be]=Ae)}}this.fixedUniforms=d(t,me),this.terrainUniforms=((ye,be)=>({u_depth:new l.Uniform1i(ye,be.u_depth),u_terrain:new l.Uniform1i(ye,be.u_terrain),u_terrain_dim:new l.Uniform1f(ye,be.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(ye,be.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(ye,be.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f(ye,be.u_terrain_exaggeration)}))(t,me),this.binderUniforms=c?c.getUniforms(t,me):[]}draw(t,o,c,d,m,v,b,E,k,I,P,F,q,j,W,N,ie,pe){const J=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(d),t.setColorMode(m),t.setCullFace(v),E){t.activeTexture.set(J.TEXTURE2),J.bindTexture(J.TEXTURE_2D,E.depthTexture),t.activeTexture.set(J.TEXTURE3),J.bindTexture(J.TEXTURE_2D,E.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(E[me])}for(const me in this.fixedUniforms)this.fixedUniforms[me].set(b[me]);W&&W.setUniforms(t,this.binderUniforms,q,{zoom:j});let se=0;switch(o){case J.LINES:se=2;break;case J.TRIANGLES:se=3;break;case J.LINE_STRIP:se=1}for(const me of F.get()){const ye=me.vaos||(me.vaos={});(ye[k]||(ye[k]=new us)).bind(t,this,I,W?W.getPaintVertexBuffers():[],P,me.vertexOffset,N,ie,pe),J.drawElements(o,me.primitiveLength*se,J.UNSIGNED_SHORT,me.primitiveOffset*se*2)}}}function hs(p,t,o){const c=1/re(o,1,t.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,t.transform.tileZoom)/d,v=m*(o.tileID.canonical.x+o.tileID.wrap*d),b=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b]}}const va=(p,t,o,c)=>{const d=t.style.light,m=d.properties.get("position"),v=[m.x,m.y,m.z],b=function(){var k=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();d.properties.get("anchor")==="viewport"&&function(k,I){var P=Math.sin(I),F=Math.cos(I);k[0]=F,k[1]=P,k[2]=0,k[3]=-P,k[4]=F,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(b,-t.transform.angle),function(k,I,P){var F=I[0],q=I[1],j=I[2];k[0]=F*P[0]+q*P[3]+j*P[6],k[1]=F*P[1]+q*P[4]+j*P[7],k[2]=F*P[2]+q*P[5]+j*P[8]}(v,v,b);const E=d.properties.get("color");return{u_matrix:p,u_lightpos:v,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+o,u_opacity:c}},pd=(p,t,o,c,d,m,v)=>l.extend(va(p,t,o,c),hs(m,t,v),{u_height_factor:-Math.pow(2,d.overscaledZ)/v.tileSize/8}),Nc=p=>({u_matrix:p}),ds=(p,t,o,c)=>l.extend(Nc(p),hs(o,t,c)),fd=(p,t)=>({u_matrix:p,u_world:t}),Vc=(p,t,o,c,d)=>l.extend(ds(p,t,o,c),{u_world:d}),md=(p,t,o,c)=>{const d=p.transform;let m,v;if(c.paint.get("circle-pitch-alignment")==="map"){const b=re(o,1,d.zoom);m=!0,v=[b,b]}else m=!1,v=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(t.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:v}},jc=(p,t,o)=>{const c=re(o,1,t.zoom),d=Math.pow(2,t.zoom-o.tileID.overscaledZ),m=o.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*d),t.pixelsToGLUnits[1]/(c*d)],u_overscale_factor:m}},qc=(p,t,o=1)=>({u_matrix:p,u_color:t,u_overlay:0,u_overlay_scale:o}),ps=p=>({u_matrix:p}),Gc=(p,t,o,c)=>({u_matrix:p,u_extrude_scale:re(t,1,o),u_intensity:c});function Zc(p,t){const o=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new l.MercatorCoordinate(0,c/o).toLngLat().lat,new l.MercatorCoordinate(0,(c+1)/o).toLngLat().lat]}const fs=(p,t,o,c)=>{const d=p.transform;return{u_matrix:ba(p,t,o,c),u_ratio:1/re(t,1,d.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Wc=(p,t,o,c,d)=>l.extend(fs(p,t,o,d),{u_image:0,u_image_height:c}),xo=(p,t,o,c,d)=>{const m=p.transform,v=Ln(t,m);return{u_matrix:ba(p,t,o,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/re(t,1,m.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[v,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},ms=(p,t,o,c,d,m)=>{const v=p.lineAtlas,b=Ln(t,p.transform),E=o.layout.get("line-cap")==="round",k=v.getDash(c.from,E),I=v.getDash(c.to,E),P=k.width*d.fromScale,F=I.width*d.toScale;return l.extend(fs(p,t,o,m),{u_patternscale_a:[b/P,-k.height/2],u_patternscale_b:[b/F,-I.height/2],u_sdfgamma:v.width/(256*Math.min(P,F)*p.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:I.y,u_mix:d.t})};function Ln(p,t){return 1/re(p,1,t.tileZoom)}function ba(p,t,o,c){return p.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const gs=(p,t,o,c,d)=>{return{u_matrix:p,u_tl_parent:t,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(v=d.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:wa(d.paint.get("raster-hue-rotate"))};var m,v};function wa(p){p*=Math.PI/180;const t=Math.sin(p),o=Math.cos(p);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const Sa=(p,t,o,c,d,m,v,b,E,k)=>{const I=d.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:I.cameraToCenterDistance,u_pitch:I.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:I.width/I.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:v,u_coord_matrix:b,u_is_text:+E,u_pitch_with_map:+c,u_texsize:k,u_texture:0}},Ea=(p,t,o,c,d,m,v,b,E,k,I)=>{const P=d.transform;return l.extend(Sa(p,t,o,c,d,m,v,b,E,k),{u_gamma_scale:c?Math.cos(P._pitch)*P.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:+I})},Ta=(p,t,o,c,d,m,v,b,E,k)=>l.extend(Ea(p,t,o,c,d,m,v,b,!0,E,!0),{u_texsize_icon:k,u_texture_icon:1}),vo=(p,t,o)=>({u_matrix:p,u_opacity:t,u_color:o}),ys=(p,t,o,c,d,m)=>l.extend(function(v,b,E,k){const I=E.imageManager.getPattern(v.from.toString()),P=E.imageManager.getPattern(v.to.toString()),{width:F,height:q}=E.imageManager.getPixelSize(),j=Math.pow(2,k.tileID.overscaledZ),W=k.tileSize*Math.pow(2,E.transform.tileZoom)/j,N=W*(k.tileID.canonical.x+k.tileID.wrap*j),ie=W*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[F,q],u_mix:b.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/re(k,1,E.transform.tileZoom),u_pixel_coord_upper:[N>>16,ie>>16],u_pixel_coord_lower:[65535&N,65535&ie]}}(c,m,o,d),{u_matrix:p,u_opacity:t}),Fn={fillExtrusion:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_lightpos:new l.Uniform3f(p,t.u_lightpos),u_lightintensity:new l.Uniform1f(p,t.u_lightintensity),u_lightcolor:new l.Uniform3f(p,t.u_lightcolor),u_vertical_gradient:new l.Uniform1f(p,t.u_vertical_gradient),u_opacity:new l.Uniform1f(p,t.u_opacity)}),fillExtrusionPattern:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_lightpos:new l.Uniform3f(p,t.u_lightpos),u_lightintensity:new l.Uniform1f(p,t.u_lightintensity),u_lightcolor:new l.Uniform3f(p,t.u_lightcolor),u_vertical_gradient:new l.Uniform1f(p,t.u_vertical_gradient),u_height_factor:new l.Uniform1f(p,t.u_height_factor),u_image:new l.Uniform1i(p,t.u_image),u_texsize:new l.Uniform2f(p,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(p,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(p,t.u_scale),u_fade:new l.Uniform1f(p,t.u_fade),u_opacity:new l.Uniform1f(p,t.u_opacity)}),fill:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix)}),fillPattern:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_image:new l.Uniform1i(p,t.u_image),u_texsize:new l.Uniform2f(p,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(p,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(p,t.u_scale),u_fade:new l.Uniform1f(p,t.u_fade)}),fillOutline:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_world:new l.Uniform2f(p,t.u_world)}),fillOutlinePattern:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_world:new l.Uniform2f(p,t.u_world),u_image:new l.Uniform1i(p,t.u_image),u_texsize:new l.Uniform2f(p,t.u_texsize),u_pixel_coord_upper:new l.Uniform2f(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(p,t.u_pixel_coord_lower),u_scale:new l.Uniform3f(p,t.u_scale),u_fade:new l.Uniform1f(p,t.u_fade)}),circle:(p,t)=>({u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(p,t.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(p,t.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(p,t.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(p,t.u_matrix)}),collisionBox:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(p,t.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(p,t.u_extrude_scale),u_overscale_factor:new l.Uniform1f(p,t.u_overscale_factor)}),collisionCircle:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_inv_matrix:new l.UniformMatrix4f(p,t.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(p,t.u_viewport_size)}),debug:(p,t)=>({u_color:new l.UniformColor(p,t.u_color),u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_overlay:new l.Uniform1i(p,t.u_overlay),u_overlay_scale:new l.Uniform1f(p,t.u_overlay_scale)}),clippingMask:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix)}),heatmap:(p,t)=>({u_extrude_scale:new l.Uniform1f(p,t.u_extrude_scale),u_intensity:new l.Uniform1f(p,t.u_intensity),u_matrix:new l.UniformMatrix4f(p,t.u_matrix)}),heatmapTexture:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_world:new l.Uniform2f(p,t.u_world),u_image:new l.Uniform1i(p,t.u_image),u_color_ramp:new l.Uniform1i(p,t.u_color_ramp),u_opacity:new l.Uniform1f(p,t.u_opacity)}),hillshade:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_image:new l.Uniform1i(p,t.u_image),u_latrange:new l.Uniform2f(p,t.u_latrange),u_light:new l.Uniform2f(p,t.u_light),u_shadow:new l.UniformColor(p,t.u_shadow),u_highlight:new l.UniformColor(p,t.u_highlight),u_accent:new l.UniformColor(p,t.u_accent)}),hillshadePrepare:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_image:new l.Uniform1i(p,t.u_image),u_dimension:new l.Uniform2f(p,t.u_dimension),u_zoom:new l.Uniform1f(p,t.u_zoom),u_unpack:new l.Uniform4f(p,t.u_unpack)}),line:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_ratio:new l.Uniform1f(p,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(p,t.u_units_to_pixels)}),lineGradient:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_ratio:new l.Uniform1f(p,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(p,t.u_units_to_pixels),u_image:new l.Uniform1i(p,t.u_image),u_image_height:new l.Uniform1f(p,t.u_image_height)}),linePattern:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_texsize:new l.Uniform2f(p,t.u_texsize),u_ratio:new l.Uniform1f(p,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_image:new l.Uniform1i(p,t.u_image),u_units_to_pixels:new l.Uniform2f(p,t.u_units_to_pixels),u_scale:new l.Uniform3f(p,t.u_scale),u_fade:new l.Uniform1f(p,t.u_fade)}),lineSDF:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_ratio:new l.Uniform1f(p,t.u_ratio),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(p,t.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(p,t.u_patternscale_a),u_patternscale_b:new l.Uniform2f(p,t.u_patternscale_b),u_sdfgamma:new l.Uniform1f(p,t.u_sdfgamma),u_image:new l.Uniform1i(p,t.u_image),u_tex_y_a:new l.Uniform1f(p,t.u_tex_y_a),u_tex_y_b:new l.Uniform1f(p,t.u_tex_y_b),u_mix:new l.Uniform1f(p,t.u_mix)}),raster:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_tl_parent:new l.Uniform2f(p,t.u_tl_parent),u_scale_parent:new l.Uniform1f(p,t.u_scale_parent),u_buffer_scale:new l.Uniform1f(p,t.u_buffer_scale),u_fade_t:new l.Uniform1f(p,t.u_fade_t),u_opacity:new l.Uniform1f(p,t.u_opacity),u_image0:new l.Uniform1i(p,t.u_image0),u_image1:new l.Uniform1i(p,t.u_image1),u_brightness_low:new l.Uniform1f(p,t.u_brightness_low),u_brightness_high:new l.Uniform1f(p,t.u_brightness_high),u_saturation_factor:new l.Uniform1f(p,t.u_saturation_factor),u_contrast_factor:new l.Uniform1f(p,t.u_contrast_factor),u_spin_weights:new l.Uniform3f(p,t.u_spin_weights)}),symbolIcon:(p,t)=>({u_is_size_zoom_constant:new l.Uniform1i(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(p,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(p,t.u_size_t),u_size:new l.Uniform1f(p,t.u_size),u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(p,t.u_pitch),u_rotate_symbol:new l.Uniform1i(p,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(p,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(p,t.u_fade_change),u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(p,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(p,t.u_coord_matrix),u_is_text:new l.Uniform1i(p,t.u_is_text),u_pitch_with_map:new l.Uniform1i(p,t.u_pitch_with_map),u_texsize:new l.Uniform2f(p,t.u_texsize),u_texture:new l.Uniform1i(p,t.u_texture)}),symbolSDF:(p,t)=>({u_is_size_zoom_constant:new l.Uniform1i(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(p,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(p,t.u_size_t),u_size:new l.Uniform1f(p,t.u_size),u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(p,t.u_pitch),u_rotate_symbol:new l.Uniform1i(p,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(p,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(p,t.u_fade_change),u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(p,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(p,t.u_coord_matrix),u_is_text:new l.Uniform1i(p,t.u_is_text),u_pitch_with_map:new l.Uniform1i(p,t.u_pitch_with_map),u_texsize:new l.Uniform2f(p,t.u_texsize),u_texture:new l.Uniform1i(p,t.u_texture),u_gamma_scale:new l.Uniform1f(p,t.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(p,t.u_is_halo)}),symbolTextAndIcon:(p,t)=>({u_is_size_zoom_constant:new l.Uniform1i(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(p,t.u_is_size_feature_constant),u_size_t:new l.Uniform1f(p,t.u_size_t),u_size:new l.Uniform1f(p,t.u_size),u_camera_to_center_distance:new l.Uniform1f(p,t.u_camera_to_center_distance),u_pitch:new l.Uniform1f(p,t.u_pitch),u_rotate_symbol:new l.Uniform1i(p,t.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(p,t.u_aspect_ratio),u_fade_change:new l.Uniform1f(p,t.u_fade_change),u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(p,t.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(p,t.u_coord_matrix),u_is_text:new l.Uniform1i(p,t.u_is_text),u_pitch_with_map:new l.Uniform1i(p,t.u_pitch_with_map),u_texsize:new l.Uniform2f(p,t.u_texsize),u_texsize_icon:new l.Uniform2f(p,t.u_texsize_icon),u_texture:new l.Uniform1i(p,t.u_texture),u_texture_icon:new l.Uniform1i(p,t.u_texture_icon),u_gamma_scale:new l.Uniform1f(p,t.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(p,t.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(p,t.u_is_halo)}),background:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_opacity:new l.Uniform1f(p,t.u_opacity),u_color:new l.UniformColor(p,t.u_color)}),backgroundPattern:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_opacity:new l.Uniform1f(p,t.u_opacity),u_image:new l.Uniform1i(p,t.u_image),u_pattern_tl_a:new l.Uniform2f(p,t.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(p,t.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(p,t.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(p,t.u_pattern_br_b),u_texsize:new l.Uniform2f(p,t.u_texsize),u_mix:new l.Uniform1f(p,t.u_mix),u_pattern_size_a:new l.Uniform2f(p,t.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(p,t.u_pattern_size_b),u_scale_a:new l.Uniform1f(p,t.u_scale_a),u_scale_b:new l.Uniform1f(p,t.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(p,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(p,t.u_tile_units_to_pixels)}),terrain:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_texture:new l.Uniform1i(p,t.u_texture),u_ele_delta:new l.Uniform1f(p,t.u_ele_delta)}),terrainDepth:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_ele_delta:new l.Uniform1f(p,t.u_ele_delta)}),terrainCoords:(p,t)=>({u_matrix:new l.UniformMatrix4f(p,t.u_matrix),u_texture:new l.Uniform1i(p,t.u_texture),u_terrain_coords_id:new l.Uniform1f(p,t.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(p,t.u_ele_delta)})};class Bn{constructor(t,o,c){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const yl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _s{constructor(t,o,c,d){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=d,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let c=0;c<this.attributes.length;c++){const d=o.attributes[this.attributes[c].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,o,c){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],v=o.attributes[m.name];v!==void 0&&t.vertexAttribPointer(v,m.components,t[yl[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const jo=new WeakMap;function qo(p){if(jo.has(p))return jo.get(p);{const t=p.getParameter(p.VERSION).startsWith("WebGL 2.0");return jo.set(p,t),t}}class Ft{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xs extends Ft{getDefault(){return l.Color.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class _l extends Ft{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class xl extends Ft{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class vs extends Ft{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Xc extends Ft{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Kc extends Ft{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Go extends Ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class gd extends Ft{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class yd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class _d extends Ft{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class xd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class vd extends Ft{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class bd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class vl extends Ft{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class bs extends Ft{getDefault(){return l.Color.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class bl extends Ft{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class wl extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class Zo extends Ft{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Hc extends Ft{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Yc extends Ft{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Sl extends Ft{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class bo extends Ft{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Jc extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Wo extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Xo extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Qc extends Ft{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class El extends Ft{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Vt extends Ft{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const c=this.gl;qo(c)?c.bindVertexArray(t):(o=c.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class ws extends Ft{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class wd extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class eu extends Ft{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class wo extends Ft{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class Sd extends wo{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ed extends wo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class tu extends wo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Td{constructor(t,o,c,d,m){this.context=t,this.width=o,this.height=c;const v=t.gl,b=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Sd(t,b),d)this.depthAttachment=m?new tu(t,b):new Ed(t,b);else if(m)throw new Error("Stencil cannot be setted without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class mr{constructor(t,o,c){this.blendFunction=t,this.blendColor=o,this.mask=c}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,l.Color.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,l.Color.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],l.Color.transparent,[!0,!0,!0,!0]);class Ss{constructor(t){var o,c;if(this.gl=t,this.clearColor=new xs(this),this.clearDepth=new _l(this),this.clearStencil=new xl(this),this.colorMask=new vs(this),this.depthMask=new Xc(this),this.stencilMask=new Kc(this),this.stencilFunc=new Go(this),this.stencilOp=new gd(this),this.stencilTest=new yd(this),this.depthRange=new _d(this),this.depthTest=new xd(this),this.depthFunc=new vd(this),this.blend=new bd(this),this.blendFunc=new vl(this),this.blendColor=new bs(this),this.blendEquation=new bl(this),this.cullFace=new wl(this),this.cullFaceSide=new Zo(this),this.frontFace=new Hc(this),this.program=new Yc(this),this.activeTexture=new Sl(this),this.viewport=new bo(this),this.bindFramebuffer=new Jc(this),this.bindRenderbuffer=new Wo(this),this.bindTexture=new Xo(this),this.bindVertexBuffer=new Qc(this),this.bindElementBuffer=new El(this),this.bindVertexArray=new Vt(this),this.pixelStoreUnpack=new ws(this),this.pixelStoreUnpackPremultiplyAlpha=new wd(this),this.pixelStoreUnpackFlipY=new eu(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),qo(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new Bn(this,t,o)}createVertexBuffer(t,o,c){return new _s(this,t,o,c)}createRenderbuffer(t,o,c){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,t,o,c),this.bindRenderbuffer.set(null),m}createFramebuffer(t,o,c,d){return new Td(this,t,o,c,d)}clear({color:t,depth:o,stencil:c}){const d=this.gl;let m=0;t&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.deepEqual(t.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return qo(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return qo(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class It{constructor(t,o,c){this.func=t,this.mask=o,this.range=c}}It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);const Ca=7680;class rr{constructor(t,o,c,d,m,v){this.test=t,this.ref=o,this.mask=c,this.fail=d,this.depthFail=m,this.pass=v}}rr.disabled=new rr({func:519,mask:0},0,0,Ca,Ca,Ca);class nr{constructor(t,o,c){this.enable=t,this.mode=o,this.frontFace=c}}let So;function ka(p,t,o,c,d,m,v){const b=p.context,E=b.gl,k=p.useProgram("collisionBox"),I=[];let P=0,F=0;for(let J=0;J<c.length;J++){const se=c[J],me=t.getTile(se),ye=me.getBucket(o);if(!ye)continue;let be=se.posMatrix;d[0]===0&&d[1]===0||(be=p.translatePosMatrix(se.posMatrix,me,d,m));const Ae=v?ye.textCollisionBox:ye.iconCollisionBox,ke=ye.collisionCircleArray;if(ke.length>0){const ze=l.create(),Qe=be;l.mul(ze,ye.placementInvProjMatrix,p.transform.glCoordMatrix),l.mul(ze,ze,ye.placementViewportMatrix),I.push({circleArray:ke,circleOffset:F,transform:Qe,invTransform:ze,coord:se}),P+=ke.length/4,F=P}Ae&&k.draw(b,E.LINES,It.disabled,rr.disabled,p.colorModeForRenderPass(),nr.disabled,jc(be,p.transform,me),p.style.map.terrain&&p.style.map.terrain.getTerrainData(se),o.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,p.transform.zoom,null,null,Ae.collisionVertexBuffer)}if(!v||!I.length)return;const q=p.useProgram("collisionCircle"),j=new l.CollisionCircleLayoutArray;j.resize(4*P),j._trim();let W=0;for(const J of I)for(let se=0;se<J.circleArray.length/4;se++){const me=4*se,ye=J.circleArray[me+0],be=J.circleArray[me+1],Ae=J.circleArray[me+2],ke=J.circleArray[me+3];j.emplace(W++,ye,be,Ae,ke,0),j.emplace(W++,ye,be,Ae,ke,1),j.emplace(W++,ye,be,Ae,ke,2),j.emplace(W++,ye,be,Ae,ke,3)}(!So||So.length<2*P)&&(So=function(J){const se=2*J,me=new l.QuadTriangleArray;me.resize(se),me._trim();for(let ye=0;ye<se;ye++){const be=6*ye;me.uint16[be+0]=4*ye+0,me.uint16[be+1]=4*ye+1,me.uint16[be+2]=4*ye+2,me.uint16[be+3]=4*ye+2,me.uint16[be+4]=4*ye+3,me.uint16[be+5]=4*ye+0}return me}(P));const N=b.createIndexBuffer(So,!0),ie=b.createVertexBuffer(j,l.collisionCircleLayout.members,!0);for(const J of I){const se={u_matrix:J.transform,u_inv_matrix:J.invTransform,u_camera_to_center_distance:(pe=p.transform).cameraToCenterDistance,u_viewport_size:[pe.width,pe.height]};q.draw(b,E.TRIANGLES,It.disabled,rr.disabled,p.colorModeForRenderPass(),nr.disabled,se,p.style.map.terrain&&p.style.map.terrain.getTerrainData(J.coord),o.id,ie,N,l.SegmentVector.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,p.transform.zoom,null,null,null)}var pe;ie.destroy(),N.destroy()}nr.disabled=new nr(!1,1029,2305),nr.backCCW=new nr(!0,1029,2305);const Tl=l.identity(new Float32Array(16));function Cd(p,t,o,c,d,m){const{horizontalAlign:v,verticalAlign:b}=l.getAnchorAlignment(p);return new l.Point((-(v-.5)*t/d+c[0])*m,(-(b-.5)*o/d+c[1])*m)}function Cl(p,t,o,c,d,m,v,b,E,k,I){const P=p.text.placedSymbolArray,F=p.text.dynamicLayoutVertexArray,q=p.icon.dynamicLayoutVertexArray,j={};F.clear();for(let W=0;W<P.length;W++){const N=P.get(W),ie=N.hidden||!N.crossTileID||p.allowVerticalPlacement&&!N.placedOrientation?null:c[N.crossTileID];if(ie){const pe=new l.Point(N.anchorX,N.anchorY),J=pt(pe,o?v:m,I),se=Ci(d.cameraToCenterDistance,J.signedDistanceFromCamera);let me=l.evaluateSizeForFeature(p.textSizeData,E,N)*se/l.ONE_EM;o&&(me*=p.tilePixelRatio/b);const{width:ye,height:be,anchor:Ae,textOffset:ke,textBoxScale:ze}=ie,Qe=Cd(Ae,ye,be,ke,ze,me),St=o?pt(pe.add(Qe),m,I).point:J.point.add(t?Qe.rotate(-d.angle):Qe),Ue=p.allowVerticalPlacement&&N.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let st=0;st<N.numGlyphs;st++)l.addDynamicAttributes(F,St,Ue);k&&N.associatedIconIndex>=0&&(j[N.associatedIconIndex]={shiftedAnchor:St,angle:Ue})}else U(N.numGlyphs,F)}if(k){q.clear();const W=p.icon.placedSymbolArray;for(let N=0;N<W.length;N++){const ie=W.get(N);if(ie.hidden)U(ie.numGlyphs,q);else{const pe=j[N];if(pe)for(let J=0;J<ie.numGlyphs;J++)l.addDynamicAttributes(q,pe.shiftedAnchor,pe.angle);else U(ie.numGlyphs,q)}}p.icon.dynamicLayoutVertexBuffer.updateData(q)}p.text.dynamicLayoutVertexBuffer.updateData(F)}function kd(p,t,o){return o.iconsInText&&t?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function kl(p,t,o,c,d,m,v,b,E,k,I,P){const F=p.context,q=F.gl,j=p.transform,W=b==="map",N=E==="map",ie=b!=="viewport"&&o.layout.get("symbol-placement")!=="point",pe=W&&!N&&!ie,J=!o.layout.get("symbol-sort-key").isConstant();let se=!1;const me=p.depthModeForSublayer(0,It.ReadOnly),ye=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),be=[];for(const Ae of c){const ke=t.getTile(Ae),ze=ke.getBucket(o);if(!ze)continue;const Qe=d?ze.text:ze.icon;if(!Qe||!Qe.segments.get().length||!Qe.hasVisibleVertices)continue;const St=Qe.programConfigurations.get(o.id),Ue=d||ze.sdfIcons,st=d?ze.textSizeData:ze.iconSizeData,Ye=N||j.pitch!==0,lr=p.useProgram(kd(Ue,d,ze),St),Et=l.evaluateSizeForZoom(st,j.zoom),lt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ae);let Tt,hr,Wt,$n,Xr=[0,0],yr=null;if(d)hr=ke.glyphAtlasTexture,Wt=q.LINEAR,Tt=ke.glyphAtlasTexture.size,ze.iconsInText&&(Xr=ke.imageAtlasTexture.size,yr=ke.imageAtlasTexture,$n=Ye||p.options.rotating||p.options.zooming||st.kind==="composite"||st.kind==="camera"?q.LINEAR:q.NEAREST);else{const Or=o.layout.get("icon-size").constantOr(0)!==1||ze.iconsNeedLinear;hr=ke.imageAtlasTexture,Wt=Ue||p.options.rotating||p.options.zooming||Or||Ye?q.LINEAR:q.NEAREST,Tt=ke.imageAtlasTexture.size}const Sn=re(ke,1,p.transform.zoom),zi=Qr(Ae.posMatrix,N,W,p.transform,Sn),ci=ji(Ae.posMatrix,N,W,p.transform,Sn),Di=ye&&ze.hasTextData(),Jo=o.layout.get("icon-text-fit")!=="none"&&Di&&ze.hasIconData();if(ie){const Or=p.style.map.terrain?(nn,dr)=>p.style.map.terrain.getElevation(Ae,nn,dr):null,zr=o.layout.get("text-rotation-alignment")==="map";to(ze,Ae.posMatrix,p,d,zi,ci,N,k,zr,Or)}const so=p.translatePosMatrix(Ae.posMatrix,ke,m,v),Zi=ie||d&&ye||Jo?Tl:zi,kr=p.translatePosMatrix(ci,ke,m,v,!0),Br=Ue&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let rn;rn=Ue?ze.iconsInText?Ta(st.kind,Et,pe,N,p,so,Zi,kr,Tt,Xr):Ea(st.kind,Et,pe,N,p,so,Zi,kr,d,Tt,!0):Sa(st.kind,Et,pe,N,p,so,Zi,kr,d,Tt);const Qo={program:lr,buffers:Qe,uniformValues:rn,atlasTexture:hr,atlasTextureIcon:yr,atlasInterpolation:Wt,atlasInterpolationIcon:$n,isSDF:Ue,hasHalo:Br};if(J&&ze.canOverlap){se=!0;const Or=Qe.segments.get();for(const zr of Or)be.push({segments:new l.SegmentVector([zr]),sortKey:zr.sortKey,state:Qo,terrainData:lt})}else be.push({segments:Qe.segments,sortKey:0,state:Qo,terrainData:lt})}se&&be.sort((Ae,ke)=>Ae.sortKey-ke.sortKey);for(const Ae of be){const ke=Ae.state;if(F.activeTexture.set(q.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,q.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(F.activeTexture.set(q.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),ke.isSDF){const ze=ke.uniformValues;ke.hasHalo&&(ze.u_is_halo=1,Ia(ke.buffers,Ae.segments,o,p,ke.program,me,I,P,ze,Ae.terrainData)),ze.u_is_halo=0}Ia(ke.buffers,Ae.segments,o,p,ke.program,me,I,P,ke.uniformValues,Ae.terrainData)}}function Ia(p,t,o,c,d,m,v,b,E,k){const I=c.context;d.draw(I,I.gl.TRIANGLES,m,v,b,nr.disabled,E,k,o.id,p.layoutVertexBuffer,p.indexBuffer,t,o.paint,c.transform.zoom,p.programConfigurations.get(o.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function Es(p,t,o,c,d){if(!o||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let v=m[o.to.toString()],b=m[o.from.toString()];if(!v||!b){const E=d.getPaintProperty(t);v=m[E],b=m[E]}v&&b&&p.setConstantPatternPositions(v,b)}function Il(p,t,o,c,d,m,v){const b=p.context.gl,E="fill-pattern",k=o.paint.get(E),I=k&&k.constantOr(1),P=o.getCrossfadeParameters();let F,q,j,W,N;v?(q=I&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=b.LINES):(q=I?"fillPattern":"fill",F=b.TRIANGLES);const ie=k.constantOr(null);for(const pe of c){const J=t.getTile(pe);if(I&&!J.patternsLoaded())continue;const se=J.getBucket(o);if(!se)continue;const me=se.programConfigurations.get(o.id),ye=p.useProgram(q,me),be=p.style.map.terrain&&p.style.map.terrain.getTerrainData(pe);I&&(p.context.activeTexture.set(b.TEXTURE0),J.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),me.updatePaintBuffers(P)),Es(me,E,ie,J,o);const Ae=be?pe:null,ke=p.translatePosMatrix(Ae?Ae.posMatrix:pe.posMatrix,J,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(v){W=se.indexBuffer2,N=se.segments2;const ze=[b.drawingBufferWidth,b.drawingBufferHeight];j=q==="fillOutlinePattern"&&I?Vc(ke,p,P,J,ze):fd(ke,ze)}else W=se.indexBuffer,N=se.segments,j=I?ds(ke,p,P,J):Nc(ke);ye.draw(p.context,F,d,p.stencilModeForClipping(pe),m,nr.disabled,j,be,o.id,se.layoutVertexBuffer,W,N,o.paint,p.transform.zoom,me)}}function Ts(p,t,o,c,d,m,v){const b=p.context,E=b.gl,k="fill-extrusion-pattern",I=o.paint.get(k),P=I.constantOr(1),F=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),j=I.constantOr(null);for(const W of c){const N=t.getTile(W),ie=N.getBucket(o);if(!ie)continue;const pe=p.style.map.terrain&&p.style.map.terrain.getTerrainData(W),J=ie.programConfigurations.get(o.id),se=p.useProgram(P?"fillExtrusionPattern":"fillExtrusion",J);P&&(p.context.activeTexture.set(E.TEXTURE0),N.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),J.updatePaintBuffers(F)),Es(J,k,j,N,o);const me=p.translatePosMatrix(W.posMatrix,N,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),ye=o.paint.get("fill-extrusion-vertical-gradient"),be=P?pd(me,p,ye,q,W,F,N):va(me,p,ye,q);se.draw(b,b.gl.TRIANGLES,d,m,v,nr.backCCW,be,pe,o.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,o.paint,p.transform.zoom,J,p.style.map.terrain&&ie.centroidVertexBuffer)}}function Cs(p,t,o,c,d,m,v){const b=p.context,E=b.gl,k=o.fbo;if(!k)return;const I=p.useProgram("hillshade"),P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(t);b.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,k.colorAttachment.get()),I.draw(b,E.TRIANGLES,d,m,v,nr.disabled,((F,q,j,W)=>{const N=j.paint.get("hillshade-shadow-color"),ie=j.paint.get("hillshade-highlight-color"),pe=j.paint.get("hillshade-accent-color");let J=j.paint.get("hillshade-illumination-direction")*(Math.PI/180);j.paint.get("hillshade-illumination-anchor")==="viewport"&&(J-=F.transform.angle);const se=!F.options.moving;return{u_matrix:W?W.posMatrix:F.transform.calculatePosMatrix(q.tileID.toUnwrapped(),se),u_image:0,u_latrange:Zc(0,q.tileID),u_light:[j.paint.get("hillshade-exaggeration"),J],u_shadow:N,u_highlight:ie,u_accent:pe}})(p,o,c,P?t:null),P,c.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function Al(p,t,o,c,d,m){const v=p.context,b=v.gl,E=t.dem;if(E&&E.data){const k=E.dim,I=E.stride,P=E.getPixels();if(v.activeTexture.set(b.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||p.getTileTexture(I),t.demTexture){const q=t.demTexture;q.update(P,{premultiply:!1}),q.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else t.demTexture=new $e(v,P,b.RGBA,{premultiply:!1}),t.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);v.activeTexture.set(b.TEXTURE0);let F=t.fbo;if(!F){const q=new $e(v,{width:k,height:k,data:null},b.RGBA);q.bind(b.LINEAR,b.CLAMP_TO_EDGE),F=t.fbo=v.createFramebuffer(k,k,!0,!1),F.colorAttachment.set(q.texture)}v.bindFramebuffer.set(F.framebuffer),v.viewport.set([0,0,k,k]),p.useProgram("hillshadePrepare").draw(v,b.TRIANGLES,c,d,m,nr.disabled,((q,j)=>{const W=j.stride,N=l.create();return l.ortho(N,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(N,N,[0,-l.EXTENT,0]),{u_matrix:N,u_image:1,u_dimension:[W,W],u_zoom:q.overscaledZ,u_unpack:j.getUnpackVector()}})(t.tileID,E),null,o.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function Id(p,t,o,c,d,m){const v=c.paint.get("raster-fade-duration");if(!m&&v>0){const b=l.browser.now(),E=(b-p.timeAdded)/v,k=t?(b-t.timeAdded)/v:-1,I=o.getSource(),P=d.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),F=!t||Math.abs(t.tileID.overscaledZ-P)>Math.abs(p.tileID.overscaledZ-P),q=F&&p.refreshedUponExpiration?1:l.clamp(F?E:1-k,0,1);return p.refreshedUponExpiration&&E>=1&&(p.refreshedUponExpiration=!1),t?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}const ru=new l.Color(1,0,0,1),Tr=new l.Color(0,1,0,1),Eo=new l.Color(0,0,1,1),ei=new l.Color(1,0,1,1),Pl=new l.Color(0,1,1,1);function ks(p,t,o,c){qi(p,0,t+o/2,p.transform.width,o,c)}function Ml(p,t,o,c){qi(p,t-o/2,0,o,p.transform.height,c)}function qi(p,t,o,c,d,m){const v=p.context,b=v.gl;b.enable(b.SCISSOR_TEST),b.scissor(t*p.pixelRatio,o*p.pixelRatio,c*p.pixelRatio,d*p.pixelRatio),v.clear({color:m}),b.disable(b.SCISSOR_TEST)}function Aa(p,t,o){const c=p.context,d=c.gl,m=o.posMatrix,v=p.useProgram("debug"),b=It.disabled,E=rr.disabled,k=p.colorModeForRenderPass(),I="$debug",P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(o);c.activeTexture.set(d.TEXTURE0);const F=t.getTileByID(o.key).latestRawTileData,q=Math.floor((F&&F.byteLength||0)/1024),j=t.getTile(o).tileSize,W=512/Math.min(j,512)*(o.overscaledZ/p.transform.zoom)*.5;let N=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(N+=` => ${o.overscaledZ}`),function(ie,pe){ie.initDebugOverlayCanvas();const J=ie.debugOverlayCanvas,se=ie.context.gl,me=ie.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,J.width,J.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(pe,5,5),me.strokeText(pe,5,5),ie.debugOverlayTexture.update(J),ie.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(p,`${N} ${q}kB`),v.draw(c,d.TRIANGLES,b,E,mr.alphaBlended,nr.disabled,qc(m,l.Color.transparent,W),null,I,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),v.draw(c,d.LINE_STRIP,b,E,k,nr.disabled,qc(m,l.Color.red),P,I,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function Is(p,t,o){const c=p.context,d=c.gl,m=p.colorModeForRenderPass(),v=new It(d.LEQUAL,It.ReadWrite,p.depthRangeFor3D),b=p.useProgram("terrain"),E=t.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,p.width,p.height]);for(const k of o){const I=p.renderToTexture.getTexture(k),P=t.getTerrainData(k.tileID);c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,I.texture);const F={u_matrix:p.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(p.transform.zoom)};b.draw(c,d.TRIANGLES,v,rr.disabled,m,nr.backCCW,F,P,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class nu{constructor(t,o){this.context=new Ss(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=ar.maxUnderzooming+ar.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Sr}resize(t,o,c){if(this.width=Math.floor(t*c),this.height=Math.floor(o*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,o=new l.PosArray;o.emplaceBack(0,0),o.emplaceBack(l.EXTENT,0),o.emplaceBack(0,l.EXTENT),o.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(o,cs.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const c=new l.PosArray;c.emplaceBack(0,0),c.emplaceBack(l.EXTENT,0),c.emplaceBack(0,l.EXTENT),c.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=t.createVertexBuffer(c,cs.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const d=new l.RasterBoundsArray;d.emplaceBack(0,0,0,0),d.emplaceBack(l.EXTENT,0,l.EXTENT,0),d.emplaceBack(0,l.EXTENT,0,l.EXTENT),d.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(d,Jr.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const m=new l.PosArray;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,cs.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const v=new l.LineStripIndexArray;v.emplaceBack(0),v.emplaceBack(1),v.emplaceBack(3),v.emplaceBack(2),v.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(v);const b=new l.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(b);const E=this.context.gl;this.stencilClearMode=new rr({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.create();l.ortho(c,0,this.width,this.height,0,0,1),l.scale(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,o.TRIANGLES,It.disabled,this.stencilClearMode,mr.disabled,nr.disabled,ps(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source;const c=this.context,d=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(mr.disabled),c.setDepthMode(It.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of o){const b=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(v);m.draw(c,d.TRIANGLES,It.disabled,new rr({func:d.ALWAYS,mask:0},b,255,d.KEEP,d.KEEP,d.REPLACE),mr.disabled,nr.disabled,ps(v.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new rr({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new rr({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,c=t.sort((v,b)=>b.overscaledZ-v.overscaledZ),d=c[c.length-1].overscaledZ,m=c[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const v={};for(let b=0;b<m;b++)v[b+d]=new rr({func:o.GEQUAL,mask:255},b+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[v,c]}return[{[d]:rr.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new mr([t.CONSTANT_COLOR,t.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(t,o,c){if(!this.opaquePassEnabledForLayer())return It.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new It(c||this.context.gl.LEQUAL,o,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();const c=this.style._order,d=this.style.sourceCaches,m={},v={},b={};for(const E in d){const k=d[E];k.used&&k.prepare(this.context),m[E]=k.getVisibleCoordinates(),v[E]=m[E].slice().reverse(),b[E]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<c.length;E++)if(this.style._layers[c[E]].is3D()){this.opaquePassCutoff=E;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const E=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||E.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(k,I){const P=k.context,F=P.gl,q=mr.unblended,j=new It(F.LEQUAL,It.ReadWrite,[0,1]),W=I.getTerrainMesh(),N=I.sourceCache.getRenderableTiles(),ie=k.useProgram("terrainDepth");P.bindFramebuffer.set(I.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),P.clear({color:l.Color.transparent,depth:1});for(const pe of N){const J=I.getTerrainData(pe.tileID),se={u_matrix:k.transform.calculatePosMatrix(pe.tileID.toUnwrapped()),u_ele_delta:I.getMeshFrameDelta(k.transform.zoom)};ie.draw(P,F.TRIANGLES,j,rr.disabled,q,nr.backCCW,se,J,"terrain",W.vertexBuffer,W.indexBuffer,W.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain),function(k,I){const P=k.context,F=P.gl,q=mr.unblended,j=new It(F.LEQUAL,It.ReadWrite,[0,1]),W=I.getTerrainMesh(),N=I.getCoordsTexture(),ie=I.sourceCache.getRenderableTiles(),pe=k.useProgram("terrainCoords");P.bindFramebuffer.set(I.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,k.width/devicePixelRatio,k.height/devicePixelRatio]),P.clear({color:l.Color.transparent,depth:1}),I.coordsIndex=[];for(const J of ie){const se=I.getTerrainData(J.tileID);P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,N.texture);const me={u_matrix:k.transform.calculatePosMatrix(J.tileID.toUnwrapped()),u_terrain_coords_id:(255-I.coordsIndex.length)/255,u_texture:0,u_ele_delta:I.getMeshFrameDelta(k.transform.zoom)};pe.draw(P,F.TRIANGLES,j,rr.disabled,q,nr.backCCW,me,se,"terrain",W.vertexBuffer,W.indexBuffer,W.segments),I.coordsIndex.push(J.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,k.width,k.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const E of c){const k=this.style._layers[E];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const I=v[k.source];(k.type==="custom"||I.length)&&this.renderLayer(this,d[k.source],k,I)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[c[this.currentLayer]],k=d[E.source],I=m[E.source];this._renderTileClippingMasks(E,I),this.renderLayer(this,k,E,I)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const E=this.style._layers[c[this.currentLayer]],k=d[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const I=(E.type==="symbol"?b:v)[E.source];this._renderTileClippingMasks(E,m[E.source]),this.renderLayer(this,k,E,I)}if(this.options.showTileBoundaries){const E=function(k,I){let P=null;const F=Object.values(k._layers).flatMap(N=>N.source&&!N.isHidden(I)?[k.sourceCaches[N.source]]:[]),q=F.filter(N=>N.getSource().type==="vector"),j=F.filter(N=>N.getSource().type!=="vector"),W=N=>{(!P||P.getSource().maxzoom<N.getSource().maxzoom)&&(P=N)};return q.forEach(N=>W(N)),P||j.forEach(N=>W(N)),P}(this.style,this.transform.zoom);E&&function(k,I,P){for(let F=0;F<P.length;F++)Aa(k,I,P[F])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const k=E.transform.padding;ks(E,E.transform.height-(k.top||0),3,ru),ks(E,k.bottom||0,3,Tr),Ml(E,k.left||0,3,Eo),Ml(E,E.transform.width-(k.right||0),3,ei);const I=E.transform.centerPoint;(function(P,F,q,j){qi(P,F-1,q-10,2,20,j),qi(P,F-10,q-1,20,2,j)})(E,I.x,E.transform.height-I.y,Pl)}(this),this.context.setDefault()}renderLayer(t,o,c,d){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(d||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(m,v,b,E,k){if(m.renderPass!=="translucent")return;const I=rr.disabled,P=m.colorModeForRenderPass();(b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,q,j,W,N,ie,pe){const J=q.transform,se=N==="map",me=ie==="map";for(const ye of F){const be=W.getTile(ye),Ae=be.getBucket(j);if(!Ae||!Ae.text||!Ae.text.segments.get().length)continue;const ke=l.evaluateSizeForZoom(Ae.textSizeData,J.zoom),ze=re(be,1,q.transform.zoom),Qe=Qr(ye.posMatrix,me,se,q.transform,ze),St=j.layout.get("icon-text-fit")!=="none"&&Ae.hasIconData();if(ke){const Ue=Math.pow(2,J.zoom-be.tileID.overscaledZ);Cl(Ae,se,me,pe,J,Qe,ye.posMatrix,Ue,ke,St,q.style.map.terrain?(st,Ye)=>q.style.map.terrain.getElevation(ye,st,Ye):null)}}}(E,m,b,v,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),k),b.paint.get("icon-opacity").constantOr(1)!==0&&kl(m,v,b,E,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),I,P),b.paint.get("text-opacity").constantOr(1)!==0&&kl(m,v,b,E,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),I,P),v.map.showCollisionBoxes&&(ka(m,v,b,E,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),!0),ka(m,v,b,E,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),!1))})(t,o,c,d,this.style.placement.variableOffsets);break;case"circle":(function(m,v,b,E){if(m.renderPass!=="translucent")return;const k=b.paint.get("circle-opacity"),I=b.paint.get("circle-stroke-width"),P=b.paint.get("circle-stroke-opacity"),F=!b.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(I.constantOr(1)===0||P.constantOr(1)===0))return;const q=m.context,j=q.gl,W=m.depthModeForSublayer(0,It.ReadOnly),N=rr.disabled,ie=m.colorModeForRenderPass(),pe=[];for(let J=0;J<E.length;J++){const se=E[J],me=v.getTile(se),ye=me.getBucket(b);if(!ye)continue;const be=ye.programConfigurations.get(b.id),Ae=m.useProgram("circle",be),ke=ye.layoutVertexBuffer,ze=ye.indexBuffer,Qe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(se),St={programConfiguration:be,program:Ae,layoutVertexBuffer:ke,indexBuffer:ze,uniformValues:md(m,se,me,b),terrainData:Qe};if(F){const Ue=ye.segments.get();for(const st of Ue)pe.push({segments:new l.SegmentVector([st]),sortKey:st.sortKey,state:St})}else pe.push({segments:ye.segments,sortKey:0,state:St})}F&&pe.sort((J,se)=>J.sortKey-se.sortKey);for(const J of pe){const{programConfiguration:se,program:me,layoutVertexBuffer:ye,indexBuffer:be,uniformValues:Ae,terrainData:ke}=J.state;me.draw(q,j.TRIANGLES,W,N,ie,nr.disabled,Ae,ke,b.id,ye,be,J.segments,b.paint,m.transform.zoom,se)}})(t,o,c,d);break;case"heatmap":(function(m,v,b,E){if(b.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const k=m.context,I=k.gl,P=rr.disabled,F=new mr([I.ONE,I.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(q,j,W){const N=q.gl;q.activeTexture.set(N.TEXTURE1),q.viewport.set([0,0,j.width/4,j.height/4]);let ie=W.heatmapFbo;if(ie)N.bindTexture(N.TEXTURE_2D,ie.colorAttachment.get()),q.bindFramebuffer.set(ie.framebuffer);else{const pe=N.createTexture();N.bindTexture(N.TEXTURE_2D,pe),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR),ie=W.heatmapFbo=q.createFramebuffer(j.width/4,j.height/4,!1,!1),function(J,se,me,ye){var be,Ae;const ke=J.gl,ze=(be=J.HALF_FLOAT)!==null&&be!==void 0?be:ke.UNSIGNED_BYTE,Qe=(Ae=J.RGBA16F)!==null&&Ae!==void 0?Ae:ke.RGBA;ke.texImage2D(ke.TEXTURE_2D,0,Qe,se.width/4,se.height/4,0,ke.RGBA,ze,null),ye.colorAttachment.set(me)}(q,j,pe,ie)}})(k,m,b),k.clear({color:l.Color.transparent});for(let q=0;q<E.length;q++){const j=E[q];if(v.hasRenderableParent(j))continue;const W=v.getTile(j),N=W.getBucket(b);if(!N)continue;const ie=N.programConfigurations.get(b.id),pe=m.useProgram("heatmap",ie),{zoom:J}=m.transform;pe.draw(k,I.TRIANGLES,It.disabled,P,F,nr.disabled,Gc(j.posMatrix,W,J,b.paint.get("heatmap-intensity")),null,b.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,b.paint,m.transform.zoom,ie)}k.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(k,I){const P=k.context,F=P.gl,q=I.heatmapFbo;if(!q)return;P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,q.colorAttachment.get()),P.activeTexture.set(F.TEXTURE1);let j=I.colorRampTexture;j||(j=I.colorRampTexture=new $e(P,I.colorRamp,F.RGBA)),j.bind(F.LINEAR,F.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(P,F.TRIANGLES,It.disabled,rr.disabled,k.colorModeForRenderPass(),nr.disabled,((W,N,ie,pe)=>{const J=l.create();l.ortho(J,0,W.width,W.height,0,0,1);const se=W.context.gl;return{u_matrix:J,u_world:[se.drawingBufferWidth,se.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}})(k,I),null,I.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,I.paint,k.transform.zoom)}(m,b))})(t,o,c,d);break;case"line":(function(m,v,b,E){if(m.renderPass!=="translucent")return;const k=b.paint.get("line-opacity"),I=b.paint.get("line-width");if(k.constantOr(1)===0||I.constantOr(1)===0)return;const P=m.depthModeForSublayer(0,It.ReadOnly),F=m.colorModeForRenderPass(),q=b.paint.get("line-dasharray"),j=b.paint.get("line-pattern"),W=j.constantOr(1),N=b.paint.get("line-gradient"),ie=b.getCrossfadeParameters(),pe=W?"linePattern":q?"lineSDF":N?"lineGradient":"line",J=m.context,se=J.gl;let me=!0;for(const ye of E){const be=v.getTile(ye);if(W&&!be.patternsLoaded())continue;const Ae=be.getBucket(b);if(!Ae)continue;const ke=Ae.programConfigurations.get(b.id),ze=m.context.program.get(),Qe=m.useProgram(pe,ke),St=me||Qe.program!==ze,Ue=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ye),st=j.constantOr(null);if(st&&be.imageAtlas){const Et=be.imageAtlas,lt=Et.patternPositions[st.to.toString()],Tt=Et.patternPositions[st.from.toString()];lt&&Tt&&ke.setConstantPatternPositions(lt,Tt)}const Ye=Ue?ye:null,lr=W?xo(m,be,b,ie,Ye):q?ms(m,be,b,q,ie,Ye):N?Wc(m,be,b,Ae.lineClipsArray.length,Ye):fs(m,be,b,Ye);if(W)J.activeTexture.set(se.TEXTURE0),be.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),ke.updatePaintBuffers(ie);else if(q&&(St||m.lineAtlas.dirty))J.activeTexture.set(se.TEXTURE0),m.lineAtlas.bind(J);else if(N){const Et=Ae.gradients[b.id];let lt=Et.texture;if(b.gradientVersion!==Et.version){let Tt=256;if(b.stepInterpolant){const hr=v.getSource().maxzoom,Wt=ye.canonical.z===hr?Math.ceil(1<<m.transform.maxZoom-ye.canonical.z):1;Tt=l.clamp(l.nextPowerOfTwo(Ae.maxLineLength/l.EXTENT*1024*Wt),256,J.maxTextureSize)}Et.gradient=l.renderColorRamp({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:Tt,image:Et.gradient||void 0,clips:Ae.lineClipsArray}),Et.texture?Et.texture.update(Et.gradient):Et.texture=new $e(J,Et.gradient,se.RGBA),Et.version=b.gradientVersion,lt=Et.texture}J.activeTexture.set(se.TEXTURE0),lt.bind(b.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Qe.draw(J,se.TRIANGLES,P,m.stencilModeForClipping(ye),F,nr.disabled,lr,Ue,b.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,b.paint,m.transform.zoom,ke,Ae.layoutVertexBuffer2),me=!1}})(t,o,c,d);break;case"fill":(function(m,v,b,E){const k=b.paint.get("fill-color"),I=b.paint.get("fill-opacity");if(I.constantOr(1)===0)return;const P=m.colorModeForRenderPass(),F=b.paint.get("fill-pattern"),q=m.opaquePassEnabledForLayer()&&!F.constantOr(1)&&k.constantOr(l.Color.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===q){const j=m.depthModeForSublayer(1,m.renderPass==="opaque"?It.ReadWrite:It.ReadOnly);Il(m,v,b,E,j,P,!1)}if(m.renderPass==="translucent"&&b.paint.get("fill-antialias")){const j=m.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);Il(m,v,b,E,j,P,!0)}})(t,o,c,d);break;case"fill-extrusion":(function(m,v,b,E){const k=b.paint.get("fill-extrusion-opacity");if(k!==0&&m.renderPass==="translucent"){const I=new It(m.context.gl.LEQUAL,It.ReadWrite,m.depthRangeFor3D);if(k!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))Ts(m,v,b,E,I,rr.disabled,mr.disabled),Ts(m,v,b,E,I,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const P=m.colorModeForRenderPass();Ts(m,v,b,E,I,rr.disabled,P)}}})(t,o,c,d);break;case"hillshade":(function(m,v,b,E){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const k=m.context,I=m.depthModeForSublayer(0,It.ReadOnly),P=m.colorModeForRenderPass(),[F,q]=m.renderPass==="translucent"?m.stencilConfigForOverlap(E):[{},E];for(const j of q){const W=v.getTile(j);W.needsHillshadePrepare!==void 0&&W.needsHillshadePrepare&&m.renderPass==="offscreen"?Al(m,W,b,I,rr.disabled,P):m.renderPass==="translucent"&&Cs(m,j,W,b,I,F[j.overscaledZ],P)}k.viewport.set([0,0,m.width,m.height])})(t,o,c,d);break;case"raster":(function(m,v,b,E){if(m.renderPass!=="translucent"||b.paint.get("raster-opacity")===0||!E.length)return;const k=m.context,I=k.gl,P=v.getSource(),F=m.useProgram("raster"),q=m.colorModeForRenderPass(),[j,W]=P instanceof Gt?[{},E]:m.stencilConfigForOverlap(E),N=W[W.length-1].overscaledZ,ie=!m.options.moving;for(const pe of W){const J=m.depthModeForSublayer(pe.overscaledZ-N,b.paint.get("raster-opacity")===1?It.ReadWrite:It.ReadOnly,I.LESS),se=v.getTile(pe);se.registerFadeDuration(b.paint.get("raster-fade-duration"));const me=v.findLoadedParent(pe,0),ye=Id(se,me,v,b,m.transform,m.style.map.terrain);let be,Ae;const ke=b.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;k.activeTexture.set(I.TEXTURE0),se.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(I.TEXTURE1),me?(me.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),be=Math.pow(2,me.tileID.overscaledZ-se.tileID.overscaledZ),Ae=[se.tileID.canonical.x*be%1,se.tileID.canonical.y*be%1]):se.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST);const ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),Qe=ze?pe:null,St=Qe?Qe.posMatrix:m.transform.calculatePosMatrix(pe.toUnwrapped(),ie),Ue=gs(St,Ae||[0,0],be||1,ye,b);P instanceof Gt?F.draw(k,I.TRIANGLES,J,rr.disabled,q,nr.disabled,Ue,ze,b.id,P.boundsBuffer,m.quadTriangleIndexBuffer,P.boundsSegments):F.draw(k,I.TRIANGLES,J,j[pe.overscaledZ],q,nr.disabled,Ue,ze,b.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(t,o,c,d);break;case"background":(function(m,v,b,E){const k=b.paint.get("background-color"),I=b.paint.get("background-opacity");if(I===0)return;const P=m.context,F=P.gl,q=m.transform,j=q.tileSize,W=b.paint.get("background-pattern");if(m.isPatternMissing(W))return;const N=!W&&k.a===1&&I===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==N)return;const ie=rr.disabled,pe=m.depthModeForSublayer(0,N==="opaque"?It.ReadWrite:It.ReadOnly),J=m.colorModeForRenderPass(),se=m.useProgram(W?"backgroundPattern":"background"),me=E||q.coveringTiles({tileSize:j,terrain:m.style.map.terrain});W&&(P.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context));const ye=b.getCrossfadeParameters();for(const be of me){const Ae=E?be.posMatrix:m.transform.calculatePosMatrix(be.toUnwrapped()),ke=W?ys(Ae,I,m,W,{tileID:be,tileSize:j},ye):vo(Ae,I,k),ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(be);se.draw(P,F.TRIANGLES,pe,ie,J,nr.disabled,ke,ze,b.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(t,0,c,d);break;case"custom":(function(m,v,b){const E=m.context,k=b.implementation;if(m.renderPass==="offscreen"){const I=k.prerender;I&&(m.setCustomLayerDefaults(),E.setColorMode(m.colorModeForRenderPass()),I.call(k,E.gl,m.transform.customLayerMatrix()),E.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),E.setColorMode(m.colorModeForRenderPass()),E.setStencilMode(rr.disabled);const I=k.renderingMode==="3d"?new It(m.context.gl.LEQUAL,It.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,It.ReadOnly);E.setDepthMode(I),k.render(E.gl,m.transform.customLayerMatrix()),E.setDirty(),m.setBaseState(),E.bindFramebuffer.set(null)}})(t,0,c)}}translatePosMatrix(t,o,c,d,m){if(!c[0]&&!c[1])return t;const v=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(v){const k=Math.sin(v),I=Math.cos(v);c=[c[0]*I-c[1]*k,c[0]*k+c[1]*I]}const b=[m?c[0]:re(o,c[0],this.transform.zoom),m?c[1]:re(o,c[1],this.transform.zoom),0],E=new Float32Array(16);return l.translate(E,t,b),E}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!o||!c}useProgram(t,o){this.cache=this.cache||{};const c=t+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new io(this.context,xa[t],o,Fn[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new $e(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}class As{constructor(t,o){this.points=t,this.planes=o}static fromInvProjectionMatrix(t,o,c){const d=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const E=1/(b=l.transformMat4([],b,t))[3]/o*d;return l.mul$1(b,b,[E,E,1/b[3],E])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const E=function(F,q){var j=q[0],W=q[1],N=q[2],ie=j*j+W*W+N*N;return ie>0&&(ie=1/Math.sqrt(ie)),F[0]=q[0]*ie,F[1]=q[1]*ie,F[2]=q[2]*ie,F}([],function(F,q,j){var W=q[0],N=q[1],ie=q[2],pe=j[0],J=j[1],se=j[2];return F[0]=N*se-ie*J,F[1]=ie*pe-W*se,F[2]=W*J-N*pe,F}([],Re([],m[b[0]],m[b[1]]),Re([],m[b[2]],m[b[1]]))),k=-((I=E)[0]*(P=m[b[1]])[0]+I[1]*P[1]+I[2]*P[2]);var I,P;return E.concat(k)});return new As(m,v)}}class Pa{constructor(t,o){this.min=t,this.max=o,this.center=function(c,d,m){return c[0]=.5*d[0],c[1]=.5*d[1],c[2]=.5*d[2],c}([],function(c,d,m){return c[0]=d[0]+m[0],c[1]=d[1]+m[1],c[2]=d[2]+m[2],c}([],this.min,this.max))}quadrant(t){const o=[t%2==0,t<2],c=We(this.min),d=We(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],d[m]=o[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new Pa(c,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let d=0;d<t.planes.length;d++){const m=t.planes[d];let v=0;for(let b=0;b<o.length;b++)l.dot(m,o[b])>=0&&v++;if(v===0)return 0;v!==o.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let b=0;b<t.points.length;b++){const E=t.points[b][d]-this.min[d];m=Math.min(m,E),v=Math.max(v,E)}if(v<0||m>this.max[d]-this.min[d])return 0}return 1}}class Ps{constructor(t=0,o=0,c=0,d=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=c,this.right=d}interpolate(t,o,c){return o.top!=null&&t.top!=null&&(this.top=l.interpolate.number(t.top,o.top,c)),o.bottom!=null&&t.bottom!=null&&(this.bottom=l.interpolate.number(t.bottom,o.bottom,c)),o.left!=null&&t.left!=null&&(this.left=l.interpolate.number(t.left,o.left,c)),o.right!=null&&t.right!=null&&(this.right=l.interpolate.number(t.right,o.right,c)),this}getCenter(t,o){const c=l.clamp((this.left+t-this.right)/2,0,t),d=l.clamp((this.top+o-this.bottom)/2,0,o);return new l.Point(c,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ps(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Ms{constructor(t,o,c,d,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||!!m,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=c==null?0:c,this._maxPitch=d==null?60:d,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ps,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const t=new Ms(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this._minEleveationForCurrentTile=t._minEleveationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const o=-l.wrap(t,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var c=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,d,m){var v=d[0],b=d[1],E=d[2],k=d[3],I=Math.sin(m),P=Math.cos(m);c[0]=v*P+E*I,c[1]=b*P+k*I,c[2]=v*-I+E*P,c[3]=b*-I+k*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=l.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,c){this._unmodified=!1,this._edgeInsets.interpolate(t,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new l.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new l.Point(0,0)),d=this.pointCoordinate(new l.Point(this.width,0)),m=this.pointCoordinate(new l.Point(this.width,this.height)),v=this.pointCoordinate(new l.Point(0,this.height)),b=Math.floor(Math.min(c.x,d.x,m.x,v.x)),E=Math.floor(Math.max(c.x,d.x,m.x,v.x)),k=1;for(let I=b-k;I<=E+k;I++)I!==0&&o.push(new l.UnwrappedTileID(I,t))}return o}coveringTiles(t){var o,c;let d=this.coveringZoomLevel(t);const m=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const v=this.pointCoordinate(this.getCameraPoint()),b=l.MercatorCoordinate.fromLngLat(this.center),E=Math.pow(2,d),k=[E*v.x,E*v.y,0],I=[E*b.x,E*b.y,0],P=As.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let F=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=d);const q=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,j=J=>({aabb:new Pa([J*E,0,0],[(J+1)*E,E,0]),zoom:0,x:0,y:0,wrap:J,fullyVisible:!1}),W=[],N=[],ie=d,pe=t.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let J=1;J<=3;J++)W.push(j(-J)),W.push(j(J));for(W.push(j(0));W.length>0;){const J=W.pop(),se=J.x,me=J.y;let ye=J.fullyVisible;if(!ye){const Qe=J.aabb.intersects(P);if(Qe===0)continue;ye=Qe===2}const be=t.terrain?k:I,Ae=J.aabb.distanceX(be),ke=J.aabb.distanceY(be),ze=Math.max(Math.abs(Ae),Math.abs(ke));if(J.zoom===ie||ze>q+(1<<ie-J.zoom)-2&&J.zoom>=F){const Qe=ie-J.zoom,St=k[0]-.5-(se<<Qe),Ue=k[1]-.5-(me<<Qe);N.push({tileID:new l.OverscaledTileID(J.zoom===ie?pe:J.zoom,J.wrap,J.zoom,se,me),distanceSq:Ce([I[0]-.5-se,I[1]-.5-me]),tileDistanceToCamera:Math.sqrt(St*St+Ue*Ue)})}else for(let Qe=0;Qe<4;Qe++){const St=(se<<1)+Qe%2,Ue=(me<<1)+(Qe>>1),st=J.zoom+1;let Ye=J.aabb.quadrant(Qe);if(t.terrain){const lr=new l.OverscaledTileID(st,J.wrap,st,St,Ue),Et=t.terrain.getMinMaxElevation(lr),lt=(o=Et.minElevation)!==null&&o!==void 0?o:this.elevation,Tt=(c=Et.maxElevation)!==null&&c!==void 0?c:this.elevation;Ye=new Pa([Ye.min[0],Ye.min[1],lt],[Ye.max[0],Ye.max[1],Tt])}W.push({aabb:Ye,zoom:st,x:St,y:Ue,wrap:J.wrap,fullyVisible:ye})}}return N.sort((J,se)=>J.distanceSq-se.distanceSq).map(J=>J.tileID)}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=l.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(t.lng)*this.worldSize,l.mercatorYfromLat(o)*this.worldSize)}unproject(t){return new l.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const o=this.pointLocation(this.centerPoint,t),c=t.getElevationForLngLatZoom(o,this.tileZoom);if(!(this.elevation-c))return;const d=this.getCameraPosition(),m=l.MercatorCoordinate.fromLngLat(d.lngLat,d.altitude),v=l.MercatorCoordinate.fromLngLat(o,c),b=m.x-v.x,E=m.y-v.y,k=m.z-v.z,I=Math.sqrt(b*b+E*E+k*k),P=this.scaleZoom(this.cameraToCenterDistance/I/this.tileSize);this._elevation=c,this._center=o,this.zoom=P}setLocationAtPoint(t,o){const c=this.pointCoordinate(o),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(t),v=new l.MercatorCoordinate(m.x-(c.x-d.x),m.y-(c.y-d.y));this.center=this.coordinateLocation(v),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,o){return o?this.coordinatePoint(this.locationCoordinate(t),o.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,o){return this.coordinateLocation(this.pointCoordinate(t,o))}locationCoordinate(t){return l.MercatorCoordinate.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,o){if(o){const F=o.pointCoordinate(t);if(F!=null)return F}const c=[t.x,t.y,0,1],d=[t.x,t.y,1,1];l.transformMat4(c,c,this.pixelMatrixInverse),l.transformMat4(d,d,this.pixelMatrixInverse);const m=c[3],v=d[3],b=c[1]/m,E=d[1]/v,k=c[2]/m,I=d[2]/v,P=k===I?0:(0-k)/(I-k);return new l.MercatorCoordinate(l.interpolate.number(c[0]/m,d[0]/v,P)/this.worldSize,l.interpolate.number(b,E,P)/this.worldSize)}coordinatePoint(t,o=0,c=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,o,1];return l.transformMat4(d,d,c),new l.Point(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Jt().extend(this.pointLocation(new l.Point(0,t))).extend(this.pointLocation(new l.Point(this.width,t))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Jt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,o=!1){const c=t.key,d=o?this._alignedPosMatrixCache:this._posMatrixCache;if(d[c])return d[c];const m=t.canonical,v=this.worldSize/this.zoomScale(m.z),b=m.x+Math.pow(2,m.z)*t.wrap,E=l.identity(new Float64Array(16));return l.translate(E,E,[b*v,m.y*v,0]),l.scale(E,E,[v/l.EXTENT,v/l.EXTENT,1]),l.multiply(E,o?this.alignedProjMatrix:this.projMatrix,E),d[c]=new Float32Array(E),d[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,o,c,d,m=-90,v=90,b=-180,E=180;const k=this.size,I=this._unmodified;if(this.latRange){const q=this.latRange;m=l.mercatorYfromLat(q[1])*this.worldSize,v=l.mercatorYfromLat(q[0])*this.worldSize,t=v-m<k.y?k.y/(v-m):0}if(this.lngRange){const q=this.lngRange;b=l.wrap(l.mercatorXfromLng(q[0])*this.worldSize,0,this.worldSize),E=l.wrap(l.mercatorXfromLng(q[1])*this.worldSize,0,this.worldSize),E<b&&(E+=this.worldSize),o=E-b<k.x?k.x/(E-b):0}const P=this.point,F=Math.max(o||0,t||0);if(F)return this.center=this.unproject(new l.Point(o?(E+b)/2:P.x,t?(v+m)/2:P.y)),this.zoom+=this.scaleZoom(F),this._unmodified=I,void(this._constraining=!1);if(this.latRange){const q=P.y,j=k.y/2;q-j<m&&(d=m+j),q+j>v&&(d=v-j)}if(this.lngRange){const q=(b+E)/2,j=l.wrap(P.x,q-this.worldSize/2,q+this.worldSize/2),W=k.x/2;j-W<b&&(c=b+W),j+W>E&&(c=E-W)}c===void 0&&d===void 0||(this.center=this.unproject(new l.Point(c!==void 0?c:P.x,d!==void 0?d:P.y)).wrap()),this._unmodified=I,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,o=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let d=l.identity(new Float64Array(16));l.scale(d,d,[this.width/2,-this.height/2,1]),l.translate(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=l.identity(new Float64Array(16)),l.scale(d,d,[1,-1,1]),l.translate(d,d,[-1,-1,0]),l.scale(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),v=Math.min(this.elevation,this._minEleveationForCurrentTile),b=m-v*this._pixelPerMeter/Math.cos(this._pitch),E=v<0?b:m,k=Math.PI/2+this._pitch,I=this._fov*(.5+t.y/this.height),P=Math.sin(I)*E/Math.sin(l.clamp(Math.PI-k-I,.01,Math.PI-.01)),F=this.getHorizon(),q=2*Math.atan(F/this.cameraToCenterDistance)*(.5+t.y/(2*F)),j=Math.sin(q)*E/Math.sin(l.clamp(Math.PI-k-q,.01,Math.PI-.01)),W=Math.min(P,j),N=1.01*(Math.cos(Math.PI/2-this._pitch)*W+E),ie=this.height/50;d=new Float64Array(16),l.perspective(d,this._fov,this.width/this.height,ie,N),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,l.scale(d,d,[1,-1,1]),l.translate(d,d,[0,0,-this.cameraToCenterDistance]),l.rotateX(d,d,this._pitch),l.rotateZ(d,d,this.angle),l.translate(d,d,[-o,-c,0]),this.mercatorMatrix=l.scale([],d,[this.worldSize,this.worldSize,this.worldSize]),l.scale(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,d),l.translate(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=l.invert([],d),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,d);const pe=this.width%2/2,J=this.height%2/2,se=Math.cos(this.angle),me=Math.sin(this.angle),ye=o-Math.round(o)+se*pe+me*J,be=c-Math.round(c)+se*J+me*pe,Ae=new Float64Array(d);if(l.translate(Ae,Ae,[ye>.5?ye-1:ye,be>.5?be-1:be,0]),this.alignedProjMatrix=Ae,d=l.invert(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new l.Point(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,t))}getCameraQueryGeometry(t){const o=this.getCameraPoint();if(t.length===1)return[t[0],o];{let c=o.x,d=o.y,m=o.x,v=o.y;for(const b of t)c=Math.min(c,b.x),d=Math.min(d,b.y),m=Math.max(m,b.x),v=Math.max(v,b.y);return[new l.Point(c,d),new l.Point(m,d),new l.Point(m,v),new l.Point(c,v),new l.Point(c,d)]}}}function oo(p,t){let o,c=!1,d=null,m=null;const v=()=>{d=null,c&&(p.apply(m,o),d=setTimeout(v,t),c=!1)};return(...b)=>(c=!0,m=this,o=b,d||v(),d)}class iu{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(c=d)}),(c&&c[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}},this._updateHash=oo(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),v=Math.round(o.lng*m)/m,b=Math.round(o.lat*m)/m,E=this._map.getBearing(),k=this._map.getPitch();let I="";if(I+=t?`/${v}/${b}/${c}`:`${c}/${b}/${v}`,(E||k)&&(I+="/"+Math.round(10*E)/10),k&&(I+=`/${Math.round(k)}`),this._hashName){const P=this._hashName;let F=!1;const q=window.location.hash.slice(1).split("&").map(j=>{const W=j.split("=")[0];return W===P?(F=!0,`${W}=${I}`):j}).filter(j=>j);return F||q.push(`${P}=${I}`),`#${q.join("&")}`}return`#${I}`}}const Ma={linearity:.3,easing:l.bezier(0,0,.3,1)},ou=l.extend({deceleration:2500,maxSpeed:1400},Ma),au=l.extend({deceleration:20,maxSpeed:1400},Ma),su=l.extend({deceleration:1e3,maxSpeed:360},Ma),lu=l.extend({deceleration:1e3,maxSpeed:90},Ma);class za{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=l.browser.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(o.pan.mag()){const m=On(o.pan.mag(),c,l.extend({},ou,t||{}));d.offset=o.pan.mult(m.amount/o.pan.mag()),d.center=this._map.transform.center,Da(d,m)}if(o.zoom){const m=On(o.zoom,c,au);d.zoom=this._map.transform.zoom+m.amount,Da(d,m)}if(o.bearing){const m=On(o.bearing,c,su);d.bearing=this._map.transform.bearing+l.clamp(m.amount,-179,179),Da(d,m)}if(o.pitch){const m=On(o.pitch,c,lu);d.pitch=this._map.transform.pitch+m.amount,Da(d,m)}if(d.zoom||d.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),l.extend(d,{noMoveStart:!0})}}function Da(p,t){(!p.duration||p.duration<t.duration)&&(p.duration=t.duration,p.easing=t.easing)}function On(p,t,o){const{maxSpeed:c,linearity:d,deceleration:m}=o,v=l.clamp(p*d/(t/1e3),-c,c),b=Math.abs(v)/(m*d);return{easing:o.easing,duration:1e3*b,amount:v*(b/2)}}class Mr extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c,d={}){const m=D.mousePos(o.getCanvasContainer(),c),v=o.unproject(m);super(t,l.extend({point:m,lngLat:v,originalEvent:c},d)),this._defaultPrevented=!1,this.target=o}}class Ra extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){const d=t==="touchend"?c.changedTouches:c.touches,m=D.touchPos(o.getCanvasContainer(),d),v=m.map(E=>o.unproject(E)),b=m.reduce((E,k,I,P)=>E.add(k.div(P.length)),new l.Point(0,0));super(t,{points:m,point:b,lngLats:v,lngLat:o.unproject(b),originalEvent:c}),this._defaultPrevented=!1}}class Gi extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class La{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Gi(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Mr(t.type,this._map,t))}mouseup(t){this._map.fire(new Mr(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Mr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Mr(t.type,this._map,t))}mouseover(t){this._map.fire(new Mr(t.type,this._map,t))}mouseout(t){this._map.fire(new Mr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Ra(t.type,this._map,t))}touchmove(t){this._map.fire(new Ra(t.type,this._map,t))}touchend(t){this._map.fire(new Ra(t.type,this._map,t))}touchcancel(t){this._map.fire(new Ra(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ad{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Mr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Mr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fa{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(l.Point.convert(t),this._map.terrain)}}class Pd{constructor(t,o){this._map=t,this._tr=new Fa(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(D.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(d.x,c.x),v=Math.max(d.x,c.x),b=Math.min(d.y,c.y),E=Math.max(d.y,c.y);D.setTransform(this._box,`translate(${m}px,${b}px)`),this._box.style.width=v-m+"px",this._box.style.height=E-b+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const c=this._startPos,d=o;if(this.reset(),D.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new l.Event(t,{originalEvent:o}))}}function zs(p,t){if(p.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${t.length}`);const o={};for(let c=0;c<p.length;c++)o[p[c].identifier]=t[c];return o}class Ba{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(d){const m=new l.Point(0,0);for(const v of d)m._add(v);return m.div(d.length)}(o),this.touches=zs(c,o)))}touchmove(t,o,c){if(this.aborted||!this.centroid)return;const d=zs(c,o);for(const m in this.touches){const v=d[m];(!v||v.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(t,o,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Pi{constructor(t){this.singleTap=new Ba(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,c){this.singleTap.touchstart(t,o,c)}touchmove(t,o,c){this.singleTap.touchmove(t,o,c)}touchend(t,o,c){const d=this.singleTap.touchend(t,o,c);if(d){const m=t.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(d)<30;if(m&&v||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Xe{constructor(t){this._tr=new Fa(t),this._zoomIn=new Pi({numTouches:1,numTaps:2}),this._zoomOut=new Pi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,c){this._zoomIn.touchstart(t,o,c),this._zoomOut.touchstart(t,o,c)}touchmove(t,o,c){this._zoomIn.touchmove(t,o,c),this._zoomOut.touchmove(t,o,c)}touchend(t,o,c){const d=this._zoomIn.touchend(t,o,c),m=this._zoomOut.touchend(t,o,c),v=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(d)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ko{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=o.length?o[0]:o;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&D.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Oa={0:1,2:2};class To{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=D.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(o,c){const d=Oa[c];return o.buttons===void 0||(o.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return D.mouseButton(t)===this._eventButton}}class zl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const je=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(t){t.preventDefault()}},Ds=({enable:p,clickTolerance:t,bearingDegreesPerPixelMoved:o=.8})=>{const c=new To({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new Ko({clickTolerance:t,move:(d,m)=>({bearingDelta:(m.x-d.x)*o}),moveStateManager:c,enable:p,assignEvents:je})},cu=({enable:p,clickTolerance:t,pitchDegreesPerPixelMoved:o=-.5})=>{const c=new To({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new Ko({clickTolerance:t,move:(d,m)=>({pitchDelta:(m.y-d.y)*o}),moveStateManager:c,enable:p,assignEvents:je})};class Md{constructor(t,o){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,o,c){return this._calculateTransform(t,o,c)}touchmove(t,o,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,o,c)}touchend(t,o,c){this._calculateTransform(t,o,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,c){c.length>0&&(this._active=!0);const d=zs(c,o),m=new l.Point(0,0),v=new l.Point(0,0);let b=0;for(const k in d){const I=d[k],P=this._touches[k];P&&(m._add(I),v._add(I.sub(P)),b++,d[k]=I)}if(this._touches=d,b<this._minTouches||!v.mag())return;const E=v.div(b);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(b),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $a{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,c){if(!this._firstTwoTouches)return;t.preventDefault();const[d,m]=this._firstTwoTouches,v=Ua(c,o,d),b=Ua(c,o,m);if(!v||!b)return;const E=this._aroundCenter?null:v.add(b).div(2);return this._move([v,b],E,t)}touchend(t,o,c){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,v=Ua(c,o,d),b=Ua(c,o,m);v&&b||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ua(p,t,o){for(let c=0;c<p.length;c++)if(p[c].identifier===o)return t[c]}function Dl(p,t){return Math.log(p/t)/Math.LN2}class zd extends $a{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Dl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dl(this._distance,c),pinchAround:o}}}function uu(p,t){return 180*p.angleWith(t)/Math.PI}class Rl extends $a{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uu(this._vector,c),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,c=uu(t,this._startVector);return Math.abs(c)<o}}function Na(p){return Math.abs(p.y)>Math.abs(p.x)}class Ll extends $a{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,c){super.touchstart(t,o,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,Na(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),m=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,c){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,m=o.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const v=t.y>0==o.y>0;return Na(t)&&Na(o)&&v}}const Fl={panStep:100,bearingStep:15,pitchStep:10};class bn{constructor(t){this._tr=new Fa(t);const o=Fl;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,c=0,d=0,m=0,v=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),v=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:b=>{const E=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:ao,zoom:o?Math.round(E.zoom)+o*(t.shiftKey?2:1):E.zoom,bearing:E.bearing+c*this._bearingStep,pitch:E.pitch+d*this._pitchStep,offset:[-m*this._panStep,-v*this._panStep],center:E.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ao(p){return p*(2-p)}const Bl=4.000244140625;class Ol{constructor(t,o){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Fa(t),this._el=t.getCanvasContainer(),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=l.browser.now(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%Bl==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=D.mousePos(this._el,t),c=this._tr;this._around=l.LngLat.convert(this._aroundCenter?c.center:c.unproject(o)),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Bl?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&E!==0&&(E=1/E);const k=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(k*E))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,d=this._easing;let m,v=!1;if(this._type==="wheel"&&c&&d){const b=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),E=d(b);m=l.interpolate.number(c,o,E),b<1?this._frameId||(this._frameId=!0):v=!0}else m=o,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:m-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=l.defaultEasing;if(this._prevEase){const c=this._prevEase,d=(l.browser.now()-c.start)/c.duration,m=c.easing(d+.01)-c.easing(d),v=.27/Math.sqrt(m*m+1e-4)*.01,b=Math.sqrt(.0729-v*v);o=l.bezier(v,b,.25,1)}return this._prevEase={start:l.browser.now(),duration:t,easing:o},o}reset(){this._active=!1}}class $l{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ul{constructor(t){this._tr=new Fa(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hu{constructor(){this._tap=new Pi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,c){if(!this._swipePoint)if(this._tapTime){const d=o[0],m=t.timeStamp-this._tapTime<500,v=this._tapPoint.dist(d)<30;m&&v?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,o,c)}touchmove(t,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=o[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,o,c)}touchend(t,o,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(t,o,c);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ti{constructor(t,o,c){this._el=t,this._mousePan=o,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class sr{constructor(t,o,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Rs{constructor(t,o,c,d){this._el=t,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ho=p=>p.zoom||p.drag||p.pitch||p.rotate;class du extends l.Event{}function Ls(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class pu{constructor(t,o){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=d.type==="renderFrame"?void 0:d,b={needsRenderFrame:!1},E={},k={},I=d.touches,P=I?this._getMapTouches(I):void 0,F=P?D.touchPos(this._el,P):D.mousePos(this._el,d);for(const{handlerName:W,handler:N,allowed:ie}of this._handlers){if(!N.isEnabled())continue;let pe;this._blockedByActive(k,ie,W)?N.reset():N[m||d.type]&&(pe=N[m||d.type](d,F,P),this.mergeHandlerResult(b,E,pe,W,v),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||N.isActive())&&(k[W]=N)}const q={};for(const W in this._previousActiveHandlers)k[W]||(q[W]=v);this._previousActiveHandlers=k,(Object.keys(q).length||Ls(b))&&(this._changes.push([b,E,q]),this._triggerRenderFrame()),(Object.keys(k).length||Ls(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=b;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new za(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,v]of this._listeners)D.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[t,o,c]of this._listeners)D.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new La(o,t));const d=o.boxZoom=new Pd(o,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const m=new Xe(o),v=new Ul(o);o.doubleClickZoom=new $l(v,m),this._add("tapZoom",m),this._add("clickZoom",v),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const b=new hu;this._add("tapDragZoom",b);const E=o.touchPitch=new Ll(o);this._add("touchPitch",E),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const k=Ds(t),I=cu(t);o.dragRotate=new sr(t,k,I),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",I,["mouseRotate"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const P=(({enable:ie,clickTolerance:pe})=>{const J=new To({checkCorrectEvent:se=>D.mouseButton(se)===0&&!se.ctrlKey});return new Ko({clickTolerance:pe,move:(se,me)=>({around:me,panDelta:me.sub(se)}),activateOnStart:!0,moveStateManager:J,enable:ie,assignEvents:je})})(t),F=new Md(t,o);o.dragPan=new ti(c,P,F),this._add("mousePan",P),this._add("touchPan",F,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const q=new Rl,j=new zd;o.touchZoomRotate=new Rs(c,j,q,b),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",j,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate);const W=o.scrollZoom=new Ol(o,()=>this._triggerRenderFrame());this._add("scrollZoom",W,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const N=o.keyboard=new bn(o);this._add("keyboard",N),t.interactive&&t.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new Ad(o))}_add(t,o,c){this._handlers.push({handlerName:t,handler:o,allowed:c}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Ho(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,o,c){for(const d in t)if(d!==c&&(!o||o.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const c of t)this._el.contains(c.target)&&o.push(c);return o}mergeHandlerResult(t,o,c,d,m){if(!c)return;l.extend(t,c);const v={handlerName:d,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(o.zoom=v),c.panDelta!==void 0&&(o.drag=v),c.pitchDelta!==void 0&&(o.pitch=v),c.bearingDelta!==void 0&&(o.rotate=v)}_applyChanges(){const t={},o={},c={};for(const[d,m,v]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new l.Point(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),l.extend(o,m),l.extend(c,v);this._updateMapTransform(t,o,c),this._changes=[]}_updateMapTransform(t,o,c){const d=this._map,m=d._getTransformForUpdate(),v=d.terrain;if(!(Ls(t)||v&&this._terrainMovement))return this._fireEvents(o,c,!0);let{panDelta:b,zoomDelta:E,bearingDelta:k,pitchDelta:I,around:P,pinchAround:F}=t;F!==void 0&&(P=F),d._stop(!0),P=P||d.transform.centerPoint;const q=m.pointLocation(b?P.sub(b):P);k&&(m.bearing+=k),I&&(m.pitch+=I),E&&(m.zoom+=E),v?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(b)):m.setLocationAtPoint(q,P):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(q,P),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,m.recalculateZoom(d.terrain)})):m.setLocationAtPoint(q,P),d._applyUpdatedTransform(m),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,c,!0)}_fireEvents(t,o,c){const d=Ho(this._eventsInProgress),m=Ho(t),v={};for(const I in t){const{originalEvent:P}=t[I];this._eventsInProgress[I]||(v[`${I}start`]=P),this._eventsInProgress[I]=t[I]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const I in v)this._fireEvent(I,v[I]);m&&this._fireEvent("move",m.originalEvent);for(const I in t){const{originalEvent:P}=t[I];this._fireEvent(I,P)}const b={};let E;for(const I in this._eventsInProgress){const{handlerName:P,originalEvent:F}=this._eventsInProgress[I];this._handlersById[P].isActive()||(delete this._eventsInProgress[I],E=o[P]||F,b[`${I}end`]=E)}for(const I in b)this._fireEvent(I,b[I]);const k=Ho(this._eventsInProgress);if(c&&(d||m)&&!k){this._updatingCamera=!0;const I=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;I?(P(I.bearing||this._map.getBearing())&&(I.bearing=0),I.freezeElevation=!0,this._map.easeTo(I,{originalEvent:E})):(this._map.fire(new l.Event("moveend",{originalEvent:E})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new l.Event(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new du("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Dd extends l.Evented{constructor(t,o){super(),this._renderFrameCallback=()=>{const c=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,c){return t=l.Point.convert(t).mult(-1),this.panTo(this.transform.center,l.extend({offset:t},o),c)}panTo(t,o,c){return this.easeTo(l.extend({center:t},o),c)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,c){return this.easeTo(l.extend({zoom:t},o),c)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,c){return this.easeTo(l.extend({bearing:t},o),c)}resetNorth(t,o){return this.rotateTo(0,l.extend({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=Jt.convert(t);const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,o)}_cameraForBoxAndBearing(t,o,c,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=l.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const me=d.padding;d.padding={top:me,bottom:me,right:me,left:me}}d.padding=l.extend(m,d.padding);const v=this.transform,b=v.padding,E=v.project(l.LngLat.convert(t)),k=v.project(l.LngLat.convert(o)),I=E.rotate(-c*Math.PI/180),P=k.rotate(-c*Math.PI/180),F=new l.Point(Math.max(I.x,P.x),Math.max(I.y,P.y)),q=new l.Point(Math.min(I.x,P.x),Math.min(I.y,P.y)),j=F.sub(q),W=(v.width-(b.left+b.right+d.padding.left+d.padding.right))/j.x,N=(v.height-(b.top+b.bottom+d.padding.top+d.padding.bottom))/j.y;if(N<0||W<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ie=Math.min(v.scaleZoom(v.scale*Math.min(W,N)),d.maxZoom),pe=l.Point.convert(d.offset),J=new l.Point((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c*Math.PI/180),se=pe.add(J).mult(v.scale/v.zoomScale(ie));return{center:v.unproject(E.add(k).div(2).sub(se)),zoom:ie,bearing:c}}fitBounds(t,o,c){return this._fitInternal(this.cameraForBounds(t,o),o,c)}fitScreenCoordinates(t,o,c,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(t)),this.transform.pointLocation(l.Point.convert(o)),c,d),d,m)}_fitInternal(t,o,c){return t?(delete(o=l.extend(t,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(t,o){this.stop();const c=this._getTransformForUpdate();let d=!1,m=!1,v=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(d=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=l.LngLat.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(m=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(v=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this._applyUpdatedTransform(c),this.fire(new l.Event("movestart",o)).fire(new l.Event("move",o)),d&&this.fire(new l.Event("zoomstart",o)).fire(new l.Event("zoom",o)).fire(new l.Event("zoomend",o)),m&&this.fire(new l.Event("rotatestart",o)).fire(new l.Event("rotate",o)).fire(new l.Event("rotateend",o)),v&&this.fire(new l.Event("pitchstart",o)).fire(new l.Event("pitch",o)).fire(new l.Event("pitchend",o)),this.fire(new l.Event("moveend",o))}calculateCameraOptionsFromTo(t,o,c,d=0){const m=l.MercatorCoordinate.fromLngLat(t,o),v=l.MercatorCoordinate.fromLngLat(c,d),b=v.x-m.x,E=v.y-m.y,k=v.z-m.z,I=Math.hypot(b,E,k);if(I===0)throw new Error("Can't calculate camera options with same From and To");const P=Math.hypot(b,E),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/I/this.transform.tileSize),q=180*Math.atan2(b,-E)/Math.PI;let j=180*Math.acos(P/I)/Math.PI;return j=k<0?90-j:90+j,{center:v.toLngLat(),zoom:F,pitch:j,bearing:q}}easeTo(t,o){this._stop(!1,t.easeId),((t=l.extend({offset:[0,0],duration:500,easing:l.defaultEasing},t)).animate===!1||!t.essential&&l.browser.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),v=this.getPitch(),b=this.getPadding(),E="zoom"in t?+t.zoom:d,k="bearing"in t?this._normalizeBearing(t.bearing,m):m,I="pitch"in t?+t.pitch:v,P="padding"in t?t.padding:c.padding,F=l.Point.convert(t.offset);let q=c.centerPoint.add(F);const j=c.pointLocation(q),W=l.LngLat.convert(t.center||j);this._normalizeCenter(W);const N=c.project(j),ie=c.project(W).sub(N),pe=c.zoomScale(E-d);let J,se;t.around&&(J=l.LngLat.convert(t.around),se=c.locationPoint(J));const me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==d,this._rotating=this._rotating||m!==k,this._pitching=this._pitching||I!==v,this._padding=!c.isPaddingEqual(P),this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,me),this.terrain&&this._prepareElevation(W),this._ease(ye=>{if(this._zooming&&(c.zoom=l.interpolate.number(d,E,ye)),this._rotating&&(c.bearing=l.interpolate.number(m,k,ye)),this._pitching&&(c.pitch=l.interpolate.number(v,I,ye)),this._padding&&(c.interpolatePadding(b,P,ye),q=c.centerPoint.add(F)),this.terrain&&!t.freezeElevation&&this._updateElevation(ye),J)c.setLocationAtPoint(J,se);else{const be=c.zoomScale(c.zoom-d),Ae=E>d?Math.min(2,pe):Math.max(.5,pe),ke=Math.pow(Ae,1-ye),ze=c.unproject(N.add(ie.mult(ye*ke)).mult(be));c.setLocationAtPoint(c.renderWorldCopies?ze.wrap():ze,q)}this._applyUpdatedTransform(c),this._fireMoveEvents(o)},ye=>{this.terrain&&this._finalizeElevation(),this._afterEase(o,ye)},t),this}_prepareEase(t,o,c={}){this._moving=!0,o||c.moving||this.fire(new l.Event("movestart",t)),this._zooming&&!c.zooming&&this.fire(new l.Event("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new l.Event("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new l.Event("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(o-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const o=t.clone(),{center:c,zoom:d,pitch:m,bearing:v,elevation:b}=this.transformCameraUpdate(o);c&&(o.center=c),d!==void 0&&(o.zoom=d),m!==void 0&&(o.pitch=m),v!==void 0&&(o.bearing=v),b!==void 0&&(o.elevation=b),this.transform.apply(o)}_fireMoveEvents(t){this.fire(new l.Event("move",t)),this._zooming&&this.fire(new l.Event("zoom",t)),this._rotating&&this.fire(new l.Event("rotate",t)),this._pitching&&this.fire(new l.Event("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const c=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new l.Event("zoomend",t)),d&&this.fire(new l.Event("rotateend",t)),m&&this.fire(new l.Event("pitchend",t)),this.fire(new l.Event("moveend",t))}flyTo(t,o){if(!t.essential&&l.browser.prefersReducedMotion){const Ye=l.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,o)}this.stop(),t=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.defaultEasing},t);const c=this._getTransformForUpdate(),d=this.getZoom(),m=this.getBearing(),v=this.getPitch(),b=this.getPadding(),E="zoom"in t?l.clamp(+t.zoom,c.minZoom,c.maxZoom):d,k="bearing"in t?this._normalizeBearing(t.bearing,m):m,I="pitch"in t?+t.pitch:v,P="padding"in t?t.padding:c.padding,F=c.zoomScale(E-d),q=l.Point.convert(t.offset);let j=c.centerPoint.add(q);const W=c.pointLocation(j),N=l.LngLat.convert(t.center||W);this._normalizeCenter(N);const ie=c.project(W),pe=c.project(N).sub(ie);let J=t.curve;const se=Math.max(c.width,c.height),me=se/F,ye=pe.mag();if("minZoom"in t){const Ye=l.clamp(Math.min(t.minZoom,d,E),c.minZoom,c.maxZoom),lr=se/c.zoomScale(Ye-d);J=Math.sqrt(lr/ye*2)}const be=J*J;function Ae(Ye){const lr=(me*me-se*se+(Ye?-1:1)*be*be*ye*ye)/(2*(Ye?me:se)*be*ye);return Math.log(Math.sqrt(lr*lr+1)-lr)}function ke(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function ze(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const Qe=Ae(!1);let St=function(Ye){return ze(Qe)/ze(Qe+J*Ye)},Ue=function(Ye){return se*((ze(Qe)*(ke(lr=Qe+J*Ye)/ze(lr))-ke(Qe))/be)/ye;var lr},st=(Ae(!0)-Qe)/J;if(Math.abs(ye)<1e-6||!isFinite(st)){if(Math.abs(se-me)<1e-6)return this.easeTo(t,o);const Ye=me<se?-1:1;st=Math.abs(Math.log(me/se))/J,Ue=function(){return 0},St=function(lr){return Math.exp(Ye*J*lr)}}return t.duration="duration"in t?+t.duration:1e3*st/("screenSpeed"in t?+t.screenSpeed/J:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=m!==k,this._pitching=I!==v,this._padding=!c.isPaddingEqual(P),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(N),this._ease(Ye=>{const lr=Ye*st,Et=1/St(lr);c.zoom=Ye===1?E:d+c.scaleZoom(Et),this._rotating&&(c.bearing=l.interpolate.number(m,k,Ye)),this._pitching&&(c.pitch=l.interpolate.number(v,I,Ye)),this._padding&&(c.interpolatePadding(b,P,Ye),j=c.centerPoint.add(q)),this.terrain&&!t.freezeElevation&&this._updateElevation(Ye);const lt=Ye===1?N:c.unproject(ie.add(pe.mult(Ue(lr))).mult(Et));c.setLocationAtPoint(c.renderWorldCopies?lt.wrap():lt,j),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(o)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,o)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,o,c){c.animate===!1||c.duration===0?(t(1),o()):(this._easeStart=l.browser.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=l.wrap(t,-180,180);const c=Math.abs(t-o);return Math.abs(t-360-o)<c&&(t-=360),Math.abs(t+360-o)<c&&(t+=360),t}_normalizeCenter(t){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const c=t.lng-o.center.lng;t.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.LngLat.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}class li{constructor(t={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const c=this._map._getUIString(`AttributionControl.${o}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const o=this._map.style.sourceCaches;for(const d in o){const m=o[d];if(m.used||m.usedForTerrain){const v=m.getSource();v.attribution&&t.indexOf(v.attribution)<0&&t.push(v.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,m)=>d.length-m.length),t=t.filter((d,m)=>{for(let v=m+1;v<t.length;v++)if(t[v].indexOf(d)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Va{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const o=D.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class rt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const d of c)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const dt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Fs=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Nl extends l.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,o){this.sourceCache.update(t,o),this._renderableTilesKeys=[];const c={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),l.ortho(d.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[d.key]=new Ni(d,this.tileSize));for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(t){for(const o in this._tiles){const c=this._tiles[o];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const o={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID;if(d.canonical.equals(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16),l.ortho(m.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),o[c]=m}else if(d.canonical.isChildOf(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const v=d.canonical.z-t.canonical.z,b=d.canonical.x-(d.canonical.x>>v<<v),E=d.canonical.y-(d.canonical.y>>v<<v),k=l.EXTENT>>v;l.ortho(m.posMatrix,0,k,0,k,0,1),l.translate(m.posMatrix,m.posMatrix,[-b*k,-E*k,0]),o[c]=m}else if(t.canonical.isChildOf(d.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const v=t.canonical.z-d.canonical.z,b=t.canonical.x-(t.canonical.x>>v<<v),E=t.canonical.y-(t.canonical.y>>v<<v),k=l.EXTENT>>v;l.ortho(m.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(m.posMatrix,m.posMatrix,[b*k,E*k,0]),l.scale(m.posMatrix,m.posMatrix,[1/2**v,1/2**v,0]),o[c]=m}}return o}getSourceTile(t,o){const c=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!m||!m.dem)&&o)for(;d>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(t.scaledTo(d--).key);return m}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=t)}}class Vl{constructor(t,o,c){this.painter=t,this.sourceCache=new Nl(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,c,d=l.EXTENT){var m;if(!(o>=0&&o<d&&c>=0&&c<d))return 0;const v=this.getTerrainData(t),b=(m=v.tile)===null||m===void 0?void 0:m.dem;if(!b)return 0;const E=function(j,W,N){var ie=W[0],pe=W[1];return j[0]=N[0]*ie+N[4]*pe+N[12],j[1]=N[1]*ie+N[5]*pe+N[13],j}([],[o/d*l.EXTENT,c/d*l.EXTENT],v.u_terrain_matrix),k=[E[0]*b.dim,E[1]*b.dim],I=Math.floor(k[0]),P=Math.floor(k[1]),F=k[0]-I,q=k[1]-P;return b.get(I,P)*(1-F)*(1-q)+b.get(I+1,P)*F*(1-q)+b.get(I,P+1)*(1-F)*q+b.get(I+1,P+1)*F*q}getElevationForLngLatZoom(t,o){const{tileID:c,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(c,d%l.EXTENT,m%l.EXTENT,l.EXTENT)}getElevation(t,o,c,d=l.EXTENT){return this.getDEMElevation(t,o,c,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,m=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new $e(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new $e(d,new l.RGBAImage({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const o=this.sourceCache.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const d=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new $e(d,o.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),o.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?m=t.canonical.z-d:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=t.canonical.x-(t.canonical.x>>m<<m),b=t.canonical.y-(t.canonical.y>>m<<m),E=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<m),1/(l.EXTENT<<m),0]);l.translate(E,E,[v*l.EXTENT,b*l.EXTENT,0]),this._demMatrixCache[t.key]={matrix:E,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,c=o.width/devicePixelRatio,d=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new $e(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new $e(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,v=0;m<this._coordsTextureSize;m++)for(let b=0;b<this._coordsTextureSize;b++,v+=4)o[v+0]=255&b,o[v+1]=255&m,o[v+2]=b>>8<<4|m>>8,o[v+3]=0;const c=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),d=new $e(t,c,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){const o=new Uint8Array(4),c=this.painter.context,d=c.gl;c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null);const m=o[0]+(o[2]>>4<<8),v=o[1]+((15&o[2])<<8),b=this.coordsIndex[255-o[3]],E=b&&this.sourceCache.getTileByID(b);if(!E)return null;const k=this._coordsTextureSize,I=(1<<E.tileID.canonical.z)*k;return new l.MercatorCoordinate((E.tileID.canonical.x*k+m)/I,(E.tileID.canonical.y*k+v)/I,this.getElevation(E.tileID,m,v,k))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,o=new l.Pos3dArray,c=new l.TriangleIndexArray,d=this.meshSize,m=l.EXTENT/d,v=d*d;for(let P=0;P<=d;P++)for(let F=0;F<=d;F++)o.emplaceBack(F*m,P*m,0);for(let P=0;P<v;P+=d+1)for(let F=0;F<d;F++)c.emplaceBack(F+P,d+F+P+1,d+F+P+2),c.emplaceBack(F+P,d+F+P+2,F+P+1);const b=o.length,E=b+2*(d+1);for(const P of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(F*m,P*l.EXTENT,q);for(let P=0;P<2*d;P+=2)c.emplaceBack(E+P,E+P+1,E+P+3),c.emplaceBack(E+P,E+P+3,E+P+2),c.emplaceBack(b+P,b+P+3,b+P+1),c.emplaceBack(b+P,b+P+2,b+P+3);const k=o.length,I=k+2*(d+1);for(const P of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(P*l.EXTENT,F*m,q);for(let P=0;P<2*d;P+=2)c.emplaceBack(k+P,k+P+1,k+P+3),c.emplaceBack(k+P,k+P+3,k+P+2),c.emplaceBack(I+P,I+P+3,I+P+1),c.emplaceBack(I+P,I+P+2,I+P+3);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(o,Fs.members),segments:l.SegmentVector.simpleSegment(0,0,o.length,c.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*l.earthRadius/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,o){var c;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=o.dem.min*this.exaggeration,c.maxElevation=o.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,o){const c=l.MercatorCoordinate.fromLngLat(t.wrap()),d=(1<<o)*l.EXTENT,m=c.x*d,v=c.y*d,b=Math.floor(m/l.EXTENT),E=Math.floor(v/l.EXTENT);return{tileID:new l.OverscaledTileID(o,0,o,b,E),mercatorX:m,mercatorY:v}}}class wn{constructor(t,o,c){this._context=t,this._size=o,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new $e(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(c.texture),{id:t,fbo:o,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>t.id!==o),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Co={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Mi{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new wn(t.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(o)),this._coordsDescendingInv={};for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const d=t.sourceCaches[c].getVisibleCoordinates();for(const m of d){const v=this.terrain.sourceCache.getTerrainCoords(m);for(const b in v)this._coordsDescendingInv[c][b]||(this._coordsDescendingInv[c][b]=[]),this._coordsDescendingInv[c][b].push(v[b])}}this._coordsDescendingInvStr={};for(const c of t._order){const d=t._layers[c],m=d.source;if(Co[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const v in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][v]=this._coordsDescendingInv[m][v].map(b=>b.key).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][c.tileID.key];m&&m!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const o=t.type,c=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Co[o]&&(this._prevType&&Co[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(Co[this._prevType]||Co[o]&&d){this._prevType=o;const m=this._stacks.length-1,v=this._stacks[m]||[];for(const b of this._renderableTiles){if(this.pool.isFull()&&(Is(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(b),b.rtt[m]){const k=this.pool.getObjectForId(b.rtt[m].id);if(k.stamp===b.rtt[m].stamp){this.pool.useObject(k);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),b.rtt[m]={id:E.id,stamp:E.stamp},c.context.bindFramebuffer.set(E.fbo.framebuffer),c.context.clear({color:l.Color.transparent,stencil:0}),c.currentStencilSource=void 0;for(let k=0;k<v.length;k++){const I=c.style._layers[v[k]],P=I.source?this._coordsDescendingInv[I.source][b.tileID.key]:[b.tileID];c.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),c._renderTileClippingMasks(I,P),c.renderLayer(c,c.style.sourceCaches[I.source],I,P),I.source&&(b.rttCoords[I.source]=this._coordsDescendingInvStr[I.source][b.tileID.key])}}return Is(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Co[o]}return!1}}const Rd=O,ja={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ur=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},Cr={showCompass:!0,showZoom:!0,visualizePitch:!1};class fu{constructor(t,o,c=!1){this.mousedown=v=>{this.startMouse(l.extend({},v,{ctrlKey:!0,preventDefault:()=>v.preventDefault()}),D.mousePos(this.element,v)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.moveMouse(v,D.mousePos(this.element,v))},this.mouseup=v=>{this.mouseRotate.dragEnd(v),this.mousePitch&&this.mousePitch.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,v.targetTouches)[0],this.startTouch(v,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,v.targetTouches)[0],this.moveTouch(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),m=t.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=Ds({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:v,clickTolerance:b,bearingDegreesPerPixelMoved:E=.8})=>{const k=new zl;return new Ko({clickTolerance:b,move:(I,P)=>({bearingDelta:(P.x-I.x)*E}),moveStateManager:k,enable:v,assignEvents:ur})})({clickTolerance:d,enable:!0}),this.map=t,c&&(this.mousePitch=cu({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:v,clickTolerance:b,pitchDegreesPerPixelMoved:E=-.5})=>{const k=new zl;return new Ko({clickTolerance:b,move:(I,P)=>({pitchDelta:(P.y-I.y)*E}),moveStateManager:k,enable:v,assignEvents:ur})})({clickTolerance:m,enable:!0})),D.addEventListener(o,"mousedown",this.mousedown),D.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(o,"touchcancel",this.reset)}startMouse(t,o){this.mouseRotate.dragStart(t,o),this.mousePitch&&this.mousePitch.dragStart(t,o),D.disableDrag()}startTouch(t,o){this.touchRotate.dragStart(t,o),this.touchPitch&&this.touchPitch.dragStart(t,o),D.disableDrag()}moveMouse(t,o){const c=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}moveTouch(t,o){const c=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}off(){const t=this.element;D.removeEventListener(t,"mousedown",this.mousedown),D.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}}let ri;function qa(p,t,o){if(p=new l.LngLat(p.lng,p.lat),t){const c=new l.LngLat(p.lng-360,p.lat),d=new l.LngLat(p.lng+360,p.lat),m=o.locationPoint(p).distSqr(t);o.locationPoint(c).distSqr(t)<m?p=c:o.locationPoint(d).distSqr(t)<m&&(p=d)}for(;Math.abs(p.lng-o.center.lng)>180;){const c=o.locationPoint(p);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;p.lng>o.center.lng?p.lng-=360:p.lng+=360}return p}const Ga={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Bs(p,t,o){const c=p.classList;for(const d in Ga)c.remove(`maplibregl-${o}-anchor-${d}`);c.add(`maplibregl-${o}-anchor-${t}`)}class Za extends l.Evented{constructor(t){if(super(),this._onKeyPress=o=>{const c=o.code,d=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=o=>{const c=o.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=o=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=qa(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let d="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?d="rotateX(0deg)":this._pitchAlignment==="map"&&(d=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Ga[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${d} ${c}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const m=this._map.unproject(this._pos),v=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=m.distanceTo(this._lngLat)>20*v?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=o=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=l.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const o=D.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${c}px`),o.setAttributeNS(null,"width",`${d}px`),o.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const m=D.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const v=D.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const b=D.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of E){const pe=D.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",ie.rx),pe.setAttributeNS(null,"ry",ie.ry),b.appendChild(pe)}const k=D.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const I=D.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(I);const P=D.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"opacity","0.25"),P.setAttributeNS(null,"fill","#000000");const F=D.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),P.appendChild(F);const q=D.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const j=D.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(8.0, 8.0)");const W=D.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#000000"),W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962");const N=D.createNS("http://www.w3.org/2000/svg","circle");N.setAttributeNS(null,"fill","#FFFFFF"),N.setAttributeNS(null,"cx","5.5"),N.setAttributeNS(null,"cy","5.5"),N.setAttributeNS(null,"r","5.4999962"),j.appendChild(W),j.appendChild(N),v.appendChild(b),v.appendChild(k),v.appendChild(P),v.appendChild(q),v.appendChild(j),o.appendChild(v),o.setAttributeNS(null,"height",c*this._scale+"px"),o.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(o),this._offset=l.Point.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),Bs(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(t){return this._offset=l.Point.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Wa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Yo=0,ko=!1;const jl={maxWidth:100,unit:"metric"};function Os(p,t,o){const c=o&&o.maxWidth||100,d=p._container.clientHeight/2,m=p.unproject([0,d]),v=p.unproject([c,d]),b=m.distanceTo(v);if(o&&o.unit==="imperial"){const E=3.2808*b;E>5280?Io(t,c,E/5280,p._getUIString("ScaleControl.Miles")):Io(t,c,E,p._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Io(t,c,b/1852,p._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Io(t,c,b/1e3,p._getUIString("ScaleControl.Kilometers")):Io(t,c,b,p._getUIString("ScaleControl.Meters"))}function Io(p,t,o,c){const d=function(m){const v=Math.pow(10,`${Math.floor(m)}`.length-1);let b=m/v;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(E){const k=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*k)/k}(b),v*b}(o);p.style.width=t*(d/o)+"px",p.innerHTML=`${d}&nbsp;${c}`}const ql={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Gl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $s(p){if(p){if(typeof p=="number"){const t=Math.round(Math.abs(p)/Math.SQRT2);return{center:new l.Point(0,0),top:new l.Point(0,p),"top-left":new l.Point(t,t),"top-right":new l.Point(-t,t),bottom:new l.Point(0,-p),"bottom-left":new l.Point(t,-t),"bottom-right":new l.Point(-t,-t),left:new l.Point(p,0),right:new l.Point(-p,0)}}if(p instanceof l.Point||Array.isArray(p)){const t=l.Point.convert(p);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.Point.convert(p.center||[0,0]),top:l.Point.convert(p.top||[0,0]),"top-left":l.Point.convert(p["top-left"]||[0,0]),"top-right":l.Point.convert(p["top-right"]||[0,0]),bottom:l.Point.convert(p.bottom||[0,0]),"bottom-left":l.Point.convert(p["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(p["bottom-right"]||[0,0]),left:l.Point.convert(p.left||[0,0]),right:l.Point.convert(p.right||[0,0])}}return $s(new l.Point(0,0))}const Us={extend:(p,...t)=>l.extend(p,...t),run(p){p()},logToElement(p,t=!1,o="log"){const c=window.document.getElementById(o);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${p}`)}},Zl=O;class $t{static get version(){return Zl}static get workerCount(){return Fr.workerCount}static set workerCount(t){Fr.workerCount=t}static get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(t){l.config.MAX_PARALLEL_IMAGE_REQUESTS=t}static get workerUrl(){return l.config.WORKER_URL}static set workerUrl(t){l.config.WORKER_URL=t}static addProtocol(t,o){l.config.REGISTERED_PROTOCOLS[t]=o}static removeProtocol(t){delete l.config.REGISTERED_PROTOCOLS[t]}}return $t.Map=class extends Dd{constructor(p){if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(p=l.extend({},ja,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ms(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._cooperativeGesturesOnWheel=t=>{this._onCooperativeGesture(t,t[this._metaKey],1)},this._contextLost=t=>{t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._cooperativeGestures=p.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new rt,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},dt,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=_e.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ie(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let t=!1;const o=oo(c=>{this._trackResize&&!this._removed&&this.resize(c)._update()},50);this._resizeObserver=new ResizeObserver(c=>{t?o(c):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new pu(this,p),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=p.hash&&new iu(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new li({customAttribution:p.customAttribution})),p.maplibreLogo&&this.addControl(new Va,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new l.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new l.Event(`${t.dataType}dataloading`,t))}),this.on("dataabort",t=>{this.fire(new l.Event("sourcedataabort",t))})}_getMapId(){return this._mapId}addControl(p,t){if(t===void 0&&(t=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=p.onAdd(this);this._controls.push(p);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(p);return t>-1&&this._controls.splice(t,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,t,o,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,t,o,c)}resize(p){var t;const o=this._containerDimensions(),c=o[0],d=o[1],m=this._getClampedPixelRatio(c,d);if(this._resizeCanvas(c,d,m),this.painter.resize(c,d,m),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const E=this._getClampedPixelRatio(c,d);this._resizeCanvas(c,d,E),this.painter.resize(c,d,E)}this.transform.resize(c,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,d);const v=!this._moving;return v&&(this.stop(),this.fire(new l.Event("movestart",p)).fire(new l.Event("move",p))),this.fire(new l.Event("resize",p)),v&&this.fire(new l.Event("moveend",p)),this}_getClampedPixelRatio(p,t){const{0:o,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),m=p*d,v=t*d;return Math.min(m>o?o/m:1,v>c?c/v:1)*d}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Jt.convert(p)),this._update()}setMinZoom(p){if((p=p==null?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p==null?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p==null?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p==null?60:p)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(p){return this.transform.locationPoint(l.LngLat.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(l.Point.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,t,o){if(p==="mouseenter"||p==="mouseover"){let c=!1;return{layer:t,listener:o,delegates:{mousemove:m=>{const v=this.getLayer(t)?this.queryRenderedFeatures(m.point,{layers:[t]}):[];v.length?c||(c=!0,o.call(this,new Mr(p,this,m.originalEvent,{features:v}))):c=!1},mouseout:()=>{c=!1}}}}if(p==="mouseleave"||p==="mouseout"){let c=!1;return{layer:t,listener:o,delegates:{mousemove:v=>{(this.getLayer(t)?this.queryRenderedFeatures(v.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,o.call(this,new Mr(p,this,v.originalEvent)))},mouseout:v=>{c&&(c=!1,o.call(this,new Mr(p,this,v.originalEvent)))}}}}{const c=d=>{const m=this.getLayer(t)?this.queryRenderedFeatures(d.point,{layers:[t]}):[];m.length&&(d.features=m,o.call(this,d),delete d.features)};return{layer:t,listener:o,delegates:{[p]:c}}}}on(p,t,o){if(o===void 0)return super.on(p,t);const c=this._createDelegatedListener(p,t,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(c);for(const d in c.delegates)this.on(d,c.delegates[d]);return this}once(p,t,o){if(o===void 0)return super.once(p,t);const c=this._createDelegatedListener(p,t,o);for(const d in c.delegates)this.once(d,c.delegates[d]);return this}off(p,t,o){return o===void 0?super.off(p,t):(this._delegatedListeners&&this._delegatedListeners[p]&&(c=>{const d=this._delegatedListeners[p];for(let m=0;m<d.length;m++){const v=d[m];if(v.layer===t&&v.listener===o){for(const b in v.delegates)this.off(b,v.delegates[b]);return d.splice(m,1),this}}})(),this)}queryRenderedFeatures(p,t){if(!this.style)return[];let o;const c=p instanceof l.Point||Array.isArray(p),d=c?p:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:p)||{},d instanceof l.Point||typeof d[0]=="number")o=[l.Point.convert(d)];else{const m=l.Point.convert(d[0]),v=l.Point.convert(d[1]);o=[m,new l.Point(v.x,m.y),v,new l.Point(m.x,v.y),m]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(p,t){return this.style.querySourceFeatures(p,t)}setStyle(p,t){return(t=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(p,t))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const t=this._locale[p];if(t==null)throw new Error(`Missing UI string '${p}'`);return t}_updateStyle(p,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,t));const o=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new tn(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,t,o):this.style.loadJSON(p,t,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,t){if(typeof p=="string"){const o=this._requestManager.transformRequest(p,ge.Style);l.getJSON(o,(c,d)=>{c?this.fire(new l.ErrorEvent(c)):d&&this._updateDiff(d,t)})}else typeof p=="object"&&this._updateDiff(p,t)}_updateDiff(p,t){try{this.style.setState(p,t)&&this._update(!0)}catch(o){l.warnOnce(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(p,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(p,t){return this._lazyInitEmptyStyle(),this.style.addSource(p,t),this._update(!0)}isSourceLoaded(p){const t=this.style&&this.style.sourceCaches[p];if(t!==void 0)return t.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const t=this.style.sourceCaches[p.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);for(const o in this.style._layers){const c=this.style._layers[o];c.type==="hillshade"&&c.source===p.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Vl(this.painter,t,p),this.painter.renderToTexture=new Mi(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==p.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.Event("terrain",{terrain:p})),this}getTerrain(){var p,t;return(t=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const t in p){const o=p[t]._tiles;for(const c in o){const d=o[c];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}addSourceType(p,t,o){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,t,o)}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,t,o={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:m,stretchY:v,content:b}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.isImageBitmap(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:k,data:I}=t,P=t;return this.style.addImage(p,{data:new l.RGBAImage({width:E,height:k},new Uint8Array(I)),pixelRatio:c,stretchX:m,stretchY:v,content:b,sdf:d,version:0,userImage:P}),P.onAdd&&P.onAdd(this,p),this}}{const{width:E,height:k,data:I}=l.browser.getImageData(t);this.style.addImage(p,{data:new l.RGBAImage({width:E,height:k},I),pixelRatio:c,stretchX:m,stretchY:v,content:b,sdf:d,version:0})}}updateImage(p,t){const o=this.style.getImage(p);if(!o)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||l.isImageBitmap(t)?l.browser.getImageData(t):t,{width:d,height:m,data:v}=c;if(d===void 0||m===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==o.data.width||m!==o.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(t instanceof HTMLImageElement||l.isImageBitmap(t));return o.data.replace(v,b),this.style.updateImage(p,o),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,t){_e.getImage(this._requestManager.transformRequest(p,ge.Image),t)}listImages(){return this.style.listImages()}addLayer(p,t){return this._lazyInitEmptyStyle(),this.style.addLayer(p,t),this._update(!0)}moveLayer(p,t){return this.style.moveLayer(p,t),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,t,o){return this.style.setLayerZoomRange(p,t,o),this._update(!0)}setFilter(p,t,o={}){return this.style.setFilter(p,t,o),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,t,o,c={}){return this.style.setPaintProperty(p,t,o,c),this._update(!0)}getPaintProperty(p,t){return this.style.getPaintProperty(p,t)}setLayoutProperty(p,t,o,c={}){return this.style.setLayoutProperty(p,t,o,c),this._update(!0)}getLayoutProperty(p,t){return this.style.getLayoutProperty(p,t)}setGlyphs(p,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,t,o,c=>{c||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,t,o=>{o||this._update(!0)}),this}setLight(p,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,t){return this.style.setFeatureState(p,t),this._update()}removeFeatureState(p,t){return this.style.removeFeatureState(p,t),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,t=0;return this._container&&(p=this._container.clientWidth||400,t=this._container.clientHeight||300),[p,t]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const t=this._canvasContainer=D.create("div","maplibregl-canvas-container",p);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),c=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],c);const d=this._controlContainer=D.create("div","maplibregl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{m[v]=D.create("div",`maplibregl-ctrl-${v} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=D.create("div","maplibregl-cooperative-gesture-screen",this._container);let p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){D.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(p,t,o){this._canvas.width=Math.floor(o*p),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:p},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});const o=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!o){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new nu(o,this.transform),V.testSupport(o)}_onCooperativeGesture(p,t,o){return!t&&o<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=l.browser.now();this.style.zoomHistory.update(d,m);const v=new l.EvaluationParameters(d,{now:m,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),b=v.crossFadingFactor();b===1&&b===this._crossFadingFactor||(o=!0,this._crossFadingFactor=b),this.style.update(v)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),_e.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.browser.frame(p=>{l.PerformanceUtils.frame(p),this._frame=null,this._render(p)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return Rd}getCameraTargetElevation(){return this.transform.elevation}},$t.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,o)=>{const c=this._map._getUIString(`NavigationControl.${o}`);t.title=c,t.setAttribute("aria-label",c)},this.options=l.extend({},Cr,p),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,t){const o=D.create("button",p,this._container);return o.type="button",o.addEventListener("click",t),o}},$t.GeolocateControl=class extends l.Evented{constructor(p){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new l.LngLat(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,d=this._map.getBearing(),m=l.extend({bearing:d},this.options.fitBoundsOptions),v=Jt.fromLngLat(o,c);this._map.fitBounds(v,m,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new l.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&ko)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Za({element:this._dotElement}),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Za({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}},this.options=l.extend({},Wa,p)}onAdd(p){return this._map=p,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,o=!1){ri===void 0||o?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{ri=c.state!=="denied",t(ri)}).catch(()=>{ri=!!window.navigator.geolocation,t(ri)}):(ri=!!window.navigator.geolocation,t(ri)):t(ri)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Yo=0,ko=!1}_isOutOfMapMaxBounds(p){const t=this._map.getMaxBounds(),o=p.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),t=p.getSouthEast(),o=p.getNorthEast(),c=t.distanceTo(o),d=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yo--,ko=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Yo++,Yo>1?(p={maximumAge:6e5,timeout:0},ko=!0):(p=this.options.positionOptions,ko=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},$t.AttributionControl=li,$t.LogoControl=Va,$t.ScaleControl=class{constructor(p){this._onMove=()=>{Os(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Os(this._map,this._container,this.options)},this.options=l.extend({},jl,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},$t.FullscreenControl=class extends l.Evented{constructor(p={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},$t.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=p}onAdd(p){return this._map=p,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},$t.Popup=class extends l.Evented{constructor(p){super(),this.remove=()=>(this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const v of this.options.className.split(" "))this._container.classList.add(v);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=qa(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const o=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let c=this.options.anchor;const d=$s(this.options.offset);if(!c){const v=this._container.offsetWidth,b=this._container.offsetHeight;let E;E=o.y+d.bottom.y<b?["top"]:o.y>this._map.transform.height-b?["bottom"]:[],o.x<v/2?E.push("left"):o.x>this._map.transform.width-v/2&&E.push("right"),c=E.length===0?"bottom":E.join("-")}const m=o.add(d[c]).round();D.setTransform(this._container,`${Ga[c]} translate(${m.x}px,${m.y}px)`),Bs(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=l.extend(Object.create(ql),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=l.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const t=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=p;c=o.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Gl);p&&p.focus()}},$t.Marker=Za,$t.Style=tn,$t.LngLat=l.LngLat,$t.LngLatBounds=Jt,$t.Point=l.Point,$t.MercatorCoordinate=l.MercatorCoordinate,$t.Evented=l.Evented,$t.AJAXError=l.AJAXError,$t.config=l.config,$t.CanvasSource=ve,$t.GeoJSONSource=zn,$t.ImageSource=Gt,$t.RasterDEMTileSource=Qi,$t.RasterTileSource=$i,$t.VectorTileSource=Hn,$t.VideoSource=br,$t.setRTLTextPlugin=l.setRTLTextPlugin,$t.getRTLTextPluginStatus=l.getRTLTextPluginStatus,$t.prewarm=function(){si().acquire(Fe)},$t.clearPrewarmedResources=function(){const p=qt;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Fe),qt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Us.extend($t,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),$t});var T=_;return T})})(n0);const mc=X_(n0.exports);function Lw(n,a){return[{id:"background",type:"background",paint:{"background-color":a.background}},{id:"earth",type:"fill",source:n,"source-layer":"earth",paint:{"fill-color":a.earth}},{id:"landuse_park",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"]],paint:{"fill-color":["interpolate",["linear"],["zoom"],0,a.park_a,12,a.park_b]}},{id:"landuse_urban_green",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","allotments","village_green","playground"]],paint:{"fill-color":a.park_b,"fill-opacity":.7}},{id:"landuse_hospital",type:"fill",source:n,"source-layer":"landuse",filter:["any",["==","pmap:kind","hospital"]],paint:{"fill-color":a.hospital}},{id:"landuse_industrial",type:"fill",source:n,"source-layer":"landuse",filter:["any",["==","pmap:kind","industrial"]],paint:{"fill-color":a.industrial}},{id:"landuse_school",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","school","university","college"]],paint:{"fill-color":a.school}},{id:"landuse_beach",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","beach"]],paint:{"fill-color":a.beach}},{id:"landuse_zoo",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","zoo"]],paint:{"fill-color":a.zoo}},{id:"landuse_military",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","military","naval_base","airfield"]],paint:{"fill-color":a.zoo}},{id:"natural_wood",type:"fill",source:n,"source-layer":"natural",filter:["any",["in","pmap:kind","wood","nature_reserve","forest"]],paint:{"fill-color":["interpolate",["linear"],["zoom"],0,a.wood_a,12,a.wood_b]}},{id:"natural_scrub",type:"fill",source:n,"source-layer":"natural",filter:["in","pmap:kind","scrub","grassland","grass"],paint:{"fill-color":["interpolate",["linear"],["zoom"],0,a.scrub_a,12,a.scrub_b]}},{id:"natural_glacier",type:"fill",source:n,"source-layer":"natural",filter:["==","pmap:kind","glacier"],paint:{"fill-color":a.glacier}},{id:"natural_sand",type:"fill",source:n,"source-layer":"natural",filter:["==","pmap:kind","sand"],paint:{"fill-color":a.sand}},{id:"landuse_aerodrome",type:"fill",source:n,"source-layer":"landuse",filter:["any",["in","pmap:kind","aerodrome"]],paint:{"fill-color":a.aerodrome}},{id:"transit_runway",type:"line",source:n,"source-layer":"transit",filter:["any",["in","pmap:kind_detail","runway"]],paint:{"line-color":a.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,12,4,18,30]}},{id:"transit_taxiway",type:"line",source:n,"source-layer":"transit",minzoom:13,filter:["any",["in","pmap:kind_detail","taxiway"]],paint:{"line-color":a.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,15,6]}},{id:"water",type:"fill",source:n,"source-layer":"water",paint:{"fill-color":a.water}},{id:"physical_line_stream",type:"line",source:n,"source-layer":"physical_line",minzoom:14,filter:["all",["in","pmap:kind","stream"]],paint:{"line-color":a.water,"line-width":.5}},{id:"physical_line_river",type:"line",source:n,"source-layer":"physical_line",minzoom:9,filter:["all",["in","pmap:kind","river"]],paint:{"line-color":a.water,"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1,18,12]}},{id:"landuse_pedestrian",type:"fill",source:n,"source-layer":"landuse",filter:["any",["==","pmap:kind","pedestrian"]],paint:{"fill-color":a.pedestrian}},{id:"landuse_pier",type:"fill",source:n,"source-layer":"landuse",filter:["any",["==","pmap:kind","pier"]],paint:{"fill-color":a.pier}},{id:"roads_tunnels_other_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["in","pmap:kind","other","path"]],paint:{"line-color":a.tunnel_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":a.tunnel_minor_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_link_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:link",1]],paint:{"line-color":a.tunnel_link_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_medium_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.tunnel_medium_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1]}},{id:"roads_tunnels_major_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.tunnel_major_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_tunnels_highway_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.tunnel_highway_casing,"line-dasharray":[6,.5],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_tunnels_other",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["in","pmap:kind","other","path"]],paint:{"line-color":a.tunnel_other,"line-dasharray":[4.5,.5],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":a.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_tunnels_link",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:link",1]],paint:{"line-color":a.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_tunnels_medium",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.tunnel_medium,"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,12,1.2,15,3,18,13]}},{id:"roads_tunnels_major",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.tunnel_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_tunnels_highway",type:"line",source:n,"source-layer":"roads",filter:["all",["<","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.tunnel_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"buildings",type:"fill",source:n,"source-layer":"buildings",paint:{"fill-color":a.buildings,"fill-opacity":.5}},{id:"transit_pier",type:"line",source:n,"source-layer":"transit",filter:["any",["==","pmap:kind","pier"]],paint:{"line-color":a.transit_pier,"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,16]}},{id:"roads_minor_service_casing",type:"line",source:n,"source-layer":"roads",minzoom:13,filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"],["==","pmap:kind_detail","service"]],paint:{"line-color":a.minor_service_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_minor_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"],["!=","pmap:kind_detail","service"]],paint:{"line-color":a.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_link_casing",type:"line",source:n,"source-layer":"roads",minzoom:13,filter:["all",["==","pmap:link",1]],paint:{"line-color":a.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1.5]}},{id:"roads_medium_casing",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.medium_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,12,1.2,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1.5]}},{id:"roads_major_casing_late",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",["==","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.major_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_highway_casing_late",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",["==","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.highway_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_other",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["in","pmap:kind","other","path"]],paint:{"line-color":a.other,"line-dasharray":[3,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_link",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:link",1]],paint:{"line-color":a.link,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_minor_service",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"],["==","pmap:kind_detail","service"]],paint:{"line-color":a.minor_service,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8]}},{id:"roads_minor",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","minor_road"],["!=","pmap:kind_detail","service"]],paint:{"line-color":["interpolate",["exponential",1.6],["zoom"],11,a.minor_a,16,a.minor_b],"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_medium",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.medium,"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,12,1.2,15,3,18,13]}},{id:"roads_major_casing_early",type:"line",source:n,"source-layer":"roads",maxzoom:12,filter:["all",["==","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.major_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_major",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_highway_casing_early",type:"line",source:n,"source-layer":"roads",maxzoom:12,filter:["all",["==","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.highway_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_highway",type:"line",source:n,"source-layer":"roads",filter:["all",["==","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"transit_railway",type:"line",source:n,"source-layer":"transit",filter:["all",["==","pmap:kind","rail"]],paint:{"line-dasharray":[.3,.75],"line-opacity":.5,"line-color":a.railway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,.15,18,9]}},{id:"boundaries_country",type:"line",source:n,"source-layer":"boundaries",filter:["<=","pmap:min_admin_level",2],paint:{"line-color":a.boundaries,"line-width":1,"line-dasharray":[3,2]}},{id:"boundaries",type:"line",source:n,"source-layer":"boundaries",filter:[">","pmap:min_admin_level",2],paint:{"line-color":a.boundaries,"line-width":.5,"line-dasharray":[3,2]}},{id:"roads_bridges_other_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["in","pmap:kind","other","path"]],paint:{"line-color":a.bridges_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_link_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:link",1]],paint:{"line-color":a.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1.5]}},{id:"roads_bridges_minor_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":a.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_bridges_medium_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.bridges_medium_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,12,1.2,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,10.5,1.5]}},{id:"roads_bridges_major_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.bridges_major_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,10],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1.5]}},{id:"roads_bridges_other",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["in","pmap:kind","other","path"]],paint:{"line-color":a.bridges_other,"line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_minor",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","minor_road"]],paint:{"line-color":a.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_bridges_link",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:link",1]],paint:{"line-color":a.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_bridges_medium",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","medium_road"]],paint:{"line-color":a.bridges_medium,"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,12,1.2,15,3,18,13]}},{id:"roads_bridges_major",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","major_road"]],paint:{"line-color":a.bridges_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_bridges_highway_casing",type:"line",source:n,"source-layer":"roads",minzoom:12,filter:["all",[">","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.bridges_highway_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_bridges_highway",type:"line",source:n,"source-layer":"roads",filter:["all",[">","pmap:level",0],["==","pmap:kind","highway"],["!=","pmap:link",1]],paint:{"line-color":a.bridges_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}}]}function Fw(n,a){return[{id:"physical_line_waterway_label",type:"symbol",source:n,"source-layer":"physical_line",minzoom:13,filter:["all",["in","pmap:kind","river","stream"]],layout:{"symbol-placement":"line","text-font":["Noto Sans Regular"],"text-field":["get","name"],"text-size":12,"text-letter-spacing":.3},paint:{"text-color":a.waterway_label}},{id:"physical_point_peak",type:"symbol",source:n,"source-layer":"physical_point",filter:["any",["==","pmap:kind","peak"]],layout:{"text-font":["Noto Sans Italic"],"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],10,8,16,12],"text-letter-spacing":.1,"text-max-width":9},paint:{"text-color":a.peak_label,"text-halo-width":1.5}},{id:"roads_labels_minor",type:"symbol",source:n,"source-layer":"roads",minzoom:15,filter:["any",["in","pmap:kind","minor_road","other","path"]],layout:{"symbol-sort-key":["get","pmap:min_zoom"],"symbol-placement":"line","text-font":["Noto Sans Regular"],"text-field":["get","name"],"text-size":12},paint:{"text-color":a.roads_label_minor,"text-halo-color":a.roads_label_minor_halo,"text-halo-width":2}},{id:"physical_point_ocean",type:"symbol",source:n,"source-layer":"physical_point",filter:["any",["in","pmap:kind","sea","ocean","lake","water","bay","strait","fjord"]],layout:{"text-font":["Noto Sans Medium"],"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],3,10,10,12],"text-letter-spacing":.1,"text-max-width":9,"text-transform":"uppercase"},paint:{"text-color":a.ocean_label}},{id:"physical_point_lakes",type:"symbol",source:n,"source-layer":"physical_point",filter:["any",["in","pmap:kind","lake","water"]],layout:{"text-font":["Noto Sans Medium"],"text-field":["get","name"],"text-size":["interpolate",["linear"],["zoom"],3,0,6,12,10,12],"text-letter-spacing":.1,"text-max-width":9},paint:{"text-color":a.ocean_label}},{id:"roads_labels_major",type:"symbol",source:n,"source-layer":"roads",minzoom:11,filter:["any",["in","pmap:kind","highway","major_road","medium_road"]],layout:{"symbol-sort-key":["get","pmap:min_zoom"],"symbol-placement":"line","text-font":["Noto Sans Regular"],"text-field":["get","name"],"text-size":12},paint:{"text-color":a.roads_label_major,"text-halo-color":a.roads_label_major_halo,"text-halo-width":2}},{id:"places_subplace",type:"symbol",source:n,"source-layer":"places",filter:["==","pmap:kind","neighbourhood"],layout:{"symbol-sort-key":["get","pmap:min_zoom"],"text-field":"{name}","text-font":["Noto Sans Regular"],"text-max-width":7,"text-letter-spacing":.1,"text-padding":["interpolate",["linear"],["zoom"],5,2,8,4,12,18,15,20],"text-size":["interpolate",["exponential",1.2],["zoom"],11,8,14,14,18,24],"text-transform":"uppercase"},paint:{"text-color":a.subplace_label,"text-halo-color":a.subplace_label_halo,"text-halo-width":1.5}},{id:"places_locality",type:"symbol",source:n,"source-layer":"places",filter:["==","pmap:kind","locality"],layout:{"icon-image":["step",["zoom"],"townspot",8,""],"icon-size":.7,"text-field":"{name}","text-font":["case",["<=",["get","pmap:min_zoom"],5],["literal",["Noto Sans Medium"]],["literal",["Noto Sans Regular"]]],"text-padding":["interpolate",["linear"],["zoom"],5,3,8,7,12,11],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","pmap:population_rank"],13],8,[">=",["get","pmap:population_rank"],13],13,0],4,["case",["<",["get","pmap:population_rank"],13],10,[">=",["get","pmap:population_rank"],13],15,0],6,["case",["<",["get","pmap:population_rank"],12],11,[">=",["get","pmap:population_rank"],12],17,0],8,["case",["<",["get","pmap:population_rank"],11],11,[">=",["get","pmap:population_rank"],11],18,0],10,["case",["<",["get","pmap:population_rank"],9],12,[">=",["get","pmap:population_rank"],9],20,0],15,["case",["<",["get","pmap:population_rank"],8],12,[">=",["get","pmap:population_rank"],8],22,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,0,8,4,10,8,12,6,22,2],"text-anchor":["step",["zoom"],"left",8,"center"],"text-radial-offset":.4},paint:{"text-color":a.city_label,"text-halo-color":a.city_label_halo,"text-halo-width":1}},{id:"places_region",type:"symbol",source:n,"source-layer":"places",filter:["==","pmap:kind","region"],layout:{"symbol-sort-key":["get","pmap:min_zoom"],"text-field":["step",["zoom"],["get","name:short"],6,["get","name"]],"text-font":["Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],3,11,7,16],"text-radial-offset":.2,"text-anchor":"center","text-transform":"uppercase"},paint:{"text-color":a.state_label,"text-halo-color":a.state_label_halo,"text-halo-width":2}},{id:"places_country",type:"symbol",source:n,"source-layer":"places",filter:["==","pmap:kind","country"],layout:{"symbol-sort-key":["get","pmap:min_zoom"],"text-field":"{name}","text-font":["Noto Sans Medium"],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","pmap:population_rank"],10],8,[">=",["get","pmap:population_rank"],10],12,0],6,["case",["<",["get","pmap:population_rank"],8],10,[">=",["get","pmap:population_rank"],8],18,0],8,["case",["<",["get","pmap:population_rank"],7],11,[">=",["get","pmap:population_rank"],7],20,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,2,14,2,16,20,17,2,22,2],"text-transform":"uppercase"},paint:{"text-color":a.country_label}}]}var Bw={background:"#dddddd",earth:"#ededed",park_a:"#bfc99c",park_b:"#bfc99c",hospital:"#ffeae8",industrial:"#f8ffed",school:"#f2fef9",wood_a:"#bfc99c",wood_b:"#bfc99c",pedestrian:"#eef0f0",scrub_a:"#bfc99c",scrub_b:"#bfc99c",glacier:"#ffffff",sand:"#ebe7da",beach:"#ebe7da",aerodrome:"#dbe7e7",runway:"#d1d9d9",water:"#84b7cf",pier:"#ededed",zoo:"#ebe6ed",military:"#ebe6ed",tunnel_other_casing:"#ffffff",tunnel_minor_casing:"#e2e2e2",tunnel_link_casing:"#e2e2e2",tunnel_medium_casing:"#e1e1e1",tunnel_major_casing:"#e3cfd3",tunnel_highway_casing:"#ebcea2",tunnel_other:"#f7f7f7",tunnel_minor:"#ebebeb",tunnel_link:"#ebebeb",tunnel_medium:"#ebebeb",tunnel_major:"#ebebeb",tunnel_highway:"#ebebeb",transit_pier:"#ededed",buildings:"#cbcece",minor_service_casing:"#e2e2e2",minor_casing:"#e2e2e2",link_casing:"#e2e2e2",medium_casing:"#e1e1e1",major_casing_late:"#e3cfd3",highway_casing_late:"#ebcea2",other:"#ffffff",minor_service:"#ffffff",minor_a:"#fff2bb",minor_b:"#fff2bb",link:"#fff2bb",medium:"#ffea94",major_casing_early:"#e3cfd3",major:"#ffdf59",highway_casing_early:"#ebcea2",highway:"#e9ac77",railway:"#b3bcc9",boundaries:"#5c4a6b",waterway_label:"#a4cae1",bridges_other_casing:"#ffffff",bridges_minor_casing:"#e2e2e2",bridges_link_casing:"#e1e1e1",bridges_medium_casing:"#e1e1e1",bridges_major_casing:"#e3cfd3",bridges_highway_casing:"#ebcea2",bridges_other:"#ffffff",bridges_minor:"#ffffff",bridges_link:"#e1e1e1",bridges_medium:"#ffffff",bridges_major:"#ffffff",bridges_highway:"#fefffc",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#91888b",roads_label_major_halo:"#ffffff",ocean_label:"#ffffff",peak_label:"#61bb5b",subplace_label:"#757d91",subplace_label_halo:"#ffffff",city_label:"#3c3c3c",city_label_halo:"#ffffff",state_label:"#777777",state_label_halo:"#ffffff",country_label:"#9590aa"},Ow={background:"#cccccc",earth:"#e0e0e0",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",pier:"#e0e0e0",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_medium_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_medium:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",transit_pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",medium_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",medium:"#f5f5f5",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",waterway_label:"#ffffff",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_medium_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_medium:"#f0eded",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#ffffff",peak_label:"#7e9aa0",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3"},$w={background:"#34373d",earth:"#1f1f1f",park_a:"#232325",park_b:"#232325",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#34373d",pier:"#222222",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_medium_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",medium_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",medium:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",waterway_label:"#717784",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_medium_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_medium:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",peak_label:"#898080",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c"},Uw={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",pier:"#f5f5f5",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_medium_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",medium_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",waterway_label:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_medium_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",peak_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8"},Nw={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",pier:"#b8b8b8",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_medium_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",medium_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",waterway_label:"#7a7a7a",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_medium_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",peak_label:"#5c5c5c",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585"},Vw={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",pier:"#0a0a0a",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_medium_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",medium_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",medium:"#292929",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",waterway_label:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_medium_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_medium:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",peak_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070"},jw={light:Ow,dark:$w,white:Uw,grayscale:Nw,black:Vw,contrast:Bw},qw=jw;function o0(n,a){const u=qw[a];return Lw(n,u).concat(Fw(n,u))}var dl={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a0=Z.exports;function Pt(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,u=1;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ip=!1;function He(n,a){return Ip&&(Ip=!1,a[0]!=="<"&&n.push("<!-- -->")),a==="<!-- -->"?Ip=!0:n.push(a)}var mi=Object.prototype.hasOwnProperty,Gw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hy={},dy={};function s0(n){return mi.call(dy,n)?!0:mi.call(hy,n)?!1:Gw.test(n)?dy[n]=!0:(hy[n]=!0,!1)}function Xn(n,a,u,g,_,w,T){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=n,this.type=a,this.sanitizeURL=w,this.removeEmptyString=T}var fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){fn[n]=new Xn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];fn[a]=new Xn(a,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){fn[n]=new Xn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){fn[n]=new Xn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){fn[n]=new Xn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){fn[n]=new Xn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){fn[n]=new Xn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){fn[n]=new Xn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){fn[n]=new Xn(n,5,!1,n.toLowerCase(),null,!1,!1)});var Sf=/[\-:]([a-z])/g;function Ef(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(Sf,Ef);fn[a]=new Xn(a,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(Sf,Ef);fn[a]=new Xn(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(Sf,Ef);fn[a]=new Xn(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){fn[n]=new Xn(n,1,!1,n.toLowerCase(),null,!1,!1)});fn.xlinkHref=new Xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){fn[n]=new Xn(n,1,!1,n.toLowerCase(),null,!0,!0)});var th={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zw=["Webkit","ms","Moz","O"];Object.keys(th).forEach(function(n){Zw.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),th[a]=th[n]})});var Ww=/["'&<>]/;function Zn(n){if(typeof n=="boolean"||typeof n=="number")return""+n;n=""+n;var a=Ww.exec(n);if(a){var u="",g,_=0;for(g=a.index;g<n.length;g++){switch(n.charCodeAt(g)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#x27;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}_!==g&&(u+=n.substring(_,g)),_=g+1,u+=a}n=_!==g?u+n.substring(_,g):u}return n}var Xw=/([A-Z])/g,Kw=/^ms-/,nf=Array.isArray;function Lo(n,a){return{insertionMode:n,selectedValue:a}}function Hw(n,a,u){switch(a){case"select":return Lo(1,u.value!=null?u.value:u.defaultValue);case"svg":return Lo(2,null);case"math":return Lo(3,null);case"foreignObject":return Lo(1,null);case"table":return Lo(4,null);case"thead":case"tbody":case"tfoot":return Lo(5,null);case"colgroup":return Lo(7,null);case"tr":return Lo(6,null)}return 4<=n.insertionMode||n.insertionMode===0?Lo(1,null):n}function py(n,a){a!==""&&n.push(Zn(a),"<!-- -->")}var fy=new Map;function l0(n,a,u){if(typeof u!="object")throw Error(Pt(62));a=!0;for(var g in u)if(mi.call(u,g)){var _=u[g];if(_!=null&&typeof _!="boolean"&&_!==""){if(g.indexOf("--")===0){var w=Zn(g);_=Zn((""+_).trim())}else{w=g;var T=fy.get(w);T!==void 0||(T=Zn(w.replace(Xw,"-$1").toLowerCase().replace(Kw,"-ms-")),fy.set(w,T)),w=T,_=typeof _=="number"?_===0||mi.call(th,g)?""+_:_+"px":Zn((""+_).trim())}a?(a=!1,n.push(' style="',w,":",_)):n.push(";",w,":",_)}}a||n.push('"')}function Bi(n,a,u,g){switch(u){case"style":l0(n,a,g);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N"){if(a=fn.hasOwnProperty(u)?fn[u]:null,a!==null){switch(typeof g){case"function":case"symbol":return;case"boolean":if(!a.acceptsBooleans)return}switch(u=a.attributeName,a.type){case 3:g&&n.push(" ",u,'=""');break;case 4:g===!0?n.push(" ",u,'=""'):g!==!1&&n.push(" ",u,'="',Zn(g),'"');break;case 5:isNaN(g)||n.push(" ",u,'="',Zn(g),'"');break;case 6:!isNaN(g)&&1<=g&&n.push(" ",u,'="',Zn(g),'"');break;default:a.sanitizeURL&&(g=""+g),n.push(" ",u,'="',Zn(g),'"')}}else if(s0(u)){switch(typeof g){case"function":case"symbol":return;case"boolean":if(a=u.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-")return}n.push(" ",u,'="',Zn(g),'"')}}}function rh(n,a,u){if(a!=null){if(u!=null)throw Error(Pt(60));if(typeof a!="object"||!("__html"in a))throw Error(Pt(61));a=a.__html,a!=null&&n.push(""+a)}}function Yw(n){var a="";return a0.Children.forEach(n,function(u){u!=null&&(a+=u)}),a}function Ap(n,a,u,g){n.push(Bo(u));var _=u=null,w;for(w in a)if(mi.call(a,w)){var T=a[w];if(T!=null)switch(w){case"children":u=T;break;case"dangerouslySetInnerHTML":_=T;break;default:Bi(n,g,w,T)}}return n.push(">"),rh(n,_,u),typeof u=="string"?(n.push(Zn(u)),null):u}var Jw=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,my=new Map;function Bo(n){var a=my.get(n);if(a===void 0){if(!Jw.test(n))throw Error(Pt(65,n));a="<"+n,my.set(n,a)}return a}function Qw(n,a,u,g,_){switch(a){case"select":n.push(Bo("select"));var w=null,T=null;for(V in u)if(mi.call(u,V)){var l=u[V];if(l!=null)switch(V){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;case"defaultValue":case"value":break;default:Bi(n,g,V,l)}}return n.push(">"),rh(n,T,w),w;case"option":T=_.selectedValue,n.push(Bo("option"));var O=l=null,D=null,V=null;for(w in u)if(mi.call(u,w)&&(a=u[w],a!=null))switch(w){case"children":l=a;break;case"selected":D=a;break;case"dangerouslySetInnerHTML":V=a;break;case"value":O=a;default:Bi(n,g,w,a)}if(T!=null)if(u=O!==null?""+O:Yw(l),nf(T)){for(g=0;g<T.length;g++)if(""+T[g]===u){n.push(' selected=""');break}}else""+T===u&&n.push(' selected=""');else D&&n.push(' selected=""');return n.push(">"),rh(n,V,l),l;case"textarea":n.push(Bo("textarea")),V=T=w=null;for(l in u)if(mi.call(u,l)&&(O=u[l],O!=null))switch(l){case"children":V=O;break;case"value":w=O;break;case"defaultValue":T=O;break;case"dangerouslySetInnerHTML":throw Error(Pt(91));default:Bi(n,g,l,O)}if(w===null&&T!==null&&(w=T),n.push(">"),V!=null){if(w!=null)throw Error(Pt(92));if(nf(V)&&1<V.length)throw Error(Pt(93));w=""+V}return typeof w=="string"&&w[0]===`
`&&n.push(`
`),w!==null&&n.push(Zn(""+w)),null;case"input":n.push(Bo("input")),O=V=l=w=null;for(T in u)if(mi.call(u,T)&&(D=u[T],D!=null))switch(T){case"children":case"dangerouslySetInnerHTML":throw Error(Pt(399,"input"));case"defaultChecked":O=D;break;case"defaultValue":l=D;break;case"checked":V=D;break;case"value":w=D;break;default:Bi(n,g,T,D)}return V!==null?Bi(n,g,"checked",V):O!==null&&Bi(n,g,"checked",O),w!==null?Bi(n,g,"value",w):l!==null&&Bi(n,g,"value",l),n.push("/>"),null;case"menuitem":n.push(Bo("menuitem"));for(var K in u)if(mi.call(u,K)&&(w=u[K],w!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(Pt(400));default:Bi(n,g,K,w)}return n.push(">"),null;case"listing":case"pre":n.push(Bo(a)),T=w=null;for(O in u)if(mi.call(u,O)&&(l=u[O],l!=null))switch(O){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;default:Bi(n,g,O,l)}if(n.push(">"),T!=null){if(w!=null)throw Error(Pt(60));if(typeof T!="object"||!("__html"in T))throw Error(Pt(61));u=T.__html,u!=null&&(typeof u=="string"&&0<u.length&&u[0]===`
`?n.push(`
`,u):n.push(""+u))}return typeof w=="string"&&w[0]===`
`&&n.push(`
`),w;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":n.push(Bo(a));for(var ae in u)if(mi.call(u,ae)&&(w=u[ae],w!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(Pt(399,a));default:Bi(n,g,ae,w)}return n.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Ap(n,u,a,g);case"html":return _.insertionMode===0&&n.push("<!DOCTYPE html>"),Ap(n,u,a,g);default:if(a.indexOf("-")===-1&&typeof u.is!="string")return Ap(n,u,a,g);n.push(Bo(a)),T=w=null;for(D in u)if(mi.call(u,D)&&(l=u[D],l!=null))switch(D){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;case"style":l0(n,g,l);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:s0(D)&&typeof l!="function"&&typeof l!="symbol"&&n.push(" ",D,'="',Zn(l),'"')}return n.push(">"),rh(n,T,w),w}}function gy(n,a,u){if(He(n,'<!--$?--><template id="'),u===null)throw Error(Pt(395));return He(n,u),He(n,'"></template>')}function e2(n,a,u,g){switch(u.insertionMode){case 0:case 1:return He(n,'<div hidden id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 2:return He(n,'<svg aria-hidden="true" style="display:none" id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 3:return He(n,'<math aria-hidden="true" style="display:none" id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 4:return He(n,'<table hidden id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 5:return He(n,'<table hidden><tbody id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 6:return He(n,'<table hidden><tr id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');case 7:return He(n,'<table hidden><colgroup id="'),He(n,a.segmentPrefix),a=g.toString(16),He(n,a),He(n,'">');default:throw Error(Pt(397))}}function t2(n,a){switch(a.insertionMode){case 0:case 1:return He(n,"</div>");case 2:return He(n,"</svg>");case 3:return He(n,"</math>");case 4:return He(n,"</table>");case 5:return He(n,"</tbody></table>");case 6:return He(n,"</tr></table>");case 7:return He(n,"</colgroup></table>");default:throw Error(Pt(397))}}function r2(n,a){return a=a===void 0?"":a,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:a+"P:",segmentPrefix:a+"S:",boundaryPrefix:a+"B:",idPrefix:a,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:n}}var bc=Object.assign,n2=Symbol.for("react.element"),c0=Symbol.for("react.portal"),u0=Symbol.for("react.fragment"),h0=Symbol.for("react.strict_mode"),d0=Symbol.for("react.profiler"),p0=Symbol.for("react.provider"),f0=Symbol.for("react.context"),m0=Symbol.for("react.forward_ref"),g0=Symbol.for("react.suspense"),y0=Symbol.for("react.suspense_list"),_0=Symbol.for("react.memo"),Tf=Symbol.for("react.lazy"),i2=Symbol.for("react.scope"),o2=Symbol.for("react.debug_trace_mode"),a2=Symbol.for("react.legacy_hidden"),s2=Symbol.for("react.default_value"),yy=Symbol.iterator;function of(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case u0:return"Fragment";case c0:return"Portal";case d0:return"Profiler";case h0:return"StrictMode";case g0:return"Suspense";case y0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case f0:return(n.displayName||"Context")+".Consumer";case p0:return(n._context.displayName||"Context")+".Provider";case m0:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case _0:return a=n.displayName||null,a!==null?a:of(n.type)||"Memo";case Tf:a=n._payload,n=n._init;try{return of(n(a))}catch{}}return null}var x0={};function _y(n,a){if(n=n.contextTypes,!n)return x0;var u={},g;for(g in n)u[g]=a[g];return u}var rs=null;function Mh(n,a){if(n!==a){n.context._currentValue2=n.parentValue,n=n.parent;var u=a.parent;if(n===null){if(u!==null)throw Error(Pt(401))}else{if(u===null)throw Error(Pt(401));Mh(n,u)}a.context._currentValue2=a.value}}function v0(n){n.context._currentValue2=n.parentValue,n=n.parent,n!==null&&v0(n)}function b0(n){var a=n.parent;a!==null&&b0(a),n.context._currentValue2=n.value}function w0(n,a){if(n.context._currentValue2=n.parentValue,n=n.parent,n===null)throw Error(Pt(402));n.depth===a.depth?Mh(n,a):w0(n,a)}function S0(n,a){var u=a.parent;if(u===null)throw Error(Pt(402));n.depth===u.depth?Mh(n,u):S0(n,u),a.context._currentValue2=a.value}function yh(n){var a=rs;a!==n&&(a===null?b0(n):n===null?v0(a):a.depth===n.depth?Mh(a,n):a.depth>n.depth?w0(a,n):S0(a,n),rs=n)}var xy={isMounted:function(){return!1},enqueueSetState:function(n,a){n=n._reactInternals,n.queue!==null&&n.queue.push(a)},enqueueReplaceState:function(n,a){n=n._reactInternals,n.replace=!0,n.queue=[a]},enqueueForceUpdate:function(){}};function vy(n,a,u,g){var _=n.state!==void 0?n.state:null;n.updater=xy,n.props=u,n.state=_;var w={queue:[],replace:!1};n._reactInternals=w;var T=a.contextType;if(n.context=typeof T=="object"&&T!==null?T._currentValue2:g,T=a.getDerivedStateFromProps,typeof T=="function"&&(T=T(u,_),_=T==null?_:bc({},_,T),n.state=_),typeof a.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function"&&(typeof n.UNSAFE_componentWillMount=="function"||typeof n.componentWillMount=="function"))if(a=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),a!==n.state&&xy.enqueueReplaceState(n,n.state,null),w.queue!==null&&0<w.queue.length)if(a=w.queue,T=w.replace,w.queue=null,w.replace=!1,T&&a.length===1)n.state=a[0];else{for(w=T?a[0]:n.state,_=!0,T=T?1:0;T<a.length;T++){var l=a[T];l=typeof l=="function"?l.call(n,w,u,g):l,l!=null&&(_?(_=!1,w=bc({},w,l)):bc(w,l))}n.state=w}else w.queue=null}var l2={id:1,overflow:""};function af(n,a,u){var g=n.id;n=n.overflow;var _=32-nh(g)-1;g&=~(1<<_),u+=1;var w=32-nh(a)+_;if(30<w){var T=_-_%5;return w=(g&(1<<T)-1).toString(32),g>>=T,_-=T,{id:1<<32-nh(a)+_|u<<_|g,overflow:w+n}}return{id:1<<w|u<<_|g,overflow:n}}var nh=Math.clz32?Math.clz32:h2,c2=Math.log,u2=Math.LN2;function h2(n){return n>>>=0,n===0?32:31-(c2(n)/u2|0)|0}function d2(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var p2=typeof Object.is=="function"?Object.is:d2,Uo=null,Cf=null,ih=null,pr=null,gc=!1,_h=!1,Tc=0,ca=null,zh=0;function Qa(){if(Uo===null)throw Error(Pt(321));return Uo}function by(){if(0<zh)throw Error(Pt(312));return{memoizedState:null,queue:null,next:null}}function kf(){return pr===null?ih===null?(gc=!1,ih=pr=by()):(gc=!0,pr=ih):pr.next===null?(gc=!1,pr=pr.next=by()):(gc=!0,pr=pr.next),pr}function If(){Cf=Uo=null,_h=!1,ih=null,zh=0,pr=ca=null}function E0(n,a){return typeof a=="function"?a(n):a}function wy(n,a,u){if(Uo=Qa(),pr=kf(),gc){var g=pr.queue;if(a=g.dispatch,ca!==null&&(u=ca.get(g),u!==void 0)){ca.delete(g),g=pr.memoizedState;do g=n(g,u.action),u=u.next;while(u!==null);return pr.memoizedState=g,[g,a]}return[pr.memoizedState,a]}return n=n===E0?typeof a=="function"?a():a:u!==void 0?u(a):a,pr.memoizedState=n,n=pr.queue={last:null,dispatch:null},n=n.dispatch=f2.bind(null,Uo,n),[pr.memoizedState,n]}function Sy(n,a){if(Uo=Qa(),pr=kf(),a=a===void 0?null:a,pr!==null){var u=pr.memoizedState;if(u!==null&&a!==null){var g=u[1];e:if(g===null)g=!1;else{for(var _=0;_<g.length&&_<a.length;_++)if(!p2(a[_],g[_])){g=!1;break e}g=!0}if(g)return u[0]}}return n=n(),pr.memoizedState=[n,a],n}function f2(n,a,u){if(25<=zh)throw Error(Pt(301));if(n===Uo)if(_h=!0,n={action:u,next:null},ca===null&&(ca=new Map),u=ca.get(a),u===void 0)ca.set(a,n);else{for(a=u;a.next!==null;)a=a.next;a.next=n}}function m2(){throw Error(Pt(394))}function Vu(){}var Ey={readContext:function(n){return n._currentValue2},useContext:function(n){return Qa(),n._currentValue2},useMemo:Sy,useReducer:wy,useRef:function(n){Uo=Qa(),pr=kf();var a=pr.memoizedState;return a===null?(n={current:n},pr.memoizedState=n):a},useState:function(n){return wy(E0,n)},useInsertionEffect:Vu,useLayoutEffect:function(){},useCallback:function(n,a){return Sy(function(){return n},a)},useImperativeHandle:Vu,useEffect:Vu,useDebugValue:Vu,useDeferredValue:function(n){return Qa(),n},useTransition:function(){return Qa(),[!1,m2]},useId:function(){var n=Cf.treeContext,a=n.overflow;n=n.id,n=(n&~(1<<32-nh(n)-1)).toString(32)+a;var u=oh;if(u===null)throw Error(Pt(404));return a=Tc++,n=":"+u.idPrefix+"R"+n,0<a&&(n+="H"+a.toString(32)),n+":"},useMutableSource:function(n,a){return Qa(),a(n._source)},useSyncExternalStore:function(n,a,u){if(u===void 0)throw Error(Pt(407));return u()}},oh=null,Pp=a0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function g2(n){console.error(n)}function yc(){}function y2(n,a,u,g,_,w,T,l,O){var D=[],V=new Set;return a={destination:null,responseState:a,progressiveChunkSize:g===void 0?12800:g,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:V,pingedTasks:D,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:_===void 0?g2:_,onAllReady:w===void 0?yc:w,onShellReady:T===void 0?yc:T,onShellError:l===void 0?yc:l,onFatalError:O===void 0?yc:O},u=xh(a,0,null,u),u.parentFlushed=!0,n=Af(a,n,null,u,V,x0,null,l2),D.push(n),a}function Af(n,a,u,g,_,w,T,l){n.allPendingTasks++,u===null?n.pendingRootTasks++:u.pendingTasks++;var O={node:a,ping:function(){var D=n.pingedTasks;D.push(O),D.length===1&&k0(n)},blockedBoundary:u,blockedSegment:g,abortSet:_,legacyContext:w,context:T,treeContext:l};return _.add(O),O}function xh(n,a,u,g){return{status:0,id:-1,index:a,parentFlushed:!1,chunks:[],children:[],formatContext:g,boundary:u}}function Cc(n,a){n=n.onError,n(a)}function vh(n,a){var u=n.onShellError;u(a),u=n.onFatalError,u(a),n.destination!==null?(n.status=2,n.destination.destroy(a)):(n.status=1,n.fatalError=a)}function Ty(n,a,u,g,_){for(Uo={},Cf=a,Tc=0,n=u(g,_);_h;)_h=!1,Tc=0,zh+=1,pr=null,n=u(g,_);return If(),n}function Cy(n,a,u,g){var _=u.render(),w=g.childContextTypes;if(w!=null){var T=a.legacyContext;if(typeof u.getChildContext!="function")g=T;else{u=u.getChildContext();for(var l in u)if(!(l in w))throw Error(Pt(108,of(g)||"Unknown",l));g=bc({},T,u)}a.legacyContext=g,gi(n,a,_),a.legacyContext=T}else gi(n,a,_)}function ky(n,a){if(n&&n.defaultProps){a=bc({},a),n=n.defaultProps;for(var u in n)a[u]===void 0&&(a[u]=n[u]);return a}return a}function sf(n,a,u,g,_){if(typeof u=="function")if(u.prototype&&u.prototype.isReactComponent){_=_y(u,a.legacyContext);var w=u.contextType;w=new u(g,typeof w=="object"&&w!==null?w._currentValue2:_),vy(w,u,g,_),Cy(n,a,w,u)}else{w=_y(u,a.legacyContext),_=Ty(n,a,u,g,w);var T=Tc!==0;if(typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0)vy(_,u,g,w),Cy(n,a,_,u);else if(T){g=a.treeContext,a.treeContext=af(g,1,0);try{gi(n,a,_)}finally{a.treeContext=g}}else gi(n,a,_)}else if(typeof u=="string")switch(_=a.blockedSegment,w=Qw(_.chunks,u,g,n.responseState,_.formatContext),T=_.formatContext,_.formatContext=Hw(T,u,g),lf(n,a,w),_.formatContext=T,u){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:_.chunks.push("</",u,">")}else{switch(u){case a2:case o2:case h0:case d0:case u0:gi(n,a,g.children);return;case y0:gi(n,a,g.children);return;case i2:throw Error(Pt(343));case g0:e:{u=a.blockedBoundary,_=a.blockedSegment,w=g.fallback,g=g.children,T=new Set;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:T},O=xh(n,_.chunks.length,l,_.formatContext);_.children.push(O);var D=xh(n,0,null,_.formatContext);D.parentFlushed=!0,a.blockedBoundary=l,a.blockedSegment=D;try{if(lf(n,a,g),D.status=1,bh(l,D),l.pendingTasks===0)break e}catch(V){D.status=4,Cc(n,V),l.forceClientRender=!0}finally{a.blockedBoundary=u,a.blockedSegment=_}a=Af(n,w,u,O,T,a.legacyContext,a.context,a.treeContext),n.pingedTasks.push(a)}return}if(typeof u=="object"&&u!==null)switch(u.$$typeof){case m0:if(g=Ty(n,a,u.render,g,_),Tc!==0){u=a.treeContext,a.treeContext=af(u,1,0);try{gi(n,a,g)}finally{a.treeContext=u}}else gi(n,a,g);return;case _0:u=u.type,g=ky(u,g),sf(n,a,u,g,_);return;case p0:if(_=g.children,u=u._context,g=g.value,w=u._currentValue2,u._currentValue2=g,T=rs,rs=g={parent:T,depth:T===null?0:T.depth+1,context:u,parentValue:w,value:g},a.context=g,gi(n,a,_),n=rs,n===null)throw Error(Pt(403));g=n.parentValue,n.context._currentValue2=g===s2?n.context._defaultValue:g,n=rs=n.parent,a.context=n;return;case f0:g=g.children,g=g(u._currentValue2),gi(n,a,g);return;case Tf:_=u._init,u=_(u._payload),g=ky(u,g),sf(n,a,u,g,void 0);return}throw Error(Pt(130,u==null?u:typeof u,""))}}function gi(n,a,u){if(a.node=u,typeof u=="object"&&u!==null){switch(u.$$typeof){case n2:sf(n,a,u.type,u.props,u.ref);return;case c0:throw Error(Pt(257));case Tf:var g=u._init;u=g(u._payload),gi(n,a,u);return}if(nf(u)){Iy(n,a,u);return}if(u===null||typeof u!="object"?g=null:(g=yy&&u[yy]||u["@@iterator"],g=typeof g=="function"?g:null),g&&(g=g.call(u))){if(u=g.next(),!u.done){var _=[];do _.push(u.value),u=g.next();while(!u.done);Iy(n,a,_)}return}throw n=Object.prototype.toString.call(u),Error(Pt(31,n==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":n))}typeof u=="string"?(a=a.blockedSegment.chunks,n.responseState.generateStaticMarkup?a.push(Zn(u)):py(a,u)):typeof u=="number"&&(a=a.blockedSegment.chunks,u=""+u,n.responseState.generateStaticMarkup?a.push(Zn(u)):py(a,u))}function Iy(n,a,u){for(var g=u.length,_=0;_<g;_++){var w=a.treeContext;a.treeContext=af(w,g,_);try{lf(n,a,u[_])}finally{a.treeContext=w}}}function lf(n,a,u){var g=a.blockedSegment.formatContext,_=a.legacyContext,w=a.context;try{return gi(n,a,u)}catch(O){if(If(),typeof O=="object"&&O!==null&&typeof O.then=="function"){u=O;var T=a.blockedSegment,l=xh(n,T.chunks.length,null,T.formatContext);T.children.push(l),n=Af(n,a.node,a.blockedBoundary,l,a.abortSet,a.legacyContext,a.context,a.treeContext).ping,u.then(n,n),a.blockedSegment.formatContext=g,a.legacyContext=_,a.context=w,yh(w)}else throw a.blockedSegment.formatContext=g,a.legacyContext=_,a.context=w,yh(w),O}}function _2(n){var a=n.blockedBoundary;n=n.blockedSegment,n.status=3,C0(this,a,n)}function T0(n){var a=n.blockedBoundary;n.blockedSegment.status=3,a===null?(this.allPendingTasks--,this.status!==2&&(this.status=2,this.destination!==null&&this.destination.push(null))):(a.pendingTasks--,a.forceClientRender||(a.forceClientRender=!0,a.parentFlushed&&this.clientRenderedBoundaries.push(a)),a.fallbackAbortableTasks.forEach(T0,this),a.fallbackAbortableTasks.clear(),this.allPendingTasks--,this.allPendingTasks===0&&(n=this.onAllReady,n()))}function bh(n,a){if(a.chunks.length===0&&a.children.length===1&&a.children[0].boundary===null){var u=a.children[0];u.id=a.id,u.parentFlushed=!0,u.status===1&&bh(n,u)}else n.completedSegments.push(a)}function C0(n,a,u){if(a===null){if(u.parentFlushed){if(n.completedRootSegment!==null)throw Error(Pt(389));n.completedRootSegment=u}n.pendingRootTasks--,n.pendingRootTasks===0&&(n.onShellError=yc,a=n.onShellReady,a())}else a.pendingTasks--,a.forceClientRender||(a.pendingTasks===0?(u.parentFlushed&&u.status===1&&bh(a,u),a.parentFlushed&&n.completedBoundaries.push(a),a.fallbackAbortableTasks.forEach(_2,n),a.fallbackAbortableTasks.clear()):u.parentFlushed&&u.status===1&&(bh(a,u),a.completedSegments.length===1&&a.parentFlushed&&n.partialBoundaries.push(a)));n.allPendingTasks--,n.allPendingTasks===0&&(n=n.onAllReady,n())}function k0(n){if(n.status!==2){var a=rs,u=Pp.current;Pp.current=Ey;var g=oh;oh=n.responseState;try{var _=n.pingedTasks,w;for(w=0;w<_.length;w++){var T=_[w],l=n,O=T.blockedSegment;if(O.status===0){yh(T.context);try{gi(l,T,T.node),T.abortSet.delete(T),O.status=1,C0(l,T.blockedBoundary,O)}catch(de){if(If(),typeof de=="object"&&de!==null&&typeof de.then=="function"){var D=T.ping;de.then(D,D)}else{T.abortSet.delete(T),O.status=4;var V=T.blockedBoundary,K=de;if(Cc(l,K),V===null?vh(l,K):(V.pendingTasks--,V.forceClientRender||(V.forceClientRender=!0,V.parentFlushed&&l.clientRenderedBoundaries.push(V))),l.allPendingTasks--,l.allPendingTasks===0){var ae=l.onAllReady;ae()}}}finally{}}}_.splice(0,w),n.destination!==null&&Pf(n,n.destination)}catch(de){Cc(n,de),vh(n,de)}finally{oh=g,Pp.current=u,u===Ey&&yh(a)}}}function ju(n,a,u){switch(u.parentFlushed=!0,u.status){case 0:var g=u.id=n.nextSegmentId++;return n=n.responseState,He(a,'<template id="'),He(a,n.placeholderPrefix),n=g.toString(16),He(a,n),He(a,'"></template>');case 1:u.status=2;var _=!0;g=u.chunks;var w=0;u=u.children;for(var T=0;T<u.length;T++){for(_=u[T];w<_.index;w++)He(a,g[w]);_=Dh(n,a,_)}for(;w<g.length-1;w++)He(a,g[w]);return w<g.length&&(_=He(a,g[w])),_;default:throw Error(Pt(390))}}function Dh(n,a,u){var g=u.boundary;if(g===null)return ju(n,a,u);if(g.parentFlushed=!0,g.forceClientRender)return n.responseState.generateStaticMarkup||He(a,"<!--$!-->"),ju(n,a,u),n=n.responseState.generateStaticMarkup?!0:He(a,"<!--/$-->"),n;if(0<g.pendingTasks){g.rootSegmentID=n.nextSegmentId++,0<g.completedSegments.length&&n.partialBoundaries.push(g);var _=n.responseState,w=_.nextSuspenseID++;return _=_.boundaryPrefix+w.toString(16),g=g.id=_,gy(a,n.responseState,g),ju(n,a,u),He(a,"<!--/$-->")}if(g.byteSize>n.progressiveChunkSize)return g.rootSegmentID=n.nextSegmentId++,n.completedBoundaries.push(g),gy(a,n.responseState,g.id),ju(n,a,u),He(a,"<!--/$-->");if(n.responseState.generateStaticMarkup||He(a,"<!--$-->"),u=g.completedSegments,u.length!==1)throw Error(Pt(391));return Dh(n,a,u[0]),n=n.responseState.generateStaticMarkup?!0:He(a,"<!--/$-->"),n}function Ay(n,a,u){return e2(a,n.responseState,u.formatContext,u.id),Dh(n,a,u),t2(a,u.formatContext)}function Py(n,a,u){for(var g=u.completedSegments,_=0;_<g.length;_++)I0(n,a,u,g[_]);if(g.length=0,n=n.responseState,g=u.id,u=u.rootSegmentID,He(a,n.startInlineScript),n.sentCompleteBoundaryFunction?He(a,'$RC("'):(n.sentCompleteBoundaryFunction=!0,He(a,'function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),g===null)throw Error(Pt(395));return u=u.toString(16),He(a,g),He(a,'","'),He(a,n.segmentPrefix),He(a,u),He(a,'")<\/script>')}function I0(n,a,u,g){if(g.status===2)return!0;var _=g.id;if(_===-1){if((g.id=u.rootSegmentID)===-1)throw Error(Pt(392));return Ay(n,a,g)}return Ay(n,a,g),n=n.responseState,He(a,n.startInlineScript),n.sentCompleteSegmentFunction?He(a,'$RS("'):(n.sentCompleteSegmentFunction=!0,He(a,'function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),He(a,n.segmentPrefix),_=_.toString(16),He(a,_),He(a,'","'),He(a,n.placeholderPrefix),He(a,_),He(a,'")<\/script>')}function Pf(n,a){try{var u=n.completedRootSegment;if(u!==null&&n.pendingRootTasks===0){Dh(n,a,u),n.completedRootSegment=null;var g=n.responseState.bootstrapChunks;for(u=0;u<g.length-1;u++)He(a,g[u]);u<g.length&&He(a,g[u])}var _=n.clientRenderedBoundaries,w;for(w=0;w<_.length;w++){g=a;var T=n.responseState,l=_[w].id;if(He(g,T.startInlineScript),T.sentClientRenderFunction?He(g,'$RX("'):(T.sentClientRenderFunction=!0,He(g,'function $RX(a){if(a=document.getElementById(a))a=a.previousSibling,a.data="$!",a._reactRetry&&a._reactRetry()};$RX("')),l===null)throw Error(Pt(395));if(He(g,l),!He(g,'")<\/script>')){n.destination=null,w++,_.splice(0,w);return}}_.splice(0,w);var O=n.completedBoundaries;for(w=0;w<O.length;w++)if(!Py(n,a,O[w])){n.destination=null,w++,O.splice(0,w);return}O.splice(0,w);var D=n.partialBoundaries;for(w=0;w<D.length;w++){var V=D[w];e:{_=n,T=a;var K=V.completedSegments;for(l=0;l<K.length;l++)if(!I0(_,T,V,K[l])){l++,K.splice(0,l);var ae=!1;break e}K.splice(0,l),ae=!0}if(!ae){n.destination=null,w++,D.splice(0,w);return}}D.splice(0,w);var de=n.completedBoundaries;for(w=0;w<de.length;w++)if(!Py(n,a,de[w])){n.destination=null,w++,de.splice(0,w);return}de.splice(0,w)}finally{n.allPendingTasks===0&&n.pingedTasks.length===0&&n.clientRenderedBoundaries.length===0&&n.completedBoundaries.length===0&&a.push(null)}}function x2(n){try{var a=n.abortableTasks;a.forEach(T0,n),a.clear(),n.destination!==null&&Pf(n,n.destination)}catch(u){Cc(n,u),vh(n,u)}}function v2(){}function A0(n,a,u){var g=!1,_=null,w="",T={push:function(O){return O!==null&&(w+=O),!0},destroy:function(O){g=!0,_=O}},l=!1;if(n=y2(n,r2(u,a?a.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,v2,void 0,function(){l=!0},void 0,void 0),k0(n),x2(n),n.status===1)n.status=2,T.destroy(n.fatalError);else if(n.status!==2&&n.destination===null){n.destination=T;try{Pf(n,T)}catch(O){Cc(n,O),vh(n,O)}}if(g)throw _;if(!l)throw Error(Pt(426));return w}dl.renderToNodeStream=function(){throw Error(Pt(207))};dl.renderToStaticMarkup=function(n,a){return A0(n,a,!0)};dl.renderToStaticNodeStream=function(){throw Error(Pt(208))};dl.renderToString=function(n,a){return A0(n,a,!1)};dl.version="18.1.0";var Mf={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P0=Z.exports;function Rt(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,u=1;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yi=null,_i=0;function _t(n,a){if(a.length!==0)if(512<a.length)0<_i&&(n.enqueue(new Uint8Array(yi.buffer,0,_i)),yi=new Uint8Array(512),_i=0),n.enqueue(a);else{var u=yi.length-_i;u<a.length&&(u===0?n.enqueue(yi):(yi.set(a.subarray(0,u),_i),n.enqueue(yi),a=a.subarray(u)),yi=new Uint8Array(512),_i=0),yi.set(a,_i),_i+=a.length}}function vr(n,a){return _t(n,a),!0}function My(n){yi&&0<_i&&(n.enqueue(new Uint8Array(yi.buffer,0,_i)),yi=null,_i=0)}var M0=new TextEncoder;function Nt(n){return M0.encode(n)}function it(n){return M0.encode(n)}function z0(n,a){typeof n.error=="function"?n.error(a):n.close()}var xi=Object.prototype.hasOwnProperty,b2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zy={},Dy={};function D0(n){return xi.call(Dy,n)?!0:xi.call(zy,n)?!1:b2.test(n)?Dy[n]=!0:(zy[n]=!0,!1)}function Kn(n,a,u,g,_,w,T){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=n,this.type=a,this.sanitizeURL=w,this.removeEmptyString=T}var mn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){mn[n]=new Kn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];mn[a]=new Kn(a,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){mn[n]=new Kn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){mn[n]=new Kn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){mn[n]=new Kn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){mn[n]=new Kn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){mn[n]=new Kn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){mn[n]=new Kn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){mn[n]=new Kn(n,5,!1,n.toLowerCase(),null,!1,!1)});var zf=/[\-:]([a-z])/g;function Df(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(zf,Df);mn[a]=new Kn(a,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(zf,Df);mn[a]=new Kn(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(zf,Df);mn[a]=new Kn(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){mn[n]=new Kn(n,1,!1,n.toLowerCase(),null,!1,!1)});mn.xlinkHref=new Kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){mn[n]=new Kn(n,1,!1,n.toLowerCase(),null,!0,!0)});var ah={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w2=["Webkit","ms","Moz","O"];Object.keys(ah).forEach(function(n){w2.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),ah[a]=ah[n]})});var S2=/["'&<>]/;function pn(n){if(typeof n=="boolean"||typeof n=="number")return""+n;n=""+n;var a=S2.exec(n);if(a){var u="",g,_=0;for(g=a.index;g<n.length;g++){switch(n.charCodeAt(g)){case 34:a="&quot;";break;case 38:a="&amp;";break;case 39:a="&#x27;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}_!==g&&(u+=n.substring(_,g)),_=g+1,u+=a}n=_!==g?u+n.substring(_,g):u}return n}var E2=/([A-Z])/g,T2=/^ms-/,cf=Array.isArray,C2=it("<script>"),k2=it("<\/script>"),I2=it('<script src="'),A2=it('<script type="module" src="'),Ry=it('" async=""><\/script>'),P2=/(<\/|<)(s)(cript)/gi;function M2(n,a,u,g){return""+a+(u==="s"?"\\u0073":"\\u0053")+g}function z2(n,a,u,g,_){n=n===void 0?"":n,a=a===void 0?C2:it('<script nonce="'+pn(a)+'">');var w=[];if(u!==void 0&&w.push(a,Nt((""+u).replace(P2,M2)),k2),g!==void 0)for(u=0;u<g.length;u++)w.push(I2,Nt(pn(g[u])),Ry);if(_!==void 0)for(g=0;g<_.length;g++)w.push(A2,Nt(pn(_[g])),Ry);return{bootstrapChunks:w,startInlineScript:a,placeholderPrefix:it(n+"P:"),segmentPrefix:it(n+"S:"),boundaryPrefix:n+"B:",idPrefix:n,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function po(n,a){return{insertionMode:n,selectedValue:a}}function D2(n){return po(n==="http://www.w3.org/2000/svg"?2:n==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function R2(n,a,u){switch(a){case"select":return po(1,u.value!=null?u.value:u.defaultValue);case"svg":return po(2,null);case"math":return po(3,null);case"foreignObject":return po(1,null);case"table":return po(4,null);case"thead":case"tbody":case"tfoot":return po(5,null);case"colgroup":return po(7,null);case"tr":return po(6,null)}return 4<=n.insertionMode||n.insertionMode===0?po(1,null):n}var Ly=it("<!-- -->"),Fy=new Map,L2=it(' style="'),By=it(":"),F2=it(";");function R0(n,a,u){if(typeof u!="object")throw Error(Rt(62));a=!0;for(var g in u)if(xi.call(u,g)){var _=u[g];if(_!=null&&typeof _!="boolean"&&_!==""){if(g.indexOf("--")===0){var w=Nt(pn(g));_=Nt(pn((""+_).trim()))}else{w=g;var T=Fy.get(w);T!==void 0||(T=it(pn(w.replace(E2,"-$1").toLowerCase().replace(T2,"-ms-"))),Fy.set(w,T)),w=T,_=typeof _=="number"?_===0||xi.call(ah,g)?Nt(""+_):Nt(_+"px"):Nt(pn((""+_).trim()))}a?(a=!1,n.push(L2,w,By,_)):n.push(F2,w,By,_)}}a||n.push(es)}var sa=it(" "),al=it('="'),es=it('"'),Oy=it('=""');function Oi(n,a,u,g){switch(u){case"style":R0(n,a,g);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N"){if(a=mn.hasOwnProperty(u)?mn[u]:null,a!==null){switch(typeof g){case"function":case"symbol":return;case"boolean":if(!a.acceptsBooleans)return}switch(u=Nt(a.attributeName),a.type){case 3:g&&n.push(sa,u,Oy);break;case 4:g===!0?n.push(sa,u,Oy):g!==!1&&n.push(sa,u,al,Nt(pn(g)),es);break;case 5:isNaN(g)||n.push(sa,u,al,Nt(pn(g)),es);break;case 6:!isNaN(g)&&1<=g&&n.push(sa,u,al,Nt(pn(g)),es);break;default:a.sanitizeURL&&(g=""+g),n.push(sa,u,al,Nt(pn(g)),es)}}else if(D0(u)){switch(typeof g){case"function":case"symbol":return;case"boolean":if(a=u.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-")return}n.push(sa,Nt(u),al,Nt(pn(g)),es)}}}var Ja=it(">"),$y=it("/>");function sh(n,a,u){if(a!=null){if(u!=null)throw Error(Rt(60));if(typeof a!="object"||!("__html"in a))throw Error(Rt(61));a=a.__html,a!=null&&n.push(Nt(""+a))}}function B2(n){var a="";return P0.Children.forEach(n,function(u){u!=null&&(a+=u)}),a}var Mp=it(' selected=""');function zp(n,a,u,g){n.push(Oo(u));var _=u=null,w;for(w in a)if(xi.call(a,w)){var T=a[w];if(T!=null)switch(w){case"children":u=T;break;case"dangerouslySetInnerHTML":_=T;break;default:Oi(n,g,w,T)}}return n.push(Ja),sh(n,_,u),typeof u=="string"?(n.push(Nt(pn(u))),null):u}var Dp=it(`
`),O2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Uy=new Map;function Oo(n){var a=Uy.get(n);if(a===void 0){if(!O2.test(n))throw Error(Rt(65,n));a=it("<"+n),Uy.set(n,a)}return a}var $2=it("<!DOCTYPE html>");function U2(n,a,u,g,_){switch(a){case"select":n.push(Oo("select"));var w=null,T=null;for(V in u)if(xi.call(u,V)){var l=u[V];if(l!=null)switch(V){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;case"defaultValue":case"value":break;default:Oi(n,g,V,l)}}return n.push(Ja),sh(n,T,w),w;case"option":T=_.selectedValue,n.push(Oo("option"));var O=l=null,D=null,V=null;for(w in u)if(xi.call(u,w)&&(a=u[w],a!=null))switch(w){case"children":l=a;break;case"selected":D=a;break;case"dangerouslySetInnerHTML":V=a;break;case"value":O=a;default:Oi(n,g,w,a)}if(T!=null)if(u=O!==null?""+O:B2(l),cf(T)){for(g=0;g<T.length;g++)if(""+T[g]===u){n.push(Mp);break}}else""+T===u&&n.push(Mp);else D&&n.push(Mp);return n.push(Ja),sh(n,V,l),l;case"textarea":n.push(Oo("textarea")),V=T=w=null;for(l in u)if(xi.call(u,l)&&(O=u[l],O!=null))switch(l){case"children":V=O;break;case"value":w=O;break;case"defaultValue":T=O;break;case"dangerouslySetInnerHTML":throw Error(Rt(91));default:Oi(n,g,l,O)}if(w===null&&T!==null&&(w=T),n.push(Ja),V!=null){if(w!=null)throw Error(Rt(92));if(cf(V)&&1<V.length)throw Error(Rt(93));w=""+V}return typeof w=="string"&&w[0]===`
`&&n.push(Dp),w!==null&&n.push(Nt(pn(""+w))),null;case"input":n.push(Oo("input")),O=V=l=w=null;for(T in u)if(xi.call(u,T)&&(D=u[T],D!=null))switch(T){case"children":case"dangerouslySetInnerHTML":throw Error(Rt(399,"input"));case"defaultChecked":O=D;break;case"defaultValue":l=D;break;case"checked":V=D;break;case"value":w=D;break;default:Oi(n,g,T,D)}return V!==null?Oi(n,g,"checked",V):O!==null&&Oi(n,g,"checked",O),w!==null?Oi(n,g,"value",w):l!==null&&Oi(n,g,"value",l),n.push($y),null;case"menuitem":n.push(Oo("menuitem"));for(var K in u)if(xi.call(u,K)&&(w=u[K],w!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(Rt(400));default:Oi(n,g,K,w)}return n.push(Ja),null;case"listing":case"pre":n.push(Oo(a)),T=w=null;for(O in u)if(xi.call(u,O)&&(l=u[O],l!=null))switch(O){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;default:Oi(n,g,O,l)}if(n.push(Ja),T!=null){if(w!=null)throw Error(Rt(60));if(typeof T!="object"||!("__html"in T))throw Error(Rt(61));u=T.__html,u!=null&&(typeof u=="string"&&0<u.length&&u[0]===`
`?n.push(Dp,Nt(u)):n.push(Nt(""+u)))}return typeof w=="string"&&w[0]===`
`&&n.push(Dp),w;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":n.push(Oo(a));for(var ae in u)if(xi.call(u,ae)&&(w=u[ae],w!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(Rt(399,a));default:Oi(n,g,ae,w)}return n.push($y),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return zp(n,u,a,g);case"html":return _.insertionMode===0&&n.push($2),zp(n,u,a,g);default:if(a.indexOf("-")===-1&&typeof u.is!="string")return zp(n,u,a,g);n.push(Oo(a)),T=w=null;for(D in u)if(xi.call(u,D)&&(l=u[D],l!=null))switch(D){case"children":w=l;break;case"dangerouslySetInnerHTML":T=l;break;case"style":R0(n,g,l);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:D0(D)&&typeof l!="function"&&typeof l!="symbol"&&n.push(sa,Nt(D),al,Nt(pn(l)),es)}return n.push(Ja),sh(n,T,w),w}}var N2=it("</"),V2=it(">"),j2=it('<template id="'),q2=it('"></template>'),G2=it("<!--$-->"),Z2=it('<!--$?--><template id="'),W2=it('"></template>'),X2=it("<!--$!-->"),K2=it("<!--/$-->");function Ny(n,a,u){if(_t(n,Z2),u===null)throw Error(Rt(395));return _t(n,u),vr(n,W2)}var H2=it('<div hidden id="'),Y2=it('">'),J2=it("</div>"),Q2=it('<svg aria-hidden="true" style="display:none" id="'),eS=it('">'),tS=it("</svg>"),rS=it('<math aria-hidden="true" style="display:none" id="'),nS=it('">'),iS=it("</math>"),oS=it('<table hidden id="'),aS=it('">'),sS=it("</table>"),lS=it('<table hidden><tbody id="'),cS=it('">'),uS=it("</tbody></table>"),hS=it('<table hidden><tr id="'),dS=it('">'),pS=it("</tr></table>"),fS=it('<table hidden><colgroup id="'),mS=it('">'),gS=it("</colgroup></table>");function yS(n,a,u,g){switch(u.insertionMode){case 0:case 1:return _t(n,H2),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,Y2);case 2:return _t(n,Q2),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,eS);case 3:return _t(n,rS),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,nS);case 4:return _t(n,oS),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,aS);case 5:return _t(n,lS),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,cS);case 6:return _t(n,hS),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,dS);case 7:return _t(n,fS),_t(n,a.segmentPrefix),_t(n,Nt(g.toString(16))),vr(n,mS);default:throw Error(Rt(397))}}function _S(n,a){switch(a.insertionMode){case 0:case 1:return vr(n,J2);case 2:return vr(n,tS);case 3:return vr(n,iS);case 4:return vr(n,sS);case 5:return vr(n,uS);case 6:return vr(n,pS);case 7:return vr(n,gS);default:throw Error(Rt(397))}}var xS=it('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),vS=it('$RS("'),bS=it('","'),wS=it('")<\/script>'),SS=it('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),ES=it('$RC("'),TS=it('","'),CS=it('")<\/script>'),kS=it('function $RX(a){if(a=document.getElementById(a))a=a.previousSibling,a.data="$!",a._reactRetry&&a._reactRetry()};$RX("'),IS=it('$RX("'),AS=it('")<\/script>'),wc=Object.assign,PS=Symbol.for("react.element"),L0=Symbol.for("react.portal"),F0=Symbol.for("react.fragment"),B0=Symbol.for("react.strict_mode"),O0=Symbol.for("react.profiler"),$0=Symbol.for("react.provider"),U0=Symbol.for("react.context"),N0=Symbol.for("react.forward_ref"),V0=Symbol.for("react.suspense"),j0=Symbol.for("react.suspense_list"),q0=Symbol.for("react.memo"),Rf=Symbol.for("react.lazy"),MS=Symbol.for("react.scope"),zS=Symbol.for("react.debug_trace_mode"),DS=Symbol.for("react.legacy_hidden"),RS=Symbol.for("react.default_value"),Vy=Symbol.iterator;function uf(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case F0:return"Fragment";case L0:return"Portal";case O0:return"Profiler";case B0:return"StrictMode";case V0:return"Suspense";case j0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case U0:return(n.displayName||"Context")+".Consumer";case $0:return(n._context.displayName||"Context")+".Provider";case N0:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case q0:return a=n.displayName||null,a!==null?a:uf(n.type)||"Memo";case Rf:a=n._payload,n=n._init;try{return uf(n(a))}catch{}}return null}var G0={};function jy(n,a){if(n=n.contextTypes,!n)return G0;var u={},g;for(g in n)u[g]=a[g];return u}var ns=null;function Rh(n,a){if(n!==a){n.context._currentValue=n.parentValue,n=n.parent;var u=a.parent;if(n===null){if(u!==null)throw Error(Rt(401))}else{if(u===null)throw Error(Rt(401));Rh(n,u)}a.context._currentValue=a.value}}function Z0(n){n.context._currentValue=n.parentValue,n=n.parent,n!==null&&Z0(n)}function W0(n){var a=n.parent;a!==null&&W0(a),n.context._currentValue=n.value}function X0(n,a){if(n.context._currentValue=n.parentValue,n=n.parent,n===null)throw Error(Rt(402));n.depth===a.depth?Rh(n,a):X0(n,a)}function K0(n,a){var u=a.parent;if(u===null)throw Error(Rt(402));n.depth===u.depth?Rh(n,u):K0(n,u),a.context._currentValue=a.value}function wh(n){var a=ns;a!==n&&(a===null?W0(n):n===null?Z0(a):a.depth===n.depth?Rh(a,n):a.depth>n.depth?X0(a,n):K0(a,n),ns=n)}var qy={isMounted:function(){return!1},enqueueSetState:function(n,a){n=n._reactInternals,n.queue!==null&&n.queue.push(a)},enqueueReplaceState:function(n,a){n=n._reactInternals,n.replace=!0,n.queue=[a]},enqueueForceUpdate:function(){}};function Gy(n,a,u,g){var _=n.state!==void 0?n.state:null;n.updater=qy,n.props=u,n.state=_;var w={queue:[],replace:!1};n._reactInternals=w;var T=a.contextType;if(n.context=typeof T=="object"&&T!==null?T._currentValue:g,T=a.getDerivedStateFromProps,typeof T=="function"&&(T=T(u,_),_=T==null?_:wc({},_,T),n.state=_),typeof a.getDerivedStateFromProps!="function"&&typeof n.getSnapshotBeforeUpdate!="function"&&(typeof n.UNSAFE_componentWillMount=="function"||typeof n.componentWillMount=="function"))if(a=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),a!==n.state&&qy.enqueueReplaceState(n,n.state,null),w.queue!==null&&0<w.queue.length)if(a=w.queue,T=w.replace,w.queue=null,w.replace=!1,T&&a.length===1)n.state=a[0];else{for(w=T?a[0]:n.state,_=!0,T=T?1:0;T<a.length;T++){var l=a[T];l=typeof l=="function"?l.call(n,w,u,g):l,l!=null&&(_?(_=!1,w=wc({},w,l)):wc(w,l))}n.state=w}else w.queue=null}var LS={id:1,overflow:""};function hf(n,a,u){var g=n.id;n=n.overflow;var _=32-lh(g)-1;g&=~(1<<_),u+=1;var w=32-lh(a)+_;if(30<w){var T=_-_%5;return w=(g&(1<<T)-1).toString(32),g>>=T,_-=T,{id:1<<32-lh(a)+_|u<<_|g,overflow:w+n}}return{id:1<<w|u<<_|g,overflow:n}}var lh=Math.clz32?Math.clz32:OS,FS=Math.log,BS=Math.LN2;function OS(n){return n>>>=0,n===0?32:31-(FS(n)/BS|0)|0}function $S(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var US=typeof Object.is=="function"?Object.is:$S,No=null,Lf=null,ch=null,fr=null,_c=!1,Sh=!1,kc=0,ua=null,Lh=0;function ts(){if(No===null)throw Error(Rt(321));return No}function Zy(){if(0<Lh)throw Error(Rt(312));return{memoizedState:null,queue:null,next:null}}function Ff(){return fr===null?ch===null?(_c=!1,ch=fr=Zy()):(_c=!0,fr=ch):fr.next===null?(_c=!1,fr=fr.next=Zy()):(_c=!0,fr=fr.next),fr}function Bf(){Lf=No=null,Sh=!1,ch=null,Lh=0,fr=ua=null}function H0(n,a){return typeof a=="function"?a(n):a}function Wy(n,a,u){if(No=ts(),fr=Ff(),_c){var g=fr.queue;if(a=g.dispatch,ua!==null&&(u=ua.get(g),u!==void 0)){ua.delete(g),g=fr.memoizedState;do g=n(g,u.action),u=u.next;while(u!==null);return fr.memoizedState=g,[g,a]}return[fr.memoizedState,a]}return n=n===H0?typeof a=="function"?a():a:u!==void 0?u(a):a,fr.memoizedState=n,n=fr.queue={last:null,dispatch:null},n=n.dispatch=NS.bind(null,No,n),[fr.memoizedState,n]}function Xy(n,a){if(No=ts(),fr=Ff(),a=a===void 0?null:a,fr!==null){var u=fr.memoizedState;if(u!==null&&a!==null){var g=u[1];e:if(g===null)g=!1;else{for(var _=0;_<g.length&&_<a.length;_++)if(!US(a[_],g[_])){g=!1;break e}g=!0}if(g)return u[0]}}return n=n(),fr.memoizedState=[n,a],n}function NS(n,a,u){if(25<=Lh)throw Error(Rt(301));if(n===No)if(Sh=!0,n={action:u,next:null},ua===null&&(ua=new Map),u=ua.get(a),u===void 0)ua.set(a,n);else{for(a=u;a.next!==null;)a=a.next;a.next=n}}function VS(){throw Error(Rt(394))}function qu(){}var Ky={readContext:function(n){return n._currentValue},useContext:function(n){return ts(),n._currentValue},useMemo:Xy,useReducer:Wy,useRef:function(n){No=ts(),fr=Ff();var a=fr.memoizedState;return a===null?(n={current:n},fr.memoizedState=n):a},useState:function(n){return Wy(H0,n)},useInsertionEffect:qu,useLayoutEffect:function(){},useCallback:function(n,a){return Xy(function(){return n},a)},useImperativeHandle:qu,useEffect:qu,useDebugValue:qu,useDeferredValue:function(n){return ts(),n},useTransition:function(){return ts(),[!1,VS]},useId:function(){var n=Lf.treeContext,a=n.overflow;n=n.id,n=(n&~(1<<32-lh(n)-1)).toString(32)+a;var u=uh;if(u===null)throw Error(Rt(404));return a=kc++,n=":"+u.idPrefix+"R"+n,0<a&&(n+="H"+a.toString(32)),n+":"},useMutableSource:function(n,a){return ts(),a(n._source)},useSyncExternalStore:function(n,a,u){if(u===void 0)throw Error(Rt(407));return u()}},uh=null,Rp=P0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function jS(n){console.error(n)}function xc(){}function qS(n,a,u,g,_,w,T,l,O){var D=[],V=new Set;return a={destination:null,responseState:a,progressiveChunkSize:g===void 0?12800:g,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:V,pingedTasks:D,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:_===void 0?jS:_,onAllReady:w===void 0?xc:w,onShellReady:T===void 0?xc:T,onShellError:l===void 0?xc:l,onFatalError:O===void 0?xc:O},u=Eh(a,0,null,u),u.parentFlushed=!0,n=Of(a,n,null,u,V,G0,null,LS),D.push(n),a}function Of(n,a,u,g,_,w,T,l){n.allPendingTasks++,u===null?n.pendingRootTasks++:u.pendingTasks++;var O={node:a,ping:function(){var D=n.pingedTasks;D.push(O),D.length===1&&Q0(n)},blockedBoundary:u,blockedSegment:g,abortSet:_,legacyContext:w,context:T,treeContext:l};return _.add(O),O}function Eh(n,a,u,g){return{status:0,id:-1,index:a,parentFlushed:!1,chunks:[],children:[],formatContext:g,boundary:u}}function Ic(n,a){n=n.onError,n(a)}function Th(n,a){var u=n.onShellError;u(a),u=n.onFatalError,u(a),n.destination!==null?(n.status=2,z0(n.destination,a)):(n.status=1,n.fatalError=a)}function Hy(n,a,u,g,_){for(No={},Lf=a,kc=0,n=u(g,_);Sh;)Sh=!1,kc=0,Lh+=1,fr=null,n=u(g,_);return Bf(),n}function Yy(n,a,u,g){var _=u.render(),w=g.childContextTypes;if(w!=null){var T=a.legacyContext;if(typeof u.getChildContext!="function")g=T;else{u=u.getChildContext();for(var l in u)if(!(l in w))throw Error(Rt(108,uf(g)||"Unknown",l));g=wc({},T,u)}a.legacyContext=g,vi(n,a,_),a.legacyContext=T}else vi(n,a,_)}function Jy(n,a){if(n&&n.defaultProps){a=wc({},a),n=n.defaultProps;for(var u in n)a[u]===void 0&&(a[u]=n[u]);return a}return a}function df(n,a,u,g,_){if(typeof u=="function")if(u.prototype&&u.prototype.isReactComponent){_=jy(u,a.legacyContext);var w=u.contextType;w=new u(g,typeof w=="object"&&w!==null?w._currentValue:_),Gy(w,u,g,_),Yy(n,a,w,u)}else{w=jy(u,a.legacyContext),_=Hy(n,a,u,g,w);var T=kc!==0;if(typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0)Gy(_,u,g,w),Yy(n,a,_,u);else if(T){g=a.treeContext,a.treeContext=hf(g,1,0);try{vi(n,a,_)}finally{a.treeContext=g}}else vi(n,a,_)}else if(typeof u=="string")switch(_=a.blockedSegment,w=U2(_.chunks,u,g,n.responseState,_.formatContext),T=_.formatContext,_.formatContext=R2(T,u,g),pf(n,a,w),_.formatContext=T,u){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:_.chunks.push(N2,Nt(u),V2)}else{switch(u){case DS:case zS:case B0:case O0:case F0:vi(n,a,g.children);return;case j0:vi(n,a,g.children);return;case MS:throw Error(Rt(343));case V0:e:{u=a.blockedBoundary,_=a.blockedSegment,w=g.fallback,g=g.children,T=new Set;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:T},O=Eh(n,_.chunks.length,l,_.formatContext);_.children.push(O);var D=Eh(n,0,null,_.formatContext);D.parentFlushed=!0,a.blockedBoundary=l,a.blockedSegment=D;try{if(pf(n,a,g),D.status=1,Ch(l,D),l.pendingTasks===0)break e}catch(V){D.status=4,Ic(n,V),l.forceClientRender=!0}finally{a.blockedBoundary=u,a.blockedSegment=_}a=Of(n,w,u,O,T,a.legacyContext,a.context,a.treeContext),n.pingedTasks.push(a)}return}if(typeof u=="object"&&u!==null)switch(u.$$typeof){case N0:if(g=Hy(n,a,u.render,g,_),kc!==0){u=a.treeContext,a.treeContext=hf(u,1,0);try{vi(n,a,g)}finally{a.treeContext=u}}else vi(n,a,g);return;case q0:u=u.type,g=Jy(u,g),df(n,a,u,g,_);return;case $0:if(_=g.children,u=u._context,g=g.value,w=u._currentValue,u._currentValue=g,T=ns,ns=g={parent:T,depth:T===null?0:T.depth+1,context:u,parentValue:w,value:g},a.context=g,vi(n,a,_),n=ns,n===null)throw Error(Rt(403));g=n.parentValue,n.context._currentValue=g===RS?n.context._defaultValue:g,n=ns=n.parent,a.context=n;return;case U0:g=g.children,g=g(u._currentValue),vi(n,a,g);return;case Rf:_=u._init,u=_(u._payload),g=Jy(u,g),df(n,a,u,g,void 0);return}throw Error(Rt(130,u==null?u:typeof u,""))}}function vi(n,a,u){if(a.node=u,typeof u=="object"&&u!==null){switch(u.$$typeof){case PS:df(n,a,u.type,u.props,u.ref);return;case L0:throw Error(Rt(257));case Rf:var g=u._init;u=g(u._payload),vi(n,a,u);return}if(cf(u)){Qy(n,a,u);return}if(u===null||typeof u!="object"?g=null:(g=Vy&&u[Vy]||u["@@iterator"],g=typeof g=="function"?g:null),g&&(g=g.call(u))){if(u=g.next(),!u.done){var _=[];do _.push(u.value),u=g.next();while(!u.done);Qy(n,a,_)}return}throw a=Object.prototype.toString.call(u),Error(Rt(31,a==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":a))}typeof u=="string"?u!==""&&a.blockedSegment.chunks.push(Nt(pn(u)),Ly):typeof u=="number"&&(n=""+u,n!==""&&a.blockedSegment.chunks.push(Nt(pn(n)),Ly))}function Qy(n,a,u){for(var g=u.length,_=0;_<g;_++){var w=a.treeContext;a.treeContext=hf(w,g,_);try{pf(n,a,u[_])}finally{a.treeContext=w}}}function pf(n,a,u){var g=a.blockedSegment.formatContext,_=a.legacyContext,w=a.context;try{return vi(n,a,u)}catch(O){if(Bf(),typeof O=="object"&&O!==null&&typeof O.then=="function"){u=O;var T=a.blockedSegment,l=Eh(n,T.chunks.length,null,T.formatContext);T.children.push(l),n=Of(n,a.node,a.blockedBoundary,l,a.abortSet,a.legacyContext,a.context,a.treeContext).ping,u.then(n,n),a.blockedSegment.formatContext=g,a.legacyContext=_,a.context=w,wh(w)}else throw a.blockedSegment.formatContext=g,a.legacyContext=_,a.context=w,wh(w),O}}function GS(n){var a=n.blockedBoundary;n=n.blockedSegment,n.status=3,J0(this,a,n)}function Y0(n){var a=n.blockedBoundary;n.blockedSegment.status=3,a===null?(this.allPendingTasks--,this.status!==2&&(this.status=2,this.destination!==null&&this.destination.close())):(a.pendingTasks--,a.forceClientRender||(a.forceClientRender=!0,a.parentFlushed&&this.clientRenderedBoundaries.push(a)),a.fallbackAbortableTasks.forEach(Y0,this),a.fallbackAbortableTasks.clear(),this.allPendingTasks--,this.allPendingTasks===0&&(n=this.onAllReady,n()))}function Ch(n,a){if(a.chunks.length===0&&a.children.length===1&&a.children[0].boundary===null){var u=a.children[0];u.id=a.id,u.parentFlushed=!0,u.status===1&&Ch(n,u)}else n.completedSegments.push(a)}function J0(n,a,u){if(a===null){if(u.parentFlushed){if(n.completedRootSegment!==null)throw Error(Rt(389));n.completedRootSegment=u}n.pendingRootTasks--,n.pendingRootTasks===0&&(n.onShellError=xc,a=n.onShellReady,a())}else a.pendingTasks--,a.forceClientRender||(a.pendingTasks===0?(u.parentFlushed&&u.status===1&&Ch(a,u),a.parentFlushed&&n.completedBoundaries.push(a),a.fallbackAbortableTasks.forEach(GS,n),a.fallbackAbortableTasks.clear()):u.parentFlushed&&u.status===1&&(Ch(a,u),a.completedSegments.length===1&&a.parentFlushed&&n.partialBoundaries.push(a)));n.allPendingTasks--,n.allPendingTasks===0&&(n=n.onAllReady,n())}function Q0(n){if(n.status!==2){var a=ns,u=Rp.current;Rp.current=Ky;var g=uh;uh=n.responseState;try{var _=n.pingedTasks,w;for(w=0;w<_.length;w++){var T=_[w],l=n,O=T.blockedSegment;if(O.status===0){wh(T.context);try{vi(l,T,T.node),T.abortSet.delete(T),O.status=1,J0(l,T.blockedBoundary,O)}catch(de){if(Bf(),typeof de=="object"&&de!==null&&typeof de.then=="function"){var D=T.ping;de.then(D,D)}else{T.abortSet.delete(T),O.status=4;var V=T.blockedBoundary,K=de;if(Ic(l,K),V===null?Th(l,K):(V.pendingTasks--,V.forceClientRender||(V.forceClientRender=!0,V.parentFlushed&&l.clientRenderedBoundaries.push(V))),l.allPendingTasks--,l.allPendingTasks===0){var ae=l.onAllReady;ae()}}}finally{}}}_.splice(0,w),n.destination!==null&&$f(n,n.destination)}catch(de){Ic(n,de),Th(n,de)}finally{uh=g,Rp.current=u,u===Ky&&wh(a)}}}function Gu(n,a,u){switch(u.parentFlushed=!0,u.status){case 0:var g=u.id=n.nextSegmentId++;return n=n.responseState,_t(a,j2),_t(a,n.placeholderPrefix),n=Nt(g.toString(16)),_t(a,n),vr(a,q2);case 1:u.status=2;var _=!0;g=u.chunks;var w=0;u=u.children;for(var T=0;T<u.length;T++){for(_=u[T];w<_.index;w++)_t(a,g[w]);_=Fh(n,a,_)}for(;w<g.length-1;w++)_t(a,g[w]);return w<g.length&&(_=vr(a,g[w])),_;default:throw Error(Rt(390))}}function Fh(n,a,u){var g=u.boundary;if(g===null)return Gu(n,a,u);if(g.parentFlushed=!0,g.forceClientRender)vr(a,X2),Gu(n,a,u);else if(0<g.pendingTasks){g.rootSegmentID=n.nextSegmentId++,0<g.completedSegments.length&&n.partialBoundaries.push(g);var _=n.responseState,w=_.nextSuspenseID++;_=it(_.boundaryPrefix+w.toString(16)),g=g.id=_,Ny(a,n.responseState,g),Gu(n,a,u)}else if(g.byteSize>n.progressiveChunkSize)g.rootSegmentID=n.nextSegmentId++,n.completedBoundaries.push(g),Ny(a,n.responseState,g.id),Gu(n,a,u);else{if(vr(a,G2),u=g.completedSegments,u.length!==1)throw Error(Rt(391));Fh(n,a,u[0])}return vr(a,K2)}function e_(n,a,u){return yS(a,n.responseState,u.formatContext,u.id),Fh(n,a,u),_S(a,u.formatContext)}function t_(n,a,u){for(var g=u.completedSegments,_=0;_<g.length;_++)ex(n,a,u,g[_]);if(g.length=0,n=n.responseState,g=u.id,u=u.rootSegmentID,_t(a,n.startInlineScript),n.sentCompleteBoundaryFunction?_t(a,ES):(n.sentCompleteBoundaryFunction=!0,_t(a,SS)),g===null)throw Error(Rt(395));return u=Nt(u.toString(16)),_t(a,g),_t(a,TS),_t(a,n.segmentPrefix),_t(a,u),vr(a,CS)}function ex(n,a,u,g){if(g.status===2)return!0;var _=g.id;if(_===-1){if((g.id=u.rootSegmentID)===-1)throw Error(Rt(392));return e_(n,a,g)}return e_(n,a,g),n=n.responseState,_t(a,n.startInlineScript),n.sentCompleteSegmentFunction?_t(a,vS):(n.sentCompleteSegmentFunction=!0,_t(a,xS)),_t(a,n.segmentPrefix),_=Nt(_.toString(16)),_t(a,_),_t(a,bS),_t(a,n.placeholderPrefix),_t(a,_),vr(a,wS)}function $f(n,a){yi=new Uint8Array(512),_i=0;try{var u=n.completedRootSegment;if(u!==null&&n.pendingRootTasks===0){Fh(n,a,u),n.completedRootSegment=null;var g=n.responseState.bootstrapChunks;for(u=0;u<g.length-1;u++)_t(a,g[u]);u<g.length&&vr(a,g[u])}var _=n.clientRenderedBoundaries,w;for(w=0;w<_.length;w++){g=a;var T=n.responseState,l=_[w].id;if(_t(g,T.startInlineScript),T.sentClientRenderFunction?_t(g,IS):(T.sentClientRenderFunction=!0,_t(g,kS)),l===null)throw Error(Rt(395));_t(g,l),vr(g,AS)}_.splice(0,w);var O=n.completedBoundaries;for(w=0;w<O.length;w++)t_(n,a,O[w]);O.splice(0,w),My(a),yi=new Uint8Array(512),_i=0;var D=n.partialBoundaries;for(w=0;w<D.length;w++){var V=D[w];e:{_=n,T=a;var K=V.completedSegments;for(l=0;l<K.length;l++)if(!ex(_,T,V,K[l])){l++,K.splice(0,l);var ae=!1;break e}K.splice(0,l),ae=!0}if(!ae){n.destination=null,w++,D.splice(0,w);return}}D.splice(0,w);var de=n.completedBoundaries;for(w=0;w<de.length;w++)t_(n,a,de[w]);de.splice(0,w)}finally{My(a),n.allPendingTasks===0&&n.pingedTasks.length===0&&n.clientRenderedBoundaries.length===0&&n.completedBoundaries.length===0&&a.close()}}function r_(n){try{var a=n.abortableTasks;a.forEach(Y0,n),a.clear(),n.destination!==null&&$f(n,n.destination)}catch(u){Ic(n,u),Th(n,u)}}Mf.renderToReadableStream=function(n,a){return new Promise(function(u,g){var _,w,T=new Promise(function(V,K){w=V,_=K}),l=qS(n,z2(a?a.identifierPrefix:void 0,a?a.nonce:void 0,a?a.bootstrapScriptContent:void 0,a?a.bootstrapScripts:void 0,a?a.bootstrapModules:void 0),D2(a?a.namespaceURI:void 0),a?a.progressiveChunkSize:void 0,a?a.onError:void 0,w,function(){var V=new ReadableStream({type:"bytes",pull:function(K){if(l.status===1)l.status=2,z0(K,l.fatalError);else if(l.status!==2&&l.destination===null){l.destination=K;try{$f(l,K)}catch(ae){Ic(l,ae),Th(l,ae)}}},cancel:function(){r_(l)}});V.allReady=T,u(V)},function(V){T.catch(function(){}),g(V)},_);if(a&&a.signal){var O=a.signal,D=function(){r_(l),O.removeEventListener("abort",D)};O.addEventListener("abort",D)}Q0(l)})};Mf.version="18.1.0";var pl,tx;pl=dl,tx=Mf;pl.version;var ZS=pl.renderToString;pl.renderToStaticMarkup;pl.renderToNodeStream;pl.renderToStaticNodeStream;tx.renderToReadableStream;const ff="black",WS=0,XS=0,KS=0,rx="https://api.protomaps.com/tiles/v3/{z}/{x}/{y}.mvt?key=1003762824b9687f",nx='Basemap <a href="https://github.com/protomaps/basemaps">Protomaps</a> \xA9 <a href="https://openstreetmap.org">OpenStreetMap</a>';mc.setRTLTextPlugin("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js",()=>{},!0);const HS=Hr("div",{height:"calc(100vh - $4 - $4)"}),YS=Hr("div",{color:"black",maxHeight:"400px",overflowY:"scroll"}),JS=Hr("div",{marginBottom:"0.5em","&:not(:last-of-type)":{borderBottom:"1px solid black"}}),QS=Hr("div",{position:"absolute",top:"10px",right:"10px",width:40,height:40,backgroundColor:"#444",cursor:"pointer",zIndex:9999}),eE=Hr("div",{position:"absolute",backgroundColor:"#444",top:"50px",right:"10px",padding:"$1",zIndex:9999}),kh=Hr("label",{display:"flex",gap:6,cursor:"pointer"}),tE=Hr("ul",{listStyleType:"none"}),rE=n=>nt(YS,{children:n.features.map((a,u)=>wt(JS,{children:[wt("span",{children:[nt("strong",{children:a.layer["source-layer"]}),wt("span",{style:{fontSize:"0.8em"},children:[" (",a.geometry.type,")"]})]}),nt("table",{children:Object.entries(a.properties).map(([g,_],w)=>wt("tr",{children:[nt("td",{children:g}),nt("td",{children:typeof _=="boolean"?JSON.stringify(_):_})]},w))})]},u))}),nE=n=>{const{layers:a,onChange:u}=n,g=Z.exports.useRef(null),_=a.filter(O=>O.visible).length,w=_>0&&_!==a.length;if(Z.exports.useEffect(()=>{g.current&&(g.current.indeterminate=w)},[w]),!n.layers.length)return wt(mh,{children:[nt("h4",{children:"Layers"}),nt("span",{children:"No vector layers found"})]});const T=()=>{const O=_!==a.length,D=a.map(V=>({...V,visible:O}));u(D)},l=O=>{const D=O.target.getAttribute("data-layer-id"),V=a.map(K=>K.id===D?{...K,visible:!K.visible}:K);u(V)};return wt(mh,{children:[nt("h4",{children:"Layers"}),wt(kh,{children:[nt("input",{ref:g,type:"checkbox",checked:_===a.length,onChange:T}),nt("em",{children:"All layers"})]}),nt(tE,{children:n.layers.map(({id:O,visible:D},V)=>nt("li",{children:wt(kh,{style:{paddingLeft:8},children:[nt("input",{type:"checkbox",checked:D,onChange:l,"data-layer-id":O}),nt("span",{style:{width:".8rem",height:".8rem",backgroundColor:Ju[V%12]}}),O]})},O))})]})},iE=async n=>{const a=await n.getHeader(),u=await n.getMetadata();let g=[];return u.type!=="baselayer"&&(g=o0("basemap",ff)),g.push({id:"raster",type:"raster",source:"source"}),{version:8,sources:{source:{type:"raster",tiles:[`pmtiles://${n.source.getKey()}/{z}/{x}/{y}`],minzoom:a.minZoom,maxzoom:a.maxZoom},basemap:{type:"vector",tiles:[rx],maxzoom:15,attribution:nx}},glyphs:"https://cdn.protomaps.com/fonts/pbf/{fontstack}/{range}.pbf",sprite:`https://protomaps.github.io/basemaps-assets/sprites/v3/${ff}`,layers:g}},oE=async n=>{const a=await n.getHeader(),u=await n.getMetadata();let g=[],_=.35;u.type!=="baselayer"&&(g=o0("basemap",ff),_=.9),u.tilestats;const w=u.vector_layers;if(w)for(const[l,O]of w.entries())g.push({id:`${O.id}_fill`,type:"fill",source:"source","source-layer":O.id,paint:{"fill-color":Ju[l%12],"fill-opacity":["case",["boolean",["feature-state","hover"],!1],_,_-.15],"fill-outline-color":["case",["boolean",["feature-state","hover"],!1],"hsl(0,100%,90%)","rgba(0,0,0,0.2)"]},filter:["==",["geometry-type"],"Polygon"]}),g.push({id:`${O.id}_stroke`,type:"line",source:"source","source-layer":O.id,paint:{"line-color":Ju[l%12],"line-width":["case",["boolean",["feature-state","hover"],!1],2,.5]},filter:["==",["geometry-type"],"LineString"]}),g.push({id:`${O.id}_point`,type:"circle",source:"source","source-layer":O.id,paint:{"circle-color":Ju[l%12],"circle-radius":["case",["boolean",["feature-state","hover"],!1],6,5]},filter:["==",["geometry-type"],"Point"]});const T=[a.minLon,a.minLat,a.maxLon,a.maxLat];return{style:{version:8,sources:{source:{type:"vector",tiles:[`pmtiles://${n.source.getKey()}/{z}/{x}/{y}`],minzoom:a.minZoom,maxzoom:a.maxZoom,bounds:T},basemap:{type:"vector",tiles:[rx],maxzoom:15,bounds:T,attribution:nx}},glyphs:"https://cdn.protomaps.com/fonts/pbf/{fontstack}/{range}.pbf",layers:g},layersVisibility:w.map(l=>({id:l.id,visible:!0}))}};function aE(n){const a=Z.exports.useRef(null),[u,g]=Z.exports.useState(!0),[_,w]=Z.exports.useState(!1),[T,l]=Z.exports.useState(!1),[O,D]=Z.exports.useState([]),[V,K]=Z.exports.useState(!1),ae=Z.exports.useRef();ae.current=V;const de=Z.exports.useRef(null),xe=Z.exports.useRef(new Set),oe=Z.exports.useRef(_);Z.exports.useEffect(()=>{oe.current=_},[_]);const _e=()=>{g(!u)},ge=()=>{w(!_),de.current.getCanvas().style.cursor=_?"":"crosshair"},Ie=()=>{l(!T),de.current.showTileBoundaries=!T},De=We=>{D(We);const Me=de.current;for(const{id:Re,visible:Ce}of We){const Ze=Ce?"visible":"none";Me.setLayoutProperty(`${Re}_fill`,"visibility",Ze),Me.setLayoutProperty(`${Re}_stroke`,"visibility",Ze),Me.setLayoutProperty(`${Re}_point`,"visibility",Ze)}};return Z.exports.useEffect(()=>{const We=new Rw;mc.addProtocol("pmtiles",We.tile),We.add(n.file);const Me=new mc.Map({container:a.current,hash:"map",zoom:WS,center:[XS,KS],style:{version:8,sources:{},layers:[]}});Me.addControl(new mc.NavigationControl({}),"bottom-left"),Me.on("load",Me.resize);const Re=new mc.Popup({closeButton:!1,closeOnClick:!1,maxWidth:"none"});return de.current=Me,Me.on("mousemove",Ce=>{if(ae.current)return;const Ze=xe.current;for(const Xt of Ze)Me.setFeatureState(Xt,{hover:!1}),Ze.delete(Xt);if(!oe.current){Re.remove();return}const{x:yt,y:$e}=Ce.point,Ot=2;let Mt=Me.queryRenderedFeatures([[yt-Ot,$e-Ot],[yt+Ot,$e+Ot]]);Mt=Mt.filter(Xt=>Xt.source==="source");for(const Xt of Mt)Me.setFeatureState(Xt,{hover:!0}),Ze.add(Xt);const or=ZS(nt(rE,{features:Mt}));Mt.length?(Re.setHTML(or),Re.setLngLat(Ce.lngLat),Re.addTo(Me)):Re.remove()}),Me.on("click",Ce=>{K(Ze=>!Ze)}),()=>{Me.remove()}},[]),Z.exports.useEffect(()=>{(async()=>{if(de.current){const Me=de.current,Re=await n.file.getHeader();if(n.mapHashPassed||Me.fitBounds([[Re.minLon,Re.minLat],[Re.maxLon,Re.maxLat]],{animate:!1}),Re.tileType===Yu.Png||Re.tileType===Yu.Webp||Re.tileType===Yu.Jpeg){const Ce=await iE(n.file);Me.setStyle(Ce)}else{const{style:Ce,layersVisibility:Ze}=await oE(n.file);Me.setStyle(Ce),D(Ze)}}})()},[]),wt(HS,{ref:a,children:[nt("div",{ref:a}),nt(QS,{onClick:_e,children:"menu"}),u?wt(eE,{children:[nt("h4",{children:"Filter"}),nt("h4",{children:"Popup"}),wt(kh,{children:[nt("input",{type:"checkbox",checked:_,onChange:ge}),"show attributes"]}),nt("h4",{children:"Tiles"}),wt(kh,{children:[nt("input",{type:"checkbox",checked:T,onChange:Ie}),"show tile boundaries"]}),nt(nE,{layers:O,onChange:De})]}):null]})}function sE(n){if(n.sheet)return n.sheet;for(var a=0;a<document.styleSheets.length;a++)if(document.styleSheets[a].ownerNode===n)return document.styleSheets[a]}function lE(n){var a=document.createElement("style");return a.setAttribute("data-emotion",n.key),n.nonce!==void 0&&a.setAttribute("nonce",n.nonce),a.appendChild(document.createTextNode("")),a.setAttribute("data-s",""),a}var cE=function(){function n(u){var g=this;this._insertTag=function(_){var w;g.tags.length===0?g.insertionPoint?w=g.insertionPoint.nextSibling:g.prepend?w=g.container.firstChild:w=g.before:w=g.tags[g.tags.length-1].nextSibling,g.container.insertBefore(_,w),g.tags.push(_)},this.isSpeedy=u.speedy===void 0?!0:u.speedy,this.tags=[],this.ctr=0,this.nonce=u.nonce,this.key=u.key,this.container=u.container,this.prepend=u.prepend,this.insertionPoint=u.insertionPoint,this.before=null}var a=n.prototype;return a.hydrate=function(g){g.forEach(this._insertTag)},a.insert=function(g){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(lE(this));var _=this.tags[this.tags.length-1];if(this.isSpeedy){var w=sE(_);try{w.insertRule(g,w.cssRules.length)}catch{}}else _.appendChild(document.createTextNode(g));this.ctr++},a.flush=function(){this.tags.forEach(function(g){return g.parentNode&&g.parentNode.removeChild(g)}),this.tags=[],this.ctr=0},n}(),An="-ms-",Ih="-moz-",Yt="-webkit-",ix="comm",Uf="rule",Nf="decl",uE="@import",ox="@keyframes",hE=Math.abs,Bh=String.fromCharCode,dE=Object.assign;function pE(n,a){return dn(n,0)^45?(((a<<2^dn(n,0))<<2^dn(n,1))<<2^dn(n,2))<<2^dn(n,3):0}function ax(n){return n.trim()}function fE(n,a){return(n=a.exec(n))?n[0]:n}function Qt(n,a,u){return n.replace(a,u)}function mf(n,a){return n.indexOf(a)}function dn(n,a){return n.charCodeAt(a)|0}function Ac(n,a,u){return n.slice(a,u)}function fo(n){return n.length}function Vf(n){return n.length}function Zu(n,a){return a.push(n),n}function mE(n,a){return n.map(a).join("")}var Oh=1,cl=1,sx=0,oi=0,qr=0,fl="";function $h(n,a,u,g,_,w,T){return{value:n,root:a,parent:u,type:g,props:_,children:w,line:Oh,column:cl,length:T,return:""}}function dc(n,a){return dE($h("",null,null,"",null,null,0),n,{length:-n.length},a)}function gE(){return qr}function yE(){return qr=oi>0?dn(fl,--oi):0,cl--,qr===10&&(cl=1,Oh--),qr}function wi(){return qr=oi<sx?dn(fl,oi++):0,cl++,qr===10&&(cl=1,Oh++),qr}function go(){return dn(fl,oi)}function hh(){return oi}function Fc(n,a){return Ac(fl,n,a)}function Pc(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function lx(n){return Oh=cl=1,sx=fo(fl=n),oi=0,[]}function cx(n){return fl="",n}function dh(n){return ax(Fc(oi-1,gf(n===91?n+2:n===40?n+1:n)))}function _E(n){for(;(qr=go())&&qr<33;)wi();return Pc(n)>2||Pc(qr)>3?"":" "}function xE(n,a){for(;--a&&wi()&&!(qr<48||qr>102||qr>57&&qr<65||qr>70&&qr<97););return Fc(n,hh()+(a<6&&go()==32&&wi()==32))}function gf(n){for(;wi();)switch(qr){case n:return oi;case 34:case 39:n!==34&&n!==39&&gf(qr);break;case 40:n===41&&gf(n);break;case 92:wi();break}return oi}function vE(n,a){for(;wi()&&n+qr!==47+10;)if(n+qr===42+42&&go()===47)break;return"/*"+Fc(a,oi-1)+"*"+Bh(n===47?n:wi())}function bE(n){for(;!Pc(go());)wi();return Fc(n,oi)}function wE(n){return cx(ph("",null,null,null,[""],n=lx(n),0,[0],n))}function ph(n,a,u,g,_,w,T,l,O){for(var D=0,V=0,K=T,ae=0,de=0,xe=0,oe=1,_e=1,ge=1,Ie=0,De="",We=_,Me=w,Re=g,Ce=De;_e;)switch(xe=Ie,Ie=wi()){case 40:if(xe!=108&&dn(Ce,K-1)==58){mf(Ce+=Qt(dh(Ie),"&","&\f"),"&\f")!=-1&&(ge=-1);break}case 34:case 39:case 91:Ce+=dh(Ie);break;case 9:case 10:case 13:case 32:Ce+=_E(xe);break;case 92:Ce+=xE(hh()-1,7);continue;case 47:switch(go()){case 42:case 47:Zu(SE(vE(wi(),hh()),a,u),O);break;default:Ce+="/"}break;case 123*oe:l[D++]=fo(Ce)*ge;case 125*oe:case 59:case 0:switch(Ie){case 0:case 125:_e=0;case 59+V:de>0&&fo(Ce)-K&&Zu(de>32?i_(Ce+";",g,u,K-1):i_(Qt(Ce," ","")+";",g,u,K-2),O);break;case 59:Ce+=";";default:if(Zu(Re=n_(Ce,a,u,D,V,_,l,De,We=[],Me=[],K),w),Ie===123)if(V===0)ph(Ce,a,Re,Re,We,w,K,l,Me);else switch(ae===99&&dn(Ce,3)===110?100:ae){case 100:case 109:case 115:ph(n,Re,Re,g&&Zu(n_(n,Re,Re,0,0,_,l,De,_,We=[],K),Me),_,Me,K,l,g?We:Me);break;default:ph(Ce,Re,Re,Re,[""],Me,0,l,Me)}}D=V=de=0,oe=ge=1,De=Ce="",K=T;break;case 58:K=1+fo(Ce),de=xe;default:if(oe<1){if(Ie==123)--oe;else if(Ie==125&&oe++==0&&yE()==125)continue}switch(Ce+=Bh(Ie),Ie*oe){case 38:ge=V>0?1:(Ce+="\f",-1);break;case 44:l[D++]=(fo(Ce)-1)*ge,ge=1;break;case 64:go()===45&&(Ce+=dh(wi())),ae=go(),V=K=fo(De=Ce+=bE(hh())),Ie++;break;case 45:xe===45&&fo(Ce)==2&&(oe=0)}}return w}function n_(n,a,u,g,_,w,T,l,O,D,V){for(var K=_-1,ae=_===0?w:[""],de=Vf(ae),xe=0,oe=0,_e=0;xe<g;++xe)for(var ge=0,Ie=Ac(n,K+1,K=hE(oe=T[xe])),De=n;ge<de;++ge)(De=ax(oe>0?ae[ge]+" "+Ie:Qt(Ie,/&\f/g,ae[ge])))&&(O[_e++]=De);return $h(n,a,u,_===0?Uf:l,O,D,V)}function SE(n,a,u){return $h(n,a,u,ix,Bh(gE()),Ac(n,2,-2),0)}function i_(n,a,u,g){return $h(n,a,u,Nf,Ac(n,0,g),Ac(n,g+1,-1),g)}function ll(n,a){for(var u="",g=Vf(n),_=0;_<g;_++)u+=a(n[_],_,n,a)||"";return u}function EE(n,a,u,g){switch(n.type){case uE:case Nf:return n.return=n.return||n.value;case ix:return"";case ox:return n.return=n.value+"{"+ll(n.children,g)+"}";case Uf:n.value=n.props.join(",")}return fo(u=ll(n.children,g))?n.return=n.value+"{"+u+"}":""}function TE(n){var a=Vf(n);return function(u,g,_,w){for(var T="",l=0;l<a;l++)T+=n[l](u,g,_,w)||"";return T}}function CE(n){return function(a){a.root||(a=a.return)&&n(a)}}function ux(n){var a=Object.create(null);return function(u){return a[u]===void 0&&(a[u]=n(u)),a[u]}}var kE=function(a,u,g){for(var _=0,w=0;_=w,w=go(),_===38&&w===12&&(u[g]=1),!Pc(w);)wi();return Fc(a,oi)},IE=function(a,u){var g=-1,_=44;do switch(Pc(_)){case 0:_===38&&go()===12&&(u[g]=1),a[g]+=kE(oi-1,u,g);break;case 2:a[g]+=dh(_);break;case 4:if(_===44){a[++g]=go()===58?"&\f":"",u[g]=a[g].length;break}default:a[g]+=Bh(_)}while(_=wi());return a},AE=function(a,u){return cx(IE(lx(a),u))},o_=new WeakMap,PE=function(a){if(!(a.type!=="rule"||!a.parent||a.length<1)){for(var u=a.value,g=a.parent,_=a.column===g.column&&a.line===g.line;g.type!=="rule";)if(g=g.parent,!g)return;if(!(a.props.length===1&&u.charCodeAt(0)!==58&&!o_.get(g))&&!_){o_.set(a,!0);for(var w=[],T=AE(u,w),l=g.props,O=0,D=0;O<T.length;O++)for(var V=0;V<l.length;V++,D++)a.props[D]=w[O]?T[O].replace(/&\f/g,l[V]):l[V]+" "+T[O]}}},ME=function(a){if(a.type==="decl"){var u=a.value;u.charCodeAt(0)===108&&u.charCodeAt(2)===98&&(a.return="",a.value="")}};function hx(n,a){switch(pE(n,a)){case 5103:return Yt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yt+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Yt+n+Ih+n+An+n+n;case 6828:case 4268:return Yt+n+An+n+n;case 6165:return Yt+n+An+"flex-"+n+n;case 5187:return Yt+n+Qt(n,/(\w+).+(:[^]+)/,Yt+"box-$1$2"+An+"flex-$1$2")+n;case 5443:return Yt+n+An+"flex-item-"+Qt(n,/flex-|-self/,"")+n;case 4675:return Yt+n+An+"flex-line-pack"+Qt(n,/align-content|flex-|-self/,"")+n;case 5548:return Yt+n+An+Qt(n,"shrink","negative")+n;case 5292:return Yt+n+An+Qt(n,"basis","preferred-size")+n;case 6060:return Yt+"box-"+Qt(n,"-grow","")+Yt+n+An+Qt(n,"grow","positive")+n;case 4554:return Yt+Qt(n,/([^-])(transform)/g,"$1"+Yt+"$2")+n;case 6187:return Qt(Qt(Qt(n,/(zoom-|grab)/,Yt+"$1"),/(image-set)/,Yt+"$1"),n,"")+n;case 5495:case 3959:return Qt(n,/(image-set\([^]*)/,Yt+"$1$`$1");case 4968:return Qt(Qt(n,/(.+:)(flex-)?(.*)/,Yt+"box-pack:$3"+An+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yt+n+n;case 4095:case 3583:case 4068:case 2532:return Qt(n,/(.+)-inline(.+)/,Yt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(fo(n)-1-a>6)switch(dn(n,a+1)){case 109:if(dn(n,a+4)!==45)break;case 102:return Qt(n,/(.+:)(.+)-([^]+)/,"$1"+Yt+"$2-$3$1"+Ih+(dn(n,a+3)==108?"$3":"$2-$3"))+n;case 115:return~mf(n,"stretch")?hx(Qt(n,"stretch","fill-available"),a)+n:n}break;case 4949:if(dn(n,a+1)!==115)break;case 6444:switch(dn(n,fo(n)-3-(~mf(n,"!important")&&10))){case 107:return Qt(n,":",":"+Yt)+n;case 101:return Qt(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yt+(dn(n,14)===45?"inline-":"")+"box$3$1"+Yt+"$2$3$1"+An+"$2box$3")+n}break;case 5936:switch(dn(n,a+11)){case 114:return Yt+n+An+Qt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Yt+n+An+Qt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Yt+n+An+Qt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Yt+n+An+n+n}return n}var zE=function(a,u,g,_){if(a.length>-1&&!a.return)switch(a.type){case Nf:a.return=hx(a.value,a.length);break;case ox:return ll([dc(a,{value:Qt(a.value,"@","@"+Yt)})],_);case Uf:if(a.length)return mE(a.props,function(w){switch(fE(w,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ll([dc(a,{props:[Qt(w,/:(read-\w+)/,":"+Ih+"$1")]})],_);case"::placeholder":return ll([dc(a,{props:[Qt(w,/:(plac\w+)/,":"+Yt+"input-$1")]}),dc(a,{props:[Qt(w,/:(plac\w+)/,":"+Ih+"$1")]}),dc(a,{props:[Qt(w,/:(plac\w+)/,An+"input-$1")]})],_)}return""})}},DE=[zE],RE=function(a){var u=a.key;if(u==="css"){var g=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(g,function(oe){var _e=oe.getAttribute("data-emotion");_e.indexOf(" ")!==-1&&(document.head.appendChild(oe),oe.setAttribute("data-s",""))})}var _=a.stylisPlugins||DE,w={},T,l=[];T=a.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+u+' "]'),function(oe){for(var _e=oe.getAttribute("data-emotion").split(" "),ge=1;ge<_e.length;ge++)w[_e[ge]]=!0;l.push(oe)});var O,D=[PE,ME];{var V,K=[EE,CE(function(oe){V.insert(oe)})],ae=TE(D.concat(_,K)),de=function(_e){return ll(wE(_e),ae)};O=function(_e,ge,Ie,De){V=Ie,de(_e?_e+"{"+ge.styles+"}":ge.styles),De&&(xe.inserted[ge.name]=!0)}}var xe={key:u,sheet:new cE({key:u,container:T,nonce:a.nonce,speedy:a.speedy,prepend:a.prepend,insertionPoint:a.insertionPoint}),nonce:a.nonce,inserted:w,registered:{},insert:O};return xe.sheet.hydrate(l),xe},dx={exports:{}},tr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cn=typeof Symbol=="function"&&Symbol.for,jf=cn?Symbol.for("react.element"):60103,qf=cn?Symbol.for("react.portal"):60106,Uh=cn?Symbol.for("react.fragment"):60107,Nh=cn?Symbol.for("react.strict_mode"):60108,Vh=cn?Symbol.for("react.profiler"):60114,jh=cn?Symbol.for("react.provider"):60109,qh=cn?Symbol.for("react.context"):60110,Gf=cn?Symbol.for("react.async_mode"):60111,Gh=cn?Symbol.for("react.concurrent_mode"):60111,Zh=cn?Symbol.for("react.forward_ref"):60112,Wh=cn?Symbol.for("react.suspense"):60113,LE=cn?Symbol.for("react.suspense_list"):60120,Xh=cn?Symbol.for("react.memo"):60115,Kh=cn?Symbol.for("react.lazy"):60116,FE=cn?Symbol.for("react.block"):60121,BE=cn?Symbol.for("react.fundamental"):60117,OE=cn?Symbol.for("react.responder"):60118,$E=cn?Symbol.for("react.scope"):60119;function Ei(n){if(typeof n=="object"&&n!==null){var a=n.$$typeof;switch(a){case jf:switch(n=n.type,n){case Gf:case Gh:case Uh:case Vh:case Nh:case Wh:return n;default:switch(n=n&&n.$$typeof,n){case qh:case Zh:case Kh:case Xh:case jh:return n;default:return a}}case qf:return a}}}function px(n){return Ei(n)===Gh}tr.AsyncMode=Gf;tr.ConcurrentMode=Gh;tr.ContextConsumer=qh;tr.ContextProvider=jh;tr.Element=jf;tr.ForwardRef=Zh;tr.Fragment=Uh;tr.Lazy=Kh;tr.Memo=Xh;tr.Portal=qf;tr.Profiler=Vh;tr.StrictMode=Nh;tr.Suspense=Wh;tr.isAsyncMode=function(n){return px(n)||Ei(n)===Gf};tr.isConcurrentMode=px;tr.isContextConsumer=function(n){return Ei(n)===qh};tr.isContextProvider=function(n){return Ei(n)===jh};tr.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===jf};tr.isForwardRef=function(n){return Ei(n)===Zh};tr.isFragment=function(n){return Ei(n)===Uh};tr.isLazy=function(n){return Ei(n)===Kh};tr.isMemo=function(n){return Ei(n)===Xh};tr.isPortal=function(n){return Ei(n)===qf};tr.isProfiler=function(n){return Ei(n)===Vh};tr.isStrictMode=function(n){return Ei(n)===Nh};tr.isSuspense=function(n){return Ei(n)===Wh};tr.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===Uh||n===Gh||n===Vh||n===Nh||n===Wh||n===LE||typeof n=="object"&&n!==null&&(n.$$typeof===Kh||n.$$typeof===Xh||n.$$typeof===jh||n.$$typeof===qh||n.$$typeof===Zh||n.$$typeof===BE||n.$$typeof===OE||n.$$typeof===$E||n.$$typeof===FE)};tr.typeOf=Ei;(function(n){n.exports=tr})(dx);var fx=dx.exports,UE={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},NE={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},mx={};mx[fx.ForwardRef]=UE;mx[fx.Memo]=NE;var VE=!0;function gx(n,a,u){var g="";return u.split(" ").forEach(function(_){n[_]!==void 0?a.push(n[_]+";"):g+=_+" "}),g}var Zf=function(a,u,g){var _=a.key+"-"+u.name;(g===!1||VE===!1)&&a.registered[_]===void 0&&(a.registered[_]=u.styles)},Wf=function(a,u,g){Zf(a,u,g);var _=a.key+"-"+u.name;if(a.inserted[u.name]===void 0){var w=u;do a.insert(u===w?"."+_:"",w,a.sheet,!0),w=w.next;while(w!==void 0)}};function jE(n){for(var a=0,u,g=0,_=n.length;_>=4;++g,_-=4)u=n.charCodeAt(g)&255|(n.charCodeAt(++g)&255)<<8|(n.charCodeAt(++g)&255)<<16|(n.charCodeAt(++g)&255)<<24,u=(u&65535)*1540483477+((u>>>16)*59797<<16),u^=u>>>24,a=(u&65535)*1540483477+((u>>>16)*59797<<16)^(a&65535)*1540483477+((a>>>16)*59797<<16);switch(_){case 3:a^=(n.charCodeAt(g+2)&255)<<16;case 2:a^=(n.charCodeAt(g+1)&255)<<8;case 1:a^=n.charCodeAt(g)&255,a=(a&65535)*1540483477+((a>>>16)*59797<<16)}return a^=a>>>13,a=(a&65535)*1540483477+((a>>>16)*59797<<16),((a^a>>>15)>>>0).toString(36)}var qE={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},GE=/[A-Z]|^ms/g,ZE=/_EMO_([^_]+?)_([^]*?)_EMO_/g,yx=function(a){return a.charCodeAt(1)===45},a_=function(a){return a!=null&&typeof a!="boolean"},Lp=ux(function(n){return yx(n)?n:n.replace(GE,"-$&").toLowerCase()}),s_=function(a,u){switch(a){case"animation":case"animationName":if(typeof u=="string")return u.replace(ZE,function(g,_,w){return mo={name:_,styles:w,next:mo},_})}return qE[a]!==1&&!yx(a)&&typeof u=="number"&&u!==0?u+"px":u};function Mc(n,a,u){if(u==null)return"";if(u.__emotion_styles!==void 0)return u;switch(typeof u){case"boolean":return"";case"object":{if(u.anim===1)return mo={name:u.name,styles:u.styles,next:mo},u.name;if(u.styles!==void 0){var g=u.next;if(g!==void 0)for(;g!==void 0;)mo={name:g.name,styles:g.styles,next:mo},g=g.next;var _=u.styles+";";return _}return WE(n,a,u)}case"function":{if(n!==void 0){var w=mo,T=u(n);return mo=w,Mc(n,a,T)}break}}if(a==null)return u;var l=a[u];return l!==void 0?l:u}function WE(n,a,u){var g="";if(Array.isArray(u))for(var _=0;_<u.length;_++)g+=Mc(n,a,u[_])+";";else for(var w in u){var T=u[w];if(typeof T!="object")a!=null&&a[T]!==void 0?g+=w+"{"+a[T]+"}":a_(T)&&(g+=Lp(w)+":"+s_(w,T)+";");else if(Array.isArray(T)&&typeof T[0]=="string"&&(a==null||a[T[0]]===void 0))for(var l=0;l<T.length;l++)a_(T[l])&&(g+=Lp(w)+":"+s_(w,T[l])+";");else{var O=Mc(n,a,T);switch(w){case"animation":case"animationName":{g+=Lp(w)+":"+O+";";break}default:g+=w+"{"+O+"}"}}}return g}var l_=/label:\s*([^\s;\n{]+)\s*(;|$)/g,mo,Xf=function(a,u,g){if(a.length===1&&typeof a[0]=="object"&&a[0]!==null&&a[0].styles!==void 0)return a[0];var _=!0,w="";mo=void 0;var T=a[0];T==null||T.raw===void 0?(_=!1,w+=Mc(g,u,T)):w+=T[0];for(var l=1;l<a.length;l++)w+=Mc(g,u,a[l]),_&&(w+=T[l]);l_.lastIndex=0;for(var O="",D;(D=l_.exec(w))!==null;)O+="-"+D[1];var V=jE(w)+O;return{name:V,styles:w,next:mo}},XE=function(a){return a()},_x=Yg["useInsertionEffect"]?Yg["useInsertionEffect"]:!1,xx=_x||XE,c_=_x||Z.exports.useLayoutEffect,Hh={}.hasOwnProperty,vx=Z.exports.createContext(typeof HTMLElement<"u"?RE({key:"css"}):null);vx.Provider;var Kf=function(a){return Z.exports.forwardRef(function(u,g){var _=Z.exports.useContext(vx);return a(u,_,g)})},Yh=Z.exports.createContext({}),yf="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",bx=function(a,u){var g={};for(var _ in u)Hh.call(u,_)&&(g[_]=u[_]);return g[yf]=a,g},KE=function(a){var u=a.cache,g=a.serialized,_=a.isStringTag;return Zf(u,g,_),xx(function(){return Wf(u,g,_)}),null},wx=Kf(function(n,a,u){var g=n.css;typeof g=="string"&&a.registered[g]!==void 0&&(g=a.registered[g]);var _=n[yf],w=[g],T="";typeof n.className=="string"?T=gx(a.registered,w,n.className):n.className!=null&&(T=n.className+" ");var l=Xf(w,void 0,Z.exports.useContext(Yh));T+=a.key+"-"+l.name;var O={};for(var D in n)Hh.call(n,D)&&D!=="css"&&D!==yf&&(O[D]=n[D]);return O.ref=u,O.className=T,Z.exports.createElement(Z.exports.Fragment,null,Z.exports.createElement(KE,{cache:a,serialized:l,isStringTag:typeof _=="string"}),Z.exports.createElement(_,O))}),bi=mh;function ut(n,a,u){return Hh.call(a,"css")?nt(wx,bx(n,a),u):nt(n,a,u)}function Gn(n,a,u){return Hh.call(a,"css")?wt(wx,bx(n,a),u):wt(n,a,u)}const HE={black:"#000",white:"#fff"},zc=HE,YE={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},tl=YE,JE={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},rl=JE,QE={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},nl=QE,eT={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},il=eT,tT={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},ol=tT,rT={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},pc=rT,nT={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},iT=nT;function Pn(n,a){if(n==null)return{};var u={},g=Object.keys(n),_,w;for(w=0;w<g.length;w++)_=g[w],!(a.indexOf(_)>=0)&&(u[_]=n[_]);return u}var oT=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,aT=ux(function(n){return oT.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91}),sT=Kf(function(n,a){var u=n.styles,g=Xf([u],void 0,Z.exports.useContext(Yh)),_=Z.exports.useRef();return c_(function(){var w=a.key+"-global",T=new a.sheet.constructor({key:w,nonce:a.sheet.nonce,container:a.sheet.container,speedy:a.sheet.isSpeedy}),l=!1,O=document.querySelector('style[data-emotion="'+w+" "+g.name+'"]');return a.sheet.tags.length&&(T.before=a.sheet.tags[0]),O!==null&&(l=!0,O.setAttribute("data-emotion",w),T.hydrate([O])),_.current=[T,l],function(){T.flush()}},[a]),c_(function(){var w=_.current,T=w[0],l=w[1];if(l){w[1]=!1;return}if(g.next!==void 0&&Wf(a,g.next,!0),T.tags.length){var O=T.tags[T.tags.length-1].nextElementSibling;T.before=O,T.flush()}a.insert("",g,T,!1)},[a,g.name]),null}),lT=aT,cT=function(a){return a!=="theme"},u_=function(a){return typeof a=="string"&&a.charCodeAt(0)>96?lT:cT},h_=function(a,u,g){var _;if(u){var w=u.shouldForwardProp;_=a.__emotion_forwardProp&&w?function(T){return a.__emotion_forwardProp(T)&&w(T)}:w}return typeof _!="function"&&g&&(_=a.__emotion_forwardProp),_},uT=function(a){var u=a.cache,g=a.serialized,_=a.isStringTag;return Zf(u,g,_),xx(function(){return Wf(u,g,_)}),null},hT=function n(a,u){var g=a.__emotion_real===a,_=g&&a.__emotion_base||a,w,T;u!==void 0&&(w=u.label,T=u.target);var l=h_(a,u,g),O=l||u_(_),D=!O("as");return function(){var V=arguments,K=g&&a.__emotion_styles!==void 0?a.__emotion_styles.slice(0):[];if(w!==void 0&&K.push("label:"+w+";"),V[0]==null||V[0].raw===void 0)K.push.apply(K,V);else{K.push(V[0][0]);for(var ae=V.length,de=1;de<ae;de++)K.push(V[de],V[0][de])}var xe=Kf(function(oe,_e,ge){var Ie=D&&oe.as||_,De="",We=[],Me=oe;if(oe.theme==null){Me={};for(var Re in oe)Me[Re]=oe[Re];Me.theme=Z.exports.useContext(Yh)}typeof oe.className=="string"?De=gx(_e.registered,We,oe.className):oe.className!=null&&(De=oe.className+" ");var Ce=Xf(K.concat(We),_e.registered,Me);De+=_e.key+"-"+Ce.name,T!==void 0&&(De+=" "+T);var Ze=D&&l===void 0?u_(Ie):O,yt={};for(var $e in oe)D&&$e==="as"||Ze($e)&&(yt[$e]=oe[$e]);return yt.className=De,yt.ref=ge,Z.exports.createElement(Z.exports.Fragment,null,Z.exports.createElement(uT,{cache:_e,serialized:Ce,isStringTag:typeof Ie=="string"}),Z.exports.createElement(Ie,yt))});return xe.displayName=w!==void 0?w:"Styled("+(typeof _=="string"?_:_.displayName||_.name||"Component")+")",xe.defaultProps=a.defaultProps,xe.__emotion_real=xe,xe.__emotion_base=_,xe.__emotion_styles=K,xe.__emotion_forwardProp=l,Object.defineProperty(xe,"toString",{value:function(){return"."+T}}),xe.withComponent=function(oe,_e){return n(oe,Ve({},u,_e,{shouldForwardProp:h_(xe,_e,!0)})).apply(void 0,K)},xe}},dT=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],_f=hT.bind();dT.forEach(function(n){_f[n]=_f(n)});const pT=_f;function fT(n){return n==null||Object.keys(n).length===0}function mT(n){const{styles:a,defaultTheme:u={}}=n;return nt(sT,{styles:typeof a=="function"?_=>a(fT(_)?u:_):a})}/** @license MUI v5.10.16
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Sx(n,a){return pT(n,a)}const gT=(n,a)=>{Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=a(n.__emotion_styles))};function vc(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function $o(n,a,u={clone:!0}){const g=u.clone?Ve({},n):n;return vc(n)&&vc(a)&&Object.keys(a).forEach(_=>{_!=="__proto__"&&(vc(a[_])&&_ in n&&vc(n[_])?g[_]=$o(n[_],a[_],u):g[_]=a[_])}),g}function os(n){let a="https://mui.com/production-error/?code="+n;for(let u=1;u<arguments.length;u+=1)a+="&args[]="+encodeURIComponent(arguments[u]);return"Minified MUI error #"+n+"; visit "+a+" for the full message."}function yo(n){if(typeof n!="string")throw new Error(os(7));return n.charAt(0).toUpperCase()+n.slice(1)}function yT(n,a=166){let u;function g(..._){const w=()=>{n.apply(this,_)};clearTimeout(u),u=setTimeout(w,a)}return g.clear=()=>{clearTimeout(u)},g}function _T(n){return n&&n.ownerDocument||document}function d_(n){return _T(n).defaultView||window}function xT(n,a){typeof n=="function"?n(a):n&&(n.current=a)}const vT=typeof window<"u"?Z.exports.useLayoutEffect:Z.exports.useEffect,Hf=vT;function Ex(...n){return Z.exports.useMemo(()=>n.every(a=>a==null)?null:a=>{n.forEach(u=>{xT(u,a)})},n)}function bT(n,a){const u=Ve({},a);return Object.keys(n).forEach(g=>{u[g]===void 0&&(u[g]=n[g])}),u}function Yf(n,a,u){const g={};return Object.keys(n).forEach(_=>{g[_]=n[_].reduce((w,T)=>(T&&(w.push(a(T)),u&&u[T]&&w.push(u[T])),w),[]).join(" ")}),g}const p_=n=>n,wT=()=>{let n=p_;return{configure(a){n=a},generate(a){return n(a)},reset(){n=p_}}},ST=wT(),Tx=ST,ET={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function Jh(n,a,u="Mui"){const g=ET[a];return g?`${u}-${g}`:`${Tx.generate(n)}-${a}`}function Jf(n,a,u="Mui"){const g={};return a.forEach(_=>{g[_]=Jh(n,_,u)}),g}function Sc(n,a){return a?$o(n,a,{clone:!1}):n}const Qf={xs:0,sm:600,md:900,lg:1200,xl:1536},f_={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${Qf[n]}px)`};function ma(n,a,u){const g=n.theme||{};if(Array.isArray(a)){const w=g.breakpoints||f_;return a.reduce((T,l,O)=>(T[w.up(w.keys[O])]=u(a[O]),T),{})}if(typeof a=="object"){const w=g.breakpoints||f_;return Object.keys(a).reduce((T,l)=>{if(Object.keys(w.values||Qf).indexOf(l)!==-1){const O=w.up(l);T[O]=u(a[l],l)}else{const O=l;T[O]=a[O]}return T},{})}return u(a)}function TT(n={}){var a;return((a=n.keys)==null?void 0:a.reduce((g,_)=>{const w=n.up(_);return g[w]={},g},{}))||{}}function CT(n,a){return n.reduce((u,g)=>{const _=u[g];return(!_||Object.keys(_).length===0)&&delete u[g],u},a)}function em(n,a,u=!0){if(!a||typeof a!="string")return null;if(n&&n.vars&&u){const g=`vars.${a}`.split(".").reduce((_,w)=>_&&_[w]?_[w]:null,n);if(g!=null)return g}return a.split(".").reduce((g,_)=>g&&g[_]!=null?g[_]:null,n)}function m_(n,a,u,g=u){let _;return typeof n=="function"?_=n(u):Array.isArray(n)?_=n[u]||g:_=em(n,u)||g,a&&(_=a(_,g)),_}function ot(n){const{prop:a,cssProperty:u=n.prop,themeKey:g,transform:_}=n,w=T=>{if(T[a]==null)return null;const l=T[a],O=T.theme,D=em(O,g)||{};return ma(T,l,K=>{let ae=m_(D,_,K);return K===ae&&typeof K=="string"&&(ae=m_(D,_,`${a}${K==="default"?"":yo(K)}`,K)),u===!1?ae:{[u]:ae}})};return w.propTypes={},w.filterProps=[a],w}function ga(...n){const a=n.reduce((g,_)=>(_.filterProps.forEach(w=>{g[w]=_}),g),{}),u=g=>Object.keys(g).reduce((_,w)=>a[w]?Sc(_,a[w](g)):_,{});return u.propTypes={},u.filterProps=n.reduce((g,_)=>g.concat(_.filterProps),[]),u}function kT(n){const a={};return u=>(a[u]===void 0&&(a[u]=n(u)),a[u])}const IT={m:"margin",p:"padding"},AT={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},g_={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},PT=kT(n=>{if(n.length>2)if(g_[n])n=g_[n];else return[n];const[a,u]=n.split(""),g=IT[a],_=AT[u]||"";return Array.isArray(_)?_.map(w=>g+w):[g+_]}),MT=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],zT=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Cx=[...MT,...zT];function Bc(n,a,u,g){var _;const w=(_=em(n,a,!1))!=null?_:u;return typeof w=="number"?T=>typeof T=="string"?T:w*T:Array.isArray(w)?T=>typeof T=="string"?T:w[T]:typeof w=="function"?w:()=>{}}function kx(n){return Bc(n,"spacing",8)}function Oc(n,a){if(typeof a=="string"||a==null)return a;const u=Math.abs(a),g=n(u);return a>=0?g:typeof g=="number"?-g:`-${g}`}function DT(n,a){return u=>n.reduce((g,_)=>(g[_]=Oc(a,u),g),{})}function RT(n,a,u,g){if(a.indexOf(u)===-1)return null;const _=PT(u),w=DT(_,g),T=n[u];return ma(n,T,w)}function LT(n,a){const u=kx(n.theme);return Object.keys(n).map(g=>RT(n,a,g,u)).reduce(Sc,{})}function Qh(n){return LT(n,Cx)}Qh.propTypes={};Qh.filterProps=Cx;function $c(n){return typeof n!="number"?n:`${n}px solid`}const FT=ot({prop:"border",themeKey:"borders",transform:$c}),BT=ot({prop:"borderTop",themeKey:"borders",transform:$c}),OT=ot({prop:"borderRight",themeKey:"borders",transform:$c}),$T=ot({prop:"borderBottom",themeKey:"borders",transform:$c}),UT=ot({prop:"borderLeft",themeKey:"borders",transform:$c}),NT=ot({prop:"borderColor",themeKey:"palette"}),VT=ot({prop:"borderTopColor",themeKey:"palette"}),jT=ot({prop:"borderRightColor",themeKey:"palette"}),qT=ot({prop:"borderBottomColor",themeKey:"palette"}),GT=ot({prop:"borderLeftColor",themeKey:"palette"}),tm=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const a=Bc(n.theme,"shape.borderRadius",4),u=g=>({borderRadius:Oc(a,g)});return ma(n,n.borderRadius,u)}return null};tm.propTypes={};tm.filterProps=["borderRadius"];const ZT=ga(FT,BT,OT,$T,UT,NT,VT,jT,qT,GT,tm),Ix=ZT,WT=ot({prop:"displayPrint",cssProperty:!1,transform:n=>({"@media print":{display:n}})}),XT=ot({prop:"display"}),KT=ot({prop:"overflow"}),HT=ot({prop:"textOverflow"}),YT=ot({prop:"visibility"}),JT=ot({prop:"whiteSpace"}),Ax=ga(WT,XT,KT,HT,YT,JT),QT=ot({prop:"flexBasis"}),eC=ot({prop:"flexDirection"}),tC=ot({prop:"flexWrap"}),rC=ot({prop:"justifyContent"}),nC=ot({prop:"alignItems"}),iC=ot({prop:"alignContent"}),oC=ot({prop:"order"}),aC=ot({prop:"flex"}),sC=ot({prop:"flexGrow"}),lC=ot({prop:"flexShrink"}),cC=ot({prop:"alignSelf"}),uC=ot({prop:"justifyItems"}),hC=ot({prop:"justifySelf"}),dC=ga(QT,eC,tC,rC,nC,iC,oC,aC,sC,lC,cC,uC,hC),Px=dC,rm=n=>{if(n.gap!==void 0&&n.gap!==null){const a=Bc(n.theme,"spacing",8),u=g=>({gap:Oc(a,g)});return ma(n,n.gap,u)}return null};rm.propTypes={};rm.filterProps=["gap"];const nm=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const a=Bc(n.theme,"spacing",8),u=g=>({columnGap:Oc(a,g)});return ma(n,n.columnGap,u)}return null};nm.propTypes={};nm.filterProps=["columnGap"];const im=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const a=Bc(n.theme,"spacing",8),u=g=>({rowGap:Oc(a,g)});return ma(n,n.rowGap,u)}return null};im.propTypes={};im.filterProps=["rowGap"];const pC=ot({prop:"gridColumn"}),fC=ot({prop:"gridRow"}),mC=ot({prop:"gridAutoFlow"}),gC=ot({prop:"gridAutoColumns"}),yC=ot({prop:"gridAutoRows"}),_C=ot({prop:"gridTemplateColumns"}),xC=ot({prop:"gridTemplateRows"}),vC=ot({prop:"gridTemplateAreas"}),bC=ot({prop:"gridArea"}),wC=ga(rm,nm,im,pC,fC,mC,gC,yC,_C,xC,vC,bC),Mx=wC;function om(n,a){return a==="grey"?a:n}const SC=ot({prop:"color",themeKey:"palette",transform:om}),EC=ot({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:om}),TC=ot({prop:"backgroundColor",themeKey:"palette",transform:om}),CC=ga(SC,EC,TC),zx=CC,kC=ot({prop:"position"}),IC=ot({prop:"zIndex",themeKey:"zIndex"}),AC=ot({prop:"top"}),PC=ot({prop:"right"}),MC=ot({prop:"bottom"}),zC=ot({prop:"left"}),Dx=ga(kC,IC,AC,PC,MC,zC),DC=ot({prop:"boxShadow",themeKey:"shadows"}),Rx=DC;function ya(n){return n<=1&&n!==0?`${n*100}%`:n}const RC=ot({prop:"width",transform:ya}),Lx=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const a=u=>{var g,_,w;return{maxWidth:((g=n.theme)==null||(_=g.breakpoints)==null||(w=_.values)==null?void 0:w[u])||Qf[u]||ya(u)}};return ma(n,n.maxWidth,a)}return null};Lx.filterProps=["maxWidth"];const LC=ot({prop:"minWidth",transform:ya}),FC=ot({prop:"height",transform:ya}),BC=ot({prop:"maxHeight",transform:ya}),OC=ot({prop:"minHeight",transform:ya});ot({prop:"size",cssProperty:"width",transform:ya});ot({prop:"size",cssProperty:"height",transform:ya});const $C=ot({prop:"boxSizing"}),UC=ga(RC,Lx,LC,FC,BC,OC,$C),Fx=UC,NC=ot({prop:"fontFamily",themeKey:"typography"}),VC=ot({prop:"fontSize",themeKey:"typography"}),jC=ot({prop:"fontStyle",themeKey:"typography"}),qC=ot({prop:"fontWeight",themeKey:"typography"}),GC=ot({prop:"letterSpacing"}),ZC=ot({prop:"textTransform"}),WC=ot({prop:"lineHeight"}),XC=ot({prop:"textAlign"}),KC=ot({prop:"typography",cssProperty:!1,themeKey:"typography"}),HC=ga(KC,NC,VC,jC,qC,GC,WC,XC,ZC),Bx=HC,y_={borders:Ix.filterProps,display:Ax.filterProps,flexbox:Px.filterProps,grid:Mx.filterProps,positions:Dx.filterProps,palette:zx.filterProps,shadows:Rx.filterProps,sizing:Fx.filterProps,spacing:Qh.filterProps,typography:Bx.filterProps},Ox={borders:Ix,display:Ax,flexbox:Px,grid:Mx,positions:Dx,palette:zx,shadows:Rx,sizing:Fx,spacing:Qh,typography:Bx},YC=Object.keys(y_).reduce((n,a)=>(y_[a].forEach(u=>{n[u]=Ox[a]}),n),{});function JC(...n){const a=n.reduce((g,_)=>g.concat(Object.keys(_)),[]),u=new Set(a);return n.every(g=>u.size===Object.keys(g).length)}function QC(n,a){return typeof n=="function"?n(a):n}function ek(n=Ox){const a=Object.keys(n).reduce((_,w)=>(n[w].filterProps.forEach(T=>{_[T]=n[w]}),_),{});function u(_,w,T){const l={[_]:w,theme:T},O=a[_];return O?O(l):{[_]:w}}function g(_){const{sx:w,theme:T={}}=_||{};if(!w)return null;function l(O){let D=O;if(typeof O=="function")D=O(T);else if(typeof O!="object")return O;if(!D)return null;const V=TT(T.breakpoints),K=Object.keys(V);let ae=V;return Object.keys(D).forEach(de=>{const xe=QC(D[de],T);if(xe!=null)if(typeof xe=="object")if(a[de])ae=Sc(ae,u(de,xe,T));else{const oe=ma({theme:T},xe,_e=>({[de]:_e}));JC(oe,xe)?ae[de]=g({sx:xe,theme:T}):ae=Sc(ae,oe)}else ae=Sc(ae,u(de,xe,T))}),CT(K,ae)}return Array.isArray(w)?w.map(l):l(w)}return g}const $x=ek();$x.filterProps=["sx"];const Ux=$x,tk=["sx"],rk=n=>{const a={systemProps:{},otherProps:{}};return Object.keys(n).forEach(u=>{YC[u]?a.systemProps[u]=n[u]:a.otherProps[u]=n[u]}),a};function nk(n){const{sx:a}=n,u=Pn(n,tk),{systemProps:g,otherProps:_}=rk(u);let w;return Array.isArray(a)?w=[g,...a]:typeof a=="function"?w=(...T)=>{const l=a(...T);return vc(l)?Ve({},g,l):g}:w=Ve({},g,a),Ve({},_,{sx:w})}function Nx(n){var a,u,g="";if(typeof n=="string"||typeof n=="number")g+=n;else if(typeof n=="object")if(Array.isArray(n))for(a=0;a<n.length;a++)n[a]&&(u=Nx(n[a]))&&(g&&(g+=" "),g+=u);else for(a in n)n[a]&&(g&&(g+=" "),g+=a);return g}function Dc(){for(var n,a,u=0,g="";u<arguments.length;)(n=arguments[u++])&&(a=Nx(n))&&(g&&(g+=" "),g+=a);return g}const ik=["values","unit","step"],ok=n=>{const a=Object.keys(n).map(u=>({key:u,val:n[u]}))||[];return a.sort((u,g)=>u.val-g.val),a.reduce((u,g)=>Ve({},u,{[g.key]:g.val}),{})};function ak(n){const{values:a={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:u="px",step:g=5}=n,_=Pn(n,ik),w=ok(a),T=Object.keys(w);function l(ae){return`@media (min-width:${typeof a[ae]=="number"?a[ae]:ae}${u})`}function O(ae){return`@media (max-width:${(typeof a[ae]=="number"?a[ae]:ae)-g/100}${u})`}function D(ae,de){const xe=T.indexOf(de);return`@media (min-width:${typeof a[ae]=="number"?a[ae]:ae}${u}) and (max-width:${(xe!==-1&&typeof a[T[xe]]=="number"?a[T[xe]]:de)-g/100}${u})`}function V(ae){return T.indexOf(ae)+1<T.length?D(ae,T[T.indexOf(ae)+1]):l(ae)}function K(ae){const de=T.indexOf(ae);return de===0?l(T[1]):de===T.length-1?O(T[de]):D(ae,T[T.indexOf(ae)+1]).replace("@media","@media not all and")}return Ve({keys:T,values:w,up:l,down:O,between:D,only:V,not:K,unit:u},_)}const sk={borderRadius:4},lk=sk;function ck(n=8){if(n.mui)return n;const a=kx({spacing:n}),u=(...g)=>(g.length===0?[1]:g).map(w=>{const T=a(w);return typeof T=="number"?`${T}px`:T}).join(" ");return u.mui=!0,u}const uk=["breakpoints","palette","spacing","shape"];function am(n={},...a){const{breakpoints:u={},palette:g={},spacing:_,shape:w={}}=n,T=Pn(n,uk),l=ak(u),O=ck(_);let D=$o({breakpoints:l,direction:"ltr",components:{},palette:Ve({mode:"light"},g),spacing:O,shape:Ve({},lk,w)},T);return D=a.reduce((V,K)=>$o(V,K),D),D}const hk=Z.exports.createContext(null),Vx=hk;function jx(){return Z.exports.useContext(Vx)}const dk=typeof Symbol=="function"&&Symbol.for,pk=dk?Symbol.for("mui.nested"):"__THEME_NESTED__";function fk(n,a){return typeof a=="function"?a(n):Ve({},n,a)}function mk(n){const{children:a,theme:u}=n,g=jx(),_=Z.exports.useMemo(()=>{const w=g===null?u:fk(g,u);return w!=null&&(w[pk]=g!==null),w},[u,g]);return nt(Vx.Provider,{value:_,children:a})}function gk(n){return Object.keys(n).length===0}function yk(n=null){const a=jx();return!a||gk(a)?n:a}const _k=am();function sm(n=_k){return yk(n)}const xk=["className","component"];function vk(n={}){const{defaultTheme:a,defaultClassName:u="MuiBox-root",generateClassName:g,styleFunctionSx:_=Ux}=n,w=Sx("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(_);return Z.exports.forwardRef(function(O,D){const V=sm(a),K=nk(O),{className:ae,component:de="div"}=K,xe=Pn(K,xk);return nt(w,Ve({as:de,ref:D,className:Dc(ae,g?g(u):u),theme:V},xe))})}const bk=["variant"];function __(n){return n.length===0}function qx(n){const{variant:a}=n,u=Pn(n,bk);let g=a||"";return Object.keys(u).sort().forEach(_=>{_==="color"?g+=__(g)?n[_]:yo(n[_]):g+=`${__(g)?_:yo(_)}${yo(n[_].toString())}`}),g}const wk=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Sk=["theme"],Ek=["theme"];function fc(n){return Object.keys(n).length===0}function Tk(n){return typeof n=="string"&&n.charCodeAt(0)>96}const Ck=(n,a)=>a.components&&a.components[n]&&a.components[n].styleOverrides?a.components[n].styleOverrides:null,kk=(n,a)=>{let u=[];a&&a.components&&a.components[n]&&a.components[n].variants&&(u=a.components[n].variants);const g={};return u.forEach(_=>{const w=qx(_.props);g[w]=_.style}),g},Ik=(n,a,u,g)=>{var _,w;const{ownerState:T={}}=n,l=[],O=u==null||(_=u.components)==null||(w=_[g])==null?void 0:w.variants;return O&&O.forEach(D=>{let V=!0;Object.keys(D.props).forEach(K=>{T[K]!==D.props[K]&&n[K]!==D.props[K]&&(V=!1)}),V&&l.push(a[qx(D.props)])}),l};function fh(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const Ak=am();function Pk(n={}){const{defaultTheme:a=Ak,rootShouldForwardProp:u=fh,slotShouldForwardProp:g=fh,styleFunctionSx:_=Ux}=n,w=T=>{const l=fc(T.theme)?a:T.theme;return _(Ve({},T,{theme:l}))};return w.__mui_systemSx=!0,(T,l={})=>{gT(T,We=>We.filter(Me=>!(Me!=null&&Me.__mui_systemSx)));const{name:O,slot:D,skipVariantsResolver:V,skipSx:K,overridesResolver:ae}=l,de=Pn(l,wk),xe=V!==void 0?V:D&&D!=="Root"||!1,oe=K||!1;let _e,ge=fh;D==="Root"?ge=u:D?ge=g:Tk(T)&&(ge=void 0);const Ie=Sx(T,Ve({shouldForwardProp:ge,label:_e},de)),De=(We,...Me)=>{const Re=Me?Me.map($e=>typeof $e=="function"&&$e.__emotion_real!==$e?Ot=>{let{theme:Mt}=Ot,or=Pn(Ot,Sk);return $e(Ve({theme:fc(Mt)?a:Mt},or))}:$e):[];let Ce=We;O&&ae&&Re.push($e=>{const Ot=fc($e.theme)?a:$e.theme,Mt=Ck(O,Ot);if(Mt){const or={};return Object.entries(Mt).forEach(([Xt,Lr])=>{or[Xt]=typeof Lr=="function"?Lr(Ve({},$e,{theme:Ot})):Lr}),ae($e,or)}return null}),O&&!xe&&Re.push($e=>{const Ot=fc($e.theme)?a:$e.theme;return Ik($e,kk(O,Ot),Ot,O)}),oe||Re.push(w);const Ze=Re.length-Me.length;if(Array.isArray(We)&&Ze>0){const $e=new Array(Ze).fill("");Ce=[...We,...$e],Ce.raw=[...We.raw,...$e]}else typeof We=="function"&&We.__emotion_real!==We&&(Ce=$e=>{let{theme:Ot}=$e,Mt=Pn($e,Ek);return We(Ve({theme:fc(Ot)?a:Ot},Mt))});return Ie(Ce,...Re)};return Ie.withConfig&&(De.withConfig=Ie.withConfig),De}}function Mk(n){const{theme:a,name:u,props:g}=n;return!a||!a.components||!a.components[u]||!a.components[u].defaultProps?g:bT(a.components[u].defaultProps,g)}function zk({props:n,name:a,defaultTheme:u}){const g=sm(u);return Mk({theme:g,name:a,props:n})}function lm(n,a=0,u=1){return Math.min(Math.max(a,n),u)}function Dk(n){n=n.slice(1);const a=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let u=n.match(a);return u&&u[0].length===1&&(u=u.map(g=>g+g)),u?`rgb${u.length===4?"a":""}(${u.map((g,_)=>_<3?parseInt(g,16):Math.round(parseInt(g,16)/255*1e3)/1e3).join(", ")})`:""}function as(n){if(n.type)return n;if(n.charAt(0)==="#")return as(Dk(n));const a=n.indexOf("("),u=n.substring(0,a);if(["rgb","rgba","hsl","hsla","color"].indexOf(u)===-1)throw new Error(os(9,n));let g=n.substring(a+1,n.length-1),_;if(u==="color"){if(g=g.split(" "),_=g.shift(),g.length===4&&g[3].charAt(0)==="/"&&(g[3]=g[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(_)===-1)throw new Error(os(10,_))}else g=g.split(",");return g=g.map(w=>parseFloat(w)),{type:u,values:g,colorSpace:_}}function ed(n){const{type:a,colorSpace:u}=n;let{values:g}=n;return a.indexOf("rgb")!==-1?g=g.map((_,w)=>w<3?parseInt(_,10):_):a.indexOf("hsl")!==-1&&(g[1]=`${g[1]}%`,g[2]=`${g[2]}%`),a.indexOf("color")!==-1?g=`${u} ${g.join(" ")}`:g=`${g.join(", ")}`,`${a}(${g})`}function Rk(n){n=as(n);const{values:a}=n,u=a[0],g=a[1]/100,_=a[2]/100,w=g*Math.min(_,1-_),T=(D,V=(D+u/30)%12)=>_-w*Math.max(Math.min(V-3,9-V,1),-1);let l="rgb";const O=[Math.round(T(0)*255),Math.round(T(8)*255),Math.round(T(4)*255)];return n.type==="hsla"&&(l+="a",O.push(a[3])),ed({type:l,values:O})}function x_(n){n=as(n);let a=n.type==="hsl"||n.type==="hsla"?as(Rk(n)).values:n.values;return a=a.map(u=>(n.type!=="color"&&(u/=255),u<=.03928?u/12.92:((u+.055)/1.055)**2.4)),Number((.2126*a[0]+.7152*a[1]+.0722*a[2]).toFixed(3))}function Lk(n,a){const u=x_(n),g=x_(a);return(Math.max(u,g)+.05)/(Math.min(u,g)+.05)}function v_(n,a){return n=as(n),a=lm(a),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${a}`:n.values[3]=a,ed(n)}function Fk(n,a){if(n=as(n),a=lm(a),n.type.indexOf("hsl")!==-1)n.values[2]*=1-a;else if(n.type.indexOf("rgb")!==-1||n.type.indexOf("color")!==-1)for(let u=0;u<3;u+=1)n.values[u]*=1-a;return ed(n)}function Bk(n,a){if(n=as(n),a=lm(a),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*a;else if(n.type.indexOf("rgb")!==-1)for(let u=0;u<3;u+=1)n.values[u]+=(255-n.values[u])*a;else if(n.type.indexOf("color")!==-1)for(let u=0;u<3;u+=1)n.values[u]+=(1-n.values[u])*a;return ed(n)}const Ok={};function $k(n){const a=sm();return nt(Yh.Provider,{value:typeof a=="object"?a:Ok,children:n.children})}function Uk(n){const{children:a,theme:u}=n;return nt(mk,{theme:u,children:nt($k,{children:a})})}function Nk(n,a){return Ve({toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}}},a)}const Vk=["mode","contrastThreshold","tonalOffset"],b_={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:zc.white,default:zc.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Fp={text:{primary:zc.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:zc.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function w_(n,a,u,g){const _=g.light||g,w=g.dark||g*1.5;n[a]||(n.hasOwnProperty(u)?n[a]=n[u]:a==="light"?n.light=Bk(n.main,_):a==="dark"&&(n.dark=Fk(n.main,w)))}function jk(n="light"){return n==="dark"?{main:nl[200],light:nl[50],dark:nl[400]}:{main:nl[700],light:nl[400],dark:nl[800]}}function qk(n="light"){return n==="dark"?{main:rl[200],light:rl[50],dark:rl[400]}:{main:rl[500],light:rl[300],dark:rl[700]}}function Gk(n="light"){return n==="dark"?{main:tl[500],light:tl[300],dark:tl[700]}:{main:tl[700],light:tl[400],dark:tl[800]}}function Zk(n="light"){return n==="dark"?{main:il[400],light:il[300],dark:il[700]}:{main:il[700],light:il[500],dark:il[900]}}function Wk(n="light"){return n==="dark"?{main:ol[400],light:ol[300],dark:ol[700]}:{main:ol[800],light:ol[500],dark:ol[900]}}function Xk(n="light"){return n==="dark"?{main:pc[400],light:pc[300],dark:pc[700]}:{main:"#ed6c02",light:pc[500],dark:pc[900]}}function Kk(n){const{mode:a="light",contrastThreshold:u=3,tonalOffset:g=.2}=n,_=Pn(n,Vk),w=n.primary||jk(a),T=n.secondary||qk(a),l=n.error||Gk(a),O=n.info||Zk(a),D=n.success||Wk(a),V=n.warning||Xk(a);function K(oe){return Lk(oe,Fp.text.primary)>=u?Fp.text.primary:b_.text.primary}const ae=({color:oe,name:_e,mainShade:ge=500,lightShade:Ie=300,darkShade:De=700})=>{if(oe=Ve({},oe),!oe.main&&oe[ge]&&(oe.main=oe[ge]),!oe.hasOwnProperty("main"))throw new Error(os(11,_e?` (${_e})`:"",ge));if(typeof oe.main!="string")throw new Error(os(12,_e?` (${_e})`:"",JSON.stringify(oe.main)));return w_(oe,"light",Ie,g),w_(oe,"dark",De,g),oe.contrastText||(oe.contrastText=K(oe.main)),oe},de={dark:Fp,light:b_};return $o(Ve({common:Ve({},zc),mode:a,primary:ae({color:w,name:"primary"}),secondary:ae({color:T,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:ae({color:l,name:"error"}),warning:ae({color:V,name:"warning"}),info:ae({color:O,name:"info"}),success:ae({color:D,name:"success"}),grey:iT,contrastThreshold:u,getContrastText:K,augmentColor:ae,tonalOffset:g},de[a]),_)}const Hk=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function Yk(n){return Math.round(n*1e5)/1e5}const S_={textTransform:"uppercase"},E_='"Roboto", "Helvetica", "Arial", sans-serif';function Jk(n,a){const u=typeof a=="function"?a(n):a,{fontFamily:g=E_,fontSize:_=14,fontWeightLight:w=300,fontWeightRegular:T=400,fontWeightMedium:l=500,fontWeightBold:O=700,htmlFontSize:D=16,allVariants:V,pxToRem:K}=u,ae=Pn(u,Hk),de=_/14,xe=K||(ge=>`${ge/D*de}rem`),oe=(ge,Ie,De,We,Me)=>Ve({fontFamily:g,fontWeight:ge,fontSize:xe(Ie),lineHeight:De},g===E_?{letterSpacing:`${Yk(We/Ie)}em`}:{},Me,V),_e={h1:oe(w,96,1.167,-1.5),h2:oe(w,60,1.2,-.5),h3:oe(T,48,1.167,0),h4:oe(T,34,1.235,.25),h5:oe(T,24,1.334,0),h6:oe(l,20,1.6,.15),subtitle1:oe(T,16,1.75,.15),subtitle2:oe(l,14,1.57,.1),body1:oe(T,16,1.5,.15),body2:oe(T,14,1.43,.15),button:oe(l,14,1.75,.4,S_),caption:oe(T,12,1.66,.4),overline:oe(T,12,2.66,1,S_)};return $o(Ve({htmlFontSize:D,pxToRem:xe,fontFamily:g,fontSize:_,fontWeightLight:w,fontWeightRegular:T,fontWeightMedium:l,fontWeightBold:O},_e),ae,{clone:!1})}const Qk=.2,eI=.14,tI=.12;function xr(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${Qk})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${eI})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${tI})`].join(",")}const rI=["none",xr(0,2,1,-1,0,1,1,0,0,1,3,0),xr(0,3,1,-2,0,2,2,0,0,1,5,0),xr(0,3,3,-2,0,3,4,0,0,1,8,0),xr(0,2,4,-1,0,4,5,0,0,1,10,0),xr(0,3,5,-1,0,5,8,0,0,1,14,0),xr(0,3,5,-1,0,6,10,0,0,1,18,0),xr(0,4,5,-2,0,7,10,1,0,2,16,1),xr(0,5,5,-3,0,8,10,1,0,3,14,2),xr(0,5,6,-3,0,9,12,1,0,3,16,2),xr(0,6,6,-3,0,10,14,1,0,4,18,3),xr(0,6,7,-4,0,11,15,1,0,4,20,3),xr(0,7,8,-4,0,12,17,2,0,5,22,4),xr(0,7,8,-4,0,13,19,2,0,5,24,4),xr(0,7,9,-4,0,14,21,2,0,5,26,4),xr(0,8,9,-5,0,15,22,2,0,6,28,5),xr(0,8,10,-5,0,16,24,2,0,6,30,5),xr(0,8,11,-5,0,17,26,2,0,6,32,5),xr(0,9,11,-5,0,18,28,2,0,7,34,6),xr(0,9,12,-6,0,19,29,2,0,7,36,6),xr(0,10,13,-6,0,20,31,3,0,8,38,7),xr(0,10,13,-6,0,21,33,3,0,8,40,7),xr(0,10,14,-6,0,22,35,3,0,8,42,7),xr(0,11,14,-7,0,23,36,3,0,9,44,8),xr(0,11,15,-7,0,24,38,3,0,9,46,8)],nI=rI,iI=["duration","easing","delay"],oI={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},aI={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function T_(n){return`${Math.round(n)}ms`}function sI(n){if(!n)return 0;const a=n/36;return Math.round((4+15*a**.25+a/5)*10)}function lI(n){const a=Ve({},oI,n.easing),u=Ve({},aI,n.duration);return Ve({getAutoHeightDuration:sI,create:(_=["all"],w={})=>{const{duration:T=u.standard,easing:l=a.easeInOut,delay:O=0}=w;return Pn(w,iI),(Array.isArray(_)?_:[_]).map(D=>`${D} ${typeof T=="string"?T:T_(T)} ${l} ${typeof O=="string"?O:T_(O)}`).join(",")}},n,{easing:a,duration:u})}const cI={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},uI=cI,hI=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function cm(n={},...a){const{mixins:u={},palette:g={},transitions:_={},typography:w={}}=n,T=Pn(n,hI);if(n.vars)throw new Error(os(18));const l=Kk(g),O=am(n);let D=$o(O,{mixins:Nk(O.breakpoints,u),palette:l,shadows:nI.slice(),typography:Jk(l,w),transitions:lI(_),zIndex:Ve({},uI)});return D=$o(D,T),D=a.reduce((V,K)=>$o(V,K),D),D}const dI=cm(),um=dI;function hm({props:n,name:a}){return zk({props:n,name:a,defaultTheme:um})}const pI=n=>fh(n)&&n!=="classes",fI=Pk({defaultTheme:um,rootShouldForwardProp:pI}),ml=fI,mI=n=>{let a;return n<1?a=5.11916*n**2:a=4.5*Math.log(n+1)+2,(a/100).toFixed(2)},C_=mI;function k_(n){return typeof n=="string"}function dm(n){const{children:a,defer:u=!1,fallback:g=null}=n,[_,w]=Z.exports.useState(!1);return Hf(()=>{u||w(!0)},[u]),Z.exports.useEffect(()=>{u&&w(!0)},[u]),nt(Z.exports.Fragment,{children:_?a:g})}const gI=["onChange","maxRows","minRows","style","value"];function Wu(n,a){return parseInt(n[a],10)||0}const yI={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function I_(n){return n==null||Object.keys(n).length===0}const _I=Z.exports.forwardRef(function(a,u){const{onChange:g,maxRows:_,minRows:w=1,style:T,value:l}=a,O=Pn(a,gI),{current:D}=Z.exports.useRef(l!=null),V=Z.exports.useRef(null),K=Ex(u,V),ae=Z.exports.useRef(null),de=Z.exports.useRef(0),[xe,oe]=Z.exports.useState({}),_e=Z.exports.useCallback(()=>{const Me=V.current,Ce=d_(Me).getComputedStyle(Me);if(Ce.width==="0px")return{};const Ze=ae.current;Ze.style.width=Ce.width,Ze.value=Me.value||a.placeholder||"x",Ze.value.slice(-1)===`
`&&(Ze.value+=" ");const yt=Ce["box-sizing"],$e=Wu(Ce,"padding-bottom")+Wu(Ce,"padding-top"),Ot=Wu(Ce,"border-bottom-width")+Wu(Ce,"border-top-width"),Mt=Ze.scrollHeight;Ze.value="x";const or=Ze.scrollHeight;let Xt=Mt;w&&(Xt=Math.max(Number(w)*or,Xt)),_&&(Xt=Math.min(Number(_)*or,Xt)),Xt=Math.max(Xt,or);const Lr=Xt+(yt==="border-box"?$e+Ot:0),Vr=Math.abs(Xt-Mt)<=1;return{outerHeightStyle:Lr,overflow:Vr}},[_,w,a.placeholder]),ge=(Me,Re)=>{const{outerHeightStyle:Ce,overflow:Ze}=Re;return de.current<20&&(Ce>0&&Math.abs((Me.outerHeightStyle||0)-Ce)>1||Me.overflow!==Ze)?(de.current+=1,{overflow:Ze,outerHeightStyle:Ce}):Me},Ie=Z.exports.useCallback(()=>{const Me=_e();I_(Me)||oe(Re=>ge(Re,Me))},[_e]),De=()=>{const Me=_e();I_(Me)||vb.exports.flushSync(()=>{oe(Re=>ge(Re,Me))})};Z.exports.useEffect(()=>{const Me=yT(()=>{de.current=0,V.current&&De()}),Re=d_(V.current);Re.addEventListener("resize",Me);let Ce;return typeof ResizeObserver<"u"&&(Ce=new ResizeObserver(Me),Ce.observe(V.current)),()=>{Me.clear(),Re.removeEventListener("resize",Me),Ce&&Ce.disconnect()}}),Hf(()=>{Ie()}),Z.exports.useEffect(()=>{de.current=0},[l]);const We=Me=>{de.current=0,D||Ie(),g&&g(Me)};return wt(Z.exports.Fragment,{children:[nt("textarea",Ve({value:l,onChange:We,ref:K,rows:w,style:Ve({height:xe.outerHeightStyle,overflow:xe.overflow?"hidden":null},T)},O)),nt("textarea",{"aria-hidden":!0,className:a.className,readOnly:!0,ref:ae,tabIndex:-1,style:Ve({},yI.shadow,T,{padding:0})})]})}),xI=_I;function vI(n){return Jh("MuiSvgIcon",n)}Jf("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const bI=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],wI=n=>{const{color:a,fontSize:u,classes:g}=n,_={root:["root",a!=="inherit"&&`color${yo(a)}`,`fontSize${yo(u)}`]};return Yf(_,vI,g)},SI=ml("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,a)=>{const{ownerState:u}=n;return[a.root,u.color!=="inherit"&&a[`color${yo(u.color)}`],a[`fontSize${yo(u.fontSize)}`]]}})(({theme:n,ownerState:a})=>{var u,g,_,w,T,l,O,D,V,K,ae,de,xe,oe,_e,ge,Ie;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:(u=n.transitions)==null||(g=u.create)==null?void 0:g.call(u,"fill",{duration:(_=n.transitions)==null||(w=_.duration)==null?void 0:w.shorter}),fontSize:{inherit:"inherit",small:((T=n.typography)==null||(l=T.pxToRem)==null?void 0:l.call(T,20))||"1.25rem",medium:((O=n.typography)==null||(D=O.pxToRem)==null?void 0:D.call(O,24))||"1.5rem",large:((V=n.typography)==null||(K=V.pxToRem)==null?void 0:K.call(V,35))||"2.1875rem"}[a.fontSize],color:(ae=(de=(n.vars||n).palette)==null||(xe=de[a.color])==null?void 0:xe.main)!=null?ae:{action:(oe=(n.vars||n).palette)==null||(_e=oe.action)==null?void 0:_e.active,disabled:(ge=(n.vars||n).palette)==null||(Ie=ge.action)==null?void 0:Ie.disabled,inherit:void 0}[a.color]}}),Gx=Z.exports.forwardRef(function(a,u){const g=hm({props:a,name:"MuiSvgIcon"}),{children:_,className:w,color:T="inherit",component:l="svg",fontSize:O="medium",htmlColor:D,inheritViewBox:V=!1,titleAccess:K,viewBox:ae="0 0 24 24"}=g,de=Pn(g,bI),xe=Ve({},g,{color:T,component:l,fontSize:O,instanceFontSize:a.fontSize,inheritViewBox:V,viewBox:ae}),oe={};V||(oe.viewBox=ae);const _e=wI(xe);return wt(SI,Ve({as:l,className:Dc(_e.root,w),focusable:"false",color:D,"aria-hidden":K?void 0:!0,role:K?"img":void 0,ref:u},oe,de,{ownerState:xe,children:[_,K?nt("title",{children:K}):null]}))});Gx.muiName="SvgIcon";const xf=Gx;function gl(n,a){function u(g,_){return nt(xf,Ve({"data-testid":`${a}Icon`,ref:_},g,{children:n}))}return u.muiName=xf.muiName,Z.exports.memo(Z.exports.forwardRef(u))}function EI(n){return Jh("MuiPaper",n)}Jf("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const TI=["className","component","elevation","square","variant"],CI=n=>{const{square:a,elevation:u,variant:g,classes:_}=n,w={root:["root",g,!a&&"rounded",g==="elevation"&&`elevation${u}`]};return Yf(w,EI,_)},kI=ml("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,a)=>{const{ownerState:u}=n;return[a.root,a[u.variant],!u.square&&a.rounded,u.variant==="elevation"&&a[`elevation${u.elevation}`]]}})(({theme:n,ownerState:a})=>{var u;return Ve({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!a.square&&{borderRadius:n.shape.borderRadius},a.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.divider}`},a.variant==="elevation"&&Ve({boxShadow:(n.vars||n).shadows[a.elevation]},!n.vars&&n.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${v_("#fff",C_(a.elevation))}, ${v_("#fff",C_(a.elevation))})`},n.vars&&{backgroundImage:(u=n.vars.overlays)==null?void 0:u[a.elevation]}))}),II=Z.exports.forwardRef(function(a,u){const g=hm({props:a,name:"MuiPaper"}),{className:_,component:w="div",elevation:T=1,square:l=!1,variant:O="elevation"}=g,D=Pn(g,TI),V=Ve({},g,{component:w,elevation:T,square:l,variant:O}),K=CI(V);return nt(kI,Ve({as:w,ownerState:V,className:Dc(K.root,_),ref:u},D))}),AI=II;function PI({props:n,states:a,muiFormControl:u}){return a.reduce((g,_)=>(g[_]=n[_],u&&typeof n[_]>"u"&&(g[_]=u[_]),g),{})}const MI=Z.exports.createContext(void 0),Zx=MI;function zI(){return Z.exports.useContext(Zx)}function DI(n){return nt(mT,Ve({},n,{defaultTheme:um}))}function A_(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function RI(n,a=!1){return n&&(A_(n.value)&&n.value!==""||a&&A_(n.defaultValue)&&n.defaultValue!=="")}function LI(n){return Jh("MuiInputBase",n)}const FI=Jf("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),vf=FI,BI=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],OI=(n,a)=>{const{ownerState:u}=n;return[a.root,u.formControl&&a.formControl,u.startAdornment&&a.adornedStart,u.endAdornment&&a.adornedEnd,u.error&&a.error,u.size==="small"&&a.sizeSmall,u.multiline&&a.multiline,u.color&&a[`color${yo(u.color)}`],u.fullWidth&&a.fullWidth,u.hiddenLabel&&a.hiddenLabel]},$I=(n,a)=>{const{ownerState:u}=n;return[a.input,u.size==="small"&&a.inputSizeSmall,u.multiline&&a.inputMultiline,u.type==="search"&&a.inputTypeSearch,u.startAdornment&&a.inputAdornedStart,u.endAdornment&&a.inputAdornedEnd,u.hiddenLabel&&a.inputHiddenLabel]},UI=n=>{const{classes:a,color:u,disabled:g,error:_,endAdornment:w,focused:T,formControl:l,fullWidth:O,hiddenLabel:D,multiline:V,readOnly:K,size:ae,startAdornment:de,type:xe}=n,oe={root:["root",`color${yo(u)}`,g&&"disabled",_&&"error",O&&"fullWidth",T&&"focused",l&&"formControl",ae==="small"&&"sizeSmall",V&&"multiline",de&&"adornedStart",w&&"adornedEnd",D&&"hiddenLabel",K&&"readOnly"],input:["input",g&&"disabled",xe==="search"&&"inputTypeSearch",V&&"inputMultiline",ae==="small"&&"inputSizeSmall",D&&"inputHiddenLabel",de&&"inputAdornedStart",w&&"inputAdornedEnd",K&&"readOnly"]};return Yf(oe,LI,a)},NI=ml("div",{name:"MuiInputBase",slot:"Root",overridesResolver:OI})(({theme:n,ownerState:a})=>Ve({},n.typography.body1,{color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${vf.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"}},a.multiline&&Ve({padding:"4px 0 5px"},a.size==="small"&&{paddingTop:1}),a.fullWidth&&{width:"100%"})),VI=ml("input",{name:"MuiInputBase",slot:"Input",overridesResolver:$I})(({theme:n,ownerState:a})=>{const u=n.palette.mode==="light",g=Ve({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:u?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),_={opacity:"0 !important"},w=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:u?.42:.5};return Ve({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":g,"&::-moz-placeholder":g,"&:-ms-input-placeholder":g,"&::-ms-input-placeholder":g,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${vf.formControl} &`]:{"&::-webkit-input-placeholder":_,"&::-moz-placeholder":_,"&:-ms-input-placeholder":_,"&::-ms-input-placeholder":_,"&:focus::-webkit-input-placeholder":w,"&:focus::-moz-placeholder":w,"&:focus:-ms-input-placeholder":w,"&:focus::-ms-input-placeholder":w},[`&.${vf.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},a.size==="small"&&{paddingTop:1},a.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},a.type==="search"&&{MozAppearance:"textfield"})}),jI=nt(DI,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),qI=Z.exports.forwardRef(function(a,u){var g;const _=hm({props:a,name:"MuiInputBase"}),{"aria-describedby":w,autoComplete:T,autoFocus:l,className:O,components:D={},componentsProps:V={},defaultValue:K,disabled:ae,disableInjectingGlobalStyles:de,endAdornment:xe,fullWidth:oe=!1,id:_e,inputComponent:ge="input",inputProps:Ie={},inputRef:De,maxRows:We,minRows:Me,multiline:Re=!1,name:Ce,onBlur:Ze,onChange:yt,onClick:$e,onFocus:Ot,onKeyDown:Mt,onKeyUp:or,placeholder:Xt,readOnly:Lr,renderSuffix:Vr,rows:gn,slotProps:yn={},slots:_n={},startAdornment:Mn,type:Yr="text",value:Ct}=_,Ar=Pn(_,BI),Jt=Ie.value!=null?Ie.value:Ct,{current:ai}=Z.exports.useRef(Jt!=null),Hn=Z.exports.useRef(),$i=Z.exports.useCallback(qt=>{},[]),Qi=Ex(Hn,De,Ie.ref,$i),[zn,Jr]=Z.exports.useState(!1),Gt=zI(),br=PI({props:_,muiFormControl:Gt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});br.focused=Gt?Gt.focused:zn,Z.exports.useEffect(()=>{!Gt&&ae&&zn&&(Jr(!1),Ze&&Ze())},[Gt,ae,zn,Ze]);const ve=Gt&&Gt.onFilled,Dn=Gt&&Gt.onEmpty,Yn=Z.exports.useCallback(qt=>{RI(qt)?ve&&ve():Dn&&Dn()},[ve,Dn]);Hf(()=>{ai&&Yn({value:Jt})},[Jt,Yn,ai]);const jt=qt=>{if(br.disabled){qt.stopPropagation();return}Ot&&Ot(qt),Ie.onFocus&&Ie.onFocus(qt),Gt&&Gt.onFocus?Gt.onFocus(qt):Jr(!0)},Lt=qt=>{Ze&&Ze(qt),Ie.onBlur&&Ie.onBlur(qt),Gt&&Gt.onBlur?Gt.onBlur(qt):Jr(!1)},Ui=(qt,...si)=>{if(!ai){const Be=qt.target||Hn.current;if(Be==null)throw new Error(os(1));Yn({value:Be.value})}Ie.onChange&&Ie.onChange(qt,...si),yt&&yt(qt,...si)};Z.exports.useEffect(()=>{Yn(Hn.current)},[]);const Ni=qt=>{Hn.current&&qt.currentTarget===qt.target&&Hn.current.focus(),$e&&$e(qt)};let eo=ge,xn=Ie;Re&&eo==="input"&&(gn?xn=Ve({type:void 0,minRows:gn,maxRows:gn},xn):xn=Ve({type:void 0,maxRows:We,minRows:Me},xn),eo=xI);const ar=qt=>{Yn(qt.animationName==="mui-auto-fill-cancel"?Hn.current:{value:"x"})};Z.exports.useEffect(()=>{Gt&&Gt.setAdornedStart(Boolean(Mn))},[Gt,Mn]);const Ti=Ve({},_,{color:br.color||"primary",disabled:br.disabled,endAdornment:xe,error:br.error,focused:br.focused,formControl:Gt,fullWidth:oe,hiddenLabel:br.hiddenLabel,multiline:Re,size:br.size,startAdornment:Mn,type:Yr}),Vi=UI(Ti),Fe=_n.root||D.Root||NI,Fr=yn.root||V.root||{},Gr=_n.input||D.Input||VI;return xn=Ve({},xn,(g=yn.input)!=null?g:V.input),wt(Z.exports.Fragment,{children:[!de&&jI,wt(Fe,Ve({},Fr,!k_(Fe)&&{ownerState:Ve({},Ti,Fr.ownerState)},{ref:u,onClick:Ni},Ar,{className:Dc(Vi.root,Fr.className,O),children:[Mn,nt(Zx.Provider,{value:null,children:nt(Gr,Ve({ownerState:Ti,"aria-invalid":br.error,"aria-describedby":w,autoComplete:T,autoFocus:l,defaultValue:K,disabled:br.disabled,id:_e,onAnimationStart:ar,name:Ce,placeholder:Xt,readOnly:Lr,required:br.required,rows:gn,value:Jt,onKeyDown:Mt,onKeyUp:or,type:Yr},xn,!k_(Gr)&&{as:eo,ownerState:Ve({},Ti,xn.ownerState)},{ref:Qi,className:Dc(Vi.input,xn.className),onBlur:Lt,onChange:Ui,onFocus:jt}))}),xe,Vr?Vr(Ve({},br,{startAdornment:Mn})):null]}))]})}),GI=qI,ZI=cm(),WI=vk({defaultTheme:ZI,defaultClassName:"MuiBox-root",generateClassName:Tx.generate}),Kr=WI,P_=gl(nt("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),XI=gl(nt("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight"),KI=gl(nt("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),HI=gl(nt("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"}),"ContentCopy"),YI=gl(nt("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit"),JI=gl(nt("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),M_=n=>{let a;const u=new Set,g=(O,D)=>{const V=typeof O=="function"?O(a):O;if(!Object.is(V,a)){const K=a;a=(D!=null?D:typeof V!="object")?V:Object.assign({},a,V),u.forEach(ae=>ae(a,K))}},_=()=>a,l={setState:g,getState:_,subscribe:O=>(u.add(O),()=>u.delete(O)),destroy:()=>u.clear()};return a=n(g,_,l),l},QI=n=>n?M_(n):M_;var Wx={exports:{}},Xx={},Kx={exports:{}},Hx={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ul=Z.exports;function eA(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var tA=typeof Object.is=="function"?Object.is:eA,rA=ul.useState,nA=ul.useEffect,iA=ul.useLayoutEffect,oA=ul.useDebugValue;function aA(n,a){var u=a(),g=rA({inst:{value:u,getSnapshot:a}}),_=g[0].inst,w=g[1];return iA(function(){_.value=u,_.getSnapshot=a,Bp(_)&&w({inst:_})},[n,u,a]),nA(function(){return Bp(_)&&w({inst:_}),n(function(){Bp(_)&&w({inst:_})})},[n]),oA(u),u}function Bp(n){var a=n.getSnapshot;n=n.value;try{var u=a();return!tA(n,u)}catch{return!0}}function sA(n,a){return a()}var lA=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?sA:aA;Hx.useSyncExternalStore=ul.useSyncExternalStore!==void 0?ul.useSyncExternalStore:lA;(function(n){n.exports=Hx})(Kx);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var td=Z.exports,cA=Kx.exports;function uA(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var hA=typeof Object.is=="function"?Object.is:uA,dA=cA.useSyncExternalStore,pA=td.useRef,fA=td.useEffect,mA=td.useMemo,gA=td.useDebugValue;Xx.useSyncExternalStoreWithSelector=function(n,a,u,g,_){var w=pA(null);if(w.current===null){var T={hasValue:!1,value:null};w.current=T}else T=w.current;w=mA(function(){function O(de){if(!D){if(D=!0,V=de,de=g(de),_!==void 0&&T.hasValue){var xe=T.value;if(_(xe,de))return K=xe}return K=de}if(xe=K,hA(V,de))return xe;var oe=g(de);return _!==void 0&&_(xe,oe)?xe:(V=de,K=oe)}var D=!1,V,K,ae=u===void 0?null:u;return[function(){return O(a())},ae===null?void 0:function(){return O(ae())}]},[a,u,g,_]);var l=dA(n,w[0],w[1]);return fA(function(){T.hasValue=!0,T.value=l},[l]),gA(l),l};(function(n){n.exports=Xx})(Wx);const yA=X_(Wx.exports),{useSyncExternalStoreWithSelector:_A}=yA;function Yx(n,a=n.getState,u){const g=_A(n.subscribe,n.getState,n.getServerState||n.getState,a,u);return Z.exports.useDebugValue(g),g}const z_=n=>{const a=typeof n=="function"?QI(n):n,u=(g,_)=>Yx(a,g,_);return Object.assign(u,a),u},Jx=n=>n?z_(n):z_;function Qx(){const n=Z.exports.createContext(void 0);return{Provider:({createStore:_,children:w})=>{const T=Z.exports.useRef();return T.current||(T.current=_()),Z.exports.createElement(n.Provider,{value:T.current},w)},useStore:(_,w)=>{const T=Z.exports.useContext(n);if(!T)throw new Error("Seems like you have not used zustand provider as an ancestor.");return Yx(T,_,w)},useStoreApi:()=>{const _=Z.exports.useContext(n);if(!_)throw new Error("Seems like you have not used zustand provider as an ancestor.");return Z.exports.useMemo(()=>({..._}),[_])}}}const ev=(n,a)=>(...u)=>Object.assign({},n,a(...u));var xA=function(){var n=document.getSelection();if(!n.rangeCount)return function(){};for(var a=document.activeElement,u=[],g=0;g<n.rangeCount;g++)u.push(n.getRangeAt(g));switch(a.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":a.blur();break;default:a=null;break}return n.removeAllRanges(),function(){n.type==="Caret"&&n.removeAllRanges(),n.rangeCount||u.forEach(function(_){n.addRange(_)}),a&&a.focus()}},vA=xA,D_={"text/plain":"Text","text/html":"Url",default:"Text"},bA="Copy to clipboard: #{key}, Enter";function wA(n){var a=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return n.replace(/#{\s*key\s*}/g,a)}function SA(n,a){var u,g,_,w,T,l,O=!1;a||(a={}),u=a.debug||!1;try{_=vA(),w=document.createRange(),T=document.getSelection(),l=document.createElement("span"),l.textContent=n,l.ariaHidden="true",l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",l.addEventListener("copy",function(V){if(V.stopPropagation(),a.format)if(V.preventDefault(),typeof V.clipboardData>"u"){u&&console.warn("unable to use e.clipboardData"),u&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var K=D_[a.format]||D_.default;window.clipboardData.setData(K,n)}else V.clipboardData.clearData(),V.clipboardData.setData(a.format,n);a.onCopy&&(V.preventDefault(),a.onCopy(V.clipboardData))}),document.body.appendChild(l),w.selectNodeContents(l),T.addRange(w);var D=document.execCommand("copy");if(!D)throw new Error("copy command was unsuccessful");O=!0}catch(V){u&&console.error("unable to copy using execCommand: ",V),u&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(a.format||"text",n),a.onCopy&&a.onCopy(window.clipboardData),O=!0}catch(K){u&&console.error("unable to copy using clipboardData: ",K),u&&console.error("falling back to prompt"),g=wA("message"in a?a.message:bA),window.prompt(g,n)}}finally{T&&(typeof T.removeRange=="function"?T.removeRange(w):T.removeAllRanges()),l&&document.body.removeChild(l),_()}return O}var R_=SA,tv={},rd={},pm={exports:{}},rv={exports:{}};(function(n,a){(function(u,g){n.exports=g()})(Ec,function(){var u=typeof Promise=="function",g=typeof self=="object"?self:Ec,_=typeof Symbol<"u",w=typeof Map<"u",T=typeof Set<"u",l=typeof WeakMap<"u",O=typeof WeakSet<"u",D=typeof DataView<"u",V=_&&typeof Symbol.iterator<"u",K=_&&typeof Symbol.toStringTag<"u",ae=T&&typeof Set.prototype.entries=="function",de=w&&typeof Map.prototype.entries=="function",xe=ae&&Object.getPrototypeOf(new Set().entries()),oe=de&&Object.getPrototypeOf(new Map().entries()),_e=V&&typeof Array.prototype[Symbol.iterator]=="function",ge=_e&&Object.getPrototypeOf([][Symbol.iterator]()),Ie=V&&typeof String.prototype[Symbol.iterator]=="function",De=Ie&&Object.getPrototypeOf(""[Symbol.iterator]()),We=8,Me=-1;function Re(Ce){var Ze=typeof Ce;if(Ze!=="object")return Ze;if(Ce===null)return"null";if(Ce===g)return"global";if(Array.isArray(Ce)&&(K===!1||!(Symbol.toStringTag in Ce)))return"Array";if(typeof window=="object"&&window!==null){if(typeof window.location=="object"&&Ce===window.location)return"Location";if(typeof window.document=="object"&&Ce===window.document)return"Document";if(typeof window.navigator=="object"){if(typeof window.navigator.mimeTypes=="object"&&Ce===window.navigator.mimeTypes)return"MimeTypeArray";if(typeof window.navigator.plugins=="object"&&Ce===window.navigator.plugins)return"PluginArray"}if((typeof window.HTMLElement=="function"||typeof window.HTMLElement=="object")&&Ce instanceof window.HTMLElement){if(Ce.tagName==="BLOCKQUOTE")return"HTMLQuoteElement";if(Ce.tagName==="TD")return"HTMLTableDataCellElement";if(Ce.tagName==="TH")return"HTMLTableHeaderCellElement"}}var yt=K&&Ce[Symbol.toStringTag];if(typeof yt=="string")return yt;var $e=Object.getPrototypeOf(Ce);return $e===RegExp.prototype?"RegExp":$e===Date.prototype?"Date":u&&$e===Promise.prototype?"Promise":T&&$e===Set.prototype?"Set":w&&$e===Map.prototype?"Map":O&&$e===WeakSet.prototype?"WeakSet":l&&$e===WeakMap.prototype?"WeakMap":D&&$e===DataView.prototype?"DataView":w&&$e===oe?"Map Iterator":T&&$e===xe?"Set Iterator":_e&&$e===ge?"Array Iterator":Ie&&$e===De?"String Iterator":$e===null?"Object":Object.prototype.toString.call(Ce).slice(We,Me)}return Re})})(rv);/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */var L_=rv.exports;function nv(){this._key="chai/deep-eql__"+Math.random()+Date.now()}nv.prototype={get:function(a){return a[this._key]},set:function(a,u){Object.isExtensible(a)&&Object.defineProperty(a,this._key,{value:u,configurable:!0})}};var fm=typeof WeakMap=="function"?WeakMap:nv;/*!
 * Check to see if the MemoizeMap has recorded a result of the two operands
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @returns {Boolean|null} result
*/function F_(n,a,u){if(!u||hl(n)||hl(a))return null;var g=u.get(n);if(g){var _=g.get(a);if(typeof _=="boolean")return _}return null}/*!
 * Set the result of the equality into the MemoizeMap
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {MemoizeMap} memoizeMap
 * @param {Boolean} result
*/function Xu(n,a,u,g){if(!(!u||hl(n)||hl(a))){var _=u.get(n);_?_.set(a,g):(_=new fm,_.set(a,g),u.set(n,_))}}/*!
 * Primary Export
 */pm.exports=nd;pm.exports.MemoizeMap=fm;function nd(n,a,u){if(u&&u.comparator)return B_(n,a,u);var g=iv(n,a);return g!==null?g:B_(n,a,u)}function iv(n,a){return n===a?n!==0||1/n===1/a:n!==n&&a!==a?!0:hl(n)||hl(a)?!1:null}/*!
 * The main logic of the `deepEqual` function.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (optional) Additional options
 * @param {Array} [options.comparator] (optional) Override default algorithm, determining custom equality.
 * @param {Array} [options.memoize] (optional) Provide a custom memoization object which will cache the results of
    complex objects for a speed boost. By passing `false` you can disable memoization, but this will cause circular
    references to blow the stack.
 * @return {Boolean} equal match
*/function B_(n,a,u){u=u||{},u.memoize=u.memoize===!1?!1:u.memoize||new fm;var g=u&&u.comparator,_=F_(n,a,u.memoize);if(_!==null)return _;var w=F_(a,n,u.memoize);if(w!==null)return w;if(g){var T=g(n,a);if(T===!1||T===!0)return Xu(n,a,u.memoize,T),T;var l=iv(n,a);if(l!==null)return l}var O=L_(n);if(O!==L_(a))return Xu(n,a,u.memoize,!1),!1;Xu(n,a,u.memoize,!0);var D=EA(n,a,O,u);return Xu(n,a,u.memoize,D),D}function EA(n,a,u,g){switch(u){case"String":case"Number":case"Boolean":case"Date":return nd(n.valueOf(),a.valueOf());case"Promise":case"Symbol":case"function":case"WeakMap":case"WeakSet":return n===a;case"Error":return ov(n,a,["name","message","code"],g);case"Arguments":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"Array":return is(n,a,g);case"RegExp":return TA(n,a);case"Generator":return CA(n,a,g);case"DataView":return is(new Uint8Array(n.buffer),new Uint8Array(a.buffer),g);case"ArrayBuffer":return is(new Uint8Array(n),new Uint8Array(a),g);case"Set":return O_(n,a,g);case"Map":return O_(n,a,g);case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.Instant":case"Temporal.ZonedDateTime":case"Temporal.PlainYearMonth":case"Temporal.PlainMonthDay":return n.equals(a);case"Temporal.Duration":return n.total("nanoseconds")===a.total("nanoseconds");case"Temporal.TimeZone":case"Temporal.Calendar":return n.toString()===a.toString();default:return IA(n,a,g)}}/*!
 * Compare two Regular Expressions for equality.
 *
 * @param {RegExp} leftHandOperand
 * @param {RegExp} rightHandOperand
 * @return {Boolean} result
 */function TA(n,a){return n.toString()===a.toString()}/*!
 * Compare two Sets/Maps for equality. Faster than other equality functions.
 *
 * @param {Set} leftHandOperand
 * @param {Set} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function O_(n,a,u){if(n.size!==a.size)return!1;if(n.size===0)return!0;var g=[],_=[];return n.forEach(function(T,l){g.push([T,l])}),a.forEach(function(T,l){_.push([T,l])}),is(g.sort(),_.sort(),u)}/*!
 * Simple equality for flat iterable objects such as Arrays, TypedArrays or Node.js buffers.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function is(n,a,u){var g=n.length;if(g!==a.length)return!1;if(g===0)return!0;for(var _=-1;++_<g;)if(nd(n[_],a[_],u)===!1)return!1;return!0}/*!
 * Simple equality for generator objects such as those returned by generator functions.
 *
 * @param {Iterable} leftHandOperand
 * @param {Iterable} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function CA(n,a,u){return is(bf(n),bf(a),u)}/*!
 * Determine if the given object has an @@iterator function.
 *
 * @param {Object} target
 * @return {Boolean} `true` if the object has an @@iterator function.
 */function kA(n){return typeof Symbol<"u"&&typeof n=="object"&&typeof Symbol.iterator<"u"&&typeof n[Symbol.iterator]=="function"}/*!
 * Gets all iterator entries from the given Object. If the Object has no @@iterator function, returns an empty array.
 * This will consume the iterator - which could have side effects depending on the @@iterator implementation.
 *
 * @param {Object} target
 * @returns {Array} an array of entries from the @@iterator function
 */function $_(n){if(kA(n))try{return bf(n[Symbol.iterator]())}catch{return[]}return[]}/*!
 * Gets all entries from a Generator. This will consume the generator - which could have side effects.
 *
 * @param {Generator} target
 * @returns {Array} an array of entries from the Generator.
 */function bf(n){for(var a=n.next(),u=[a.value];a.done===!1;)a=n.next(),u.push(a.value);return u}/*!
 * Gets all own and inherited enumerable keys from a target.
 *
 * @param {Object} target
 * @returns {Array} an array of own and inherited enumerable keys from the target.
 */function U_(n){var a=[];for(var u in n)a.push(u);return a}function N_(n){var a=Object.getOwnPropertySymbols(n);return a}/*!
 * Determines if two objects have matching values, given a set of keys. Defers to deepEqual for the equality check of
 * each key. If any value of the given key is not equal, the function will return false (early).
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Array} keys An array of keys to compare the values of leftHandOperand and rightHandOperand against
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function ov(n,a,u,g){var _=u.length;if(_===0)return!0;for(var w=0;w<_;w+=1)if(nd(n[u[w]],a[u[w]],g)===!1)return!1;return!0}/*!
 * Recursively check the equality of two Objects. Once basic sameness has been established it will defer to `deepEqual`
 * for each enumerable key in the object.
 *
 * @param {Mixed} leftHandOperand
 * @param {Mixed} rightHandOperand
 * @param {Object} [options] (Optional)
 * @return {Boolean} result
 */function IA(n,a,u){var g=U_(n),_=U_(a),w=N_(n),T=N_(a);if(g=g.concat(w),_=_.concat(T),g.length&&g.length===_.length)return is(V_(g).sort(),V_(_).sort())===!1?!1:ov(n,a,g,u);var l=$_(n),O=$_(a);return l.length&&l.length===O.length?(l.sort(),O.sort(),is(l,O,u)):g.length===0&&l.length===0&&_.length===0&&O.length===0}/*!
 * Returns true if the argument is a primitive.
 *
 * This intentionally returns true for all objects that can be compared by reference,
 * including functions and symbols.
 *
 * @param {Mixed} value
 * @return {Boolean} result
 */function hl(n){return n===null||typeof n!="object"}function V_(n){return n.map(function(u){return typeof u=="symbol"?u.toString():u})}var id={};Object.defineProperty(id,"__esModule",{value:!0});id.findOrCreate=void 0;function AA(n,a,u){const g=n.findIndex(w=>a(w));if(g>=0)return n[g];const _=u();return n.push(_),_}id.findOrCreate=AA;var od={};Object.defineProperty(od,"__esModule",{value:!0});od.asArraysFactory=void 0;function PA(n){return()=>n.map(a=>a.items)}od.asArraysFactory=PA;var ad={};Object.defineProperty(ad,"__esModule",{value:!0});ad.asEntriesFactory=void 0;function MA(n){return a=>{var u,g;const _=(u=a==null?void 0:a.keyName)!==null&&u!==void 0?u:"key",w=(g=a==null?void 0:a.itemsName)!==null&&g!==void 0?g:"items";return n.map(T=>({[_]:T.key,[w]:T.items}))}}ad.asEntriesFactory=MA;var sd={};Object.defineProperty(sd,"__esModule",{value:!0});sd.asMapFactory=void 0;function zA(n){return()=>{const a=new Map;for(const u of n)a.set(u.key,u.items);return a}}sd.asMapFactory=zA;var ld={};Object.defineProperty(ld,"__esModule",{value:!0});ld.asObjectFactory=void 0;function DA(n){return typeof n=="string"||typeof n=="number"||typeof n=="symbol"}function RA(n){return()=>{const a={};for(const u of n)DA(u.key)&&(a[u.key]=u.items);return a}}ld.asObjectFactory=RA;var cd={};Object.defineProperty(cd,"__esModule",{value:!0});cd.asTuplesFactory=void 0;function LA(n){return()=>n.map(a=>[a.key,a.items])}cd.asTuplesFactory=LA;var ud={};Object.defineProperty(ud,"__esModule",{value:!0});ud.keysFactory=void 0;function FA(n){return()=>n.map(a=>a.key)}ud.keysFactory=FA;var BA=Ec&&Ec.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rd,"__esModule",{value:!0});rd.group=void 0;const OA=BA(pm.exports),$A=id,UA=od,NA=ad,VA=sd,jA=ld,qA=cd,GA=ud;function ZA(n,a){const u=[];let g=0;for(const _ of n){const w=a(_,g);g++;const T=O=>(0,OA.default)(O.key,w),l=()=>({key:w,items:[]});(0,$A.findOrCreate)(u,T,l).items.push(_)}return u}function WA(n){return Object.freeze({by:u=>{const _=ZA(n,typeof u=="function"?u:w=>w[u]);return Object.freeze({asArrays:(0,UA.asArraysFactory)(_),asEntries:(0,NA.asEntriesFactory)(_),asMap:(0,VA.asMapFactory)(_),asObject:(0,jA.asObjectFactory)(_),asTuples:(0,qA.asTuplesFactory)(_),keys:(0,GA.keysFactory)(_)})}})}rd.group=WA;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.group=void 0;var a=rd;Object.defineProperty(n,"group",{enumerable:!0,get:function(){return a.group}})})(tv);const mm={scheme:"Light Theme",author:"mac gainor (https://github.com/mac-s-g)",base00:"rgba(0, 0, 0, 0)",base01:"rgb(245, 245, 245)",base02:"rgb(235, 235, 235)",base03:"#93a1a1",base04:"rgba(0, 0, 0, 0.3)",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#d33682",base09:"#cb4b16",base0A:"#dc322f",base0B:"#859900",base0C:"#6c71c4",base0D:"#586e75",base0E:"#2aa198",base0F:"#268bd2"},av={scheme:"Dark Theme",author:"Chris Kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},sv=()=>null;sv.when=()=>!1;var Op,$p,Up,Np,Vp,jp,qp,Gp,Zp,Wp,Xp,Kp,Hp,Yp,Jp;const XA=n=>Jx(ev({enableClipboard:(Op=n.enableClipboard)!==null&&Op!==void 0?Op:!0,indentWidth:($p=n.indentWidth)!==null&&$p!==void 0?$p:3,groupArraysAfterLength:(Up=n.groupArraysAfterLength)!==null&&Up!==void 0?Up:100,collapseStringsAfterLength:n.collapseStringsAfterLength===!1?Number.MAX_VALUE:(Np=n.collapseStringsAfterLength)!==null&&Np!==void 0?Np:50,maxDisplayLength:(Vp=n.maxDisplayLength)!==null&&Vp!==void 0?Vp:30,rootName:(jp=n.rootName)!==null&&jp!==void 0?jp:"root",onChange:(qp=n.onChange)!==null&&qp!==void 0?qp:()=>{},onCopy:(Gp=n.onCopy)!==null&&Gp!==void 0?Gp:void 0,keyRenderer:(Zp=n.keyRenderer)!==null&&Zp!==void 0?Zp:sv,editable:(Wp=n.editable)!==null&&Wp!==void 0?Wp:!1,defaultInspectDepth:(Xp=n.defaultInspectDepth)!==null&&Xp!==void 0?Xp:5,objectSortKeys:(Kp=n.objectSortKeys)!==null&&Kp!==void 0?Kp:!1,quotesOnKeys:(Hp=n.quotesOnKeys)!==null&&Hp!==void 0?Hp:!0,displayDataTypes:(Yp=n.displayDataTypes)!==null&&Yp!==void 0?Yp:!0,inspectCache:{},hoverPath:null,colorspace:mm,value:n.value,displayObjectSize:(Jp=n.displayObjectSize)!==null&&Jp!==void 0?Jp:!0},(a,u)=>({getInspectCache:(g,_)=>{const w=_!==void 0?g.join(".")+`[${_}]nt`:g.join(".");return u().inspectCache[w]},setInspectCache:(g,_,w)=>{const T=w!==void 0?g.join(".")+`[${w}]nt`:g.join(".");a(l=>({inspectCache:{...l.inspectCache,[T]:typeof _=="function"?_(l.inspectCache[T]):_}}))},setHover:(g,_)=>{a({hoverPath:g?{path:g,nestedIndex:_}:null})}}))),{useStore:Ut,useStoreApi:lv,Provider:KA}=Qx(),gm=()=>Ut(n=>n.colorspace.base07);function HA({timeout:n=2e3}={}){const[a,u]=Z.exports.useState(!1),g=Z.exports.useRef(null),_=Z.exports.useCallback(O=>{const D=g.current;D&&window.clearTimeout(D),g.current=window.setTimeout(()=>u(!1),n),u(O)},[n]),w=Ut(O=>O.onCopy),T=Z.exports.useCallback((O,D)=>{if(typeof w=="function")try{const V=w(O,D);V instanceof Promise?V.then(()=>{_(!0)}).catch(K=>{console.error(`error when copy ${O.length===0?"src":`src[${O.join(".")}`}]`,K)}):_(!0)}catch(V){console.error(`error when copy ${O.length===0?"src":`src[${O.join(".")}`}]`,V)}else{const V=JSON.stringify(typeof D=="function"?D.toString():D,null,"  ");"clipboard"in navigator?navigator.clipboard.writeText(V).then(()=>_(!0)).catch(()=>R_(V)):R_(V)}},[_,w]),l=Z.exports.useCallback(()=>{u(!1),g.current&&clearTimeout(g.current)},[]);return{copy:T,reset:l,copied:a}}const YA=(n,a,u)=>{if(n===null||u===null||typeof n!="object"||typeof u!="object")return!1;if(Object.is(n,u)&&a.length!==0)return"";const g=[],_=[...a];let w=n;for(;w!==u||_.length!==0;){if(typeof w!="object"||w===null)return!1;if(Object.is(w,u))return g.reduce((l,O,D)=>typeof O=="number"?l+`[${O}]`:l+`${D===0?"":"."}${O}`,"");const T=_.shift();g.push(T),w=w[T]}return!1};function ym(n,a){const u=Ut(g=>g.value);return Z.exports.useMemo(()=>YA(u,n,a),[n,a,u])}function JA(n,a,u){const g=n.length,_=ym(n,a),w=Ut(K=>K.getInspectCache),T=Ut(K=>K.setInspectCache),l=Ut(K=>K.defaultInspectDepth);Z.exports.useEffect(()=>{if(w(n,u)===void 0)if(u!==void 0)T(n,!1,u);else{const ae=_?!1:g<l;T(n,ae)}},[l,g,w,_,u,n,T]);const[O,D]=Z.exports.useState(()=>{const K=w(n,u);return K!==void 0?K:u!==void 0||_?!1:g<l}),V=Z.exports.useCallback(K=>{D(ae=>{const de=typeof K=="boolean"?K:K(ae);return T(n,de,u),de})},[u,n,T]);return[O,V]}class QA extends Error{constructor(a){super(a?`${a}
`:`The behavior is not expected and not allowed.
If you see this in development, please fix the error ASAP.
If you see this in production, please contract our customer service.
`)}}const ha=ml(n=>ut(Kr,{component:"div",...n}))`
  display: inline-block;
`,cv=({dataType:n,enable:a=!0})=>a?ut(ha,{className:"data-type-label",sx:{mx:.5,fontSize:"0.7rem",opacity:.8},children:n}):null;function Fo(n,a,u){var g;const _=(g=u.displayTypeLabel)!==null&&g!==void 0?g:!0,w=Bt.memo(a),T=D=>{const V=Ut(ae=>ae.displayDataTypes),K=Ut(ae=>ae.colorspace[u.colorKey]);return Gn(ha,{sx:{color:K},children:[_&&V&&ut(cv,{dataType:n}),ut(ha,{className:`${n}-value`,children:ut(w,{value:D.value})})]})};if(T.displayName=`easy-${n}-type`,!u.fromString)return{Component:T};const l=u.fromString,O=({value:D,setValue:V})=>{const K=Ut(ae=>ae.colorspace[u.colorKey]);return ut(GI,{value:`${D}`,onChange:Z.exports.useCallback(ae=>{const de=l(ae.target.value);V(de)},[V]),size:"small",multiline:!0,sx:{color:K,padding:.5,borderStyle:"solid",borderColor:"black",borderWidth:1,fontSize:"0.8rem",fontFamily:"monospace",display:"inline-flex"}})};return O.displayName=`easy-${n}-type-editor`,{Component:T,Editor:O}}const eP=n=>{const a=n.toString();let u=!0;const g=a.indexOf(")"),_=a.indexOf("=>");return _!==-1&&_>g&&(u=!1),u?a.substring(a.indexOf("{",g)+1,a.lastIndexOf("}")):a.substring(a.indexOf("=>")+2)},tP=n=>{const a=n.toString();return a.indexOf("function")!==-1?a.substring(8,a.indexOf("{")).trim():a.substring(0,a.indexOf("=>")+2).trim()},rP="{",nP="}",iP=n=>Gn(dm,{children:[ut(cv,{dataType:"function"}),Gn(Kr,{component:"span",className:"data-function-start",sx:{letterSpacing:.5},children:[tP(n.value)," ",rP]})]}),oP=()=>ut(dm,{children:ut(Kr,{component:"span",className:"data-function-end",children:nP})}),aP=n=>{const a=Ut(u=>u.colorspace.base05);return ut(dm,{children:ut(Kr,{className:"data-function",sx:{display:n.inspect?"block":"inline-block",pl:n.inspect?2:0,color:a},children:n.inspect?eP(n.value):ut(Kr,{component:"span",className:"data-function-body",onClick:()=>n.setInspect(!0),sx:{"&:hover":{cursor:"pointer"}},children:"..."})})})},sP=n=>ut(xf,{...n,children:ut("path",{d:"M 12 2 C 10.615 1.998 9.214625 2.2867656 7.890625 2.8847656 L 8.9003906 4.6328125 C 9.9043906 4.2098125 10.957 3.998 12 4 C 15.080783 4 17.738521 5.7633175 19.074219 8.3222656 L 17.125 9 L 21.25 11 L 22.875 7 L 20.998047 7.6523438 C 19.377701 4.3110398 15.95585 2 12 2 z M 6.5097656 4.4882812 L 2.2324219 5.0820312 L 3.734375 6.3808594 C 1.6515335 9.4550558 1.3615962 13.574578 3.3398438 17 C 4.0308437 18.201 4.9801562 19.268234 6.1601562 20.115234 L 7.1699219 18.367188 C 6.3019219 17.710187 5.5922656 16.904 5.0722656 16 C 3.5320014 13.332354 3.729203 10.148679 5.2773438 7.7128906 L 6.8398438 9.0625 L 6.5097656 4.4882812 z M 19.929688 13 C 19.794687 14.08 19.450734 15.098 18.927734 16 C 17.386985 18.668487 14.531361 20.090637 11.646484 19.966797 L 12.035156 17.9375 L 8.2402344 20.511719 L 10.892578 23.917969 L 11.265625 21.966797 C 14.968963 22.233766 18.681899 20.426323 20.660156 17 C 21.355156 15.801 21.805219 14.445 21.949219 13 L 19.929688 13 z"})}),lP="{",cP="[",uP="}",hP="]";function uv(n){let a,u="";return Array.isArray(n)?a=n.length:n instanceof Map||n instanceof Set?(u=n[Symbol.toStringTag],a=n.size):a=Object.keys(n).length,Object.prototype.hasOwnProperty.call(n,Symbol.toStringTag)&&(u=n[Symbol.toStringTag]),`${a} Items${u?` (${u})`:""}`}const dP=n=>{const a=Ut(l=>l.colorspace.base04),u=gm(),g=Z.exports.useMemo(()=>Array.isArray(n.value),[n.value]),_=Z.exports.useMemo(()=>n.inspect?uv(n.value):"",[n.inspect,n.value]),w=Ut(l=>l.displayObjectSize),T=ym(n.path,n.value);return Gn(Kr,{component:"span",className:"data-object-start",sx:{letterSpacing:.5},children:[g?cP:lP,w?ut(Kr,{component:"span",sx:{pl:.5,fontStyle:"italic",color:a},children:_}):null,T&&!n.inspect?Gn(bi,{children:[ut(sP,{sx:{fontSize:12,color:u,mx:.5}}),T]}):null]})},pP=n=>{const a=Ut(w=>w.colorspace.base04),u=Z.exports.useMemo(()=>Array.isArray(n.value),[n.value]),g=Ut(w=>w.displayObjectSize),_=Z.exports.useMemo(()=>n.inspect?"":uv(n.value),[n.inspect,n.value]);return Gn(Kr,{component:"span",className:"data-object-end",children:[u?hP:uP,g?ut(Kr,{component:"span",sx:{pl:.5,fontStyle:"italic",color:a},children:_}):null]})};function fP(n){return typeof(n==null?void 0:n[Symbol.iterator])=="function"}const mP=n=>{const a=gm(),u=Ut(ae=>ae.colorspace.base02),g=Ut(ae=>ae.groupArraysAfterLength),_=ym(n.path,n.value),[w,T]=Z.exports.useState(Ut(ae=>ae.maxDisplayLength)),l=Ut(ae=>ae.objectSortKeys),O=Z.exports.useMemo(()=>{if(!n.inspect)return null;const ae=n.value;if(fP(ae)&&!Array.isArray(ae)){const _e=[];if(ae instanceof Map)for(const ge of ae){const[Ie,De]=ge,We=`${Ie}`;_e.push(ut(sl,{path:[...n.path,We],value:De,editable:!1},We))}else{let ge=0;for(const Ie of ae)_e.push(ut(sl,{path:[...n.path,`iterator:${ge}`],value:Ie,nestedIndex:ge,editable:!1},ge)),ge++}return _e}if(Array.isArray(ae)){if(ae.length<=g){const ge=ae.slice(0,w).map((Ie,De)=>{const We=[...n.path,De];return ut(sl,{path:We,value:Ie},De)});if(ae.length>w){const Ie=ae.length-w;ge.push(Gn(ha,{sx:{cursor:"pointer",lineHeight:1.5,color:a,letterSpacing:.5,opacity:.8},onClick:()=>T(De=>De*2),children:["hidden ",Ie," items..."]},"last"))}return ge}return tv.group(ae).by((ge,Ie)=>Math.floor(Ie/g)).asArrays().map((ge,Ie)=>{const De=[...n.path];return ut(sl,{path:De,value:ge,nestedIndex:Ie},Ie)})}let xe=Object.entries(ae);l&&(xe=xe.sort(([_e],[ge])=>l===!0?_e.localeCompare(ge):l(_e,ge)));const oe=xe.slice(0,w).map(([_e,ge])=>{const Ie=[...n.path,_e];return ut(sl,{path:Ie,value:ge},_e)});if(xe.length>w){const _e=xe.length-w;oe.push(Gn(ha,{sx:{cursor:"pointer",lineHeight:1.5,color:a,letterSpacing:.5,opacity:.8},onClick:()=>T(ge=>ge*2),children:["hidden ",_e," items..."]},"last"))}return oe},[n.inspect,n.value,n.path,g,w,a,l]),D=n.inspect?.6:0,V=Ut(ae=>ae.indentWidth),K=n.inspect?V-D:V;return ut(Kr,{className:"data-object",sx:{display:n.inspect?"block":"inline-block",pl:n.inspect?K-.6:0,marginLeft:D,color:a,borderLeft:n.inspect?`1px solid ${u}`:"none"},children:n.inspect?O:_?null:ut(Kr,{component:"span",className:"data-object-body",onClick:()=>n.setInspect(!0),sx:{"&:hover":{cursor:"pointer"}},children:"..."})})},gP=()=>Jx(ev({registry:[]},n=>({registerTypes:a=>{n(u=>({registry:typeof a=="function"?a(u.registry):a}))}}))),{Provider:yP,useStore:hv,useStoreApi:SM}=Qx(),_P={is:n=>typeof n=="object",Component:mP,PreComponent:dP,PostComponent:pP};function xP(n,a,u){let g;for(const _ of u)if(_.is(n,a)&&(g=_,typeof n=="object"))return _;if(g===void 0){if(typeof n=="object")return _P;throw new QA("this is not possible")}return g}function vP(n,a){const u=hv(g=>g.registry);return Z.exports.useMemo(()=>xP(n,a,u),[n,a,u])}function bP(){const n=[];function a(_){function w(T,l){var O,D;return Object.is(T.value,l.value)&&T.inspect&&l.inspect&&((O=T.path)===null||O===void 0?void 0:O.join("."))===((D=l.path)===null||D===void 0?void 0:D.join("."))}_.Component=Z.exports.memo(_.Component,w),_.Editor&&(_.Editor=Z.exports.memo(_.Editor,function(l,O){return Object.is(l.value,O.value)})),_.PreComponent&&(_.PreComponent=Z.exports.memo(_.PreComponent,w)),_.PostComponent&&(_.PostComponent=Z.exports.memo(_.PostComponent,w)),n.push(_)}a({is:_=>typeof _=="boolean",...Fo("bool",({value:_})=>ut(bi,{children:_?"true":"false"}),{colorKey:"base0E",fromString:_=>Boolean(_)})});const u={weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};a({is:_=>_ instanceof Date,...Fo("date",({value:_})=>ut(bi,{children:_.toLocaleTimeString("en-us",u)}),{colorKey:"base0D"})}),a({is:_=>_===null,...Fo("null",()=>{const _=Ut(w=>w.colorspace.base02);return ut(Kr,{sx:{fontSize:"0.8rem",backgroundColor:_,fontWeight:"bold",borderRadius:"3px",padding:"0.5px 2px"},children:"NULL"})},{colorKey:"base08",displayTypeLabel:!1})}),a({is:_=>_===void 0,...Fo("undefined",()=>{const _=Ut(w=>w.colorspace.base02);return ut(Kr,{sx:{fontSize:"0.7rem",backgroundColor:_,borderRadius:"3px",padding:"0.5px 2px"},children:"undefined"})},{colorKey:"base05",displayTypeLabel:!1})}),a({is:_=>typeof _=="string",...Fo("string",_=>{const[w,T]=Z.exports.useState(!1),l=Ut(V=>V.collapseStringsAfterLength),O=w?_.value:_.value.slice(0,l),D=_.value.length>l;return Gn(Kr,{component:"span",sx:{overflowWrap:"anywhere",cursor:D?"pointer":"inherit"},onClick:()=>{T(V=>!V)},children:['"',O,w?ut("span",{children:"..."}):ut(bi,{}),'"']})},{colorKey:"base09",fromString:_=>_})}),a({is:_=>typeof _=="function",Component:aP,PreComponent:iP,PostComponent:oP});const g=_=>_%1===0;return a({is:_=>typeof _=="number"&&isNaN(_),...Fo("NaN",()=>{const _=Ut(w=>w.colorspace.base02);return ut(Kr,{sx:{backgroundColor:_,fontSize:"0.8rem",fontWeight:"bold",borderRadius:"3px"},children:"NaN"})},{colorKey:"base08",displayTypeLabel:!1})}),a({is:_=>typeof _=="number"&&!g(_),...Fo("float",({value:_})=>ut(bi,{children:`${_}`}),{colorKey:"base0B",fromString:_=>parseFloat(_)})}),a({is:_=>typeof _=="number"&&g(_),...Fo("int",({value:_})=>ut(bi,{children:`${_}`}),{colorKey:"base0F",fromString:_=>parseInt(_)})}),a({is:_=>typeof _=="bigint",...Fo("bigint",({value:_})=>ut(bi,{children:`${_}n`}),{colorKey:"base0F",fromString:_=>BigInt(_.replace(/\D/g,""))})}),n}const Ku=ml(n=>ut(Kr,{...n,component:"span"}))`
  cursor: pointer;
  padding-left: 0.7rem;
`,sl=n=>{const{value:a,path:u,nestedIndex:g}=n;var _;const w=(_=n.editable)!==null&&_!==void 0?_:void 0,T=Ut(Ct=>Ct.editable),l=Z.exports.useMemo(()=>T===!1||w===!1?!1:typeof T=="function"?!!T(u,a):T,[u,w,T,a]),[O,D]=Z.exports.useState(typeof a=="function"?()=>a:a),V=u.length,K=u[V-1],ae=Ut(Ct=>Ct.hoverPath),de=Z.exports.useMemo(()=>ae&&u.every((Ct,Ar)=>Ct===ae.path[Ar]&&g===ae.nestedIndex),[ae,u,g]),xe=Ut(Ct=>Ct.setHover),oe=Ut(Ct=>Ct.value),[_e,ge]=JA(u,a,g),[Ie,De]=Z.exports.useState(!1),We=Ut(Ct=>Ct.onChange),Me=gm(),Re=Ut(Ct=>Ct.colorspace.base0C),{Component:Ce,PreComponent:Ze,PostComponent:yt,Editor:$e}=vP(a,u),Ot=Ut(Ct=>Ct.quotesOnKeys),Mt=Ut(Ct=>Ct.rootName),or=oe===a,Xt=Number.isInteger(Number(K)),Lr=Ut(Ct=>Ct.enableClipboard),{copy:Vr,copied:gn}=HA(),yn=Z.exports.useMemo(()=>Ie?Gn(bi,{children:[ut(Ku,{children:ut(KI,{sx:{fontSize:".8rem"},onClick:()=>{De(!1),D(a)}})}),ut(Ku,{children:ut(P_,{sx:{fontSize:".8rem"},onClick:()=>{De(!1),We(u,a,O)}})})]}):Gn(bi,{children:[Lr&&ut(Ku,{onClick:Ct=>{Ct.preventDefault();try{Vr(u,a)}catch(Ar){console.error(Ar)}},children:gn?ut(P_,{sx:{fontSize:".8rem"}}):ut(HI,{sx:{fontSize:".8rem"}})}),$e&&l&&ut(Ku,{onClick:Ct=>{Ct.preventDefault(),De(!0)},children:ut(YI,{sx:{fontSize:".8rem"}})})]}),[$e,gn,Vr,l,Ie,Lr,We,u,O,a]),_n=!!(Ze&&yt),Mn=Ut(Ct=>Ct.keyRenderer),Yr=Z.exports.useMemo(()=>({path:u,inspect:_e,setInspect:ge,value:a}),[_e,u,ge,a]);return Gn(Kr,{className:"data-key-pair","data-testid":"data-key-pair"+u.join("."),onMouseEnter:Z.exports.useCallback(()=>xe(u,g),[xe,u,g]),children:[Gn(ha,{component:"span",className:"data-key",sx:{lineHeight:1.5,color:Me,letterSpacing:.5,opacity:.8},onClick:Z.exports.useCallback(Ct=>{Ct.isDefaultPrevented()||ge(Ar=>!Ar)},[ge]),children:[_n?_e?ut(JI,{sx:{fontSize:".8rem","&:hover":{cursor:"pointer"}}}):ut(XI,{sx:{fontSize:".8rem","&:hover":{cursor:"pointer"}}}):null,or?Mt!==!1?Ot?Gn(bi,{children:['"',Mt,'"']}):ut(bi,{children:Mt}):null:Mn.when(Yr)?ut(Mn,{...Yr}):g===void 0&&(Xt?ut(Kr,{component:"span",style:{color:Re},children:K}):Ot?Gn(bi,{children:['"',K,'"']}):ut(bi,{children:K})),or?Mt!==!1?ut(ha,{sx:{mx:.5},children:":"}):null:g===void 0&&ut(ha,{sx:{mx:.5},children:":"}),Ze&&ut(Ze,{...Yr}),de&&_n&&_e&&yn]}),Ie&&l?$e&&ut($e,{value:O,setValue:D}):Ce?ut(Ce,{...Yr}):ut(Kr,{component:"span",className:"data-value-fallback",children:`fallback: ${a}`}),yt&&ut(yt,{...Yr}),de&&_n&&!_e&&yn,de&&!_n&&yn]})},j_="(prefers-color-scheme: dark)";function wP(){const[n,a]=Z.exports.useState(!1);return Z.exports.useEffect(()=>{const u=_=>{a(_.matches)};a(window.matchMedia(j_).matches);const g=window.matchMedia(j_);return g.addEventListener("change",u),()=>g.removeEventListener("change",u)},[]),n}function Fi(n,a){const u=lv();Z.exports.useEffect(()=>{a!==void 0&&u.setState({[n]:a})},[n,a,u])}const SP=n=>{const a=lv();Fi("value",n.value),Fi("editable",n.editable),Fi("indentWidth",n.indentWidth),Fi("onChange",n.onChange),Fi("groupArraysAfterLength",n.groupArraysAfterLength),Fi("keyRenderer",n.keyRenderer),Fi("maxDisplayLength",n.maxDisplayLength),Fi("enableClipboard",n.enableClipboard),Fi("rootName",n.rootName),Fi("displayDataTypes",n.displayDataTypes),Fi("displayObjectSize",n.displayObjectSize),Fi("onCopy",n.onCopy),Z.exports.useEffect(()=>{n.theme==="light"?a.setState({colorspace:mm}):n.theme==="dark"?a.setState({colorspace:av}):typeof n.theme=="object"&&a.setState({colorspace:n.theme})},[a,n.theme]);const u=Z.exports.useRef(!0),g=Z.exports.useMemo(()=>bP(),[]),_=hv(O=>O.registerTypes);if(u.current){var w;const O=[...g];(w=n.valueTypes)===null||w===void 0||w.forEach(D=>{O.push(D)}),_(O),u.current=!1}Z.exports.useEffect(()=>{var O;const D=[...g];(O=n.valueTypes)===null||O===void 0||O.forEach(V=>{D.push(V)}),_(D)},[g,n.valueTypes,_]);const T=Ut(O=>O.value),l=Ut(O=>O.setHover);return ut(AI,{elevation:0,className:n.className,style:n.style,sx:{fontFamily:"monospace",userSelect:"none",contentVisibility:"auto"},onMouseLeave:Z.exports.useCallback(()=>{l(null)},[l]),children:ut(sl,{value:T,path:Z.exports.useMemo(()=>[],[])})})},EP=function(a){const u=wP();var g;const _=Z.exports.useMemo(()=>a.theme==="auto"?u?"light":"dark":(g=a.theme)!==null&&g!==void 0?g:"light",[u,a.theme]),w=Z.exports.useMemo(()=>{const l=typeof _=="object"?_.base00:_==="dark"?av.base00:mm.base00;return cm({components:{MuiPaper:{styleOverrides:{root:{backgroundColor:l}}}},palette:{mode:_==="dark"?"dark":"light",background:{default:l}}})},[_]),T={...a,theme:_};return ut(Uk,{theme:w,children:ut(yP,{createStore:gP,children:ut(KA,{createStore:()=>XA(a),children:ut(SP,{...T})})})})},TP=Hr("div",{padding:"2rem"}),CP=Hr("div",{paddingBottom:"2rem",fontFamily:"monospace"});function kP(n){const[a,u]=Z.exports.useState(),[g,_]=Z.exports.useState(null);return Z.exports.useEffect(()=>{const w=n.file;(async()=>{u(await w.getMetadata()),_(await w.getHeader())})()},[n.file]),wt(TP,{children:[g?wt(CP,{children:[wt("div",{children:["root directory: offset=",g.rootDirectoryOffset," len=",g.rootDirectoryLength]}),wt("div",{children:["metadata: offset=",g.jsonMetadataOffset," len=",g.jsonMetadataLength]}),wt("div",{children:["leaf directories: offset=",g.leafDirectoryOffset," len=",g.leafDirectoryLength]}),wt("div",{children:["tile data: offset=",g.tileDataOffset," len=",g.tileDataLength]}),wt("div",{children:["num addressed tiles: ",g.numAddressedTiles]}),wt("div",{children:["num tile entries: ",g.numTileEntries]}),wt("div",{children:["num tile contents: ",g.numTileContents]}),wt("div",{children:["clustered: ",g.clustered?"true":"false"]}),wt("div",{children:["internal compression: ",g.internalCompression]}),wt("div",{children:["tile compression: ",g.tileCompression]}),wt("div",{children:["tile type: ",g.tileType]}),wt("div",{children:["min zoom: ",g.minZoom]}),wt("div",{children:["max zoom: ",g.maxZoom]}),wt("div",{children:["min lon, min lat, max lon, max lat: ",g.minLon,", ",g.minLat,", ",g.maxLon,", ",g.maxLat]}),wt("div",{children:["center zoom: ",g.centerZoom]}),wt("div",{children:["center lon, center lat: ",g.centerLon,", ",g.centerLat]})]}):null,nt(EP,{value:a,theme:"dark",defaultInspectDepth:1})]})}const IP=Z.exports.forwardRef((n,a)=>{const{pressed:u,defaultPressed:g=!1,onPressedChange:_,...w}=n,[T=!1,l]=Lc({prop:u,onChange:_,defaultProp:g});return Z.exports.createElement(Si.button,Ve({type:"button","aria-pressed":T,"data-state":T?"on":"off","data-disabled":n.disabled?"":void 0},w,{ref:a,onClick:Wn(n.onClick,()=>{n.disabled||l(!T)})}))});function AP(n){const a=n+"CollectionProvider",[u,g]=Rc(a),[_,w]=u(a,{collectionRef:{current:null},itemMap:new Map}),T=ae=>{const{scope:de,children:xe}=ae,oe=Bt.useRef(null),_e=Bt.useRef(new Map).current;return Bt.createElement(_,{scope:de,itemMap:_e,collectionRef:oe},xe)},l=n+"CollectionSlot",O=Bt.forwardRef((ae,de)=>{const{scope:xe,children:oe}=ae,_e=w(l,xe),ge=da(de,_e.collectionRef);return Bt.createElement(ef,{ref:ge},oe)}),D=n+"CollectionItemSlot",V="data-radix-collection-item";return[{Provider:T,Slot:O,ItemSlot:Bt.forwardRef((ae,de)=>{const{scope:xe,children:oe,..._e}=ae,ge=Bt.useRef(null),Ie=da(de,ge),De=w(D,xe);return Bt.useEffect(()=>(De.itemMap.set(ge,{ref:ge,..._e}),()=>{De.itemMap.delete(ge)})),Bt.createElement(ef,{[V]:"",ref:Ie},oe)})},function(ae){const de=w(n+"CollectionConsumer",ae);return Bt.useCallback(()=>{const xe=de.collectionRef.current;if(!xe)return[];const oe=Array.from(xe.querySelectorAll(`[${V}]`));return Array.from(de.itemMap.values()).sort((_e,ge)=>oe.indexOf(_e.ref.current)-oe.indexOf(ge.ref.current))},[de.collectionRef,de.itemMap])},g]}const PP={bubbles:!1,cancelable:!0},[wf,dv,MP]=AP("RovingFocusGroup"),[zP,hd]=Rc("RovingFocusGroup",[MP]),[DP,RP]=zP("RovingFocusGroup"),LP=Z.exports.forwardRef((n,a)=>Z.exports.createElement(wf.Provider,{scope:n.__scopeRovingFocusGroup},Z.exports.createElement(wf.Slot,{scope:n.__scopeRovingFocusGroup},Z.exports.createElement(FP,Ve({},n,{ref:a}))))),FP=Z.exports.forwardRef((n,a)=>{const{__scopeRovingFocusGroup:u,orientation:g,dir:_="ltr",loop:w=!1,currentTabStopId:T,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:O,onEntryFocus:D,...V}=n,K=Z.exports.useRef(null),ae=da(a,K),[de=null,xe]=Lc({prop:T,defaultProp:l,onChange:O}),[oe,_e]=Z.exports.useState(!1),ge=pa(D),Ie=dv(u),De=Z.exports.useRef(!1);return Z.exports.useEffect(()=>{const We=K.current;if(We)return We.addEventListener("rovingFocusGroup.onEntryFocus",ge),()=>We.removeEventListener("rovingFocusGroup.onEntryFocus",ge)},[ge]),Z.exports.createElement(DP,{scope:u,orientation:g,dir:_,loop:w,currentTabStopId:de,onItemFocus:Z.exports.useCallback(We=>xe(We),[xe]),onItemShiftTab:Z.exports.useCallback(()=>_e(!0),[])},Z.exports.createElement(Si.div,Ve({tabIndex:oe?-1:0,"data-orientation":g},V,{ref:ae,style:{outline:"none",...n.style},onMouseDown:Wn(n.onMouseDown,()=>{De.current=!0}),onFocus:Wn(n.onFocus,We=>{const Me=!De.current;if(We.target===We.currentTarget&&Me&&!oe){const Re=new Event("rovingFocusGroup.onEntryFocus",PP);if(We.currentTarget.dispatchEvent(Re),!Re.defaultPrevented){const Ce=Ie().filter(Ze=>Ze.focusable);pv([Ce.find(Ze=>Ze.active),Ce.find(Ze=>Ze.id===de),...Ce].filter(Boolean).map(Ze=>Ze.ref.current))}}De.current=!1}),onBlur:Wn(n.onBlur,()=>_e(!1))})))}),BP=Z.exports.forwardRef((n,a)=>{const{__scopeRovingFocusGroup:u,focusable:g=!0,active:_=!1,...w}=n,T=Hu(),l=RP("RovingFocusGroupItem",u),O=l.currentTabStopId===T,D=dv(u);return Z.exports.createElement(wf.ItemSlot,{scope:u,id:T,focusable:g,active:_},Z.exports.createElement(Si.span,Ve({tabIndex:O?0:-1,"data-orientation":l.orientation},w,{ref:a,onMouseDown:Wn(n.onMouseDown,V=>{g?l.onItemFocus(T):V.preventDefault()}),onFocus:Wn(n.onFocus,()=>l.onItemFocus(T)),onKeyDown:Wn(n.onKeyDown,V=>{if(V.key==="Tab"&&V.shiftKey)return void l.onItemShiftTab();if(V.target!==V.currentTarget)return;const K=function(xe,oe,_e){const ge=function(Ie,De){return De!=="rtl"?Ie:Ie==="ArrowLeft"?"ArrowRight":Ie==="ArrowRight"?"ArrowLeft":Ie}(xe.key,_e);return oe==="vertical"&&["ArrowLeft","ArrowRight"].includes(ge)||oe==="horizontal"&&["ArrowUp","ArrowDown"].includes(ge)?void 0:OP[ge]}(V,l.orientation,l.dir);if(K!==void 0){V.preventDefault();let xe=D().filter(oe=>oe.focusable).map(oe=>oe.ref.current);if(K==="last")xe.reverse();else if(K==="prev"||K==="next"){K==="prev"&&xe.reverse();const oe=xe.indexOf(V.currentTarget);xe=l.loop?(de=oe+1,(ae=xe).map((_e,ge)=>ae[(de+ge)%ae.length])):xe.slice(oe+1)}setTimeout(()=>pv(xe))}var ae,de})})))}),OP={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function pv(n){const a=document.activeElement;for(const u of n)if(u===a||(u.focus(),document.activeElement!==a))return}const fv=LP,_m=BP,[mv,gv]=Rc("ToggleGroup",[hd]),yv=hd(),$P=Bt.forwardRef((n,a)=>{const{type:u,...g}=n;if(u==="single"){const _=g;return Bt.createElement(UP,Ve({},_,{ref:a}))}if(u==="multiple"){const _=g;return Bt.createElement(NP,Ve({},_,{ref:a}))}throw new Error("Missing prop `type` expected on `ToggleGroup`")}),[_v,xv]=mv("ToggleGroup"),UP=Bt.forwardRef((n,a)=>{const{value:u,defaultValue:g,onValueChange:_=()=>{},...w}=n,[T,l]=Lc({prop:u,defaultProp:g,onChange:_});return Bt.createElement(_v,{scope:n.__scopeToggleGroup,type:"single",value:T?[T]:[],onItemActivate:l,onItemDeactivate:Bt.useCallback(()=>l(""),[l])},Bt.createElement(vv,Ve({},w,{ref:a})))}),NP=Bt.forwardRef((n,a)=>{const{value:u,defaultValue:g,onValueChange:_=()=>{},...w}=n,[T=[],l]=Lc({prop:u,defaultProp:g,onChange:_}),O=Bt.useCallback(V=>l((K=[])=>[...K,V]),[l]),D=Bt.useCallback(V=>l((K=[])=>K.filter(ae=>ae!==V)),[l]);return Bt.createElement(_v,{scope:n.__scopeToggleGroup,type:"multiple",value:T,onItemActivate:O,onItemDeactivate:D},Bt.createElement(vv,Ve({},w,{ref:a})))}),[VP,jP]=mv("ToggleGroup"),vv=Bt.forwardRef((n,a)=>{const{__scopeToggleGroup:u,disabled:g=!1,rovingFocus:_=!0,orientation:w,dir:T="ltr",loop:l=!0,...O}=n,D=yv(u),V={role:"group",dir:T,...O};return Bt.createElement(VP,{scope:u,rovingFocus:_,disabled:g},_?Bt.createElement(fv,Ve({asChild:!0},D,{orientation:w,dir:T,loop:l}),Bt.createElement(Si.div,Ve({},V,{ref:a}))):Bt.createElement(Si.div,Ve({},V,{ref:a})))}),qP=Bt.forwardRef((n,a)=>{const u=xv("ToggleGroupItem",n.__scopeToggleGroup),g=jP("ToggleGroupItem",n.__scopeToggleGroup),_=yv(n.__scopeToggleGroup),w=u.value.includes(n.value),T=g.disabled||n.disabled,l={...n,pressed:w,disabled:T},O=Bt.useRef(null);return g.rovingFocus?Bt.createElement(_m,Ve({asChild:!0},_,{focusable:!T,active:w,ref:O}),Bt.createElement(q_,Ve({},l,{ref:a}))):Bt.createElement(q_,Ve({},l,{ref:a}))}),q_=Bt.forwardRef((n,a)=>{const{__scopeToggleGroup:u,value:g,..._}=n,w=xv("ToggleGroupItem",u),T={role:"radio","aria-checked":n.pressed,"aria-pressed":void 0},l=w.type==="single"?T:void 0;return Bt.createElement(IP,Ve({},l,_,{ref:a,onPressedChange:O=>{O?w.onItemActivate(g):w.onItemDeactivate(g)}}))}),GP=$P,ZP=qP,[WP,EM]=Rc("Toolbar",[hd,gv]),xm=hd(),bv=gv(),[XP,KP]=WP("Toolbar"),HP=Z.exports.forwardRef((n,a)=>{const{__scopeToolbar:u,orientation:g="horizontal",dir:_="ltr",loop:w=!0,...T}=n,l=xm(u);return Z.exports.createElement(XP,{scope:u,orientation:g},Z.exports.createElement(fv,Ve({asChild:!0},l,{orientation:g,dir:_,loop:w}),Z.exports.createElement(Si.div,Ve({role:"toolbar","aria-orientation":g,dir:_},T,{ref:a}))))}),YP=Z.exports.forwardRef((n,a)=>{const{__scopeToolbar:u,...g}=n,_=xm(u);return Z.exports.createElement(_m,Ve({asChild:!0},_,{focusable:!n.disabled}),Z.exports.createElement(Si.button,Ve({type:"button"},g,{ref:a})))}),JP=Z.exports.forwardRef((n,a)=>{const{__scopeToolbar:u,...g}=n,_=xm(u);return Z.exports.createElement(_m,Ve({asChild:!0},_,{focusable:!0}),Z.exports.createElement(Si.a,Ve({},g,{ref:a,onKeyDown:Wn(n.onKeyDown,w=>{w.key===" "&&w.currentTarget.click()})})))}),QP=Z.exports.forwardRef((n,a)=>{const{__scopeToolbar:u,...g}=n,_=KP("ToolbarToggleGroup",u),w=bv(u);return Z.exports.createElement(GP,Ve({"data-orientation":_.orientation},w,g,{ref:a,rovingFocus:!1}))}),eM=Z.exports.forwardRef((n,a)=>{const{__scopeToolbar:u,...g}=n,_=bv(u);return Z.exports.createElement(YP,Ve({asChild:!0},n),Z.exports.createElement(ZP,Ve({},_,g,{ref:a})))}),tM=HP,rM=JP,nM=QP,iM=eM,oM=Hr(tM,{display:"flex",height:"$4",width:"100%",boxSizing:"border-box",minWidth:"max-content",backgroundColor:"white",boxShadow:'0 2px 10px "black"'}),wv={all:"unset",flex:"0 0 auto",color:"$black",display:"inline-flex",padding:"0 $1 0 $1",fontSize:"$2",alignItems:"center","&:hover":{backgroundColor:"$hover",color:"$white"},"&:focus":{position:"relative",boxShadow:"0 0 0 2px blue"}},aM=Hr(rM,{...wv,backgroundColor:"transparent",color:"black",display:"inline-flex",justifyContent:"center",alignItems:"center"},{"&:hover":{backgroundColor:"$hover",color:"$white",cursor:"pointer"}}),sM=Hr(nM,{display:"inline-flex",borderRadius:4}),lM=Hr(iM,{...wv,boxShadow:0,backgroundColor:"white",marginLeft:2,cursor:"pointer","&:first-child":{marginLeft:0},"&[data-state=on]":{backgroundColor:"$primary",color:"$primaryText"}}),cM=oM,G_=aM,uM=sM,Z_=lM;function hM(n){const[a,u]=Z.exports.useState("maplibre");let g;return a==="maplibre"?g=nt(aE,{file:n.file,mapHashPassed:n.mapHashPassed}):g=nt(kP,{file:n.file}),wt(mh,{children:[wt(cM,{"aria-label":"Formatting options",children:[wt(uM,{type:"single",defaultValue:"center","aria-label":"Text alignment",value:a,onValueChange:u,children:[nt(Z_,{value:"maplibre","aria-label":"Right aligned",children:"Map View"}),nt(Z_,{value:"metadata","aria-label":"Left aligned",children:"Metadata"})]}),nt(G_,{href:`tileinspect/?url=${n.file.source.getKey()}`,children:"\u{1F50E} Tile Inspector"}),nt(G_,{css:{marginRight:10},children:n.file.source.getKey()})]}),g]})}const dM=Hr("div",{height:"$4",display:"flex",alignItems:"center",padding:"0 $2 0 $2"}),pM=Hr("a",{fontWeight:500,color:"unset",textDecoration:"none"}),fM=Hr("a",{color:"white",textDecoration:"none",fontSize:"$1"}),mM=Hr("span",{marginLeft:"auto"}),gM=Hr(kw,{backgroundColor:"black",position:"fixed",inset:0,opacity:"40%",zIndex:3}),yM=Hr(Iw,{backgroundColor:"black",color:"#ef4444",padding:"$1",borderRadius:6,position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90vw",zIndex:4,"&:focus":{outline:"none"}}),_M="669e1d6".substr(0,8);function xM(){bb();const[n,a]=Z.exports.useState(),[u,g]=Z.exports.useState(),[_,w]=Z.exports.useState(!1);Z.exports.useEffect(()=>{const O=new URLSearchParams(location.search).get("url");if(O){const D=new tf(O);g(D)}location.hash.includes("map")&&w(!0)},[]),Z.exports.useEffect(()=>{u&&u.getHeader().catch(O=>{a(O.message)})},[u]),Z.exports.useEffect(()=>{const O=new URL(window.location.href);u!=null&&u.source.getKey().startsWith("http")?(O.searchParams.set("url",u.source.getKey()),history.pushState(null,"",O.toString())):(O.searchParams.delete("url"),history.pushState(null,"",O.toString()))},[u]);const T=O=>{O.preventDefault(),g(void 0)},l=()=>{a(void 0)};return wt("div",{children:[wt(dM,{children:[nt(pM,{href:"/PMTiles/",onClick:T,children:"PMTiles Viewer"}),nt(mM,{children:wt(fM,{href:"https://github.com/protomaps/PMTiles",target:"_blank",children:[nt(zw,{})," ",_M]})})]}),u?nt(hM,{file:u,mapHashPassed:_}):nt(wb,{setFile:g}),nt(Tw,{open:n!==void 0,children:wt(Cw,{children:[nt(gM,{}),wt(yM,{onEscapeKeyDown:l,onPointerDownOutside:l,children:[nt("div",{children:u?u.source.getKey():null}),nt("div",{children:n}),nt(Aw,{})]})]})})]})}const W_=document.getElementById("root");W_&&Sb.createRoot(W_).render(nt(Bt.StrictMode,{children:nt(xM,{})}));
